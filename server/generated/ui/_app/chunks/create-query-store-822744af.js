var y=Object.defineProperty,I=Object.defineProperties;var j=Object.getOwnPropertyDescriptors;var f=Object.getOwnPropertySymbols;var v=Object.prototype.hasOwnProperty,D=Object.prototype.propertyIsEnumerable;var m=(a,t,e)=>t in a?y(a,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[t]=e,c=(a,t)=>{for(var e in t||(t={}))v.call(t,e)&&m(a,e,t[e]);if(f)for(var e of f(t))D.call(t,e)&&m(a,e,t[e]);return a},l=(a,t)=>I(a,j(t));import{C as O}from"./vendor-b03dee8a.js";const g=a=>{const t={},e={};for(const s of a){const n=s.id;t[n]=!0,e[n]=s}return{ids:Object.keys(t),data:e}},Q=(a,t,e,s=[])=>{let n=e;const r=()=>{a(l(c({},n),{onStart:q(i),onUpdate:S(i,t),onComplete:w(i,t)}))},o=u=>{n=c(c({},n),u),r()},i=O({loading:!0,updating:!1,ids:[],data:{}},()=>{const u=[];let d;for(const b of s){const C=b.subscribe(h=>o(h));u.push(C)}const p=()=>{d&&cancelIdleCallback(d),d=requestIdleCallback(r)};s.length||setTimeout(p,0);const k=setInterval(p,3e4);return()=>{d&&cancelIdleCallback(d);for(const b of u)b();clearInterval(k)}});return c({},i)},q=a=>{a.update(t=>{const s=!t.ids.length,n=!s;return l(c({},t),{loading:s,updating:n})})},S=(a,t)=>e=>{const s=t(e),{ids:n,data:r}=g(s);return a.update(o=>l(c({},o),{ids:[...o.ids,...Object.keys(n)],data:c(c({},o.data),r)}))},w=(a,t)=>e=>{const s=t(e),{ids:n,data:r}=g(s);return a.update(o=>l(c({},o),{loading:!1,updating:!1,ids:Object.keys(n),data:r}))};export{Q as c};
