var S=Object.defineProperty,b=Object.defineProperties;var m=Object.getOwnPropertyDescriptors;var T=Object.getOwnPropertySymbols;var C=Object.prototype.hasOwnProperty,g=Object.prototype.propertyIsEnumerable;var f=(t,e,s)=>e in t?S(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s,l=(t,e)=>{for(var s in e||(e={}))C.call(e,s)&&f(t,s,e[s]);if(T)for(var s of T(e))g.call(e,s)&&f(t,s,e[s]);return t},y=(t,e)=>b(t,m(e));import{ad as o,C as k}from"./vendor-b03dee8a.js";import{b as h}from"./workflow-execution-service-1dbf448e.js";import{c as p}from"./create-query-store-822744af.js";const O=t=>t.history.events.map(e=>y(l({},e),{id:String(e.eventId)})),q=t=>t.length===0,I=(t,e,s)=>{let r=t;for(Array.isArray(e)||(e=e.split("."));e.length;){const c=e.shift();q(e)?r[c]=s:(typeof r[c]=="undefined"&&(r[c]={}),r=r[c])}return t},F=t=>!!t.activityTaskScheduledEventAttributes,R=t=>!!t.activityTaskStartedEventAttributes,j=t=>!!t.activityTaskCompletedEventAttributes,w=t=>!!t.activityTaskFailedEventAttributes,$=t=>!!t.activityTaskTimedOutEventAttributes,H=t=>!!t.activityTaskCancelRequestedEventAttributes,L=t=>!!t.activityTaskCanceledEventAttributes,Q=t=>e=>{t[e]||(t[e]={}),t[e].id=e},W=t=>(e,s)=>{t[e]||(t[e]={}),t[e].status=s},x=t=>(e,s,r)=>{t[e]||(t[e]={}),t[e][s]=r},z=t=>{const e=o(t,r=>{const c={},a=x(c),d=Q(c),v=W(c);for(const n of r){if(F(n)){const i=n.activityTaskScheduledEventAttributes.activityId;a(i,"activityTaskScheduledEvent",n),d(i),v(i,"Started")}if(R(n)){const i=String(n.activityTaskStartedEventAttributes.scheduledEventId);a(i,"activityTaskStartedEvent",n),v(i,"Started")}if(j(n)){const i=String(n.activityTaskCompletedEventAttributes.scheduledEventId);a(i,"activityTaskCompletedEvent",n),v(i,"Completed")}if(w(n)){const i=String(n.activityTaskFailedEventAttributes.scheduledEventId);a(i,"activityTaskFailedEvent",n),v(i,"Failed")}if($(n)){const i=String(n.activityTaskTimedOutEventAttributes.scheduledEventId);a(i,"activityTaskTimedOutEvent",n),v(i,"TimedOut")}if(H(n)){const i=String(n.activityTaskCancelRequestedEventAttributes.scheduledEventId);a(i,"activityTaskCancelRequestedEvent",n),v(i,"CancelRequested")}if(L(n)){const i=String(n.activityTaskCanceledEventAttributes.scheduledEventId);a(i,"activityTaskCanceledEvent",n),v(i,"Canceled")}}return c},{}),s=o(e,r=>Object.values(r));return y(l({},s),{getActivity:r=>o(e,c=>c[r]||{})})},u={},B=(t,e,s)=>{const r=p(h,O,{namespace:t,executionId:e,runId:s}),c=o(r,i=>Object.values(i.data),[]),a=k("grid"),d=k(null),v=o([c,d],([i,E])=>i.filter(A=>!(E&&!String(A.eventType).startsWith(E))),[]),n=z(c);return{subscribe:r.subscribe,all:c,filtered:v,activities:n,format:a,type:d}},M=(t,e,s)=>{var a,d;let r=(d=(a=u==null?void 0:u[t])==null?void 0:a[e])==null?void 0:d[s];const c=`${t}.${e}.${s}`;return r||(r=B(t,e,s),I(u,c,r)),r};export{M as c};
