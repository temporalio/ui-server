var O=Object.defineProperty;var T=Object.getOwnPropertySymbols;var S=Object.prototype.hasOwnProperty,C=Object.prototype.propertyIsEnumerable;var g=(n,o,c)=>o in n?O(n,o,{enumerable:!0,configurable:!0,writable:!0,value:c}):n[o]=c,t=(n,o)=>{for(var c in o||(o={}))S.call(o,c)&&g(n,c,o[c]);if(T)for(var c of T(o))C.call(o,c)&&g(n,c,o[c]);return n};import{b as _,d as $,t as U}from"./route-for-15bcc76e.js";import{w as b}from"./index-c9e619a8.js";import{n as I}from"./notifications-cfed8e58.js";import{i as k}from"./is-network-error-ac7c8caf.js";import{i as q}from"./is-function-b969a126.js";const x=b(null),F=n=>{if(N(n)&&_){window.location.assign($());return}if(K(n)&&_){window.location.assign($());return}if(k(n))throw I.add("error",`${n.statusCode} ${n.statusText}`),x.set(n),n;typeof n=="string"&&I.add("error",n),n instanceof Error&&I.add("error",n.message)},N=n=>k(n)?n.statusCode===401:!1,K=n=>k(n)?n.statusCode===403:!1,m=n=>n.message!==void 0&&typeof n.message=="string",B=async(n,o={},c=10)=>{var E;const{params:l={},request:f=fetch,token:w,shouldRetry:h=!1,notifyOnError:A=!0,onError:d,retryInterval:P=5e3}=o;let{options:s}=o;const V=w?{next_page_token:w}:{},v=new URLSearchParams(t(t({},l),V)),y=U(n,v);try{s=D(s),globalThis!=null&&globalThis.AccessToken&&(s.headers=await M(s==null?void 0:s.headers,globalThis.AccessToken));const i=await f(y,s),u=await i.json(),{status:L,statusText:R}=i;if(!i.ok)if(d&&q(d))d({status:L,statusText:R,body:u});else throw{statusCode:i.status,statusText:i.statusText,response:i,message:(E=u==null?void 0:u.message)!=null?E:i.statusText};return u}catch(i){if(A){if(F(i),h&&c>0)return new Promise(u=>{setTimeout(()=>{u(B(n,o,c-1))},P)})}else throw i}},D=n=>{const o=t({credentials:"include"},n);return o.headers=j(n==null?void 0:n.headers),o},M=async(n,o)=>{n||(n={});try{const c=await o();c&&(n.Authorization=`Bearer ${c}`)}catch(c){console.error(c)}return n},j=n=>{n||(n={});const o="_csrf=",c="X-CSRF-TOKEN";try{let f=document.cookie.split(";").find(w=>w.includes(o));f&&!n[c]&&(f=f.trim().slice(o.length),n[c]=f)}catch(l){console.error(l)}return n},z=(n,o)=>n.replace("%namespace%",o),W=n=>{var c;let o="";return((c=globalThis==null?void 0:globalThis.AppConfig)==null?void 0:c.apiUrl)&&n?o=z(globalThis.AppConfig.apiUrl,n):o="",o.endsWith("/")&&(o=o.slice(0,-1)),o},H=(n,o)=>(n.startsWith("/")&&(n=n.slice(1)),`${W(o)}/api/v1/${n}`),X=n=>Object.keys(n!=null?n:{}).reduce((o,c)=>(o[c]=encodeURIComponent(encodeURIComponent(n[c])),o),{namespace:"",workflowId:"",runId:"",queue:""});function p(n,o,c=!0){c&&(o=X(o));const l={cluster:"/cluster",settings:"/settings",user:"/me",namespaces:"/namespaces","task-queue":`/namespaces/${o==null?void 0:o.namespace}/task-queues/${o==null?void 0:o.queue}`,workflows:`/namespaces/${o==null?void 0:o.namespace}/workflows`,"workflows.archived":`/namespaces/${o==null?void 0:o.namespace}/workflows/archived`,workflow:`/namespaces/${o==null?void 0:o.namespace}/workflows/${o==null?void 0:o.workflowId}/runs/${o==null?void 0:o.runId}`,"workflow.terminate":`/namespaces/${o==null?void 0:o.namespace}/workflows/${o==null?void 0:o.workflowId}/runs/${o==null?void 0:o.runId}/terminate`,"events.ascending":`/namespaces/${o==null?void 0:o.namespace}/workflows/${o==null?void 0:o.workflowId}/runs/${o==null?void 0:o.runId}/events`,"events.descending":`/namespaces/${o==null?void 0:o.namespace}/workflows/${o==null?void 0:o.workflowId}/runs/${o==null?void 0:o.runId}/events/reverse`,query:`/namespaces/${o==null?void 0:o.namespace}/workflows/${o==null?void 0:o.workflowId}/runs/${o==null?void 0:o.runId}/query`};return H(l[n],o==null?void 0:o.namespace)}export{p as a,F as h,m as i,x as n,B as r};
