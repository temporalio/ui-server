var g=Object.defineProperty,j=Object.defineProperties;var I=Object.getOwnPropertyDescriptors;var u=Object.getOwnPropertySymbols;var x=Object.prototype.hasOwnProperty,$=Object.prototype.propertyIsEnumerable;var b=(e,t,s)=>t in e?g(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,l=(e,t)=>{for(var s in t||(t={}))x.call(t,s)&&b(e,s,t[s]);if(u)for(var s of u(t))$.call(t,s)&&b(e,s,t[s]);return e},m=(e,t)=>j(e,I(t));var v=(e,t)=>{var s={};for(var r in e)x.call(e,r)&&t.indexOf(r)<0&&(s[r]=e[r]);if(e!=null&&u)for(var r of u(e))t.indexOf(r)<0&&$.call(e,r)&&(s[r]=e[r]);return s};import{h as q,r as y}from"./request-from-api-a1f394a2.js";import{aq as C,ar as P}from"./vendor-b03dee8a.js";const p=e=>typeof e=="function",A=(e={},t={})=>{const s=l({},e);for(const r of Object.keys(t)){const o=s[r];Array.isArray(o)?s[r]=s[r].concat(t[r]):typeof o=="object"&&!Array.isArray(o)?s[r]=A(s[r],t[r]):s[r]=t[r]}return s},w=async(e,{onStart:t,onUpdate:s,onComplete:r,onError:o=q,token:a,previousProps:c}={})=>{!c&&p(t)&&t();try{const f=await e(a),{nextPageToken:h}=f,k=v(f,["nextPageToken"]),i=A(c,k);return p(s)&&s(i,k),h?w(e,{onStart:t,onUpdate:s,onComplete:r,token:h,previousProps:i}):(p(r)&&r(i),i)}catch(n){o(n)}},W=e=>C(P(new Date,e)),d=e=>async({namespace:t,onStart:s,onUpdate:r,onComplete:o,startTime:a={days:1}},c=fetch)=>await w(async f=>y(`/namespaces/${t}/workflows/${e}`,{params:{"start_time_filter.earliest_time":W(a)},token:f,request:c}),{onStart:s,onUpdate:r,onComplete:o}),F=async e=>{const{onComplete:t}=e,s={executions:[]},r=n=>{s.executions.push(...n.executions),o&&a&&p(t)&&t(s)};let o=!1,a=!1;const c=await d("open")(m(l({},e),{onComplete:n=>{o=!0,r(n)}})),f=await d("closed")(m(l({},e),{onComplete:n=>{a=!0,r(n)}}));return{executions:[...c.executions,...f.executions]}};async function O({executionId:e,runId:t,namespace:s},r=fetch){return y(`/namespaces/${s}/workflows/${e}/executions/${t}`,{request:r})}const T=async({namespace:e,executionId:t,runId:s,onStart:r,onUpdate:o,onComplete:a},c=fetch)=>await w(async n=>y(`/namespaces/${e}/workflows/${t}/executions/${s}/events`,{token:n,request:c}),{onStart:r,onUpdate:o,onComplete:a});export{O as a,T as b,F as f};
