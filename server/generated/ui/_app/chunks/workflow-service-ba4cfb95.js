var K=Object.defineProperty,P=Object.defineProperties;var Q=Object.getOwnPropertyDescriptors;var I=Object.getOwnPropertySymbols;var R=Object.prototype.hasOwnProperty,N=Object.prototype.propertyIsEnumerable;var E=(t,o,n)=>o in t?K(t,o,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[o]=n,h=(t,o)=>{for(var n in o||(o={}))R.call(o,n)&&E(t,n,o[n]);if(I)for(var n of I(o))N.call(o,n)&&E(t,n,o[n]);return t},A=(t,o)=>P(t,Q(o));import{X as j}from"./index-68c8bf39.js";import{s as B}from"./settings-e5e19f0d.js";import{s as F}from"./simplify-attributes-018c5a8d.js";import{r as $,a as S}from"./route-for-api-6952cf05.js";import{b as L,e as _,h as W,j as O}from"./to-duration-6d22e6d2.js";const U=(t=B)=>!j(t).disableWriteActions,V=(t=[])=>t.map(o=>{const n=F(o,!0),i=o.activityId;return A(h({},n),{id:i})}),b=t=>{var k,d,x,g,y,T;const o=t.workflowExecutionInfo.type.name,n=t.workflowExecutionInfo.execution.workflowId,i=t.workflowExecutionInfo.execution.runId,a=String(t.workflowExecutionInfo.startTime),l=String(t.workflowExecutionInfo.closeTime),r=t.workflowExecutionInfo.status,f=t.workflowExecutionInfo.status==="Running",w=t.workflowExecutionInfo.historyLength,m=`/workflows/${n}/${i}`,c=(d=(k=t==null?void 0:t.executionConfig)==null?void 0:k.taskQueue)==null?void 0:d.name,e=(x=t==null?void 0:t.workflowExecutionInfo)==null?void 0:x.parentNamespaceId,u=(g=t==null?void 0:t.workflowExecutionInfo)==null?void 0:g.parentExecution,s=t.workflowExecutionInfo.stateTransitionCount,C=(y=t.executionConfig)==null?void 0:y.defaultWorkflowTaskTimeout,D=V(t.pendingActivities),q=(T=t==null?void 0:t.pendingChildren)!=null?T:[];return{name:o,id:n,runId:i,startTime:a,endTime:l,status:r,historyEvents:w,url:m,taskQueue:c,pendingActivities:D,pendingChildren:q,parentNamespaceId:e,parent:u,stateTransitionCount:s,isRunning:f,defaultWorkflowTaskTimeout:C,get canBeTerminated(){return f&&U()}}},X=t=>(t.executions||[]).map(o=>b({workflowExecutionInfo:o})),z={workflowId:"WorkflowId",workflowType:"WorkflowType",timeRange:"StartTime",executionStatus:"ExecutionStatus",closeTime:"CloseTime"},G=["workflowId","workflowType","timeRange","executionStatus","closeTime"],H=t=>!(t===null||t===void 0||t===""||typeof t=="string"&&t==="undefined"),J=t=>{if(typeof t!="string")return!1;for(const o of G)if(o===t)return!0;return!1},M=(t,o,n)=>{const i=z[t];return o==="All"?"":L(o)||_(o)?n?`${i} > "${W(o)}"`:`${i} BETWEEN "${W(o)}" AND "${O()}"`:`${i}="${o}"`},Y=(t,o)=>Object.entries(t).map(([n,i])=>{if(J(n)&&H(i))return M(n,i,o)}).filter(Boolean),Z=(t,o=!1)=>Y(t,o).join(" and "),p=async(t,o,n=fetch,i=!1)=>{var c;const a=decodeURIComponent(o.query||Z(o,i)),l=i?"workflows.archived":"workflows";let r="";const f=e=>{var u,s;return r=(s=(u=e==null?void 0:e.body)==null?void 0:u.message)!=null?s:`Error fetching workflows: ${e.status}: ${e.statusText}`},{executions:w,nextPageToken:m}=(c=await $(S(l,{namespace:t}),{params:{query:a},onError:f,request:n}))!=null?c:{executions:[],nextPageToken:""};return{workflows:X({executions:w}),nextPageToken:String(m),error:r}},rt=async(t,o,n=fetch)=>p(t,o,n,!0);async function ft(t,o=fetch){return $(S("workflow",t),{request:o}).then(b)}export{p as a,rt as b,ft as f,Z as t};
