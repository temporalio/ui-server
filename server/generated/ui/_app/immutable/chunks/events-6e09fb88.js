import{d as o,r as g,w as u}from"./index-ed4e6b3e.js";import{p as i}from"./stores-3338201a.js";import{a as y}from"./events-service-0199f727.js";import{a as l,b as c}from"./event-view-a27e0aa0.js";import{m}from"./route-for-62d7d3b1.js";import{w as k,d as I}from"./with-loading-f07bedaf.js";import{g as b}from"./index-9319d41b.js";import{r as v}from"./workflow-run-78f5baa7.js";import{a6 as P}from"./index-9ea626a2.js";const h={events:[],eventGroups:[]},E=o([i],([e])=>e.params.namespace?m(e.params.namespace):""),G=o([i],([e])=>e.params.workflow?m(e.params.workflow):""),_=o([i],([e])=>e.params.run?m(e.params.run):""),S=o([i],([e])=>e.stuff.settings),p={namespace:null,workflowId:null,runId:null,rawPayloads:null,sort:null},d=u(p),D=()=>{d.set(p)},q=(e,t)=>{for(const n of["namespace","workflowId","runId"])if(!e[n])return!1;let r=!0;const s=P(t);for(const n of Object.keys(s))if(s[n]!==e[n]){r=!1;break}return r?!1:(t.set(e),!0)},H=o([E,G,_,l],([e,t,r,s])=>({namespace:e,workflowId:t,runId:r,sort:s})),O=o([H,S,v],([e,t,r])=>({...e,settings:t,refresh:v,$refresh:r})),R=e=>O.subscribe(async t=>{const{settings:r,...s}=t;q(s,d)&&k(C,x,async()=>{var a;const n=await y(t);(a=n==null?void 0:n.events)!=null&&a.length?e(n):setTimeout(()=>{e(n)},I)})}),f=g(h,R),j=u(null),J=o([f,c,j],([e,t,r])=>{if(r)return r;const{events:s}=e;return t?s.filter(n=>n.category===t):s}),K=o([f,c],([e,t])=>{const{eventGroups:r}=e;return t?r.filter(s=>s.category===t):r}),M=o([f,l,c],([e,t,r])=>{const{events:s}=e,n=t==="descending"?s.slice().reverse():s,a=b(n);return r?a.filter(w=>w.category===r):a});o([f,l,c],([e,t,r])=>{const{events:s}=e,n=t==="descending"?s.slice().reverse():s;return r?n.filter(a=>a.category===r):n});const x=u(!0),C=u(!0);export{M as a,J as b,D as c,K as d,f as e,j as t,x as u};
