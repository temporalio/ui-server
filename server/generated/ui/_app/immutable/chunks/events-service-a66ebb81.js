import{d as v,w as Q}from"./index-87898c83.js";import{p as y}from"./stores-46e0fa40.js";import{e as J}from"./event-view-dd8ea025.js";import{l as S}from"./route-for-9e2a964e.js";import{r as R}from"./workflow-run-f80f3337.js";import{a as L}from"./auth-user-46bafa9a.js";import{S as O,i as W,s as X,k as E,a as D,q as Y,l as w,m as k,c as P,r as Z,h as _,n as b,Q as T,b as q,K as p,f as d,g as V,t as g,d as z,u as U,ae as x,M as C,N as G,w as $,x as ee,y as te,z as se,F as ne,G as ae,H as oe,I as re}from"./index-eadb3ae7.js";import{I as ie}from"./icon-4da365da.js";import{p as j}from"./paginated-8fdd6ac7.js";import{r as A,a as F}from"./route-for-api-b7e90108.js";import{t as I}from"./index-4630a992.js";import{a as le}from"./is-199b1f9e.js";const ce=v([y],([t])=>t.params.namespace?S(t.params.namespace):""),fe=v([y],([t])=>t.params.workflow?S(t.params.workflow):""),ue=v([y],([t])=>t.params.run?S(t.params.run):""),me=v([y],([t])=>{var e;return(e=t.data)==null?void 0:e.settings}),de=v([L],([t])=>t==null?void 0:t.accessToken),_e=v([ce,fe,ue,J],([t,e,n,r])=>({namespace:t,workflowId:e,runId:n,sort:r}));v([_e,me,de,R],([t,e,n,r])=>({...t,settings:e,accessToken:n,refresh:R,$refresh:r}));const ve={start:[],end:[]},Re=Q(ve),De=Q(null);function K(t){let e,n,r;return n=new ie({props:{name:t[2]}}),{c(){e=E("div"),$(n.$$.fragment)},l(s){e=w(s,"DIV",{});var a=k(e);ee(n.$$.fragment,a),a.forEach(_)},m(s,a){q(s,e,a),te(n,e,null),r=!0},p(s,a){const l={};a&4&&(l.name=s[2]),n.$set(l)},i(s){r||(d(n.$$.fragment,s),r=!0)},o(s){g(n.$$.fragment,s),r=!1},d(s){s&&_(e),se(n)}}}function M(t){let e,n;const r=t[7].default,s=ne(r,t,t[6],null);return{c(){e=E("div"),s&&s.c(),this.h()},l(a){e=w(a,"DIV",{class:!0});var l=k(e);s&&s.l(l),l.forEach(_),this.h()},h(){b(e,"class","content svelte-19bo4l1")},m(a,l){q(a,e,l),s&&s.m(e,null),n=!0},p(a,l){s&&s.p&&(!n||l&64)&&ae(s,r,a,a[6],n?re(r,a[6],l,null):oe(a[6]),null)},i(a){n||(d(s,a),n=!0)},o(a){g(s,a),n=!1},d(a){a&&_(e),s&&s.d(a)}}}function he(t){let e,n,r,s,a,l,m,u,i=t[2]&&K(t),o=t[5].default&&M(t);return{c(){e=E("div"),i&&i.c(),n=D(),r=E("div"),s=E("h5"),a=Y(t[1]),l=D(),o&&o.c(),this.h()},l(c){e=w(c,"DIV",{class:!0});var f=k(e);i&&i.l(f),n=P(f),r=w(f,"DIV",{class:!0});var h=k(r);s=w(h,"H5",{class:!0});var H=k(s);a=Z(H,t[1]),H.forEach(_),l=P(h),o&&o.l(h),h.forEach(_),f.forEach(_),this.h()},h(){b(s,"class","font-semibold leading-6"),b(r,"class","ml-1"),b(e,"class",m="alert "+t[0]+" "+t[4].class+" svelte-19bo4l1"),T(e,"bold",t[3])},m(c,f){q(c,e,f),i&&i.m(e,null),p(e,n),p(e,r),p(r,s),p(s,a),p(r,l),o&&o.m(r,null),u=!0},p(c,[f]){c[2]?i?(i.p(c,f),f&4&&d(i,1)):(i=K(c),i.c(),d(i,1),i.m(e,n)):i&&(V(),g(i,1,1,()=>{i=null}),z()),(!u||f&2)&&U(a,c[1]),c[5].default?o?(o.p(c,f),f&32&&d(o,1)):(o=M(c),o.c(),d(o,1),o.m(r,null)):o&&(V(),g(o,1,1,()=>{o=null}),z()),(!u||f&17&&m!==(m="alert "+c[0]+" "+c[4].class+" svelte-19bo4l1"))&&b(e,"class",m),(!u||f&25)&&T(e,"bold",c[3])},i(c){u||(d(i),d(o),u=!0)},o(c){g(i),g(o),u=!1},d(c){c&&_(e),i&&i.d(),o&&o.d()}}}function ge(t,e,n){let{$$slots:r={},$$scope:s}=e;const a=x(r);let{intent:l}=e,{title:m}=e,{icon:u=null}=e,{bold:i=!1}=e;return t.$$set=o=>{n(4,e=C(C({},e),G(o))),"intent"in o&&n(0,l=o.intent),"title"in o&&n(1,m=o.title),"icon"in o&&n(2,u=o.icon),"bold"in o&&n(3,i=o.bold),"$$scope"in o&&n(6,s=o.$$scope)},e=G(e),[l,m,u,i,e,a,s,r]}class Pe extends O{constructor(e){super(),W(this,e,ge,he,X,{intent:0,title:1,icon:2,bold:3})}}const B=t=>!le(t)||t==="descending"?"events.descending":t==="ascending"?"events.ascending":"events.descending",Te=async({namespace:t,workflowId:e,runId:n,sort:r,onStart:s,onUpdate:a,onComplete:l})=>{const m=B(r),u=await A(m,{namespace:t,workflowId:e,runId:n});return(await j(async o=>F(u,{token:o,request:fetch}),{onStart:s,onUpdate:a,onComplete:l})).history.events},Ve=async({namespace:t,workflowId:e,runId:n,sort:r,settings:s,accessToken:a,onStart:l,onUpdate:m,onComplete:u})=>{const i=B(r),o=await A(i,{namespace:t,workflowId:e,runId:n}),c=await j(async h=>F(o,{token:h,request:fetch}),{onStart:l,onUpdate:m,onComplete:u});return await I({response:c.history.events,namespace:t,settings:s,accessToken:a})},N=async({namespace:t,workflowId:e,runId:n,sort:r})=>{const s=await A(`events.${r}`,{namespace:t,workflowId:e,runId:n});try{return(await F(s,{request:fetch,params:{maximumPageSize:"20"}})).history.events}catch{return[]}},ze=async t=>{const{settings:e,namespace:n,accessToken:r}=t,s=await N({...t,sort:"ascending"}),a=await N({...t,sort:"descending"}),[l,m]=await Promise.all([I({response:s,namespace:n,settings:e,accessToken:r}),I({response:a,namespace:n,settings:e,accessToken:r})]);return{start:l,end:m}};export{Pe as A,Te as a,Ve as b,Re as e,ze as f,ve as i,De as t};
