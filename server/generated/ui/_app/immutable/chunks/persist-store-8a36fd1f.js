import{w as f}from"./index-73e3ae8e.js";import{p as g,s as d}from"./parse-with-big-int-02e81897.js";const u=e=>typeof e=="function";function I(e,r=null,p=!1){var i,a;let s=u(r)?r():r,o;try{(i=window==null?void 0:window.localStorage)!=null&&i.getItem(e)&&(s=g(((a=window==null?void 0:window.localStorage)==null?void 0:a.getItem(e))??""))}catch{s=null}const{subscribe:w,set:n}=f(s);if(p)try{o=new BroadcastChannel(`persist-store-${e}`),o==null||o.addEventListener("message",t=>{n(t.data)})}catch{console.error("Browser does not support BroadcastChannel")}return{subscribe:w,set:t=>{var l,c;o&&o.postMessage(t),t===null?(l=window==null?void 0:window.localStorage)==null||l.removeItem(e):(c=window==null?void 0:window.localStorage)==null||c.setItem(e,d(t)),n(t)}}}export{u as i,I as p};
