import{S as $,i as y,s as h,l as b,a as g,w as S,m as w,c as N,x as C,p as c,b as u,y as E,T as x,f as O,t as T,h as f,B as A,r as F,u as I}from"../../chunks/index-f283717a.js";import{f as k}from"../../chunks/route-for-4a4bbbc1.js";import{g as B}from"../../chunks/navigation-fbe70647.js";import{B as J}from"../../chunks/button-397b3a8c.js";import{t as U}from"../../chunks/index-d52817b7.js";import{n as v}from"../../chunks/notifications-dddf88f8.js";import{i as G,a as L}from"../../chunks/import-events-a4e951c1.js";import"../../chunks/get-public-path-6c4a8950.js";import"../../chunks/singletons-eca981c1.js";import"../../chunks/icon-c6a60499.js";import"../../chunks/badge-46845e47.js";/* empty css                                                        */import"../../chunks/is-http-d28111f6.js";import"../../chunks/index-5dff130b.js";import"../../chunks/persist-store-c4deb1a0.js";import"../../chunks/is-function-45497f08.js";import"../../chunks/data-converter-config-49e426af.js";import"../../chunks/atob-5380a47e.js";import"../../chunks/format-date-e7563fe7.js";import"../../chunks/to-duration-a5f6615f.js";import"../../chunks/is-6159121b.js";import"../../chunks/index-9319d41b.js";import"../../chunks/has-ae9b6b71.js";import"../../chunks/get-event-categorization-2cfb578f.js";import"../../chunks/simplify-attributes-61797c15.js";const _={auth:{enabled:!1,options:[]},baseUrl:"base",codec:{},defaultNamespace:"namespace",disableWriteActions:!1,showTemporalSystemNamespace:!1,notifyOnNewVersion:!1,feedbackURL:"",runtimeEnvironment:{isCloud:!1,isLocal:!0,envOverride:!1},version:"2.0.0"};function R(l){let t;return{c(){t=F("Import")},l(s){t=I(s,"Import")},m(s,o){u(s,t,o)},d(s){s&&f(t)}}}function j(l){let t,s,o,a,n,i;return o=new J({props:{icon:"file-upload",$$slots:{default:[R]},$$scope:{ctx:l}}}),o.$on("click",l[1]),{c(){t=b("input"),s=g(),S(o.$$.fragment),this.h()},l(e){t=w(e,"INPUT",{class:!0,type:!0,accept:!0}),s=N(e),C(o.$$.fragment,e),this.h()},h(){c(t,"class","import-input block rounded-md border border-gray-200 p-2"),c(t,"type","file"),c(t,"accept",".json")},m(e,r){u(e,t,r),u(e,s,r),E(o,e,r),a=!0,n||(i=x(t,"change",l[0]),n=!0)},p(e,[r]){const m={};r&8&&(m.$$scope={dirty:r,ctx:e}),o.$set(m)},i(e){a||(O(o.$$.fragment,e),a=!0)},o(e){T(o.$$.fragment,e),a=!1},d(e){e&&f(t),e&&f(s),A(o,e),n=!1,i()}}}function q(l){let t;return[async a=>{var n;const i=a.target,e=(n=i==null?void 0:i.files)===null||n===void 0?void 0:n[0],r=new FileReader;e&&(r.readAsText(e),r.onload=()=>{var m,p;try{const d=(p=(m=r==null?void 0:r.result)===null||m===void 0?void 0:m.toString())!==null&&p!==void 0?p:"";t=JSON.parse(d)}catch{v.add("error","Could not parse JSON")}})},async()=>{try{const{events:a,eventGroups:n}=await U({response:Array.isArray(t)?t:t==null?void 0:t.events,namespace:_.defaultNamespace,settings:_});G.set(a),L.set(n);const i=k({importType:"events",view:"feed"});B(i)}catch(a){console.error(a),v.add("error","Could not create event history from JSON")}}]}class ft extends ${constructor(t){super(),y(this,t,q,j,h,{})}}export{ft as default};
