var ue=Object.defineProperty,ce=Object.defineProperties;var me=Object.getOwnPropertyDescriptors;var A=Object.getOwnPropertySymbols;var de=Object.prototype.hasOwnProperty,_e=Object.prototype.propertyIsEnumerable;var G=(o,e,n)=>e in o?ue(o,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):o[e]=n,Q=(o,e)=>{for(var n in e||(e={}))de.call(e,n)&&G(o,n,e[n]);if(A)for(var n of A(e))_e.call(e,n)&&G(o,n,e[n]);return o},W=(o,e)=>ce(o,me(e));import{X as pe,S as q,i as z,s as P,e as j,t as R,k as D,c as U,a as O,h as x,d as v,m as S,b,Y as ee,g as N,M as k,T as ve,j as ge,l as y,E as ne,N as X,C as te,V as re,w as V,x as I,y as $,Z as H,q as g,o as h,B as E,_ as M,$ as J,n as he,p as be,I as we,J as ke,K as ye,L as Be}from"../chunks/index-68c8bf39.js";import{g as Ve}from"../chunks/get-namespace-1b8bcf77.js";import{s as Ie}from"../chunks/search-attributes-55a8c221.js";import{r as Y,a as Z}from"../chunks/route-for-api-5c8354ce.js";import{n as $e}from"../chunks/notifications-518c18f6.js";import{c as Ee,i as se}from"../chunks/version-check-4ef3b01c.js";import{f as Ne,N as Ce,E as Te}from"../chunks/error-boundary-cc5b4b1a.js";import{f as je}from"../chunks/settings-service-bfab03bd.js";/* empty css                    */import Ue from"./_header.svelte-b24cb106.js";import{p as ae}from"../chunks/stores-5114c64c.js";import{p as Oe}from"../chunks/persist-store-1f86d88b.js";import{P as Le}from"../chunks/page-title-7f1b4fc1.js";import"../chunks/index-f99f80f5.js";import"../chunks/route-for-0fcfcb54.js";import"../chunks/is-network-error-ac7c8caf.js";import"../chunks/is-function-b969a126.js";import"../chunks/get-api-origin-7e36d6d7.js";import"../chunks/index-e1d0d1fc.js";import"../chunks/error-57b6f650.js";import"../chunks/navigation-6709cf39.js";import"../chunks/singletons-d1fb5791.js";import"../chunks/link-47891654.js";import"../chunks/settings-e5e19f0d.js";import"../chunks/index-e75fc38f.js";import"../chunks/feature-tag-b6ee075f.js";import"../chunks/nav-open-cf977121.js";import"../chunks/_nav-row-4f4d7b87.js";import"../chunks/empty-state-1894a157.js";import"../chunks/tooltip-d3a292a9.js";import"../chunks/copyable-3ae46b30.js";import"../chunks/copy-to-clipboard-d03df54a.js";import"../chunks/data-encoder-status-17725524.js";import"../chunks/data-converter-config-47f05b39.js";import"../chunks/is-http-af6e754e.js";import"../chunks/modal-5af02eb3.js";import"../chunks/button-73ba6201.js";import"../chunks/badge-42583471.js";/* empty css                                                     */import"../chunks/namespaces-a2a9adc6.js";const De=(o,e)=>!o.auth.enabled||Boolean(e==null?void 0:e.email),Se=async(o,e=fetch)=>{if(!o.runtimeEnvironment.isCloud)return await Y(Z("search-attributes"),{request:e}).then(n=>(n!=null&&n.keys&&Ie.set(n.keys),n))},qe=async(o=fetch)=>{const e=await o("https://api.github.com/repos/temporalio/ui-server/releases"),n=await e.json();if(!e.ok)return;let t;if(n.length>0){const{tag_name:r}=n[0];t=r.replace("v","")}return t},oe={namespaces:[]};async function ze(o,e=fetch){if(o.runtimeEnvironment.isCloud)return oe;const n=await Y(Z("namespaces"),{request:e,onError:()=>$e.add("error","Unable to fetch namespaces")});return n!=null?n:oe}const Pe=async(o,e=fetch)=>{if(!o.runtimeEnvironment.isCloud)return await Y(Z("cluster"),{request:e}).then(n=>(Ee.set(n),n))};var F=(o=>(o[o.TemporalVersion=1]="TemporalVersion",o[o.UIVersion=2]="UIVersion",o))(F||{});const K=Oe("closedBanners",null),Fe=o=>{var n;let e=(n=pe(K))!=null?n:[];e=[...e,o],e=e.slice(e.length-10,e.length),K.set(e)};function ie(o){let e,n,t,r,s,i,a,l,f,u;return{c(){e=j("section"),n=j("a"),t=R(o[2]),r=D(),s=j("button"),i=R("\u2715"),this.h()},l(c){e=U(c,"SECTION",{class:!0,"data-cy":!0});var d=O(e);n=U(d,"A",{href:!0,target:!0});var _=O(n);t=x(_,o[2]),_.forEach(v),r=S(d),s=U(d,"BUTTON",{class:!0,"data-cy":!0});var w=O(s);i=x(w,"\u2715"),w.forEach(v),d.forEach(v),this.h()},h(){b(n,"href",o[3]),b(n,"target","_blank"),b(s,"class","text-black-600 absolute top-0 right-0 mr-5"),b(s,"data-cy","close-banner"),b(e,"class",a=ee(`relative block text-center leading-10 ${o[1]}`)+" svelte-1xgik0j"),b(e,"data-cy",l=o[5].dataCy)},m(c,d){N(c,e,d),k(e,n),k(n,t),k(e,r),k(e,s),k(s,i),f||(u=ve(s,"click",o[8]),f=!0)},p(c,d){d&4&&ge(t,c[2]),d&8&&b(n,"href",c[3]),d&2&&a!==(a=ee(`relative block text-center leading-10 ${c[1]}`)+" svelte-1xgik0j")&&b(e,"class",a),d&32&&l!==(l=c[5].dataCy)&&b(e,"data-cy",l)},d(c){c&&v(e),f=!1,u()}}}function He(o){let e,n=o[4]&&ie(o);return{c(){n&&n.c(),e=y()},l(t){n&&n.l(t),e=y()},m(t,r){n&&n.m(t,r),N(t,e,r)},p(t,[r]){t[4]?n?n.p(t,r):(n=ie(t),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},i:ne,o:ne,d(t){n&&n.d(t),t&&v(e)}}}function Me(o,e,n){let t,r;X(o,K,c=>n(7,r=c));let{key:s}=e,{severity:i}=e,{message:a}=e,{link:l}=e,{shownBanner:f}=e;const u=()=>Fe(s);return o.$$set=c=>{n(5,e=te(te({},e),re(c))),"key"in c&&n(0,s=c.key),"severity"in c&&n(1,i=c.severity),"message"in c&&n(2,a=c.message),"link"in c&&n(3,l=c.link),"shownBanner"in c&&n(6,f=c.shownBanner)},o.$$.update=()=>{o.$$.dirty&129&&n(4,t=!(r!=null?r:[]).includes(s)),o.$$.dirty&80&&(t||n(6,f++,f))},e=re(e),[s,i,a,l,t,e,f,r,u]}class le extends q{constructor(e){super(),z(this,e,Me,He,P,{key:0,severity:1,message:2,link:3,shownBanner:6})}}function Je(o){let e,n,t;function r(i){o[6](i)}let s={key:o[2],severity:o[1],message:o[5],link:o[3],dataCy:"temporal-version-banner"};return o[0]!==void 0&&(s.shownBanner=o[0]),e=new le({props:s}),M.push(()=>J(e,"shownBanner",r)),{c(){V(e.$$.fragment)},l(i){I(e.$$.fragment,i)},m(i,a){$(e,i,a),t=!0},p(i,a){const l={};!n&&a&1&&(n=!0,l.shownBanner=i[0],H(()=>n=!1)),e.$set(l)},i(i){t||(g(e.$$.fragment,i),t=!0)},o(i){h(e.$$.fragment,i),t=!1},d(i){E(e,i)}}}function Ke(o){let e,n,t=o[4]&&Je(o);return{c(){t&&t.c(),e=y()},l(r){t&&t.l(r),e=y()},m(r,s){t&&t.m(r,s),N(r,e,s),n=!0},p(r,[s]){r[4]&&t.p(r,s)},i(r){n||(g(t),n=!0)},o(r){h(t),n=!1},d(r){t&&t.d(r),r&&v(e)}}}function Xe(o,e,n){let t;X(o,ae,L=>n(12,t=L));var r,s,i,a,l;let{shownBanner:f}=e;const{cluster:u}=t.stuff,c={High:"high",Medium:"medium",Low:"low"},{recommended:d,current:_}=(r=u==null?void 0:u.versionInfo)!==null&&r!==void 0?r:{},w=(i=(s=u==null?void 0:u.versionInfo)===null||s===void 0?void 0:s.alerts)===null||i===void 0?void 0:i[0],m=w?c[w.severity]:c.Low,p=`server-v${_==null?void 0:_.version}`,C=`https://github.com/temporalio/temporal/releases/tag/v${(l=(a=u==null?void 0:u.versionInfo)===null||a===void 0?void 0:a.recommended)===null||l===void 0?void 0:l.version}`,B=se(d==null?void 0:d.version,_==null?void 0:_.version),T=m===c.Low?`\u{1F4E5} Temporal v${d==null?void 0:d.version} is available`:`\u{1F4E5} ${w==null?void 0:w.message}`;function fe(L){f=L,n(0,f)}return o.$$set=L=>{"shownBanner"in L&&n(0,f=L.shownBanner)},[f,m,p,C,B,T,fe]}class Ye extends q{constructor(e){super(),z(this,e,Xe,Ke,P,{shownBanner:0})}}function Ze(o){let e,n,t;function r(i){o[6](i)}let s={key:o[1],severity:Ge,message:o[2],link:o[4],dataCy:"ui-version-banner"};return o[0]!==void 0&&(s.shownBanner=o[0]),e=new le({props:s}),M.push(()=>J(e,"shownBanner",r)),{c(){V(e.$$.fragment)},l(i){I(e.$$.fragment,i)},m(i,a){$(e,i,a),t=!0},p(i,a){const l={};!n&&a&1&&(n=!0,l.shownBanner=i[0],H(()=>n=!1)),e.$set(l)},i(i){t||(g(e.$$.fragment,i),t=!0)},o(i){h(e.$$.fragment,i),t=!1},d(i){E(e,i)}}}function Ae(o){let e,n,t=o[3]&&Ze(o);return{c(){t&&t.c(),e=y()},l(r){t&&t.l(r),e=y()},m(r,s){t&&t.m(r,s),N(r,e,s),n=!0},p(r,[s]){r[3]&&t.p(r,s)},i(r){n||(g(t),n=!0)},o(r){h(t),n=!1},d(r){t&&t.d(r),r&&v(e)}}}const Ge="low";function Qe(o,e,n){let{shownBanner:t}=e,{uiVersionInfo:r}=e;const s=`ui-v${r==null?void 0:r.current}`,i=`\u{1F4E5} Temporal UI v${r==null?void 0:r.recommended} is available`,a=se(r==null?void 0:r.recommended,r==null?void 0:r.current),l=`https://github.com/temporalio/ui-server/releases/tag/v${r==null?void 0:r.recommended}`;function f(u){t=u,n(0,t)}return o.$$set=u=>{"shownBanner"in u&&n(0,t=u.shownBanner),"uiVersionInfo"in u&&n(5,r=u.uiVersionInfo)},[t,s,i,a,l,r,f]}class We extends q{constructor(e){super(),z(this,e,Qe,Ae,P,{shownBanner:0,uiVersionInfo:5})}}function Re(o){let e,n,t,r;const s=[en,xe],i=[];function a(l,f){return l[1]===F.TemporalVersion?0:l[1]===F.UIVersion?1:-1}return~(e=a(o))&&(n=i[e]=s[e](o)),{c(){n&&n.c(),t=y()},l(l){n&&n.l(l),t=y()},m(l,f){~e&&i[e].m(l,f),N(l,t,f),r=!0},p(l,f){let u=e;e=a(l),e===u?~e&&i[e].p(l,f):(n&&(he(),h(i[u],1,1,()=>{i[u]=null}),be()),~e?(n=i[e],n?n.p(l,f):(n=i[e]=s[e](l),n.c()),g(n,1),n.m(t.parentNode,t)):n=null)},i(l){r||(g(n),r=!0)},o(l){h(n),r=!1},d(l){~e&&i[e].d(l),l&&v(t)}}}function xe(o){let e,n,t;function r(i){o[4](i)}let s={uiVersionInfo:o[0]};return o[1]!==void 0&&(s.shownBanner=o[1]),e=new We({props:s}),M.push(()=>J(e,"shownBanner",r)),{c(){V(e.$$.fragment)},l(i){I(e.$$.fragment,i)},m(i,a){$(e,i,a),t=!0},p(i,a){const l={};a&1&&(l.uiVersionInfo=i[0]),!n&&a&2&&(n=!0,l.shownBanner=i[1],H(()=>n=!1)),e.$set(l)},i(i){t||(g(e.$$.fragment,i),t=!0)},o(i){h(e.$$.fragment,i),t=!1},d(i){E(e,i)}}}function en(o){let e,n,t;function r(i){o[3](i)}let s={};return o[1]!==void 0&&(s.shownBanner=o[1]),e=new Ye({props:s}),M.push(()=>J(e,"shownBanner",r)),{c(){V(e.$$.fragment)},l(i){I(e.$$.fragment,i)},m(i,a){$(e,i,a),t=!0},p(i,a){const l={};!n&&a&2&&(n=!0,l.shownBanner=i[1],H(()=>n=!1)),e.$set(l)},i(i){t||(g(e.$$.fragment,i),t=!0)},o(i){h(e.$$.fragment,i),t=!1},d(i){E(e,i)}}}function nn(o){let e,n,t=o[2]&&Re(o);return{c(){t&&t.c(),e=y()},l(r){t&&t.l(r),e=y()},m(r,s){t&&t.m(r,s),N(r,e,s),n=!0},p(r,[s]){r[2]&&t.p(r,s)},i(r){n||(g(t),n=!0)},o(r){h(t),n=!1},d(r){t&&t.d(r),r&&v(e)}}}function tn(o,e,n){let t;X(o,ae,f=>n(5,t=f));let{uiVersionInfo:r}=e,s=F.TemporalVersion;const i=t.stuff.settings.notifyOnNewVersion;function a(f){s=f,n(1,s)}function l(f){s=f,n(1,s)}return o.$$set=f=>{"uiVersionInfo"in f&&n(0,r=f.uiVersionInfo)},[r,s,i,a,l]}class rn extends q{constructor(e){super(),z(this,e,tn,nn,P,{uiVersionInfo:0})}}function on(o){let e;const n=o[2].default,t=we(n,o,o[3],null);return{c(){t&&t.c()},l(r){t&&t.l(r)},m(r,s){t&&t.m(r,s),e=!0},p(r,s){t&&t.p&&(!e||s&8)&&ke(t,n,r,r[3],e?Be(n,r[3],s,null):ye(r[3]),null)},i(r){e||(g(t,r),e=!0)},o(r){h(t,r),e=!1},d(r){t&&t.d(r)}}}function sn(o){let e,n,t,r,s,i,a,l,f,u,c,d,_,w;return e=new Le({}),r=new Ce({}),a=new Ue({props:{user:o[0]}}),u=new rn({props:{uiVersionInfo:o[1]}}),_=new Te({props:{onError:an,$$slots:{default:[on]},$$scope:{ctx:o}}}),{c(){V(e.$$.fragment),n=D(),t=j("div"),V(r.$$.fragment),s=D(),i=j("div"),V(a.$$.fragment),l=D(),f=j("section"),V(u.$$.fragment),c=D(),d=j("div"),V(_.$$.fragment),this.h()},l(m){I(e.$$.fragment,m),n=S(m),t=U(m,"DIV",{class:!0});var p=O(t);I(r.$$.fragment,p),s=S(p),i=U(p,"DIV",{class:!0});var C=O(i);I(a.$$.fragment,C),C.forEach(v),l=S(p),f=U(p,"SECTION",{id:!0,class:!0});var B=O(f);I(u.$$.fragment,B),c=S(B),d=U(B,"DIV",{class:!0});var T=O(d);I(_.$$.fragment,T),T.forEach(v),B.forEach(v),p.forEach(v),this.h()},h(){b(i,"class","sticky top-0 z-20 h-screen w-auto"),b(d,"class","z-10 flex h-full flex-col gap-4 px-10 pb-10 pt-8"),b(f,"id","content"),b(f,"class","h-screen w-max flex-auto overflow-auto"),b(t,"class","flex h-screen w-screen flex-row")},m(m,p){$(e,m,p),N(m,n,p),N(m,t,p),$(r,t,null),k(t,s),k(t,i),$(a,i,null),k(t,l),k(t,f),$(u,f,null),k(f,c),k(f,d),$(_,d,null),w=!0},p(m,[p]){const C={};p&1&&(C.user=m[0]),a.$set(C);const B={};p&2&&(B.uiVersionInfo=m[1]),u.$set(B);const T={};p&8&&(T.$$scope={dirty:p,ctx:m}),_.$set(T)},i(m){w||(g(e.$$.fragment,m),g(r.$$.fragment,m),g(a.$$.fragment,m),g(u.$$.fragment,m),g(_.$$.fragment,m),w=!0)},o(m){h(e.$$.fragment,m),h(r.$$.fragment,m),h(a.$$.fragment,m),h(u.$$.fragment,m),h(_.$$.fragment,m),w=!1},d(m){E(e,m),m&&v(n),m&&v(t),E(r),E(a),E(u),E(_)}}}const Qn=async function({fetch:o}){const e=await je(o),n=await Ne(o);if(!De(e,n))return{status:302,redirect:"/login"};const t=await ze(e,o),r=Ve({namespaces:t==null?void 0:t.namespaces,settings:e}),s=await Pe(e,o);Se(e);const i={current:e.version,recommended:e.notifyOnNewVersion?await qe(o):void 0};return{props:{user:n,uiVersionInfo:i},stuff:{namespaces:t==null?void 0:t.namespaces,settings:W(Q({},e),{defaultNamespace:r}),cluster:s}}},an=()=>{};function ln(o,e,n){let{$$slots:t={},$$scope:r}=e,{user:s}=e,{uiVersionInfo:i}=e;return o.$$set=a=>{"user"in a&&n(0,s=a.user),"uiVersionInfo"in a&&n(1,i=a.uiVersionInfo),"$$scope"in a&&n(3,r=a.$$scope)},[s,i,t,r]}class Wn extends q{constructor(e){super(),z(this,e,ln,sn,P,{user:0,uiVersionInfo:1})}}export{Wn as default,Qn as load};
