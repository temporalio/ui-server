import{S as J,i as z,s as M,D as ie,e as m,t as x,k as q,c as $,a as v,g as W,d as i,n as L,b as g,f as O,E as f,F as fe,G as _e,H as he,x as A,u as R,h as te,r as U,w as X,$ as C,J as se,af as le,j as V,m as Y,o as B,v as G,_ as pe}from"../../../../../chunks/vendor-b03dee8a.js";import{r as re}from"../../../../../chunks/request-from-api-a1f394a2.js";import{f as ae}from"../../../../../chunks/format-date-34e4dc1a.js";async function de({queue:c,namespace:e},l=fetch){const s=await re(`/namespaces/${e}/task-queues/${c}?task_queue_type=1`,{request:l}),t=await re(`/namespaces/${e}/task-queues/${c}?task_queue_type=2`,{request:l});t.pollers.forEach(o=>{o.taskQueueTypes=["ACTIVITY"]}),s.pollers.forEach(o=>{o.taskQueueTypes=["WORKFLOW"]});const n=o=>(r,u)=>{const a=r[u.identity]||{lastAccessTime:void 0,taskQueueTypes:[]};return r[u.identity]={lastAccessTime:!a.lastAccessTime||a.lastAccessTime<u.lastAccessTime?u.lastAccessTime:a.lastAccessTime,taskQueueTypes:a.taskQueueTypes.concat([o])},r};return t.pollers.filter(o=>s.pollers.some(r=>{if(o.identity===r.identity)return o.taskQueueTypes=[...r.taskQueueTypes,...o.taskQueueTypes],o})),t.pollers.reduce(n("ACTIVITY"),s.pollers.reduce(n("WORKFLOW"),{})),{pollers:t.pollers,taskQueueStatus:t.taskQueueStatus}}const me=c=>({}),oe=c=>({});function $e(c){let e,l,s,t,n,o,r,u,a,p,E,Q,T,k,P,H;const y=c[1].rows,_=ie(y,c,c[0],oe);return{c(){e=m("table"),l=m("thead"),s=m("tr"),t=m("th"),n=x("Identity"),o=q(),r=m("th"),u=x("Last Access Time"),a=q(),p=m("th"),E=x("WORKFLOW TASK HANDLER"),Q=q(),T=m("th"),k=x("ACTIVITY HANDLER"),P=q(),_&&_.c(),this.h()},l(b){e=$(b,"TABLE",{class:!0});var w=v(e);l=$(w,"THEAD",{});var j=v(l);s=$(j,"TR",{class:!0});var D=v(s);t=$(D,"TH",{class:!0});var N=v(t);n=W(N,"Identity"),N.forEach(i),o=L(D),r=$(D,"TH",{class:!0});var I=v(r);u=W(I,"Last Access Time"),I.forEach(i),a=L(D),p=$(D,"TH",{class:!0});var S=v(p);E=W(S,"WORKFLOW TASK HANDLER"),S.forEach(i),Q=L(D),T=$(D,"TH",{class:!0});var h=v(T);k=W(h,"ACTIVITY HANDLER"),h.forEach(i),D.forEach(i),j.forEach(i),P=L(w),_&&_.l(w),w.forEach(i),this.h()},h(){g(t,"class","w-6/12 svelte-1ypb9ei"),g(r,"class","w-2/12 svelte-1ypb9ei"),g(p,"class","w-2/12 svelte-1ypb9ei"),g(T,"class","w-2/12 svelte-1ypb9ei"),g(s,"class","bg-gray-200"),g(e,"class","border-collapse w-full")},m(b,w){O(b,e,w),f(e,l),f(l,s),f(s,t),f(t,n),f(s,o),f(s,r),f(r,u),f(s,a),f(s,p),f(p,E),f(s,Q),f(s,T),f(T,k),f(e,P),_&&_.m(e,null),H=!0},p(b,[w]){_&&_.p&&(!H||w&1)&&fe(_,y,b,b[0],H?he(y,b[0],w,me):_e(b[0]),oe)},i(b){H||(A(_,b),H=!0)},o(b){R(_,b),H=!1},d(b){b&&i(e),_&&_.d(b)}}}function ve(c,e,l){let{$$slots:s={},$$scope:t}=e;return c.$$set=n=>{"$$scope"in n&&l(0,t=n.$$scope)},[t,s]}class Te extends J{constructor(e){super();z(this,e,ve,$e,M,{})}}function be(c){let e;return{c(){e=m("td"),this.h()},l(l){e=$(l,"TD",{class:!0}),v(e).forEach(i),this.h()},h(){g(e,"class","svelte-1jbitmj")},m(l,s){O(l,e,s)},p:C,i:C,o:C,d(l){l&&i(e)}}}function ge(c){let e,l,s;return l=new se({props:{src:le,class:"w-8 h-8 pl-3"}}),{c(){e=m("td"),V(l.$$.fragment),this.h()},l(t){e=$(t,"TD",{class:!0});var n=v(e);Y(l.$$.fragment,n),n.forEach(i),this.h()},h(){g(e,"class","svelte-1jbitmj")},m(t,n){O(t,e,n),B(l,e,null),s=!0},p:C,i(t){s||(A(l.$$.fragment,t),s=!0)},o(t){R(l.$$.fragment,t),s=!1},d(t){t&&i(e),G(l)}}}function ke(c){let e;return{c(){e=m("td"),this.h()},l(l){e=$(l,"TD",{class:!0}),v(e).forEach(i),this.h()},h(){g(e,"class","svelte-1jbitmj")},m(l,s){O(l,e,s)},p:C,i:C,o:C,d(l){l&&i(e)}}}function ye(c){let e,l,s;return l=new se({props:{src:le,class:"w-8 h-8 pl-3"}}),{c(){e=m("td"),V(l.$$.fragment),this.h()},l(t){e=$(t,"TD",{class:!0});var n=v(e);Y(l.$$.fragment,n),n.forEach(i),this.h()},h(){g(e,"class","svelte-1jbitmj")},m(t,n){O(t,e,n),B(l,e,null),s=!0},p:C,i(t){s||(A(l.$$.fragment,t),s=!0)},o(t){R(l.$$.fragment,t),s=!1},d(t){t&&i(e),G(l)}}}function Ee(c){let e,l,s,t=c[0].identity+"",n,o,r,u,a=ae(c[0].lastAccessTime)+"",p,E,Q,T,k,P,H,y,_,b;const w=[ge,be],j=[];function D(h,d){return(Q==null||d&1)&&(Q=!!h[0].taskQueueTypes.includes("WORKFLOW")),Q?0:1}T=D(c,-1),k=j[T]=w[T](c);const N=[ye,ke],I=[];function S(h,d){return(H==null||d&1)&&(H=!!h[0].taskQueueTypes.includes("ACTIVITY")),H?0:1}return y=S(c,-1),_=I[y]=N[y](c),{c(){e=m("tr"),l=m("td"),s=m("h3"),n=x(t),o=q(),r=m("td"),u=m("p"),p=x(a),E=q(),k.c(),P=q(),_.c(),this.h()},l(h){e=$(h,"TR",{class:!0});var d=v(e);l=$(d,"TD",{class:!0});var F=v(l);s=$(F,"H3",{class:!0});var K=v(s);n=W(K,t),K.forEach(i),F.forEach(i),o=L(d),r=$(d,"TD",{class:!0});var Z=v(r);u=$(Z,"P",{class:!0});var ee=v(u);p=W(ee,a),ee.forEach(i),Z.forEach(i),E=L(d),k.l(d),P=L(d),_.l(d),d.forEach(i),this.h()},h(){g(s,"class","svelte-1jbitmj"),g(l,"class","svelte-1jbitmj"),g(u,"class","svelte-1jbitmj"),g(r,"class","svelte-1jbitmj"),g(e,"class","svelte-1jbitmj")},m(h,d){O(h,e,d),f(e,l),f(l,s),f(s,n),f(e,o),f(e,r),f(r,u),f(u,p),f(e,E),j[T].m(e,null),f(e,P),I[y].m(e,null),b=!0},p(h,[d]){(!b||d&1)&&t!==(t=h[0].identity+"")&&te(n,t),(!b||d&1)&&a!==(a=ae(h[0].lastAccessTime)+"")&&te(p,a);let F=T;T=D(h,d),T===F?j[T].p(h,d):(U(),R(j[F],1,1,()=>{j[F]=null}),X(),k=j[T],k?k.p(h,d):(k=j[T]=w[T](h),k.c()),A(k,1),k.m(e,P));let K=y;y=S(h,d),y===K?I[y].p(h,d):(U(),R(I[K],1,1,()=>{I[K]=null}),X(),_=I[y],_?_.p(h,d):(_=I[y]=N[y](h),_.c()),A(_,1),_.m(e,null))},i(h){b||(A(k),A(_),b=!0)},o(h){R(k),R(_),b=!1},d(h){h&&i(e),j[T].d(),I[y].d()}}}function we(c,e,l){let{poller:s}=e;return c.$$set=t=>{"poller"in t&&l(0,s=t.poller)},[s]}class Ae extends J{constructor(e){super();z(this,e,we,Ee,M,{poller:0})}}function ce(c,e,l){const s=c.slice();return s[1]=e[l],s}function ne(c){let e,l,s,t;return{c(){e=m("tr"),l=m("td"),s=x("No Results"),t=q(),this.h()},l(n){e=$(n,"TR",{});var o=v(e);l=$(o,"TD",{colspan:!0,class:!0});var r=v(l);s=W(r,"No Results"),r.forEach(i),t=L(o),o.forEach(i),this.h()},h(){g(l,"colspan","4"),g(l,"class","m-auto p-12 text-center font-extralight text-2xl")},m(n,o){O(n,e,o),f(e,l),f(l,s),f(e,t)},d(n){n&&i(e)}}}function ue(c){let e,l;return e=new Ae({props:{poller:c[1]}}),{c(){V(e.$$.fragment)},l(s){Y(e.$$.fragment,s)},m(s,t){B(e,s,t),l=!0},p(s,t){const n={};t&1&&(n.poller=s[1]),e.$set(n)},i(s){l||(A(e.$$.fragment,s),l=!0)},o(s){R(e.$$.fragment,s),l=!1},d(s){G(e,s)}}}function je(c){let e,l,s=c[0].pollers,t=[];for(let r=0;r<s.length;r+=1)t[r]=ue(ce(c,s,r));const n=r=>R(t[r],1,1,()=>{t[r]=null});let o=null;return s.length||(o=ne()),{c(){e=m("tbody");for(let r=0;r<t.length;r+=1)t[r].c();o&&o.c(),this.h()},l(r){e=$(r,"TBODY",{slot:!0});var u=v(e);for(let a=0;a<t.length;a+=1)t[a].l(u);o&&o.l(u),u.forEach(i),this.h()},h(){g(e,"slot","rows")},m(r,u){O(r,e,u);for(let a=0;a<t.length;a+=1)t[a].m(e,null);o&&o.m(e,null),l=!0},p(r,u){if(u&1){s=r[0].pollers;let a;for(a=0;a<s.length;a+=1){const p=ce(r,s,a);t[a]?(t[a].p(p,u),A(t[a],1)):(t[a]=ue(p),t[a].c(),A(t[a],1),t[a].m(e,null))}for(U(),a=s.length;a<t.length;a+=1)n(a);X(),s.length?o&&(o.d(1),o=null):o||(o=ne(),o.c(),o.m(e,null))}},i(r){if(!l){for(let u=0;u<s.length;u+=1)A(t[u]);l=!0}},o(r){t=t.filter(Boolean);for(let u=0;u<t.length;u+=1)R(t[u]);l=!1},d(r){r&&i(e),pe(t,r),o&&o.d()}}}function De(c){let e,l,s,t,n,o,r,u;return r=new Te({props:{$$slots:{rows:[je]},$$scope:{ctx:c}}}),{c(){e=m("section"),l=m("header"),s=m("h3"),t=x("Pollers"),n=q(),o=m("div"),V(r.$$.fragment),this.h()},l(a){e=$(a,"SECTION",{class:!0});var p=v(e);l=$(p,"HEADER",{class:!0});var E=v(l);s=$(E,"H3",{class:!0});var Q=v(s);t=W(Q,"Pollers"),Q.forEach(i),E.forEach(i),n=L(p),o=$(p,"DIV",{class:!0});var T=v(o);Y(r.$$.fragment,T),T.forEach(i),p.forEach(i),this.h()},h(){g(s,"class","text-2xl"),g(l,"class","p-3 mb-5"),g(o,"class","w-full h-full overflow-x-scroll"),g(e,"class","flex flex-col items-start")},m(a,p){O(a,e,p),f(e,l),f(l,s),f(s,t),f(e,n),f(e,o),B(r,o,null),u=!0},p(a,[p]){const E={};p&17&&(E.$$scope={dirty:p,ctx:a}),r.$set(E)},i(a){u||(A(r.$$.fragment,a),u=!0)},o(a){R(r.$$.fragment,a),u=!1},d(a){a&&i(e),G(r)}}}async function qe({fetch:c,page:e}){const{namespace:l,queue:s}=e.params;return await de({queue:s,namespace:l},c).then(t=>({props:{pollers:t}}))}function Ie(c,e,l){let{pollers:s}=e;return c.$$set=t=>{"pollers"in t&&l(0,s=t.pollers)},[s]}class Le extends J{constructor(e){super();z(this,e,Ie,De,M,{pollers:0})}}export{Le as default,qe as load};
