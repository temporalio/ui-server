import{S as J,i as L,s as G,l as ne,f as I,r as Ae,u as k,w as Ne,x as d,d as u,ab as Te,J as _e,e as b,c as g,a as p,b as _,a5 as se,T as K,V as Se,L as he,M as we,N as de,j as $,m as j,o as P,v as W,t as y,g as D,R as ke,G as $e,h as Q,k as A,n as N,K as c,O as We,as as ye,at as De}from"../../../../../../chunks/vendor-8450f4eb.js";import{i as Re,W as ze,a as Fe}from"../../../../../../chunks/workflow-status-1de41349.js";import{r as He,h as qe}from"../../../../../../chunks/request-from-api-da859ff0.js";import{n as Oe}from"../../../../../../chunks/notifications-406f245b.js";import{p as je}from"../../../../../../chunks/stores-1a2349b5.js";import{r as be}from"../../../../../../chunks/route-for-d04bdb15.js";import"../../../../../../chunks/data-converter-config-7491540a.js";async function Me({workflow:l,namespace:e,reason:t}){return await He(`/namespaces/${e}/workflows/${l.id}/executions/${l.runId}/terminate`,{options:{method:"POST",body:JSON.stringify({reason:t})},shouldRetry:!1})}function Ve(l){let e,t,s,a,r;const f=l[7].default,o=_e(f,l,l[6],null);return{c(){e=b("a"),o&&o.c(),this.h()},l(n){e=g(n,"A",{href:!0,disabled:!0,class:!0});var i=p(e);o&&o.l(i),i.forEach(u),this.h()},h(){_(e,"href",l[5]),_(e,"disabled",l[0]),_(e,"class",t=""+(se(`${l[4]} ${l[1]}`)+" svelte-11brngx")),K(e,"selected",l[3])},m(n,i){I(n,e,i),o&&o.m(e,null),s=!0,a||(r=Se(e,"click",l[9]),a=!0)},p(n,i){o&&o.p&&(!s||i&64)&&he(o,f,n,n[6],s?de(f,n[6],i,null):we(n[6]),null),(!s||i&32)&&_(e,"href",n[5]),(!s||i&1)&&_(e,"disabled",n[0]),(!s||i&18&&t!==(t=""+(se(`${n[4]} ${n[1]}`)+" svelte-11brngx")))&&_(e,"class",t),i&26&&K(e,"selected",n[3])},i(n){s||(d(o,n),s=!0)},o(n){k(o,n),s=!1},d(n){n&&u(e),o&&o.d(n),a=!1,r()}}}function Be(l){let e,t,s,a,r;const f=l[7].default,o=_e(f,l,l[6],null);return{c(){e=b("button"),o&&o.c(),this.h()},l(n){e=g(n,"BUTTON",{class:!0});var i=p(e);o&&o.l(i),i.forEach(u),this.h()},h(){e.disabled=l[0],_(e,"class",t=""+(se(`${l[4]} ${l[1]}`)+" svelte-11brngx")),K(e,"selected",l[3])},m(n,i){I(n,e,i),o&&o.m(e,null),s=!0,a||(r=Se(e,"click",l[8]),a=!0)},p(n,i){o&&o.p&&(!s||i&64)&&he(o,f,n,n[6],s?de(f,n[6],i,null):we(n[6]),null),(!s||i&1)&&(e.disabled=n[0]),(!s||i&18&&t!==(t=""+(se(`${n[4]} ${n[1]}`)+" svelte-11brngx")))&&_(e,"class",t),i&26&&K(e,"selected",n[3])},i(n){s||(d(o,n),s=!0)},o(n){k(o,n),s=!1},d(n){n&&u(e),o&&o.d(n),a=!1,r()}}}function Ce(l){let e,t,s,a;const r=[Be,Ve],f=[];function o(n,i){return n[2]==="button"?0:1}return e=o(l),t=f[e]=r[e](l),{c(){t.c(),s=ne()},l(n){t.l(n),s=ne()},m(n,i){f[e].m(n,i),I(n,s,i),a=!0},p(n,[i]){let m=e;e=o(n),e===m?f[e].p(n,i):(Ae(),k(f[m],1,1,()=>{f[m]=null}),Ne(),t=f[e],t?t.p(n,i):(t=f[e]=r[e](n),t.c()),d(t,1),t.m(s.parentNode,s))},i(n){a||(d(t),a=!0)},o(n){k(t),a=!1},d(n){f[e].d(n),n&&u(s)}}}function Je(l,e,t){let{$$slots:s={},$$scope:a}=e,{disabled:r=!1}=e,{variant:f="primary"}=e,{as:o="button"}=e,{active:n=!1}=e,{size:i="small"}=e,{href:m=null}=e;function v(w){Te.call(this,l,w)}function S(w){Te.call(this,l,w)}return l.$$set=w=>{"disabled"in w&&t(0,r=w.disabled),"variant"in w&&t(1,f=w.variant),"as"in w&&t(2,o=w.as),"active"in w&&t(3,n=w.active),"size"in w&&t(4,i=w.size),"href"in w&&t(5,m=w.href),"$$scope"in w&&t(6,a=w.$$scope)},[r,f,o,n,i,m,a,s,v,S]}class Le extends J{constructor(e){super();L(this,e,Je,Ce,G,{disabled:0,variant:1,as:2,active:3,size:4,href:5})}}function Pe(l){let e,t;return e=new Le({props:{variant:"destroy",size:"small",$$slots:{default:[Ge]},$$scope:{ctx:l}}}),e.$on("click",l[2]),{c(){$(e.$$.fragment)},l(s){j(e.$$.fragment,s)},m(s,a){P(e,s,a),t=!0},p(s,a){const r={};a&64&&(r.$$scope={dirty:a,ctx:s}),e.$set(r)},i(s){t||(d(e.$$.fragment,s),t=!0)},o(s){k(e.$$.fragment,s),t=!1},d(s){W(e,s)}}}function Ge(l){let e;return{c(){e=y("Terminate")},l(t){e=D(t,"Terminate")},m(t,s){I(t,e,s)},d(t){t&&u(e)}}}function Ke(l){let e=l[1](l[0]),t,s,a=e&&Pe(l);return{c(){a&&a.c(),t=ne()},l(r){a&&a.l(r),t=ne()},m(r,f){a&&a.m(r,f),I(r,t,f),s=!0},p(r,[f]){f&1&&(e=r[1](r[0])),e?a?(a.p(r,f),f&1&&d(a,1)):(a=Pe(r),a.c(),d(a,1),a.m(t.parentNode,t)):a&&(Ae(),k(a,1,1,()=>{a=null}),Ne())},i(r){s||(d(a),s=!0)},o(r){k(a),s=!1},d(r){a&&a.d(r),r&&u(t)}}}function Qe(l,e,t){let{workflow:s}=e,{namespace:a}=e,{refresh:r=null}=e,f="";const o=i=>String(i.status)==="Running",n=()=>{Me({workflow:s,namespace:a,reason:f}).then(()=>{f="",Oe.add("success","Workflow Terminated"),Re(r)&&r()}).catch(qe)};return l.$$set=i=>{"workflow"in i&&t(0,s=i.workflow),"namespace"in i&&t(3,a=i.namespace),"refresh"in i&&t(4,r=i.refresh)},[s,o,n,a,r]}class Ue extends J{constructor(e){super();L(this,e,Qe,Ke,G,{workflow:0,namespace:3,refresh:4})}}function Xe(l){let e;return{c(){e=y(l[1])},l(t){e=D(t,l[1])},m(t,s){I(t,e,s)},p(t,s){s&2&&Q(e,t[1])},d(t){t&&u(e)}}}function Ye(l){let e,t,s,a;return{c(){e=y(l[1]),t=A(),s=b("span"),a=y(l[2]),this.h()},l(r){e=D(r,l[1]),t=N(r),s=g(r,"SPAN",{class:!0});var f=p(s);a=D(f,l[2]),f.forEach(u),this.h()},h(){_(s,"class","px-2 text-blue-700 bg-blue-100 rounded-sm")},m(r,f){I(r,e,f),I(r,t,f),I(r,s,f),c(s,a)},p(r,f){f&2&&Q(e,r[1]),f&4&&Q(a,r[2])},d(r){r&&u(e),r&&u(t),r&&u(s)}}}function Ze(l){let e;function t(r,f){return r[2]?Ye:Xe}let s=t(l),a=s(l);return{c(){e=b("a"),a.c(),this.h()},l(r){e=g(r,"A",{class:!0,href:!0});var f=p(e);a.l(f),f.forEach(u),this.h()},h(){_(e,"class","block svelte-62pa3r"),_(e,"href",l[0]),K(e,"active",l[3])},m(r,f){I(r,e,f),a.m(e,null)},p(r,[f]){s===(s=t(r))&&a?a.p(r,f):(a.d(1),a=s(r),a&&(a.c(),a.m(e,null))),f&1&&_(e,"href",r[0]),f&8&&K(e,"active",r[3])},i:ke,o:ke,d(r){r&&u(e),a.d()}}}function xe(l,e,t){let s;$e(l,je,n=>t(4,s=n));let{href:a}=e,{label:r}=e,{amount:f=null}=e,{active:o=s.path.includes(a)}=e;return l.$$set=n=>{"href"in n&&t(0,a=n.href),"label"in n&&t(1,r=n.label),"amount"in n&&t(2,f=n.amount),"active"in n&&t(3,o=n.active)},[a,r,f,o]}class le extends J{constructor(e){super();L(this,e,xe,Ze,G,{href:0,label:1,amount:2,active:3})}}function et(l){let e,t,s,a,r,f,o,n,i;return t=new le({props:{label:"History",href:be("workflow.events",{namespace:l[0],workflowId:l[1],runId:l[2]}),amount:l[3]}}),a=new le({props:{label:"Workers",href:"#not-implemented"}}),f=new le({props:{label:"Stack Trace",href:be("workflow.stack-trace",{namespace:l[0],workflowId:l[1],runId:l[2]})}}),n=new le({props:{label:"Query",href:be("workflow.query",{namespace:l[0],workflowId:l[1],runId:l[2]})}}),{c(){e=b("nav"),$(t.$$.fragment),s=A(),$(a.$$.fragment),r=A(),$(f.$$.fragment),o=A(),$(n.$$.fragment),this.h()},l(m){e=g(m,"NAV",{class:!0});var v=p(e);j(t.$$.fragment,v),s=N(v),j(a.$$.fragment,v),r=N(v),j(f.$$.fragment,v),o=N(v),j(n.$$.fragment,v),v.forEach(u),this.h()},h(){_(e,"class","flex gap-6")},m(m,v){I(m,e,v),P(t,e,null),c(e,s),P(a,e,null),c(e,r),P(f,e,null),c(e,o),P(n,e,null),i=!0},p:ke,i(m){i||(d(t.$$.fragment,m),d(a.$$.fragment,m),d(f.$$.fragment,m),d(n.$$.fragment,m),i=!0)},o(m){k(t.$$.fragment,m),k(a.$$.fragment,m),k(f.$$.fragment,m),k(n.$$.fragment,m),i=!1},d(m){m&&u(e),W(t),W(a),W(f),W(n)}}}function tt(l,e,t){let s;$e(l,je,i=>t(5,s=i));let{workflow:a}=e;const{namespace:r,workflow:f,run:o}=s.params,n=a==null?void 0:a.historyEvents;return l.$$set=i=>{"workflow"in i&&t(4,a=i.workflow)},[r,f,o,n,a]}class at extends J{constructor(e){super();L(this,e,tt,et,G,{workflow:4})}}function nt(l){var ge;let e,t,s,a,r,f,o,n,i=l[0].name+"",m,v,S,w,R,re,z,U,fe,oe,V,X=l[0].id+"",x,ie,F,Y,ue,ce,B,Z=l[0].runId+"",ee,me,H,q;return a=new We({props:{icon:ye}}),S=new ze({props:{status:(ge=l[0])==null?void 0:ge.status}}),R=new Ue({props:{workflow:l[0],namespace:l[1]}}),H=new at({props:{workflow:l[0]}}),{c(){e=b("header"),t=b("main"),s=b("a"),$(a.$$.fragment),f=A(),o=b("div"),n=b("h1"),m=y(i),v=A(),$(S.$$.fragment),w=A(),$(R.$$.fragment),re=A(),z=b("p"),U=b("span"),fe=y("Workflow ID"),oe=A(),V=b("span"),x=y(X),ie=A(),F=b("p"),Y=b("span"),ue=y("Run ID"),ce=A(),B=b("span"),ee=y(Z),me=A(),$(H.$$.fragment),this.h()},l(h){e=g(h,"HEADER",{class:!0});var E=p(e);t=g(E,"MAIN",{class:!0});var T=p(t);s=g(T,"A",{href:!0,class:!0,style:!0});var C=p(s);j(a.$$.fragment,C),C.forEach(u),f=N(T),o=g(T,"DIV",{class:!0});var O=p(o);n=g(O,"H1",{class:!0});var M=p(n);m=D(M,i),v=N(M),j(S.$$.fragment,M),M.forEach(u),w=N(O),j(R.$$.fragment,O),O.forEach(u),re=N(T),z=g(T,"P",{class:!0});var te=p(z);U=g(te,"SPAN",{});var pe=p(U);fe=D(pe,"Workflow ID"),pe.forEach(u),oe=N(te),V=g(te,"SPAN",{class:!0});var ve=p(V);x=D(ve,X),ve.forEach(u),te.forEach(u),ie=N(T),F=g(T,"P",{class:!0});var ae=p(F);Y=g(ae,"SPAN",{});var Ee=p(Y);ue=D(Ee,"Run ID"),Ee.forEach(u),ce=N(ae),B=g(ae,"SPAN",{class:!0});var Ie=p(B);ee=D(Ie,Z),Ie.forEach(u),ae.forEach(u),T.forEach(u),me=N(E),j(H.$$.fragment,E),E.forEach(u),this.h()},h(){_(s,"href",r="/namespaces/"+l[1]+"/workflows"),_(s,"class","absolute top-2 back-to-workflows"),De(s,"left","-1.5rem"),_(n,"class","text-2xl"),_(o,"class","flex justify-between items-center"),_(V,"class","font-medium"),_(z,"class","text-md"),_(B,"class","font-medium"),_(F,"class","text-md"),_(t,"class","flex flex-col gap-1 relative"),_(e,"class","flex flex-col gap-4")},m(h,E){I(h,e,E),c(e,t),c(t,s),P(a,s,null),c(t,f),c(t,o),c(o,n),c(n,m),c(n,v),P(S,n,null),c(o,w),P(R,o,null),c(t,re),c(t,z),c(z,U),c(U,fe),c(z,oe),c(z,V),c(V,x),c(t,ie),c(t,F),c(F,Y),c(Y,ue),c(F,ce),c(F,B),c(B,ee),c(e,me),P(H,e,null),q=!0},p(h,[E]){var M;(!q||E&2&&r!==(r="/namespaces/"+h[1]+"/workflows"))&&_(s,"href",r),(!q||E&1)&&i!==(i=h[0].name+"")&&Q(m,i);const T={};E&1&&(T.status=(M=h[0])==null?void 0:M.status),S.$set(T);const C={};E&1&&(C.workflow=h[0]),E&2&&(C.namespace=h[1]),R.$set(C),(!q||E&1)&&X!==(X=h[0].id+"")&&Q(x,X),(!q||E&1)&&Z!==(Z=h[0].runId+"")&&Q(ee,Z);const O={};E&1&&(O.workflow=h[0]),H.$set(O)},i(h){q||(d(a.$$.fragment,h),d(S.$$.fragment,h),d(R.$$.fragment,h),d(H.$$.fragment,h),q=!0)},o(h){k(a.$$.fragment,h),k(S.$$.fragment,h),k(R.$$.fragment,h),k(H.$$.fragment,h),q=!1},d(h){h&&u(e),W(a),W(S),W(R),W(H)}}}function st(l,e,t){let{workflow:s}=e,{namespace:a}=e;return l.$$set=r=>{"workflow"in r&&t(0,s=r.workflow),"namespace"in r&&t(1,a=r.namespace)},[s,a]}class lt extends J{constructor(e){super();L(this,e,st,nt,G,{workflow:0,namespace:1})}}function rt(l){let e,t,s,a;t=new lt({props:{workflow:l[0],namespace:l[1]}});const r=l[3].default,f=_e(r,l,l[2],null);return{c(){e=b("main"),$(t.$$.fragment),s=A(),f&&f.c(),this.h()},l(o){e=g(o,"MAIN",{class:!0});var n=p(e);j(t.$$.fragment,n),s=N(n),f&&f.l(n),n.forEach(u),this.h()},h(){_(e,"class","flex flex-col gap-4 h-full")},m(o,n){I(o,e,n),P(t,e,null),c(e,s),f&&f.m(e,null),a=!0},p(o,[n]){const i={};n&1&&(i.workflow=o[0]),n&2&&(i.namespace=o[1]),t.$set(i),f&&f.p&&(!a||n&4)&&he(f,r,o,o[2],a?de(r,o[2],n,null):we(o[2]),null)},i(o){a||(d(t.$$.fragment,o),d(f,o),a=!0)},o(o){k(t.$$.fragment,o),k(f,o),a=!1},d(o){o&&u(e),W(t),f&&f.d(o)}}}async function wt({page:l}){const{workflow:e,run:t,namespace:s}=l.params,{workflow:a,events:r}=await Fe({namespace:s,executionId:e,runId:t});return{props:{workflow:a,namespace:s},stuff:{workflow:a,events:r}}}function ft(l,e,t){let{$$slots:s={},$$scope:a}=e,{workflow:r}=e,{namespace:f}=e;return l.$$set=o=>{"workflow"in o&&t(0,r=o.workflow),"namespace"in o&&t(1,f=o.namespace),"$$scope"in o&&t(2,a=o.$$scope)},[r,f,a,s]}class dt extends J{constructor(e){super();L(this,e,ft,rt,G,{workflow:0,namespace:1})}}export{dt as default,wt as load};
