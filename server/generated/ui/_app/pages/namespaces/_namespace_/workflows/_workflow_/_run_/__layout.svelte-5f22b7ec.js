import{S as G,i as X,s as Y,w as A,x as y,y as S,q as $,o as I,B as N,l as de,g as T,n as ve,p as Ie,d as m,t as P,h as W,e as _,c as d,a as k,b as p,U as ke,T as me,I as $e,j as V,k as b,m as v,L as u,P as Ee,aA as Ae,f as ye,K as Se,M as Ne,N as Te,O as Pe}from"../../../../../../chunks/vendor-81c0e211.js";import{W as We,a as De}from"../../../../../../chunks/workflow-status-7bfe05c2.js";import{g as Fe}from"../../../../../../chunks/navigation-093db9e2.js";import{r as z}from"../../../../../../chunks/route-for-11851a4f.js";import{r as Re,a as qe,h as He}from"../../../../../../chunks/route-for-api-e9908c01.js";import{n as Be}from"../../../../../../chunks/notifications-5747bfcc.js";import{B as Me}from"../../../../../../chunks/button-7d13177b.js";import{p as be}from"../../../../../../chunks/stores-eb9dc606.js";import"../../../../../../chunks/singletons-a6a7384f.js";import"../../../../../../chunks/is-network-error-ac7c8caf.js";async function Oe({workflow:r,namespace:e,reason:a}){return await Re(qe("workflow.terminate",{namespace:e,executionId:r.id,runId:r.runId}),{options:{method:"POST",body:JSON.stringify({reason:a})},shouldRetry:!1})}function ge(r){let e,a;return e=new Me({props:{destroy:!0,$$slots:{default:[je]},$$scope:{ctx:r}}}),e.$on("click",r[2]),{c(){A(e.$$.fragment)},l(s){y(e.$$.fragment,s)},m(s,t){S(e,s,t),a=!0},p(s,t){const n={};t&64&&(n.$$scope={dirty:t,ctx:s}),e.$set(n)},i(s){a||($(e.$$.fragment,s),a=!0)},o(s){I(e.$$.fragment,s),a=!1},d(s){N(e,s)}}}function je(r){let e;return{c(){e=P("Terminate")},l(a){e=W(a,"Terminate")},m(a,s){T(a,e,s)},d(a){a&&m(e)}}}function Ce(r){let e=r[1](r[0]),a,s,t=e&&ge(r);return{c(){t&&t.c(),a=de()},l(n){t&&t.l(n),a=de()},m(n,o){t&&t.m(n,o),T(n,a,o),s=!0},p(n,[o]){o&1&&(e=n[1](n[0])),e?t?(t.p(n,o),o&1&&$(t,1)):(t=ge(n),t.c(),$(t,1),t.m(a.parentNode,a)):t&&(ve(),I(t,1,1,()=>{t=null}),Ie())},i(n){s||($(t),s=!0)},o(n){I(t),s=!1},d(n){t&&t.d(n),n&&m(a)}}}function Le(r,e,a){let{workflow:s}=e,{namespace:t}=e,n="";const o=i=>String(i.status)==="Running",l=()=>{n="",Be.add("success","Workflow Terminated"),Fe(z("workflow",{namespace:t,workflowId:s.id,runId:s.runId}))},f=()=>{Oe({workflow:s,namespace:t,reason:n}).then(l).catch(He)};return r.$$set=i=>{"workflow"in i&&a(0,s=i.workflow),"namespace"in i&&a(3,t=i.namespace)},[s,o,f,t]}class Ve extends G{constructor(e){super();X(this,e,Le,Ce,Y,{workflow:0,namespace:3})}}function Je(r){let e;return{c(){e=P(r[1])},l(a){e=W(a,r[1])},m(a,s){T(a,e,s)},p(a,s){s&2&&V(e,a[1])},d(a){a&&m(e)}}}function Ke(r){let e,a,s,t;return{c(){e=P(r[1]),a=b(),s=_("span"),t=P(r[2]),this.h()},l(n){e=W(n,r[1]),a=v(n),s=d(n,"SPAN",{class:!0});var o=k(s);t=W(o,r[2]),o.forEach(m),this.h()},h(){p(s,"class","px-2 text-blue-700 bg-blue-100 rounded-sm")},m(n,o){T(n,e,o),T(n,a,o),T(n,s,o),u(s,t)},p(n,o){o&2&&V(e,n[1]),o&4&&V(t,n[2])},d(n){n&&m(e),n&&m(a),n&&m(s)}}}function Qe(r){let e;function a(n,o){return n[2]?Ke:Je}let s=a(r),t=s(r);return{c(){e=_("a"),t.c(),this.h()},l(n){e=d(n,"A",{class:!0,href:!0});var o=k(e);t.l(o),o.forEach(m),this.h()},h(){p(e,"class","block svelte-tavydt"),p(e,"href",r[0]),ke(e,"active",r[3])},m(n,o){T(n,e,o),t.m(e,null)},p(n,[o]){s===(s=a(n))&&t?t.p(n,o):(t.d(1),t=s(n),t&&(t.c(),t.m(e,null))),o&1&&p(e,"href",n[0]),o&8&&ke(e,"active",n[3])},i:me,o:me,d(n){n&&m(e),t.d()}}}function Ue(r,e,a){let s,t;$e(r,be,f=>a(4,t=f));let{href:n}=e,{label:o}=e,{amount:l=null}=e;return r.$$set=f=>{"href"in f&&a(0,n=f.href),"label"in f&&a(1,o=f.label),"amount"in f&&a(2,l=f.amount)},r.$$.update=()=>{r.$$.dirty&17&&a(3,s=t.url.pathname.includes(n))},[n,o,l,s,t]}class ae extends G{constructor(e){super();X(this,e,Ue,Qe,Y,{href:0,label:1,amount:2})}}function ze(r){let e,a,s,t,n,o,l,f,i;return a=new ae({props:{label:"History",href:z("workflow.events",{namespace:r[0],workflowId:r[1],runId:r[2]}),amount:r[3]}}),t=new ae({props:{label:"Workers",href:z("workers",{namespace:r[0],workflowId:r[1],runId:r[2]})}}),o=new ae({props:{label:"Stack Trace",href:z("workflow.stack-trace",{namespace:r[0],workflowId:r[1],runId:r[2]})}}),f=new ae({props:{label:"Query",href:z("workflow.query",{namespace:r[0],workflowId:r[1],runId:r[2]})}}),{c(){e=_("nav"),A(a.$$.fragment),s=b(),A(t.$$.fragment),n=b(),A(o.$$.fragment),l=b(),A(f.$$.fragment),this.h()},l(w){e=d(w,"NAV",{class:!0});var g=k(e);y(a.$$.fragment,g),s=v(g),y(t.$$.fragment,g),n=v(g),y(o.$$.fragment,g),l=v(g),y(f.$$.fragment,g),g.forEach(m),this.h()},h(){p(e,"class","flex gap-6")},m(w,g){T(w,e,g),S(a,e,null),u(e,s),S(t,e,null),u(e,n),S(o,e,null),u(e,l),S(f,e,null),i=!0},p:me,i(w){i||($(a.$$.fragment,w),$(t.$$.fragment,w),$(o.$$.fragment,w),$(f.$$.fragment,w),i=!0)},o(w){I(a.$$.fragment,w),I(t.$$.fragment,w),I(o.$$.fragment,w),I(f.$$.fragment,w),i=!1},d(w){w&&m(e),N(a),N(t),N(o),N(f)}}}function Ge(r,e,a){let s;$e(r,be,i=>a(5,s=i));let{workflow:t}=e;const{namespace:n,workflow:o,run:l}=s.params,f=t==null?void 0:t.historyEvents;return r.$$set=i=>{"workflow"in i&&a(4,t=i.workflow)},[n,o,l,f,t]}class Xe extends G{constructor(e){super();X(this,e,Ge,ze,Y,{workflow:4})}}function Ye(r){var ce;let e,a,s,t,n,o,l,f,i=r[1].name+"",w,g,D,ne,F,re,R,J,se,oe,j,K=r[1].id+"",Z,le,q,Q,fe,ue,C,U=r[1].runId+"",x,ie,H,B;return t=new Ee({props:{icon:Ae}}),D=new We({props:{status:(ce=r[1])==null?void 0:ce.status}}),F=new Ve({props:{workflow:r[1],namespace:r[0]}}),H=new Xe({props:{workflow:r[1]}}),{c(){e=_("header"),a=_("main"),s=_("a"),A(t.$$.fragment),o=b(),l=_("div"),f=_("h1"),w=P(i),g=b(),A(D.$$.fragment),ne=b(),A(F.$$.fragment),re=b(),R=_("p"),J=_("span"),se=P("Workflow ID"),oe=b(),j=_("span"),Z=P(K),le=b(),q=_("p"),Q=_("span"),fe=P("Run ID"),ue=b(),C=_("span"),x=P(U),ie=b(),A(H.$$.fragment),this.h()},l(c){e=d(c,"HEADER",{class:!0});var h=k(e);a=d(h,"MAIN",{class:!0});var E=k(a);s=d(E,"A",{href:!0,class:!0,style:!0});var L=k(s);y(t.$$.fragment,L),L.forEach(m),o=v(E),l=d(E,"DIV",{class:!0});var M=k(l);f=d(M,"H1",{class:!0});var O=k(f);w=W(O,i),g=v(O),y(D.$$.fragment,O),O.forEach(m),ne=v(M),y(F.$$.fragment,M),M.forEach(m),re=v(E),R=d(E,"P",{class:!0});var ee=k(R);J=d(ee,"SPAN",{});var we=k(J);se=W(we,"Workflow ID"),we.forEach(m),oe=v(ee),j=d(ee,"SPAN",{class:!0});var pe=k(j);Z=W(pe,K),pe.forEach(m),ee.forEach(m),le=v(E),q=d(E,"P",{class:!0});var te=k(q);Q=d(te,"SPAN",{});var he=k(Q);fe=W(he,"Run ID"),he.forEach(m),ue=v(te),C=d(te,"SPAN",{class:!0});var _e=k(C);x=W(_e,U),_e.forEach(m),te.forEach(m),E.forEach(m),ie=v(h),y(H.$$.fragment,h),h.forEach(m),this.h()},h(){p(s,"href",n="/namespaces/"+r[0]+"/workflows"),p(s,"class","absolute top-2 back-to-workflows"),ye(s,"left","-1.5rem"),p(f,"class","text-2xl"),p(l,"class","flex justify-between items-center"),p(j,"class","font-medium"),p(R,"class","text-md"),p(C,"class","font-medium"),p(q,"class","text-md"),p(a,"class","flex flex-col gap-1 relative"),p(e,"class","flex flex-col gap-4")},m(c,h){T(c,e,h),u(e,a),u(a,s),S(t,s,null),u(a,o),u(a,l),u(l,f),u(f,w),u(f,g),S(D,f,null),u(l,ne),S(F,l,null),u(a,re),u(a,R),u(R,J),u(J,se),u(R,oe),u(R,j),u(j,Z),u(a,le),u(a,q),u(q,Q),u(Q,fe),u(q,ue),u(q,C),u(C,x),u(e,ie),S(H,e,null),B=!0},p(c,[h]){var O;(!B||h&1&&n!==(n="/namespaces/"+c[0]+"/workflows"))&&p(s,"href",n),(!B||h&2)&&i!==(i=c[1].name+"")&&V(w,i);const E={};h&2&&(E.status=(O=c[1])==null?void 0:O.status),D.$set(E);const L={};h&2&&(L.workflow=c[1]),h&1&&(L.namespace=c[0]),F.$set(L),(!B||h&2)&&K!==(K=c[1].id+"")&&V(Z,K),(!B||h&2)&&U!==(U=c[1].runId+"")&&V(x,U);const M={};h&2&&(M.workflow=c[1]),H.$set(M)},i(c){B||($(t.$$.fragment,c),$(D.$$.fragment,c),$(F.$$.fragment,c),$(H.$$.fragment,c),B=!0)},o(c){I(t.$$.fragment,c),I(D.$$.fragment,c),I(F.$$.fragment,c),I(H.$$.fragment,c),B=!1},d(c){c&&m(e),N(t),N(D),N(F),N(H)}}}function Ze(r,e,a){let{namespace:s}=e,{workflow:t}=e;return r.$$set=n=>{"namespace"in n&&a(0,s=n.namespace),"workflow"in n&&a(1,t=n.workflow)},[s,t]}class xe extends G{constructor(e){super();X(this,e,Ze,Ye,Y,{namespace:0,workflow:1})}}function et(r){let e,a,s,t;a=new xe({props:{namespace:r[1],workflow:r[0]}});const n=r[3].default,o=Se(n,r,r[2],null);return{c(){e=_("main"),A(a.$$.fragment),s=b(),o&&o.c(),this.h()},l(l){e=d(l,"MAIN",{class:!0});var f=k(e);y(a.$$.fragment,f),s=v(f),o&&o.l(f),f.forEach(m),this.h()},h(){p(e,"class","flex flex-col gap-6 h-full")},m(l,f){T(l,e,f),S(a,e,null),u(e,s),o&&o.m(e,null),t=!0},p(l,[f]){const i={};f&2&&(i.namespace=l[1]),f&1&&(i.workflow=l[0]),a.$set(i),o&&o.p&&(!t||f&4)&&Ne(o,n,l,l[2],t?Pe(n,l[2],f,null):Te(l[2]),null)},i(l){t||($(a.$$.fragment,l),$(o,l),t=!0)},o(l){I(a.$$.fragment,l),I(o,l),t=!1},d(l){l&&m(e),N(a),o&&o.d(l)}}}const ct=async function({params:r}){const{workflow:e,run:a,namespace:s}=r,n=await De({namespace:s,executionId:e,runId:a},fetch);return{props:{workflow:n,namespace:s},stuff:{workflow:n}}};function tt(r,e,a){let{$$slots:s={},$$scope:t}=e,{workflow:n}=e,{namespace:o}=e;return r.$$set=l=>{"workflow"in l&&a(0,n=l.workflow),"namespace"in l&&a(1,o=l.namespace),"$$scope"in l&&a(2,t=l.$$scope)},[n,o,t,s]}class wt extends G{constructor(e){super();X(this,e,tt,et,Y,{workflow:0,namespace:1})}}export{wt as default,ct as load};
