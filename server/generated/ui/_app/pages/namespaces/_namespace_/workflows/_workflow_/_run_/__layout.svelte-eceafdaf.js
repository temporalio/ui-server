import{S as he,i as pe,s as de,e as _,k as g,w as H,c as h,a as d,d as c,m as v,x as M,b as p,g as D,G as i,y as R,W as qe,H as Ee,I as Ie,J as Te,q as w,o as k,B as j,l as we,n as Be,p as Oe,ah as Le,L as Je,aC as Qe,F as Ae,t as F,h as V,j as fe,ao as Fe,U as Ve,O as Ce,K as Ue,aD as Ge,f as Ke}from"../../../../../../chunks/vendor-c58cc9e7.js";import{W as ze,a as Xe}from"../../../../../../chunks/workflow-status-44750080.js";import{c as Ye,d as Ze,e as xe,f as et,g as tt}from"../../../../../../chunks/route-for-66ab8490.js";import{r as nt,a as st,h as at}from"../../../../../../chunks/route-for-api-02d6e3d1.js";import{n as lt}from"../../../../../../chunks/notifications-ac094b56.js";import{B as De}from"../../../../../../chunks/button-0d1aab5a.js";import{p as rt}from"../../../../../../chunks/stores-810f7c97.js";import"../../../../../../chunks/navigation-093db9e2.js";import"../../../../../../chunks/singletons-a6a7384f.js";import"../../../../../../chunks/is-network-error-ac7c8caf.js";async function ot({workflow:l,namespace:e,reason:t}){return await nt(st("workflow.terminate",{namespace:e,executionId:l.id,runId:l.runId}),{options:{method:"POST",body:JSON.stringify({reason:t})},shouldRetry:!1})}const ft=l=>({}),He=l=>({}),it=l=>({}),Me=l=>({});function Re(l){let e,t,s,n,a,r,o,f,$,A,P,E,b,B,q,y,U,ie;r=new Je({props:{icon:Qe}});const ee=l[3].title,J=Ae(ee,l,l[7],Me),S=J||ct(),G=l[3].content,K=Ae(G,l,l[7],He),I=K||ut();return b=new De({props:{secondary:!0,$$slots:{default:[mt]},$$scope:{ctx:l}}}),b.$on("click",l[5]),q=new De({props:{destroy:!0,$$slots:{default:[_t]},$$scope:{ctx:l}}}),q.$on("click",l[6]),{c(){e=_("div"),t=_("div"),s=g(),n=_("div"),a=_("div"),H(r.$$.fragment),o=g(),f=_("div"),S&&S.c(),$=g(),A=_("div"),I&&I.c(),P=g(),E=_("div"),H(b.$$.fragment),B=g(),H(q.$$.fragment),this.h()},l(u){e=h(u,"DIV",{class:!0});var T=d(e);t=h(T,"DIV",{class:!0}),d(t).forEach(c),s=v(T),n=h(T,"DIV",{class:!0});var W=d(n);a=h(W,"DIV",{class:!0});var O=d(a);M(r.$$.fragment,O),O.forEach(c),o=v(W),f=h(W,"DIV",{class:!0});var z=d(f);S&&S.l(z),z.forEach(c),$=v(W),A=h(W,"DIV",{class:!0});var te=d(A);I&&I.l(te),te.forEach(c),P=v(W),E=h(W,"DIV",{class:!0});var X=d(E);M(b.$$.fragment,X),B=v(X),M(q.$$.fragment,X),X.forEach(c),W.forEach(c),T.forEach(c),this.h()},h(){p(t,"class","overlay svelte-p12tlm"),p(a,"class","float-right cursor-pointer p-6"),p(f,"class","title svelte-p12tlm"),p(A,"class","content svelte-p12tlm"),p(E,"class","flex justify-end items-center p-6 space-x-2"),p(n,"class","body svelte-p12tlm"),p(e,"class","modal svelte-p12tlm")},m(u,T){D(u,e,T),i(e,t),i(e,s),i(e,n),i(n,a),R(r,a,null),i(n,o),i(n,f),S&&S.m(f,null),i(n,$),i(n,A),I&&I.m(A,null),i(n,P),i(n,E),R(b,E,null),i(E,B),R(q,E,null),y=!0,U||(ie=qe(a,"click",l[4]),U=!0)},p(u,T){J&&J.p&&(!y||T&128)&&Ee(J,ee,u,u[7],y?Te(ee,u[7],T,it):Ie(u[7]),Me),K&&K.p&&(!y||T&128)&&Ee(K,G,u,u[7],y?Te(G,u[7],T,ft):Ie(u[7]),He);const W={};T&128&&(W.$$scope={dirty:T,ctx:u}),b.$set(W);const O={};T&130&&(O.$$scope={dirty:T,ctx:u}),q.$set(O)},i(u){y||(w(r.$$.fragment,u),w(S,u),w(I,u),w(b.$$.fragment,u),w(q.$$.fragment,u),y=!0)},o(u){k(r.$$.fragment,u),k(S,u),k(I,u),k(b.$$.fragment,u),k(q.$$.fragment,u),y=!1},d(u){u&&c(e),j(r),S&&S.d(u),I&&I.d(u),j(b),j(q),U=!1,ie()}}}function ct(l){let e,t;return{c(){e=_("h3"),t=F("Title")},l(s){e=h(s,"H3",{});var n=d(e);t=V(n,"Title"),n.forEach(c)},m(s,n){D(s,e,n),i(e,t)},d(s){s&&c(e)}}}function ut(l){let e,t;return{c(){e=_("span"),t=F("Content")},l(s){e=h(s,"SPAN",{});var n=d(e);t=V(n,"Content"),n.forEach(c)},m(s,n){D(s,e,n),i(e,t)},d(s){s&&c(e)}}}function mt(l){let e;return{c(){e=F("Cancel")},l(t){e=V(t,"Cancel")},m(t,s){D(t,e,s)},d(t){t&&c(e)}}}function _t(l){let e;return{c(){e=F(l[1])},l(t){e=V(t,l[1])},m(t,s){D(t,e,s)},p(t,s){s&2&&fe(e,t[1])},d(t){t&&c(e)}}}function ht(l){let e,t,s=l[0]&&Re(l);return{c(){s&&s.c(),e=we()},l(n){s&&s.l(n),e=we()},m(n,a){s&&s.m(n,a),D(n,e,a),t=!0},p(n,[a]){n[0]?s?(s.p(n,a),a&1&&w(s,1)):(s=Re(n),s.c(),w(s,1),s.m(e.parentNode,e)):s&&(Be(),k(s,1,1,()=>{s=null}),Oe())},i(n){t||(w(s),t=!0)},o(n){k(s),t=!1},d(n){s&&s.d(n),n&&c(e)}}}function pt(l,e,t){let{$$slots:s={},$$scope:n}=e,{open:a=!1}=e,{confirmText:r="Confirm"}=e;const o=Le(),f=()=>o("cancelModal",{}),$=()=>o("cancelModal",{}),A=()=>o("confirmModal",{});return l.$$set=P=>{"open"in P&&t(0,a=P.open),"confirmText"in P&&t(1,r=P.confirmText),"$$scope"in P&&t(7,n=P.$$scope)},[a,r,o,s,f,$,A,n]}class dt extends he{constructor(e){super();pe(this,e,pt,ht,de,{open:0,confirmText:1})}}function je(l){let e,t,s,n;return e=new De({props:{destroy:!0,thin:!0,$$slots:{default:[$t]},$$scope:{ctx:l}}}),e.$on("click",l[3]),s=new dt({props:{open:l[2],confirmText:"Terminate",$$slots:{content:[gt],title:[wt]},$$scope:{ctx:l}}}),s.$on("cancelModal",l[4]),s.$on("confirmModal",l[6]),{c(){H(e.$$.fragment),t=g(),H(s.$$.fragment)},l(a){M(e.$$.fragment,a),t=v(a),M(s.$$.fragment,a)},m(a,r){R(e,a,r),D(a,t,r),R(s,a,r),n=!0},p(a,r){const o={};r&1024&&(o.$$scope={dirty:r,ctx:a}),e.$set(o);const f={};r&4&&(f.open=a[2]),r&1026&&(f.$$scope={dirty:r,ctx:a}),s.$set(f)},i(a){n||(w(e.$$.fragment,a),w(s.$$.fragment,a),n=!0)},o(a){k(e.$$.fragment,a),k(s.$$.fragment,a),n=!1},d(a){j(e,a),a&&c(t),j(s,a)}}}function $t(l){let e;return{c(){e=F("Terminate")},l(t){e=V(t,"Terminate")},m(t,s){D(t,e,s)},d(t){t&&c(e)}}}function wt(l){let e,t;return{c(){e=_("h3"),t=F("Terminate Workflow"),this.h()},l(s){e=h(s,"H3",{slot:!0});var n=d(e);t=V(n,"Terminate Workflow"),n.forEach(c),this.h()},h(){p(e,"slot","title")},m(s,n){D(s,e,n),i(e,t)},d(s){s&&c(e)}}}function gt(l){let e,t,s,n,a,r,o;return{c(){e=_("div"),t=_("p"),s=F(`Are you sure you want to terminate this workflow? This action cannot be
        undone.`),n=g(),a=_("input"),this.h()},l(f){e=h(f,"DIV",{slot:!0});var $=d(e);t=h($,"P",{});var A=d(t);s=V(A,`Are you sure you want to terminate this workflow? This action cannot be
        undone.`),A.forEach(c),n=v($),a=h($,"INPUT",{class:!0,placeholder:!0}),$.forEach(c),this.h()},h(){p(a,"class","block w-full border border-gray-200 rounded-md p-2 mt-4"),p(a,"placeholder","Enter a reason"),p(e,"slot","content")},m(f,$){D(f,e,$),i(e,t),i(t,s),i(e,n),i(e,a),Fe(a,l[1]),r||(o=qe(a,"input",l[8]),r=!0)},p(f,$){$&2&&a.value!==f[1]&&Fe(a,f[1])},d(f){f&&c(e),r=!1,o()}}}function vt(l){let e=l[5](l[0]),t,s,n=e&&je(l);return{c(){n&&n.c(),t=we()},l(a){n&&n.l(a),t=we()},m(a,r){n&&n.m(a,r),D(a,t,r),s=!0},p(a,[r]){r&1&&(e=a[5](a[0])),e?n?(n.p(a,r),r&1&&w(n,1)):(n=je(a),n.c(),w(n,1),n.m(t.parentNode,t)):n&&(Be(),k(n,1,1,()=>{n=null}),Oe())},i(a){s||(w(n),s=!0)},o(a){k(n),s=!1},d(a){n&&n.d(a),a&&c(t)}}}function kt(l,e,t){let{workflow:s}=e,{namespace:n}=e,a="",r=!1;const o=()=>t(2,r=!0),f=()=>t(2,r=!1),$=b=>String(b.status)==="Running",A=()=>{t(2,r=!1),t(1,a=""),lt.add("success","Workflow Terminated"),window.location.reload()},P=()=>{ot({workflow:s,namespace:n,reason:a}).then(A).catch(at)};function E(){a=this.value,t(1,a)}return l.$$set=b=>{"workflow"in b&&t(0,s=b.workflow),"namespace"in b&&t(7,n=b.namespace)},[s,a,r,o,f,$,P,n,E]}class bt extends he{constructor(e){super();pe(this,e,kt,vt,de,{workflow:0,namespace:7})}}function Et(l){let e;return{c(){e=F(l[1])},l(t){e=V(t,l[1])},m(t,s){D(t,e,s)},p(t,s){s&2&&fe(e,t[1])},d(t){t&&c(e)}}}function It(l){let e,t,s,n;return{c(){e=F(l[1]),t=g(),s=_("span"),n=F(l[2]),this.h()},l(a){e=V(a,l[1]),t=v(a),s=h(a,"SPAN",{class:!0});var r=d(s);n=V(r,l[2]),r.forEach(c),this.h()},h(){p(s,"class","px-2 text-blue-700 bg-blue-100 rounded-sm")},m(a,r){D(a,e,r),D(a,t,r),D(a,s,r),i(s,n)},p(a,r){r&2&&fe(e,a[1]),r&4&&fe(n,a[2])},d(a){a&&c(e),a&&c(t),a&&c(s)}}}function Tt(l){let e;function t(a,r){return a[2]||a[2]===0?It:Et}let s=t(l),n=s(l);return{c(){e=_("a"),n.c(),this.h()},l(a){e=h(a,"A",{class:!0,href:!0});var r=d(e);n.l(r),r.forEach(c),this.h()},h(){p(e,"class","block svelte-tavydt"),p(e,"href",l[0]),Ve(e,"active",l[3])},m(a,r){D(a,e,r),n.m(e,null)},p(a,[r]){s===(s=t(a))&&n?n.p(a,r):(n.d(1),n=s(a),n&&(n.c(),n.m(e,null))),r&1&&p(e,"href",a[0]),r&8&&Ve(e,"active",a[3])},i:Ce,o:Ce,d(a){a&&c(e),n.d()}}}function At(l,e,t){let s,n;Ue(l,rt,f=>t(4,n=f));let{href:a}=e,{label:r}=e,{amount:o=null}=e;return l.$$set=f=>{"href"in f&&t(0,a=f.href),"label"in f&&t(1,r=f.label),"amount"in f&&t(2,o=f.amount)},l.$$.update=()=>{l.$$.dirty&17&&t(3,s=n.url.pathname.includes(a))},[a,r,o,s,n]}class _e extends he{constructor(e){super();pe(this,e,At,Tt,de,{href:0,label:1,amount:2})}}function Dt(l){var ye,Pe,Se;let e,t,s,n,a,r,o,f,$=l[1].name+"",A,P,E,b,B,q,y,U,ie,ee,J,S=l[1].id+"",G,K,I,u,T,W,O,z=l[1].runId+"",te,X,C,Y,ge,Z,ve,ne,ke,se,be,ae,x;return n=new Je({props:{icon:Ge}}),E=new ze({props:{status:(ye=l[1])==null?void 0:ye.status}}),B=new bt({props:{workflow:l[1],namespace:l[0]}}),Y=new _e({props:{label:"History",href:Ye(l[2]),amount:(Pe=l[1])==null?void 0:Pe.historyEvents}}),Z=new _e({props:{label:"Pending Activities",href:Ze(l[2]),amount:(Se=l[1].pendingActivities)==null?void 0:Se.length}}),ne=new _e({props:{label:"Workers",href:xe(l[2])}}),se=new _e({props:{label:"Stack Trace",href:et(l[2])}}),ae=new _e({props:{label:"Query",href:tt(l[2])}}),{c(){e=_("header"),t=_("main"),s=_("a"),H(n.$$.fragment),r=g(),o=_("div"),f=_("h1"),A=F($),P=g(),H(E.$$.fragment),b=g(),H(B.$$.fragment),q=g(),y=_("p"),U=_("span"),ie=F("Workflow ID"),ee=g(),J=_("span"),G=F(S),K=g(),I=_("p"),u=_("span"),T=F("Run ID"),W=g(),O=_("span"),te=F(z),X=g(),C=_("nav"),H(Y.$$.fragment),ge=g(),H(Z.$$.fragment),ve=g(),H(ne.$$.fragment),ke=g(),H(se.$$.fragment),be=g(),H(ae.$$.fragment),this.h()},l(m){e=h(m,"HEADER",{class:!0});var N=d(e);t=h(N,"MAIN",{class:!0});var L=d(t);s=h(L,"A",{href:!0,class:!0,style:!0});var ce=d(s);M(n.$$.fragment,ce),ce.forEach(c),r=v(L),o=h(L,"DIV",{class:!0});var le=d(o);f=h(le,"H1",{class:!0});var re=d(f);A=V(re,$),P=v(re),M(E.$$.fragment,re),re.forEach(c),b=v(le),M(B.$$.fragment,le),le.forEach(c),q=v(L),y=h(L,"P",{class:!0});var oe=d(y);U=h(oe,"SPAN",{});var ue=d(U);ie=V(ue,"Workflow ID"),ue.forEach(c),ee=v(oe),J=h(oe,"SPAN",{class:!0});var me=d(J);G=V(me,S),me.forEach(c),oe.forEach(c),K=v(L),I=h(L,"P",{class:!0});var $e=d(I);u=h($e,"SPAN",{});var Ne=d(u);T=V(Ne,"Run ID"),Ne.forEach(c),W=v($e),O=h($e,"SPAN",{class:!0});var We=d(O);te=V(We,z),We.forEach(c),$e.forEach(c),L.forEach(c),X=v(N),C=h(N,"NAV",{class:!0});var Q=d(C);M(Y.$$.fragment,Q),ge=v(Q),M(Z.$$.fragment,Q),ve=v(Q),M(ne.$$.fragment,Q),ke=v(Q),M(se.$$.fragment,Q),be=v(Q),M(ae.$$.fragment,Q),Q.forEach(c),N.forEach(c),this.h()},h(){p(s,"href",a="/namespaces/"+l[0]+"/workflows"),p(s,"class","absolute top-2 back-to-workflows"),Ke(s,"left","-1.5rem"),p(f,"class","text-2xl"),p(o,"class","flex justify-between items-center"),p(J,"class","font-medium"),p(y,"class","text-md"),p(O,"class","font-medium"),p(I,"class","text-md"),p(t,"class","flex flex-col gap-1 relative"),p(C,"class","flex gap-6"),p(e,"class","flex flex-col gap-4")},m(m,N){D(m,e,N),i(e,t),i(t,s),R(n,s,null),i(t,r),i(t,o),i(o,f),i(f,A),i(f,P),R(E,f,null),i(o,b),R(B,o,null),i(t,q),i(t,y),i(y,U),i(U,ie),i(y,ee),i(y,J),i(J,G),i(t,K),i(t,I),i(I,u),i(u,T),i(I,W),i(I,O),i(O,te),i(e,X),i(e,C),R(Y,C,null),i(C,ge),R(Z,C,null),i(C,ve),R(ne,C,null),i(C,ke),R(se,C,null),i(C,be),R(ae,C,null),x=!0},p(m,[N]){var oe,ue,me;(!x||N&1&&a!==(a="/namespaces/"+m[0]+"/workflows"))&&p(s,"href",a),(!x||N&2)&&$!==($=m[1].name+"")&&fe(A,$);const L={};N&2&&(L.status=(oe=m[1])==null?void 0:oe.status),E.$set(L);const ce={};N&2&&(ce.workflow=m[1]),N&1&&(ce.namespace=m[0]),B.$set(ce),(!x||N&2)&&S!==(S=m[1].id+"")&&fe(G,S),(!x||N&2)&&z!==(z=m[1].runId+"")&&fe(te,z);const le={};N&2&&(le.amount=(ue=m[1])==null?void 0:ue.historyEvents),Y.$set(le);const re={};N&2&&(re.amount=(me=m[1].pendingActivities)==null?void 0:me.length),Z.$set(re)},i(m){x||(w(n.$$.fragment,m),w(E.$$.fragment,m),w(B.$$.fragment,m),w(Y.$$.fragment,m),w(Z.$$.fragment,m),w(ne.$$.fragment,m),w(se.$$.fragment,m),w(ae.$$.fragment,m),x=!0)},o(m){k(n.$$.fragment,m),k(E.$$.fragment,m),k(B.$$.fragment,m),k(Y.$$.fragment,m),k(Z.$$.fragment,m),k(ne.$$.fragment,m),k(se.$$.fragment,m),k(ae.$$.fragment,m),x=!1},d(m){m&&c(e),j(n),j(E),j(B),j(Y),j(Z),j(ne),j(se),j(ae)}}}function yt(l,e,t){let{namespace:s}=e,{workflow:n}=e;const a={namespace:s,workflow:n.id,run:n.runId};return l.$$set=r=>{"namespace"in r&&t(0,s=r.namespace),"workflow"in r&&t(1,n=r.workflow)},[s,n,a]}class Pt extends he{constructor(e){super();pe(this,e,yt,Dt,de,{namespace:0,workflow:1})}}function St(l){let e,t,s,n;t=new Pt({props:{namespace:l[1],workflow:l[0]}});const a=l[3].default,r=Ae(a,l,l[2],null);return{c(){e=_("main"),H(t.$$.fragment),s=g(),r&&r.c(),this.h()},l(o){e=h(o,"MAIN",{class:!0});var f=d(e);M(t.$$.fragment,f),s=v(f),r&&r.l(f),f.forEach(c),this.h()},h(){p(e,"class","flex flex-col gap-6 h-full")},m(o,f){D(o,e,f),R(t,e,null),i(e,s),r&&r.m(e,null),n=!0},p(o,[f]){const $={};f&2&&($.namespace=o[1]),f&1&&($.workflow=o[0]),t.$set($),r&&r.p&&(!n||f&4)&&Ee(r,a,o,o[2],n?Te(a,o[2],f,null):Ie(o[2]),null)},i(o){n||(w(t.$$.fragment,o),w(r,o),n=!0)},o(o){k(t.$$.fragment,o),k(r,o),n=!1},d(o){o&&c(e),j(t),r&&r.d(o)}}}const Ot=async function({params:l,fetch:e}){const{workflow:t,run:s,namespace:n}=l,r=await Xe({namespace:n,executionId:t,runId:s},e);return{props:{workflow:r,namespace:n},stuff:{workflow:r}}};function Nt(l,e,t){let{$$slots:s={},$$scope:n}=e,{workflow:a}=e,{namespace:r}=e;return l.$$set=o=>{"workflow"in o&&t(0,a=o.workflow),"namespace"in o&&t(1,r=o.namespace),"$$scope"in o&&t(2,n=o.$$scope)},[a,r,n,s]}class Jt extends he{constructor(e){super();pe(this,e,Nt,St,de,{workflow:0,namespace:1})}}export{Jt as default,Ot as load};
