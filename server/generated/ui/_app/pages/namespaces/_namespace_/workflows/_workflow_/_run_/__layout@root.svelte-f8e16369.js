import{S as k,i as _,s as d,I as T,e as h,w as y,k as Q,c as g,a as I,x as A,m as q,d as u,b as F,g as P,y as S,M as O,J as W,K as C,L as E,q as c,o as f,B as K}from"../../../../../../chunks/index-fbba58ee.js";import{e as L}from"../../../../../../chunks/route-for-e4b4dbdd.js";import{r as p,a as w}from"../../../../../../chunks/route-for-api-0c88d2a9.js";import{f as R}from"../../../../../../chunks/workflow-status-5fe651e4.js";import b from"./_header.svelte-26ff147f.js";import"../../../../../../chunks/index-ba9db614.js";import"../../../../../../chunks/notifications-efbae72f.js";import"../../../../../../chunks/is-network-error-ac7c8caf.js";import"../../../../../../chunks/simplify-attributes-433df544.js";import"../../../../../../chunks/format-date-a1a343f8.js";import"../../../../../../chunks/to-duration-6ce02332.js";import"../../../../../../chunks/index-976b9d76.js";import"../../../../../../chunks/event-view-e3c4ca6d.js";import"../../../../../../chunks/stores-c599ed87.js";import"../../../../../../chunks/persist-store-fb1219b0.js";import"../../../../../../chunks/workflows-4d3e23c6.js";import"../../../../../../chunks/with-loading-22689bcc.js";import"../../../../../../chunks/button-900a389e.js";import"../../../../../../chunks/modal-aea1f74c.js";import"../../../../../../chunks/events-service-e417652b.js";import"../../../../../../chunks/index-3eb2a7b4.js";import"../../../../../../chunks/is-http-0c9cc01f.js";import"../../../../../../chunks/data-converter-config-708bfcc9.js";import"../../../../../../chunks/atob-eb4fc9a1.js";import"../../../../../../chunks/index-8821dfb5.js";import"../../../../../../chunks/get-event-categorization-20095c1b.js";async function v(i,a=fetch){const o=await p(w("task-queue",i),{request:a,params:{taskQueueType:"1"}}),l=await p(w("task-queue",i),{request:a,params:{taskQueueType:"2"}});l.pollers.forEach(r=>{r.taskQueueTypes=["ACTIVITY"]}),o.pollers.forEach(r=>{r.taskQueueTypes=["WORKFLOW"]});const n=r=>(s,e)=>{const t=s[e.identity]||{lastAccessTime:void 0,taskQueueTypes:[]};return s[e.identity]={lastAccessTime:!t.lastAccessTime||t.lastAccessTime<e.lastAccessTime?e.lastAccessTime:t.lastAccessTime,taskQueueTypes:t.taskQueueTypes.concat([r])},s};return l.pollers.filter(r=>o.pollers.some(s=>{if(r.identity===s.identity)return r.taskQueueTypes=[...s.taskQueueTypes,...r.taskQueueTypes],r})),l.pollers.reduce(n("ACTIVITY"),o.pollers.reduce(n("WORKFLOW"),{})),{pollers:l.pollers,taskQueueStatus:l.taskQueueStatus}}function M(i){let a,o,l,n;o=new b({props:{namespace:i[1],workflow:i[0],workers:i[2]}});const r=i[4].default,s=T(r,i,i[3],null);return{c(){a=h("main"),y(o.$$.fragment),l=Q(),s&&s.c(),this.h()},l(e){a=g(e,"MAIN",{class:!0});var t=I(a);A(o.$$.fragment,t),l=q(t),s&&s.l(t),t.forEach(u),this.h()},h(){F(a,"class","flex h-full flex-col gap-6")},m(e,t){P(e,a,t),S(o,a,null),O(a,l),s&&s.m(a,null),n=!0},p(e,[t]){const m={};t&2&&(m.namespace=e[1]),t&1&&(m.workflow=e[0]),t&4&&(m.workers=e[2]),o.$set(m),s&&s.p&&(!n||t&8)&&W(s,r,e,e[3],n?E(r,e[3],t,null):C(e[3]),null)},i(e){n||(c(o.$$.fragment,e),c(s,e),n=!0)},o(e){f(o.$$.fragment,e),f(s,e),n=!1},d(e){e&&u(a),K(o),s&&s.d(e)}}}const fe=async function({params:i,fetch:a}){const{workflow:o,run:l,namespace:n}=i,r={namespace:n,workflowId:L(o),runId:l},s=await R(r,a),{taskQueue:e}=s,t=await v({queue:e,namespace:n});return{props:{workflow:s,namespace:n,workers:t},stuff:{workflow:s,workers:t}}};function V(i,a,o){let{$$slots:l={},$$scope:n}=a,{workflow:r}=a,{namespace:s}=a,{workers:e}=a;return i.$$set=t=>{"workflow"in t&&o(0,r=t.workflow),"namespace"in t&&o(1,s=t.namespace),"workers"in t&&o(2,e=t.workers),"$$scope"in t&&o(3,n=t.$$scope)},[r,s,e,n,l]}class pe extends k{constructor(a){super(),_(this,a,V,M,d,{workflow:0,namespace:1,workers:2})}}export{pe as default,fe as load};
