import{t as m}from"./CmQ9-Uxk.js";import{f as I}from"./398CnOUd.js";import{r as x}from"./BrrWw5aB.js";import{b as q}from"./BDfAQ6r3.js";import{p as F}from"./sJfIZrdj.js";import{r as v,a as y}from"./Dn3vENvG.js";var N=A;function A(t,a,n){var r=null,e=null,s=n&&n.leading,o=n&&n.trailing;s==null&&(s=!0),o==null&&(o=!s),s==!0&&(o=!1);var c=function(){r&&(clearTimeout(r),r=null)},l=function(){var i=e;c(),i&&i()},u=function(){var i=s&&!r,f=this,w=arguments;if(e=function(){return t.apply(f,w)},r||(r=setTimeout(function(){if(r=null,o)return e()},a)),i)return i=!1,e()};return u.cancel=c,u.flush=l,u}const j=({namespace:t,workflowId:a,runId:n})=>v("events.raw",{namespace:t,workflowId:a,runId:n},!0),H=t=>!q(t)||t==="descending"?"events.descending":t==="ascending"?"events.ascending":"events.descending",k=async({namespace:t,workflowId:a,runId:n,sort:r,onStart:e,onUpdate:s,onComplete:o})=>{const c=H(r),l=v(c,{namespace:t,workflowId:a});return(await F(async i=>y(l,{token:i,request:fetch,params:{"execution.runId":n}}),{onStart:e,onUpdate:s,onComplete:o})).history.events},P=N(()=>{x.set(Date.now())},5e3),z=async({namespace:t,workflowId:a,runId:n,sort:r="ascending",signal:e,historySize:s})=>{const o=()=>{e&&I.set([])},c=(d,p)=>{var g,E;if(!e)return;I.set([...m((g=d.history)==null?void 0:g.events)]);const h=(E=p==null?void 0:p.history)==null?void 0:E.events;s&&(h==null?void 0:h.every(R=>parseInt(R.eventId)>parseInt(s)))&&P()},l=()=>{e&&x.set(Date.now())},u=H(r),i=v(u,{namespace:t,workflowId:a}),f=await F(async d=>y(i,{token:d,request:fetch,params:{"execution.runId":n,waitNewEvent:e?"true":"false"},options:{signal:e}}),{onStart:o,onUpdate:c,onComplete:l});return f!=null&&f.history?await m(f.history.events):[]},S=async({namespace:t,workflowId:a,runId:n,sort:r,maximumPageSize:e="20"})=>{const s=v(`events.${r}`,{namespace:t,workflowId:a});try{return(await y(s,{request:fetch,params:{maximumPageSize:e,"execution.runId":n}})).history.events}catch{return[]}},B=async t=>{const a=await S({...t,sort:"ascending",maximumPageSize:"1"});return(await m(a))[0]};export{B as a,k as b,z as f,j as g,P as t};
