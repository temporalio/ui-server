import"./DhkeTKsX.js";import"./BUApaBEI.js";import"./DAcYyk2F.js";import"./urDygoU8.js";import"./BTr00nzv.js";import"./ikbOq2O5.js";import{h as b}from"./BJzbPR4R.js";import{f as C}from"./2dgXBwRQ.js";import{e as U,f as N,g as K}from"./DNNVWk-J.js";import{m as q}from"./CrZfxCV7.js";const D=["workflowExecutionStartedEventAttributes","workflowExecutionCompletedEventAttributes","workflowExecutionFailedEventAttributes","workflowExecutionTimedOutEventAttributes","workflowExecutionOptionsUpdatedEventAttributes","workflowTaskStartedEventAttributes","workflowTaskScheduledEventAttributes","workflowTaskCompletedEventAttributes","workflowTaskTimedOutEventAttributes","workflowTaskFailedEventAttributes","activityTaskScheduledEventAttributes","activityTaskCompletedEventAttributes","activityTaskStartedEventAttributes","activityTaskFailedEventAttributes","activityTaskTimedOutEventAttributes","timerStartedEventAttributes","timerFiredEventAttributes","activityTaskCancelRequestedEventAttributes","activityTaskCanceledEventAttributes","timerCanceledEventAttributes","markerRecordedEventAttributes","workflowExecutionSignaledEventAttributes","workflowExecutionTerminatedEventAttributes","workflowExecutionUpdateAdmittedEventAttributes","workflowExecutionUpdateAcceptedEventAttributes","workflowExecutionUpdateCompletedEventAttributes","workflowExecutionUpdateRejectedEventAttributes","workflowExecutionCancelRequestedEventAttributes","workflowExecutionCanceledEventAttributes","requestCancelExternalWorkflowExecutionInitiatedEventAttributes","requestCancelExternalWorkflowExecutionFailedEventAttributes","externalWorkflowExecutionCancelRequestedEventAttributes","workflowExecutionContinuedAsNewEventAttributes","startChildWorkflowExecutionInitiatedEventAttributes","startChildWorkflowExecutionFailedEventAttributes","childWorkflowExecutionStartedEventAttributes","childWorkflowExecutionCompletedEventAttributes","childWorkflowExecutionFailedEventAttributes","childWorkflowExecutionCanceledEventAttributes","childWorkflowExecutionTimedOutEventAttributes","childWorkflowExecutionTerminatedEventAttributes","signalExternalWorkflowExecutionInitiatedEventAttributes","signalExternalWorkflowExecutionFailedEventAttributes","externalWorkflowExecutionSignaledEventAttributes","upsertWorkflowSearchAttributesEventAttributes","nexusOperationScheduledEventAttributes","nexusOperationStartedEventAttributes","nexusOperationCompletedEventAttributes","nexusOperationFailedEventAttributes","nexusOperationCanceledEventAttributes","nexusOperationTimedOutEventAttributes","nexusOperationCancelRequestedEventAttributes","nexusOperationCancelRequestCompletedEventAttributes","nexusOperationCancelRequestFailedEventAttributes","workflowExecutionOptionsUpdatedEventAttributes","workflowPropertiesModifiedEventAttributes"],V=["WorkflowTaskCompleted","WorkflowTaskFailed","WorkflowTaskTimedOut"],H=t=>{for(const o of D)if(o in t)return o},_=(t,o)=>t[o],B=t=>{const o=H(t),n=_(t,o);return{key:o,attributes:n}},i=t=>o=>!!(o!=null&&o[t]),R=i("workflowExecutionStartedEventAttributes"),yt=i("workflowExecutionCompletedEventAttributes"),It=i("workflowExecutionFailedEventAttributes"),gt=i("workflowExecutionTimedOutEventAttributes"),ht=i("workflowTaskScheduledEventAttributes"),Lt=i("workflowTaskStartedEventAttributes"),M=i("workflowTaskCompletedEventAttributes"),Ut=i("workflowTaskTimedOutEventAttributes"),S=i("workflowTaskFailedEventAttributes"),Nt=t=>{var o,n,r,s;return S(t)&&((n=(o=t.workflowTaskFailedEventAttributes)==null?void 0:o.failure)==null?void 0:n.message)!=="UnhandledCommand"&&!((s=(r=t.workflowTaskFailedEventAttributes)==null?void 0:r.failure)!=null&&s.resetWorkflowFailureInfo)},Y=i("activityTaskScheduledEventAttributes"),P=i("activityTaskStartedEventAttributes"),Kt=i("activityTaskCompletedEventAttributes"),qt=i("activityTaskFailedEventAttributes"),Dt=i("activityTaskTimedOutEventAttributes"),X=i("timerStartedEventAttributes"),Vt=i("timerFiredEventAttributes"),Ht=i("activityTaskCancelRequestedEventAttributes"),_t=i("activityTaskCanceledEventAttributes"),Bt=i("timerCanceledEventAttributes"),F=i("markerRecordedEventAttributes"),y=i("workflowExecutionOptionsUpdatedEventAttributes"),j=i("workflowExecutionSignaledEventAttributes"),Mt=i("workflowExecutionTerminatedEventAttributes"),Yt=i("workflowExecutionCanceledEventAttributes"),Pt=i("workflowExecutionContinuedAsNewEventAttributes"),G=i("startChildWorkflowExecutionInitiatedEventAttributes"),Xt=i("childWorkflowExecutionStartedEventAttributes"),jt=i("childWorkflowExecutionCompletedEventAttributes"),Gt=i("childWorkflowExecutionFailedEventAttributes"),Jt=i("childWorkflowExecutionCanceledEventAttributes"),Qt=i("childWorkflowExecutionTimedOutEventAttributes"),Zt=i("childWorkflowExecutionTerminatedEventAttributes"),$t=i("signalExternalWorkflowExecutionInitiatedEventAttributes"),zt=i("signalExternalWorkflowExecutionFailedEventAttributes"),te=i("externalWorkflowExecutionSignaledEventAttributes"),J=i("upsertWorkflowSearchAttributesEventAttributes"),ee=t=>V.includes(t.eventType),Q=["LocalActivity","core_local_activity"],oe=t=>!(!F(t)||!Q.includes(t.markerRecordedEventAttributes.markerName)),Z=i("workflowExecutionUpdateAcceptedEventAttributes"),$=i("workflowExecutionUpdateRejectedEventAttributes"),z=i("workflowExecutionUpdateCompletedEventAttributes"),ie=t=>{var o;return z(t)&&!!((o=t.workflowExecutionUpdateCompletedEventAttributes.outcome)!=null&&o.failure)},tt=i("nexusOperationScheduledEventAttributes"),ne=i("nexusOperationStartedEventAttributes"),re=i("nexusOperationCompletedEventAttributes"),se=i("nexusOperationFailedEventAttributes"),ae=i("nexusOperationCanceledEventAttributes"),le=i("nexusOperationTimedOutEventAttributes"),et=i("nexusOperationCancelRequestedEventAttributes"),ot=t=>t.eventType==="WorkflowTaskFailed",I=t=>t.eventType==="WorkflowTaskTimedOut",it=t=>t.eventType==="WorkflowTaskCompleted",g=t=>S(t)&&h(t)==="ResetWorkflow",h=t=>{var r;if(I(t))return"WorkflowTaskTimedOut";const{workflowTaskFailedEventAttributes:{failure:o,cause:n}={}}=t;return((r=o==null?void 0:o.applicationFailureInfo)==null?void 0:r.type)==="workflowTaskHeartbeatError"?"WorkflowTaskHeartbeatError":U(n)},O=t=>{const o=t.findIndex(ot),n=t.findIndex(I),r=o<0?n:o;if(r<0)return;const s=t.findIndex(it),u=t[r];if(h(u)!=="ResetWorkflow"&&(s<0||r<s))return u},ue=(t,o)=>{if(o==="descending")return O(t);{const n=[...t].reverse();return O(n)}},nt=(t,o)=>{var n,r,s,u,c,f,k,w,T,v,A,m,d,E;try{if(R(t)){const a=((n=t.attributes)==null?void 0:n.attempt)||1,l=(r=t.attributes)==null?void 0:r.firstExecutionRunId,p=(s=t.attributes)==null?void 0:s.originalExecutionRunId,L=l===p&&((f=(c=(u=t.attributes)==null?void 0:u.searchAttributes)==null?void 0:c.indexedFields)==null?void 0:f.TemporalScheduledById);return a>1?0:L?3:1}if(Y(t)||X(t)||j(t)&&t.id!=="2"||tt(t)||et(t)||Z(t)||$(t)||y(t))return 1;if(J(t)){const a=Object.keys(t.attributes.searchAttributes.indexedFields);return(a==null?void 0:a.length)===1&&((T=(w=(k=t.attributes)==null?void 0:k.searchAttributes)==null?void 0:w.indexedFields)!=null&&T.TemporalChangeVersion)?0:1}if(F(t)){if(["core_patch","Version"].includes((v=t==null?void 0:t.attributes)==null?void 0:v.markerName))return 0;const l=(A=t.attributes)==null?void 0:A.workflowTaskCompletedEventId;if(l&&o)return o.has(String(l))?0:(o.add(String(l)),1);if(l)return 1}return g(t)||G(t)?1:P(t)?(((m=t.attributes)==null?void 0:m.attempt)||1)-1:M(t)?Math.min(((E=(d=t.attributes)==null?void 0:d.meteringMetadata)==null?void 0:E.nonfirstLocalActivityExecutionAttempts)||0,100):0}catch{return 0}},e={ACTIVITY:"activity",CHILD_WORKFLOW:"child-workflow",LOCAL_ACTIVITY:"local-activity",NEXUS:"nexus",SIGNAL:"signal",TIMER:"timer",UPDATE:"update",WORKFLOW:"workflow",OTHER:"other"},W={ActivityTaskCanceled:e.ACTIVITY,ActivityTaskCancelRequested:e.ACTIVITY,ActivityTaskCompleted:e.ACTIVITY,ActivityTaskFailed:e.ACTIVITY,ActivityTaskScheduled:e.ACTIVITY,ActivityTaskStarted:e.ACTIVITY,ActivityTaskTimedOut:e.ACTIVITY,ChildWorkflowExecutionCanceled:e.CHILD_WORKFLOW,ChildWorkflowExecutionCompleted:e.CHILD_WORKFLOW,ChildWorkflowExecutionFailed:e.CHILD_WORKFLOW,ChildWorkflowExecutionStarted:e.CHILD_WORKFLOW,ChildWorkflowExecutionTerminated:e.CHILD_WORKFLOW,ChildWorkflowExecutionTimedOut:e.CHILD_WORKFLOW,StartChildWorkflowExecutionFailed:e.CHILD_WORKFLOW,StartChildWorkflowExecutionInitiated:e.CHILD_WORKFLOW,SignalExternalWorkflowExecutionFailed:e.SIGNAL,SignalExternalWorkflowExecutionInitiated:e.SIGNAL,WorkflowExecutionSignaled:e.SIGNAL,ExternalWorkflowExecutionSignaled:e.SIGNAL,TimerCanceled:e.TIMER,TimerFired:e.TIMER,TimerStarted:e.TIMER,WorkflowExecutionCanceled:e.WORKFLOW,WorkflowExecutionCancelRequested:e.WORKFLOW,WorkflowExecutionCompleted:e.WORKFLOW,WorkflowExecutionContinuedAsNew:e.WORKFLOW,WorkflowExecutionFailed:e.WORKFLOW,WorkflowExecutionStarted:e.WORKFLOW,WorkflowExecutionTerminated:e.WORKFLOW,WorkflowExecutionTimedOut:e.WORKFLOW,WorkflowExecutionOptionsUpdated:e.WORKFLOW,WorkflowTaskCompleted:e.WORKFLOW,WorkflowTaskFailed:e.WORKFLOW,WorkflowTaskScheduled:e.WORKFLOW,WorkflowTaskStarted:e.WORKFLOW,WorkflowTaskTimedOut:e.WORKFLOW,ExternalWorkflowExecutionCancelRequested:e.WORKFLOW,RequestCancelExternalWorkflowExecutionFailed:e.WORKFLOW,RequestCancelExternalWorkflowExecutionInitiated:e.WORKFLOW,WorkflowExecutionUpdateAccepted:e.UPDATE,WorkflowExecutionUpdateCompleted:e.UPDATE,WorkflowExecutionUpdateRequested:e.UPDATE,WorkflowExecutionUpdateRejected:e.UPDATE,WorkflowExecutionUpdateAdmitted:e.UPDATE,NexusOperationScheduled:e.NEXUS,NexusOperationStarted:e.NEXUS,NexusOperationCompleted:e.NEXUS,NexusOperationFailed:e.NEXUS,NexusOperationCanceled:e.NEXUS,NexusOperationTimedOut:e.NEXUS,NexusOperationCancelRequested:e.NEXUS,NexusOperationCancelRequestCompleted:e.NEXUS,NexusOperationCancelRequestFailed:e.NEXUS,MarkerRecorded:e.OTHER,UpsertWorkflowSearchAttributes:e.OTHER,WorkflowPropertiesModified:e.OTHER},rt=[{label:"events.category.activity",value:e.ACTIVITY,description:"events.category.activity-tooltip"},{label:"events.category.child-workflow",value:e.CHILD_WORKFLOW,description:"events.category.child-workflow-tooltip"},{label:"events.category.local-activity",value:e.LOCAL_ACTIVITY,description:"events.category.local-activity-tooltip"},{label:"events.category.signal",value:e.SIGNAL,description:"events.category.signal-tooltip"},{label:"events.category.timer",value:e.TIMER,description:"events.category.timer-tooltip"},{label:"events.category.update",value:e.UPDATE,description:"events.category.update-tooltip"},{label:"events.category.nexus",value:e.NEXUS,description:"events.category.nexus-tooltip"},{label:"events.category.workflow",value:e.WORKFLOW,description:"events.category.workflow-tooltip"},{label:"events.category.other",value:e.OTHER,description:"events.category.other-tooltip"}],st=[e.ACTIVITY,e.LOCAL_ACTIVITY,e.CHILD_WORKFLOW,e.SIGNAL,e.TIMER,e.UPDATE,e.NEXUS,e.OTHER],ce=rt.filter(({value:t})=>st.includes(t)),at=t=>(W==null?void 0:W[t])||e.OTHER,de=t=>{for(const o in e)if(t===e[o])return!0;return!1},lt=["Unspecified","Scheduled","Open","New","Started","Initiated","Running","Completed","Fired","CancelRequested","TimedOut","Signaled","Canceled","Failed","Terminated"],ut=t=>{if(typeof t=="number")return"Unspecified";if(t.includes("RequestCancel"))return"CancelRequested";for(const o of lt)if(t.includes(o))return o;return"Unspecified"},ct=["closeTime","createTime","currentAttemptScheduledTime","earliestTime","eventTime","executionTime","expirationTime","expireTime","lastAccessTime","lastHeartbeatTime","lastStartedTime","lastUpdateTime","latestTime","releaseTime","scheduledTime","startedTime","startTime","workflowExecutionExpirationTime"],dt=["backoffStartInterval","defaultWorkflowTaskTimeout","firstWorkflowTaskBackoff","heartbeatTimeout","initialInterval","maximumInterval","scheduleToCloseTimeout","scheduleToStartTimeout","startToCloseTimeout","startToFireTimeout","workflowExecutionRetentionPeriod","workflowExecutionRetentionTtl","workflowExecutionTimeout","workflowRunTimeout","workflowTaskTimeout"],Et=t=>{for(const o of ct)if(o===t)return!0;return!1},ft=t=>{for(const o of dt)if(o===t)return!0;return!1},kt=t=>{if(t===null||t===void 0||typeof t!="object")return!1;const o=Object.keys(t),[n]=o;return!(o.length!==1||typeof t[n]!="string")},wt=t=>{for(const o of Object.values(t))return o};function Tt(t,o=!1){for(const[n,r]of Object.entries(t))kt(r)&&(t[n]=wt(r)),Et(n)&&!o&&(t[n]=C(r)),ft(n)&&(t[n]=q(r)),n==="versioningBehavior"&&(t[n]=N(r,"VersioningBehavior"));return b(t,"workerVersion")&&b(t,"deploymentVersion")&&delete t.workerVersion,t}const vt=(t,o=()=>!1,n)=>({...t,billableActions:o(t)?0:nt(t,n)}),At=(t,o={})=>{var d,E,a,l,p,x;const n=String(t.eventId),r=K(t.eventType),s=C(String(t.eventTime)),u=ut(r),c=at(r),{key:f,attributes:k}=B(t),w=R(t)&&((a=(E=(d=t.workflowExecutionStartedEventAttributes)==null?void 0:d.completionCallbacks)==null?void 0:E[0])==null?void 0:a.links),T=y(t)&&((x=(p=(l=t.workflowExecutionOptionsUpdatedEventAttributes)==null?void 0:l.attachedCompletionCallbacks)==null?void 0:p[0])==null?void 0:x.links),v=w||T,A=(t==null?void 0:t.links)||v||[],m={...t,name:r,id:n,eventType:r,timestamp:s,classification:u,category:c,links:A,billableActions:0,attributes:Tt({type:f,...k})};return vt(m,o.shouldNotAddBillableAction,o.processedWorkflowTaskIds)},Ee=t=>{const o=t.findLast(g),n=s=>o?Number(s.id)<Number(o.eventId):!1,r=new Set;return t.map(s=>At(s,{shouldNotAddBillableAction:n,processedWorkflowTaskIds:r}))},fe=t=>t===null||typeof t!="object"||Array.isArray(t)?!1:!!b(t,"eventType"),ke=t=>{const o={...t};return delete o.name,delete o.id,delete o.timestamp,delete o.classification,delete o.category,delete o.attributes,o};export{h as $,It as A,gt as B,Ut as C,Nt as D,zt as E,ie as F,se as G,le as H,Ht as I,Kt as J,Xt as K,Vt as L,z as M,te as N,Lt as O,M as P,S as Q,ne as R,re as S,X as T,$t as U,j as V,F as W,G as X,ht as Y,Tt as Z,ce as _,y as a,I as a0,ot as a1,Pt as a2,yt as a3,jt as b,Gt as c,Jt as d,Qt as e,Zt as f,fe as g,oe as h,R as i,Z as j,tt as k,rt as l,ee as m,de as n,ue as o,P as p,ke as q,Y as r,Mt as s,Ee as t,_t as u,Bt as v,Yt as w,ae as x,Dt as y,qt as z};
