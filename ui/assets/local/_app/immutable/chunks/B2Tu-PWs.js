import"./CWj6FrbW.js";import{p as _e,i as ee,c as L,e as C,b as be,M as Fe,I as x,f as ye,d as Ve,t as H,j as g,h as m,k as ce,g as l,v as i,u as Ue,r as f,n as me}from"./UnFCzZBm.js";import{s as h}from"./CX2avYX0.js";import{i as Ne}from"./pI5hk1MB.js";import{a as Ge}from"./B2F5qMuF.js";import{p as O,s as he,a as k,c as pe,e as T}from"./GmGfGY7t.js";import"./69_IOA4Y.js";import"./BU7d8K5s.js";import"./C9dKMfSl.js";import"./BUApaBEI.js";import{s as We,z as Xe}from"./ChZl2d3c.js";import{M as Ye}from"./B763ffML.js";import{s as ve}from"./D_idi4aj.js";import{i as Ze}from"./BBLBidKq.js";import{p as De}from"./Dwxo_w7E.js";import{B as ge}from"./iyExifMn.js";import{C as fe}from"./CeyrvK5h.js";import{I as xe}from"./D2wqjjbn.js";import{M as et}from"./C6Ru7ayV.js";import{t as r}from"./DEjs8ZrU.js";import{o as tt,b as at,s as q}from"./Cm-t6BD2.js";import{e as rt}from"./B1xCkJjR.js";function st(v,s){_e(s,!1);const o=()=>k(De,"$page",c),[c,Q]=he();let w=O(s,"isCloud",8,!1);Ze();var j=ee(),z=L(j);{var y=_=>{var p=ee(),b=L(p);ve(b,s,"default",{},null),C(_,p)},B=_=>{var p=ee(),b=L(p);ve(b,s,"fallback",{},null),C(_,p)};Ne(z,_=>{Fe(w()),o(),x(()=>{var p,b,$;return w()||(($=(b=(p=o().data)==null?void 0:p.settings)==null?void 0:b.runtimeEnvironment)==null?void 0:$.isCloud)})?_(y):_(B,!1)})}C(v,j),be(),Q()}var nt=ye('<div class="flex flex-col gap-0"><p class="text-base text-primary"> </p> <p class="text-xs text-secondary"> </p></div> <!>',1),ot=ye('<form class="flex w-full flex-col gap-4 xl:w-1/2" novalidate=""><!> <div class="flex flex-col gap-0"><p class="text-base text-primary"> </p> <p class="text-xs text-secondary"> </p></div> <!> <!> <!> <div class="flex flex-col gap-2"><p class="text-sm font-medium"> </p> <!> <p class="text-xs text-secondary"> </p></div> <div class="flex w-full flex-col items-center gap-4 sm:flex-row"><!> <!> <!></div> <!></form>');function qt(v,s){_e(s,!0);const o=()=>k(S,"$form",y),c=()=>k(Te,"$errors",y),Q=()=>k(qe,"$constraints",y),w=()=>k(Qe,"$submitting",y),j=()=>k(je,"$tainted",y),z=()=>k(te,"$message",y),[y,B]=he();var _,p,b,$,J,K,R,A,F;let we=O(s,"nameHintText",19,()=>r("nexus.endpoint-name-hint")),d=O(s,"endpoint",3,void 0),ke=O(s,"nameDisabled",3,!1);const Ce=e=>tt({name:q().min(3,r("nexus.endpoint-name-hint")).max(200,r("nexus.endpoint-name-hint")).refine(n=>e.test(n),{message:r("nexus.endpoint-name-hint")}),descriptionString:q().optional().default(""),targetNamespace:q().min(1,r("nexus.target-namespace-required")),taskQueue:q().min(1,r("nexus.task-queue-required")),allowedCallerNamespaces:at(q()).default([])}),$e={name:((_=d()===null||d()===void 0?void 0:d().spec)===null||_===void 0?void 0:_.name)||"",descriptionString:((p=d()===null||d()===void 0?void 0:d().spec)===null||p===void 0?void 0:p.descriptionString)||"",targetNamespace:((J=($=(b=d()===null||d()===void 0?void 0:d().spec)===null||b===void 0?void 0:b.target)===null||$===void 0?void 0:$.worker)===null||J===void 0?void 0:J.namespace)||"",taskQueue:((A=(R=(K=d()===null||d()===void 0?void 0:d().spec)===null||K===void 0?void 0:K.target)===null||R===void 0?void 0:R.worker)===null||A===void 0?void 0:A.taskQueue)||"",allowedCallerNamespaces:((F=d()===null||d()===void 0?void 0:d().spec)===null||F===void 0?void 0:F.allowedCallerNamespaces)||[]},Se=We($e,{SPA:!0,validators:Xe(Ce(s.nameRegexPattern)),resetForm:!1,dataType:"json",onUpdate:async({form:e})=>{e.valid&&await(s.onSubmit===null||s.onSubmit===void 0?void 0:s.onSubmit(e.data))},onError:({result:e})=>{const n=e.error;let u="An error occurred";if(n instanceof Error)u=n.message;else if(typeof n=="string")u=n;else if(n&&typeof n=="object"){const t=n,a=typeof t.message=="string"?t.message:void 0,N=typeof t.error=="string"?t.error:void 0,I=typeof t.statusText=="string"?t.statusText:void 0,M=t.body;u=a||N||I||M&&JSON.stringify(M)||JSON.stringify(n)}te.set({type:"error",text:u})}}),{form:S,errors:Te,constraints:qe,enhance:V,submitting:Qe,tainted:je,isTainted:Pe,message:te}=Se,Ie=i(()=>s.callerNamespaceList.map(e=>({value:e.namespace,label:e.namespace})));var P=ot(),ae=g(P);{let e=i(()=>{var a;return!!((a=c().name)!=null&&a[0])}),n=i(()=>{var a;return((a=c().name)==null?void 0:a[0])||we()}),u=i(()=>r("nexus.endpoint-name")),t=i(()=>r("nexus.endpoint-name-placeholder"));xe(ae,pe({required:!0,get disabled(){return ke()},get error(){return l(e)},get hintText(){return l(n)},get label(){return l(u)},id:"name",name:"name",maxLength:200,get placeholder(){return l(t)}},()=>Q().name,{get value(){return o().name},set value(a){T(S,x(o).name=a,x(o))}}))}var U=m(ae,2),G=g(U),Me=g(G,!0);f(G);var re=m(G,2),Ee=g(re,!0);f(re),f(U);var se=m(U,2);{let e=i(()=>r("nexus.target-namespace")),n=i(()=>r("common.no-results")),u=i(()=>!c().targetNamespace),t=i(()=>{var N;return((N=c().targetNamespace)==null?void 0:N[0])||r("nexus.target-namespace-required")}),a=i(()=>r("nexus.select-namespace"));fe(se,{get label(){return l(e)},get noResultsText(){return l(n)},get valid(){return l(u)},get error(){return l(t)},required:!0,id:"target-namespace",name:"targetNamespace",get placeholder(){return l(a)},leadingIcon:"namespace-switcher",get options(){return s.targetNamespaceList},optionValueKey:"namespace",minSize:32,get value(){return o().targetNamespace},set value(N){T(S,x(o).targetNamespace=N,x(o))}})}var ne=m(se,2);{let e=i(()=>{var a;return!!((a=c().taskQueue)!=null&&a[0])}),n=i(()=>{var a;return(a=c().taskQueue)==null?void 0:a[0]}),u=i(()=>r("common.task-queue")),t=i(()=>r("nexus.task-queue-placeholder"));xe(ne,pe({required:!0,get error(){return l(e)},get hintText(){return l(n)},get label(){return l(u)},id:"task-queue",name:"taskQueue",get placeholder(){return l(t)}},()=>Q().taskQueue,{get value(){return o().taskQueue},set value(a){T(S,x(o).taskQueue=a,x(o))}}))}var oe=m(ne,2);st(oe,{get isCloud(){return s.isCloud},children:(e,n)=>{var u=nt(),t=L(u),a=g(t),N=g(a,!0);f(a);var I=m(a,2),M=g(I,!0);f(I),f(t);var Je=m(t,2);{let Z=i(()=>r("nexus.allowed-caller-namespaces")),D=i(()=>r("common.no-results")),Ke=i(()=>!c().allowedCallerNamespaces),Re=i(()=>{var E;return typeof((E=c().allowedCallerNamespaces)==null?void 0:E[0])=="string"?c().allowedCallerNamespaces[0]:r("nexus.caller-namespace-required")}),Ae=i(()=>r("nexus.select-namespaces"));fe(Je,{id:"caller-namespace-filter-menu",name:"allowedCallerNamespaces",multiselect:!0,displayChips:!1,get options(){return l(Ie)},get label(){return l(Z)},leadingIcon:"search",get noResultsText(){return l(D)},get valid(){return l(Ke)},get error(){return l(Re)},get placeholder(){return l(Ae)},optionValueKey:"value",optionLabelKey:"label",get value(){return o().allowedCallerNamespaces},set value(E){T(S,x(o).allowedCallerNamespaces=E,x(o))}})}H((Z,D)=>{h(N,Z),h(M,D)},[()=>r("nexus.access-policy"),()=>r("nexus.allowed-caller-namespaces-description")]),C(e,u)},$$slots:{default:!0}});var W=m(oe,2),X=g(W),He=g(X,!0);f(X);var le=m(X,2);et(le,{get content(){return o().descriptionString},set content(e){T(S,x(o).descriptionString=e,x(o))}});var ie=m(le,2),Le=g(ie,!0);f(ie),f(W);var Y=m(W,2),ue=g(Y);{let e=i(()=>w()||d()&&!Pe(j()));ge(ue,{type:"submit",get disabled(){return l(e)},get loading(){return w()},class:"max-sm:w-full","data-testid":"nexus-form-submit-button",children:(n,u)=>{me();var t=ce();H(()=>h(t,s.submitButtonText)),C(n,t)},$$slots:{default:!0}})}var de=m(ue,2);{var Oe=e=>{ge(e,{variant:"ghost",get disabled(){return w()},get href(){return s.cancelHref},class:"max-sm:w-full","data-testid":"nexus-form-cancel-button",children:(n,u)=>{me();var t=ce();H(a=>h(t,a),[()=>r("common.cancel")]),C(n,t)},$$slots:{default:!0}})};Ne(de,e=>{s.cancelHref&&e(Oe)})}var ze=m(de,2);Ve(ze,()=>s.footer??Ue,()=>({submitting:w()})),f(Y);var Be=m(Y,2);Ye(Be,{get value(){return z()}}),f(P),Ge(P,e=>V==null?void 0:V(e)),H((e,n,u,t)=>{h(Me,e),h(Ee,n),h(He,u),h(Le,t)},[()=>r("nexus.target"),()=>r("nexus.target-description"),()=>r("nexus.description-label"),()=>r("nexus.description-hint")]),C(v,P),be(),B()}async function Qt(v){var o;const s={spec:{name:v.name,target:{worker:{namespace:v.targetNamespace,taskQueue:v.taskQueue}},allowedCallerNamespaces:((o=v.allowedCallerNamespaces)==null?void 0:o.length)>0?v.allowedCallerNamespaces:void 0}};if(v.descriptionString){const c=await rt({input:JSON.stringify(v.descriptionString),encoding:"json/plain"});s.spec.description=c==null?void 0:c[0]}return s}export{qt as N,Qt as g};
