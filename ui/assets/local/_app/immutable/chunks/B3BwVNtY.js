import"./CWj6FrbW.js";import"./69_IOA4Y.js";import{d as ie,g as Ie,w as ye,o as De}from"./D7JzDj9r.js";import{p as we,s as C,m as ae,g as u,l as ne,O as re,a as ze,aR as Ne,f as me,j as J,K as l,h as G,o as Q,r as V,t as oe,e as P,i as w,c as z,b as Le}from"./DZ1-1a5q.js";import{e as ke,s as le}from"./DxwvfIkW.js";import{i as de}from"./DnKg3jxh.js";import{s as N}from"./DMJjfc0_.js";import{s as Ae}from"./D3L9VHHD.js";import{i as Ee}from"./Bby3K3wO.js";import{l as ce,p as o,a as Ke,s as Te}from"./TaaIktnz.js";import{d as Be}from"./CvkHpCCQ.js";import{A as Fe}from"./BxPfauF3.js";import{E as ge}from"./DEyS7vMf.js";import{I as ue}from"./D5aSE9Ui.js";import{L as Re}from"./DW6uis09.js";import{F as Me}from"./BBoZRFFq.js";import{p as Oe}from"./P-60DauF.js";import{o as pe,p as ve,b as Ue,d as X}from"./D4oZ1vFI.js";import{d as He}from"./BJzbPR4R.js";import{P as We}from"./CnSkB0OL.js";const fe={key:ve,loading:!0,updating:!1,hasNext:!1,hasPrevious:!1,index:0,previousPageSize:X,pageSize:X,indexData:{},visibleItems:[],hasNextIndexData:!1,indexStart:0,indexEnd:0,activeIndex:0},xe=b=>{const n=b[0];if(!n)return X;const v=parseInt(n.toString());return isNaN(v)?X:v},je=(b,n=void 0)=>{if(n){const v=parseInt(n.toString());return isNaN(v)?xe(b):v}else return xe(b)};function qe(b=pe,n=void 0){const v=ie([Oe],([t])=>{const a=t.url.searchParams.get(ve);return a?Ue(a):void 0}),E=je(b,Ie(v)||n),e=ye({...fe,previousPageSize:E,pageSize:E}),{set:Y,update:h}=e,{subscribe:K}=ie([e,v],([t,a])=>{var T,B,H;const d=((T=t.indexData[t.index])==null?void 0:T.items)??[],f=((B=t.indexData[t.index])==null?void 0:B.start)??0,i=((H=t.indexData[t.index])==null?void 0:H.end)??0,ee=!!t.indexData[t.index+1];return{...t,visibleItems:d,indexStart:f,indexEnd:i,hasNextIndexData:ee,pageSize:a??t.pageSize}}),L=(t,a,d)=>{const f=d.index,i={...d,indexData:{...d.indexData},hasNext:!!t,updating:!1,loading:!1};return a.length?(i.indexData[f]?(i.index=f+1,i.indexData[i.index]={nextToken:t,start:i.indexData[f].end+1,end:i.indexData[f].end+a.length,items:a},i.hasPrevious=!0):(i.indexData[f]={nextToken:t,start:1,end:a.length,items:a},i.hasPrevious=!1),i):{...i,hasNext:!1}},Z=t=>{var d;const a={...t,index:t.index+1,hasPrevious:!0,loading:!1,updating:!1};return(d=a.indexData[a.index])!=null&&d.nextToken||(a.hasNext=!1),a},$=t=>{const a={...t,hasNext:!0,updating:!1,loading:!1,index:t.index>0?t.index-1:0};return a.index===0&&(a.hasPrevious=!1),a},k=t=>{var f,i;const a={...t},d=((i=(f=a.indexData[a.index])==null?void 0:f.items)==null?void 0:i.length)??0;return a.activeIndex<d-1&&(a.activeIndex=a.activeIndex+1),a},M=t=>{const a={...t},d=a.activeIndex>=1?a.activeIndex-1:0;return a.activeIndex=d,a},O=(t,a)=>({...t,activeIndex:a}),U=(t,a)=>({...t,pageSize:a,previousPageSize:a,index:0,indexData:{},loading:!0,updating:!1});return{subscribe:K,nextPageWithItems:(t,a)=>h(d=>L(t,a,d)),nextPage:()=>h(t=>Z(t)),previousPage:()=>h(t=>$(t)),setUpdating:()=>h(t=>({...t,updating:!0})),reset:()=>Y(fe),resetPageSize:t=>h(a=>U(a,t)),nextRow:()=>h(t=>k(t)),previousRow:()=>h(t=>M(t)),setActiveIndex:t=>h(a=>O(a,t))}}var Ce=me("<p> </p>"),Je=me('<nav class="flex shrink-0 items-center gap-2" slot="actions-end"><!> <!> <div class="flex gap-1"><p> </p> <!></div> <!></nav>');function ft(b,n){const v=ce(n,["children","$$slots","$$events","$$legacy"]),E=ce(v,["id","maxHeight","onError","onFetch","onShiftUp","onShiftDown","onSpace","total","pageSizeSelectLabel","emptyStateTitle","emptyStateMessage","errorTitle","errorMessage","itemsKeyname","previousButtonLabel","nextButtonLabel","pageSizeOptions","debounceDelay"]);we(n,!1);const e=()=>Ke(x,"$store",Y),[Y,h]=Te(),K=ae(),L=ae();let Z=o(n,"id",8,null),$=o(n,"maxHeight",8,""),k=o(n,"onError",8,void 0),M=o(n,"onFetch",8),O=o(n,"onShiftUp",8,void 0),U=o(n,"onShiftDown",8,void 0),t=o(n,"onSpace",8,void 0),a=o(n,"total",8,""),d=o(n,"pageSizeSelectLabel",8),f=o(n,"emptyStateTitle",8,""),i=o(n,"emptyStateMessage",8,""),ee=o(n,"errorTitle",8,""),T=o(n,"errorMessage",8,""),B=o(n,"itemsKeyname",8,"items"),H=o(n,"previousButtonLabel",8),he=o(n,"nextButtonLabel",8),te=o(n,"pageSizeOptions",8,pe),Se=o(n,"debounceDelay",8,250),x=qe(te(),te()[0]),I=ae();function Pe(){u(I)&&C(I,void 0)}De(()=>{W()});async function W(){const r=await M()();try{const c=await r(e().pageSize,""),{nextPageToken:s}=c,g=c[B()]||[];x.nextPageWithItems(s,g)}catch(c){C(I,c),k()&&k()(u(I))}}const be=async()=>{try{const c=await(await M()())(e().pageSize,e().indexData[e().index].nextToken),{nextPageToken:s}=c,g=c[B()]||[];x.nextPageWithItems(s,g)}catch(r){He(r)&&k()&&k()(r)}};async function se(){Pe(),x.setUpdating(),e().hasNextIndexData?x.nextPage():Be(await be,Se())()}async function _e(r){if(r.repeat)return;const c=r.shiftKey;switch(r.code){case"ArrowRight":case"KeyL":e().hasNext&&!e().updating&&se();break;case"ArrowLeft":case"KeyH":e().hasPrevious&&!e().updating&&x.previousPage();break;case"ArrowUp":case"KeyK":c&&O()?(O()(r),x.reset(),W()):x.previousRow();break;case"ArrowDown":case"KeyJ":c&&U()?(U()(r),x.reset(),W()):x.nextRow();break;case"Space":t()&&t()(r);break}}ne(()=>e(),()=>{C(K,!e().loading&&e().pageSize!==e().previousPageSize)}),ne(()=>(u(K),e()),()=>{u(K)&&(x.resetPageSize(e().pageSize),W())}),ne(()=>(e(),re(a())),()=>{C(L,!e().hasNext&&e().indexEnd!==a()?e().indexEnd:a())}),ze(),Ee(),ke("keydown",Ne,_e),We(b,{get loading(){return e(),l(()=>e().loading)},get updating(){return e(),l(()=>e().updating)},get visibleItems(){return e(),l(()=>e().visibleItems)},get maxHeight(){return $()},get id(){return Z()},children:(r,c)=>{var s=w(),g=z(s);N(g,n,"default",{get visibleItems(){return e(),l(()=>e().visibleItems)}},null),P(r,s)},$$slots:{default:!0,caption:(r,c)=>{var s=w(),g=z(s);N(g,n,"caption",{},null),P(r,s)},headers:(r,c)=>{var s=w(),g=z(s);N(g,n,"headers",{get visibleItems(){return e(),l(()=>e().visibleItems)}},null),P(r,s)},empty:(r,c)=>{var s=w(),g=z(s);{var j=m=>{var S=w(),y=z(S);N(y,n,"loading",{},D=>{Re(D,{})}),P(m,S)},F=m=>{var S=w(),y=z(S);N(y,n,"error",{},D=>{ge(D,{get title(){return ee()},children:(p,_)=>{{let A=Q(()=>(u(I),re(T()),l(()=>{var q;return((q=u(I))==null?void 0:q.message)??T()})));Fe(p,{intent:"error",get title(){return u(A)}})}},$$slots:{default:!0}})}),P(m,S)},R=m=>{var S=w(),y=z(S);N(y,n,"empty",{},D=>{ge(D,{get title(){return f()},get content(){return i()}})}),P(m,S)};de(g,m=>{e(),l(()=>e().loading)?m(j):u(I)?m(F,1):m(R,!1)})}P(r,s)},"actions-start":(r,c)=>{{let s=Q(()=>(e(),l(()=>String(e().pageSize))));Me(r,{get label(){return d()},get parameter(){return e(),l(()=>e().key)},get value(){return u(s)},get options(){return te()}})}},"actions-end":(r,c)=>{var s=Je(),g=J(s);N(g,n,"actions-end-additional",{get visibleItems(){return e(),l(()=>e().visibleItems)},get page(){return e(),l(()=>e().index+1)}},null);var j=G(g,2);{let p=Q(()=>(e(),l(()=>!e().hasPrevious)));ue(j,{get label(){return H()},get disabled(){return u(p)},icon:"arrow-left",$$events:{click(..._){var A;(A=x.previousPage)==null||A.apply(this,_)}}})}var F=G(j,2),R=J(F),m=J(R);V(R);var S=G(R,2);{var y=p=>{var _=Ce(),A=J(_);V(_),oe(q=>le(A,`of ${q??""}`),[()=>(u(L),l(()=>u(L).toLocaleString()))]),P(p,_)};de(S,p=>{u(L)&&p(y)})}V(F);var D=G(F,2);{let p=Q(()=>(e(),l(()=>!e().hasNext||e().updating)));ue(D,{get label(){return he()},get disabled(){return u(p)},icon:"arrow-right",$$events:{click:se}})}V(s),oe((p,_)=>{Ae(s,"aria-label",(re(E),l(()=>E["aria-label"]))),le(m,`${p??""}â€“${_??""}`)},[()=>(e(),l(()=>e().indexStart.toLocaleString())),()=>(e(),l(()=>e().indexEnd.toLocaleString()))]),P(r,s)}}}),Le(),h()}export{ft as A};
