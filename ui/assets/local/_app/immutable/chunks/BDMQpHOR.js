import"./CWj6FrbW.js";import"./69_IOA4Y.js";import{d as ge,g as Le,w as ke,o as Ae}from"./D12POdU-.js";import{p as Ee,s as C,m as ae,g as f,l as ne,L as re,a as Ke,f as ie,aM as Te,c as b,G as o,h as R,j as G,o as J,r as Q,t as ue,e as p,i as y,b as Be}from"./yn9lut7I.js";import{e as Fe,s as fe}from"./B95CcGmx.js";import{i as se}from"./Bw1cG9kR.js";import{i as Me,s as D}from"./Bk16Yghv.js";import{s as Re}from"./BLNXIcBS.js";import{l as xe,p as l,a as Ue,s as He}from"./C6jR5PNA.js";import{d as Oe}from"./BDANSl4B.js";import{A as We}from"./CEIbjQ5i.js";import{E as me}from"./BJtmZDlL.js";import{I as ve}from"./BwZMvxzh.js";import{L as je}from"./nhWcYVoD.js";import{F as qe}from"./Npi4KvdU.js";import{p as Ce}from"./BrtlPyR9.js";import{o as Se,p as Pe,b as Ge,d as V}from"./DVFsQK-H.js";import{c as Je}from"./rlUF3pky.js";import{P as Qe}from"./kgkb0208.js";const pe={key:Pe,loading:!0,updating:!1,hasNext:!1,hasPrevious:!1,index:0,previousPageSize:V,pageSize:V,indexData:{},visibleItems:[],hasNextIndexData:!1,indexStart:0,indexEnd:0,activeIndex:0},he=_=>{const n=_[0];if(!n)return V;const h=parseInt(n.toString());return isNaN(h)?V:h},Ve=(_,n=void 0)=>{if(n){const h=parseInt(n.toString());return isNaN(h)?he(_):h}else return he(_)};function Xe(_=Se,n=void 0){const h=ge([Ce],([t])=>{const a=t.url.searchParams.get(Pe);return a?Ge(a):void 0}),k=Ve(_,Le(h)||n),e=ke({...pe,previousPageSize:k,pageSize:k}),{set:X,update:S}=e,{subscribe:A}=ge([e,h],([t,a])=>{var E,K,W;const d=((E=t.indexData[t.index])==null?void 0:E.items)??[],m=((K=t.indexData[t.index])==null?void 0:K.start)??0,i=((W=t.indexData[t.index])==null?void 0:W.end)??0,$=!!t.indexData[t.index+1];return{...t,visibleItems:d,indexStart:m,indexEnd:i,hasNextIndexData:$,pageSize:a??t.pageSize}}),N=(t,a,d)=>{const m=d.index,i={...d,indexData:{...d.indexData},hasNext:!!t,updating:!1,loading:!1};return a.length?(i.indexData[m]?(i.index=m+1,i.indexData[i.index]={nextToken:t,start:i.indexData[m].end+1,end:i.indexData[m].end+a.length,items:a},i.hasPrevious=!0):(i.indexData[m]={nextToken:t,start:1,end:a.length,items:a},i.hasPrevious=!1),i):{...i,hasNext:!1}},Y=t=>{var d;const a={...t,index:t.index+1,hasPrevious:!0,loading:!1,updating:!1};return(d=a.indexData[a.index])!=null&&d.nextToken||(a.hasNext=!1),a},Z=t=>{const a={...t,hasNext:!0,updating:!1,loading:!1,index:t.index>0?t.index-1:0};return a.index===0&&(a.hasPrevious=!1),a},L=t=>{var m,i;const a={...t},d=((i=(m=a.indexData[a.index])==null?void 0:m.items)==null?void 0:i.length)??0;return a.activeIndex<d-1&&(a.activeIndex=a.activeIndex+1),a},U=t=>{const a={...t},d=a.activeIndex>=1?a.activeIndex-1:0;return a.activeIndex=d,a},H=(t,a)=>({...t,activeIndex:a}),O=(t,a)=>({...t,pageSize:a,previousPageSize:a,index:0,indexData:{},loading:!0,updating:!1});return{subscribe:A,nextPageWithItems:(t,a)=>S(d=>N(t,a,d)),nextPage:()=>S(t=>Y(t)),previousPage:()=>S(t=>Z(t)),setUpdating:()=>S(t=>({...t,updating:!0})),reset:()=>X(pe),resetPageSize:t=>S(a=>O(a,t)),nextRow:()=>S(t=>L(t)),previousRow:()=>S(t=>U(t)),setActiveIndex:t=>S(a=>H(a,t))}}var Ye=ie("<p> </p>"),Ze=ie('<nav class="flex shrink-0 items-center gap-2" slot="actions-end"><!> <!> <div class="flex gap-1"><p> </p> <!></div> <!></nav>'),$e=ie("<!> <!>",1);function Pt(_,n){const h=xe(n,["children","$$slots","$$events","$$legacy"]),k=xe(h,["id","maxHeight","onError","onFetch","onShiftUp","onShiftDown","onSpace","total","pageSizeSelectLabel","emptyStateTitle","emptyStateMessage","errorTitle","errorMessage","itemsKeyname","previousButtonLabel","nextButtonLabel","pageSizeOptions","debounceDelay"]);Ee(n,!1);const e=()=>Ue(v,"$store",X),[X,S]=He(),A=ae(),N=ae();let Y=l(n,"id",8,null),Z=l(n,"maxHeight",8,""),L=l(n,"onError",8,void 0),U=l(n,"onFetch",8),H=l(n,"onShiftUp",8,void 0),O=l(n,"onShiftDown",8,void 0),t=l(n,"onSpace",8,void 0),a=l(n,"total",8,""),d=l(n,"pageSizeSelectLabel",8),m=l(n,"emptyStateTitle",8,""),i=l(n,"emptyStateMessage",8,""),$=l(n,"errorTitle",8,""),E=l(n,"errorMessage",8,""),K=l(n,"itemsKeyname",8,"items"),W=l(n,"previousButtonLabel",8),be=l(n,"nextButtonLabel",8),ee=l(n,"pageSizeOptions",8,Se),_e=l(n,"debounceDelay",8,250),v=Xe(ee(),ee()[0]),w=ae();function Ie(){f(w)&&C(w,void 0)}Ae(()=>{j()});async function j(){const r=await U()();try{const c=await r(e().pageSize,""),{nextPageToken:s}=c,u=c[K()]||[];v.nextPageWithItems(s,u)}catch(c){C(w,c),L()&&L()(f(w))}}const ye=async()=>{try{const c=await(await U()())(e().pageSize,e().indexData[e().index].nextToken),{nextPageToken:s}=c,u=c[K()]||[];v.nextPageWithItems(s,u)}catch(r){Je(r)&&L()&&L()(r)}};async function oe(){Ie(),v.setUpdating(),e().hasNextIndexData?v.nextPage():Oe(await ye,_e())()}async function De(r){if(r.repeat)return;const c=r.shiftKey;switch(r.code){case"ArrowRight":case"KeyL":e().hasNext&&!e().updating&&oe();break;case"ArrowLeft":case"KeyH":e().hasPrevious&&!e().updating&&v.previousPage();break;case"ArrowUp":case"KeyK":c&&H()?(H()(r),v.reset(),j()):v.previousRow();break;case"ArrowDown":case"KeyJ":c&&O()?(O()(r),v.reset(),j()):v.nextRow();break;case"Space":t()&&t()(r);break}}ne(()=>e(),()=>{C(A,!e().loading&&e().pageSize!==e().previousPageSize)}),ne(()=>(f(A),e()),()=>{f(A)&&(v.resetPageSize(e().pageSize),j())}),ne(()=>(e(),re(a())),()=>{C(N,!e().hasNext&&e().indexEnd!==a()?e().indexEnd:a())}),Ke(),Me();var le=$e();Fe("keydown",Te,De);var de=b(le);D(de,n,"header",{get visibleItems(){return e(),o(()=>e().visibleItems)}},null);var we=R(de,2);Qe(we,{get loading(){return e(),o(()=>e().loading)},get updating(){return e(),o(()=>e().updating)},get visibleItems(){return e(),o(()=>e().visibleItems)},get maxHeight(){return Z()},get id(){return Y()},children:(r,c)=>{var s=y(),u=b(s);D(u,n,"default",{get visibleItems(){return e(),o(()=>e().visibleItems)}},null),p(r,s)},$$slots:{default:!0,caption:(r,c)=>{var s=y(),u=b(s);D(u,n,"caption",{},null),p(r,s)},headers:(r,c)=>{var s=y(),u=b(s);D(u,n,"headers",{get visibleItems(){return e(),o(()=>e().visibleItems)}},null),p(r,s)},empty:(r,c)=>{var s=y(),u=b(s);{var q=P=>{var z=y(),B=b(z);D(B,n,"loading",{},F=>{je(F,{})}),p(P,z)},T=P=>{var z=y(),B=b(z);{var F=g=>{var x=y(),I=b(x);D(I,n,"error",{},M=>{me(M,{get title(){return $()},children:(ze,et)=>{{let Ne=J(()=>(f(w),re(E()),o(()=>{var ce;return((ce=f(w))==null?void 0:ce.message)??E()})));We(ze,{intent:"error",get title(){return f(Ne)}})}},$$slots:{default:!0}})}),p(g,x)},te=g=>{var x=y(),I=b(x);D(I,n,"empty",{},M=>{me(M,{get title(){return m()},get content(){return i()}})}),p(g,x)};se(B,g=>{f(w)?g(F):g(te,!1)},!0)}p(P,z)};se(u,P=>{e(),o(()=>e().loading)?P(q):P(T,!1)})}p(r,s)},"actions-start":(r,c)=>{{let s=J(()=>(e(),o(()=>String(e().pageSize))));qe(r,{get label(){return d()},get parameter(){return e(),o(()=>e().key)},get value(){return f(s)},get options(){return ee()}})}},"actions-end":(r,c)=>{var s=Ze(),u=G(s);D(u,n,"actions-end-additional",{get visibleItems(){return e(),o(()=>e().visibleItems)},get page(){return e(),o(()=>e().index+1)}},null);var q=R(u,2);{let g=J(()=>(e(),o(()=>!e().hasPrevious)));ve(q,{get label(){return W()},get disabled(){return f(g)},icon:"arrow-left",$$events:{click(...x){var I;(I=v.previousPage)==null||I.apply(this,x)}}})}var T=R(q,2),P=G(T),z=G(P);Q(P);var B=R(P,2);{var F=g=>{var x=Ye(),I=G(x);Q(x),ue(M=>fe(I,`of ${M??""}`),[()=>(f(N),o(()=>f(N).toLocaleString()))]),p(g,x)};se(B,g=>{f(N)&&g(F)})}Q(T);var te=R(T,2);{let g=J(()=>(e(),o(()=>!e().hasNext||e().updating)));ve(te,{get label(){return be()},get disabled(){return f(g)},icon:"arrow-right",$$events:{click:oe}})}Q(s),ue((g,x)=>{Re(s,"aria-label",(re(k),o(()=>k["aria-label"]))),fe(z,`${g??""}â€“${x??""}`)},[()=>(e(),o(()=>e().indexStart.toLocaleString())),()=>(e(),o(()=>e().indexEnd.toLocaleString()))]),p(r,s)}}}),p(_,le),Be(),S()}export{Pt as A};
