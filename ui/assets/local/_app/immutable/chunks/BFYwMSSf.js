import{t as h}from"./DEjs8ZrU.js";import{w as d}from"./CfXw_P7u.js";import{e as p}from"./B8ioVi-I.js";import{s as l}from"./ikbOq2O5.js";import{r as a,a as u}from"./C011TGqO.js";import{s as T}from"./CRZn06HR.js";const E=d(0),S=d({count:0,newCount:0}),y=d(""),C=d(""),k=d(""),O=async(e,n="",o=fetch)=>(s=100,i="")=>{y.set("");const t=r=>{var m;y.set(((m=r==null?void 0:r.body)==null?void 0:m.message)||h("standalone-activities.activities-error-querying"))},c=a("standalone-activities",{namespace:e});return u(c,{params:{pageSize:String(s),nextPageToken:i,...n?{query:n}:{}},request:o,onError:t,handleError:t}).then(r=>{const{executions:m=[],nextPageToken:f=""}=r||{};return{items:m,nextPageToken:f?String(f):""}})},g=async e=>{let n=null,o=null,s=null,i=null;if(e.input){const{input:t,encoding:c,messageType:r}=e;try{n=await p({input:t,encoding:c,messageType:r})}catch{throw new Error("Could not encode input for starting activity execution")}}if(e.summary)try{const t=await p({input:l(e.summary),encoding:"json/plain"});t&&t[0]&&(o=t[0])}catch{throw new Error("Could not encode summary for starting activity execution")}if(e.details)try{const t=await p({input:l(e.details),encoding:"json/plain"});t&&t[0]&&(s=t[0])}catch{throw new Error("Could not encode details for starting activity execution")}return e.searchAttributes&&(i={indexedFields:{...T(e.searchAttributes)}}),{identity:e.identity,namespace:e.namespace,activityId:e.activityId,requestId:crypto.randomUUID(),activityType:{name:e.activityType},taskQueue:{name:e.taskQueue},input:{payloads:n},searchAttributes:i,userMetadata:{summary:o,details:s},...e.startToCloseTimeout&&{startToCloseTimeout:e.startToCloseTimeout},...e.scheduleToCloseTimeout&&{scheduleToCloseTimeout:e.scheduleToCloseTimeout},...e.scheduleToStartTimeout&&{scheduleToStartTimeout:e.scheduleToStartTimeout},retryPolicy:{...e.initialInterval&&{initialInterval:e.initialInterval},...e.maximumInterval&&{maximumInterval:e.maximumInterval},...e.maximumAttempts&&{maximumAttempts:Number(e.maximumAttempts)},...e.backoffCoefficient&&{backoffCoefficient:Number(e.backoffCoefficient)}}}},v=async e=>{const{activityId:n,namespace:o}=e,s=a("standalone-activity",{namespace:o,activityId:n}),i=await g(e);return u(s,{options:{method:"POST",body:l(i)}})},U=(e,n)=>{const o=a("standalone-activity",{namespace:e,activityId:n}),s=new URLSearchParams({includeInput:"true",includeOutcome:"true"});return u(o,{params:s})},q=(e,n,o,s,i)=>{const t=a("standalone-activity",{namespace:e,activityId:n}),c=new URLSearchParams({includeInput:"false",includeOutcome:"true",runId:o,longPollToken:s});return u(t,{params:c,notifyOnError:!1,options:{signal:i}})},R=async(e,n,o,s)=>{const i=a("standalone-activity.cancel",{namespace:e,activityId:n}),t={namespace:e,activityId:n,runId:o,requestId:crypto.randomUUID(),...s&&{identity:s}};return u(i,{notifyOnError:!1,options:{method:"POST",body:l(t)}})},Q=async(e,n,o,s,i)=>{const t=a("standalone-activity.terminate",{namespace:e,activityId:n});return u(t,{notifyOnError:!1,options:{method:"POST",body:l({runId:o,reason:s||"",...i&&{identity:i}})}})};export{k as a,y as b,R as c,S as d,E as e,O as f,U as g,C as h,q as p,v as s,Q as t};
