import"./CWj6FrbW.js";import{o as _t}from"./CfXw_P7u.js";import{p as ke,f as w,j as z,g as a,v as G,r as E,t as Y,e as O,b as be,d as me,aN as It,h as P,u as pe,au as Ot,aO as ce,at as ue,s as de,i as zt,c as Nt}from"./B6CF0p-B.js";import{d as xe,e as Rt,s as wt}from"./BSSJzwu8.js";import{i as X}from"./DVfqY6Lp.js";import{e as Ht}from"./DNXtLIpi.js";import{a as Jt,C as Gt}from"./Rrz4rnkO.js";import{c as V,s as U}from"./CVNTlwXL.js";import{b as Pt}from"./DsKFGCQq.js";import{p as g,s as Vt,a as _e,r as Ut}from"./BrOjBIf0.js";import{u as T,I as Ft,z as jt,j as qe,A as Ie,E as b,B as Ke,D as F,S as qt,F as Kt,i as Wt,a as Qt,G as We,H as Qe,J as fe,K as Xe,M as Xt,O as Yt,Q as Zt,R as Oe,k as $t,U as en,l as tn,V as nn,W as rn,X as on,Y as sn,Z as ln,_ as an,$ as cn,a0 as un,a1 as dn,n as ze,a2 as fn,a3 as hn,a4 as mn,a5 as pn}from"./cuKDFPl-.js";import{B as Ne}from"./DVhwr0OH.js";import{I as gn}from"./CsmBsHFA.js";import{t as Re}from"./DEjs8ZrU.js";import{t as R}from"./BC0HqUZ9.js";import{c as yn}from"./Bra16--0.js";import"./69_IOA4Y.js";import{u as vn}from"./EGcux4wu.js";import{p as kn,s as bn}from"./ikbOq2O5.js";const ge=Qe.define(),xn=Qe.define(),Sn=We.define(),Bn=We.define({combine(e){return Zt(e,{minDepth:100,newGroupDelay:500,joinToEvent:(t,n)=>n},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(t,n)=>(r,o)=>t(r,o)||n(r,o)})}}),An=qt.define({create(){return D.empty},update(e,t){let n=t.state.facet(Bn),r=t.annotation(ge);if(r){let c=k.fromTransaction(t,r.selection),m=r.side,f=m==0?e.undone:e.done;return c?f=Z(f,f.length,n.minDepth,c):f=Ze(f,t.startState.selection),new D(m==0?r.rest:f,m==0?f:r.rest)}let o=t.annotation(xn);if((o=="full"||o=="before")&&(e=e.isolate()),t.annotation(fe.addToHistory)===!1)return t.changes.empty?e:e.addMapping(t.changes.desc);let s=k.fromTransaction(t),i=t.annotation(fe.time),l=t.annotation(fe.userEvent);return s?e=e.addChanges(s,i,l,n,t):t.selection&&(e=e.addSelection(t.startState.selection,i,l,n.newGroupDelay)),(o=="full"||o=="after")&&(e=e.isolate()),e},toJSON(e){return{done:e.done.map(t=>t.toJSON()),undone:e.undone.map(t=>t.toJSON())}},fromJSON(e){return new D(e.done.map(k.fromJSON),e.undone.map(k.fromJSON))}});function $(e,t){return function({state:n,dispatch:r}){if(!t&&n.readOnly)return!1;let o=n.field(An,!1);if(!o)return!1;let s=o.pop(e,n,t);return s?(r(s),!0):!1}}const Dn=$(0,!1),we=$(1,!1),Cn=$(0,!0),Tn=$(1,!0);class k{constructor(t,n,r,o,s){this.changes=t,this.effects=n,this.mapped=r,this.startSelection=o,this.selectionsAfter=s}setSelAfter(t){return new k(this.changes,this.effects,this.mapped,this.startSelection,t)}toJSON(){var t,n,r;return{changes:(t=this.changes)===null||t===void 0?void 0:t.toJSON(),mapped:(n=this.mapped)===null||n===void 0?void 0:n.toJSON(),startSelection:(r=this.startSelection)===null||r===void 0?void 0:r.toJSON(),selectionsAfter:this.selectionsAfter.map(o=>o.toJSON())}}static fromJSON(t){return new k(t.changes&&Xt.fromJSON(t.changes),[],t.mapped&&Yt.fromJSON(t.mapped),t.startSelection&&b.fromJSON(t.startSelection),t.selectionsAfter.map(b.fromJSON))}static fromTransaction(t,n){let r=S;for(let o of t.startState.facet(Sn)){let s=o(t);s.length&&(r=r.concat(s))}return!r.length&&t.changes.empty?null:new k(t.changes.invert(t.startState.doc),r,void 0,n||t.startState.selection,S)}static selection(t){return new k(void 0,S,void 0,void 0,t)}}function Z(e,t,n,r){let o=t+1>n+20?t-n-1:0,s=e.slice(o,t);return s.push(r),s}function Mn(e,t){let n=[],r=!1;return e.iterChangedRanges((o,s)=>n.push(o,s)),t.iterChangedRanges((o,s,i,l)=>{for(let c=0;c<n.length;){let m=n[c++],f=n[c++];l>=m&&i<=f&&(r=!0)}}),r}function Ln(e,t){return e.ranges.length==t.ranges.length&&e.ranges.filter((n,r)=>n.empty!=t.ranges[r].empty).length===0}function Ye(e,t){return e.length?t.length?e.concat(t):e:t}const S=[],En=200;function Ze(e,t){if(e.length){let n=e[e.length-1],r=n.selectionsAfter.slice(Math.max(0,n.selectionsAfter.length-En));return r.length&&r[r.length-1].eq(t)?e:(r.push(t),Z(e,e.length-1,1e9,n.setSelAfter(r)))}else return[k.selection([t])]}function _n(e){let t=e[e.length-1],n=e.slice();return n[e.length-1]=t.setSelAfter(t.selectionsAfter.slice(0,t.selectionsAfter.length-1)),n}function he(e,t){if(!e.length)return e;let n=e.length,r=S;for(;n;){let o=In(e[n-1],t,r);if(o.changes&&!o.changes.empty||o.effects.length){let s=e.slice(0,n);return s[n-1]=o,s}else t=o.mapped,n--,r=o.selectionsAfter}return r.length?[k.selection(r)]:S}function In(e,t,n){let r=Ye(e.selectionsAfter.length?e.selectionsAfter.map(l=>l.map(t)):S,n);if(!e.changes)return k.selection(r);let o=e.changes.map(t),s=t.mapDesc(e.changes,!0),i=e.mapped?e.mapped.composeDesc(s):s;return new k(o,Xe.mapEffects(e.effects,t),i,e.startSelection.map(s),r)}const On=/^(input\.type|delete)($|\.)/;class D{constructor(t,n,r=0,o=void 0){this.done=t,this.undone=n,this.prevTime=r,this.prevUserEvent=o}isolate(){return this.prevTime?new D(this.done,this.undone):this}addChanges(t,n,r,o,s){let i=this.done,l=i[i.length-1];return l&&l.changes&&!l.changes.empty&&t.changes&&(!r||On.test(r))&&(!l.selectionsAfter.length&&n-this.prevTime<o.newGroupDelay&&o.joinToEvent(s,Mn(l.changes,t.changes))||r=="input.type.compose")?i=Z(i,i.length-1,o.minDepth,new k(t.changes.compose(l.changes),Ye(Xe.mapEffects(t.effects,l.changes),l.effects),l.mapped,l.startSelection,S)):i=Z(i,i.length,o.minDepth,t),new D(i,S,n,r)}addSelection(t,n,r,o){let s=this.done.length?this.done[this.done.length-1].selectionsAfter:S;return s.length>0&&n-this.prevTime<o&&r==this.prevUserEvent&&r&&/^select($|\.)/.test(r)&&Ln(s[s.length-1],t)?this:new D(Ze(this.done,t),this.undone,n,r)}addMapping(t){return new D(he(this.done,t),he(this.undone,t),this.prevTime,this.prevUserEvent)}pop(t,n,r){let o=t==0?this.done:this.undone;if(o.length==0)return null;let s=o[o.length-1],i=s.selectionsAfter[0]||n.selection;if(r&&s.selectionsAfter.length)return n.update({selection:s.selectionsAfter[s.selectionsAfter.length-1],annotations:ge.of({side:t,rest:_n(o),selection:i}),userEvent:t==0?"select.undo":"select.redo",scrollIntoView:!0});if(s.changes){let l=o.length==1?S:o.slice(0,o.length-1);return s.mapped&&(l=he(l,s.mapped)),n.update({changes:s.changes,selection:s.startSelection,effects:s.effects,annotations:ge.of({side:t,rest:l,selection:i}),filter:!1,userEvent:t==0?"undo":"redo",scrollIntoView:!0})}else return null}}D.empty=new D(S,S);const zn=[{key:"Mod-z",run:Dn,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:we,preventDefault:!0},{linux:"Ctrl-Shift-z",run:we,preventDefault:!0},{key:"Mod-u",run:Cn,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:Tn,preventDefault:!0}];function Se(e,t){return b.create(e.ranges.map(t),e.mainIndex)}function N(e,t){return e.update({selection:t,scrollIntoView:!0,userEvent:"select"})}function M({state:e,dispatch:t},n){let r=Se(e.selection,n);return r.eq(e.selection,!0)?!1:(t(N(e,r)),!0)}function ee(e,t){return b.cursor(t?e.to:e.from)}function $e(e,t){return M(e,n=>n.empty?e.moveByChar(n,t):ee(n,t))}function B(e){return e.textDirectionAt(e.state.selection.main.head)==Kt.LTR}const et=e=>$e(e,!B(e)),tt=e=>$e(e,B(e));function nt(e,t){return M(e,n=>n.empty?e.moveByGroup(n,t):ee(n,t))}const Nn=e=>nt(e,!B(e)),Rn=e=>nt(e,B(e));function rt(e,t){return M(e,n=>{if(!n.empty)return ee(n,t);let r=e.moveVertically(n,t);return r.head!=n.head?r:e.moveToLineBoundary(n,t)})}const ot=e=>rt(e,!1),st=e=>rt(e,!0);function it(e){let t=e.scrollDOM.clientHeight<e.scrollDOM.scrollHeight-2,n=0,r=0,o;if(t){for(let s of e.state.facet(T.scrollMargins)){let i=s(e);i!=null&&i.top&&(n=Math.max(i==null?void 0:i.top,n)),i!=null&&i.bottom&&(r=Math.max(i==null?void 0:i.bottom,r))}o=e.scrollDOM.clientHeight-n-r}else o=(e.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:n,marginBottom:r,selfScroll:t,height:Math.max(e.defaultLineHeight,o-5)}}function lt(e,t){let n=it(e),{state:r}=e,o=Se(r.selection,i=>i.empty?e.moveVertically(i,t,n.height):ee(i,t));if(o.eq(r.selection))return!1;let s;if(n.selfScroll){let i=e.coordsAtPos(r.selection.main.head),l=e.scrollDOM.getBoundingClientRect(),c=l.top+n.marginTop,m=l.bottom-n.marginBottom;i&&i.top>c&&i.bottom<m&&(s=T.scrollIntoView(o.main.head,{y:"start",yMargin:i.top-c}))}return e.dispatch(N(r,o),{effects:s}),!0}const He=e=>lt(e,!1),ye=e=>lt(e,!0);function _(e,t,n){let r=e.lineBlockAt(t.head),o=e.moveToLineBoundary(t,n);if(o.head==t.head&&o.head!=(n?r.to:r.from)&&(o=e.moveToLineBoundary(t,n,!1)),!n&&o.head==r.from&&r.length){let s=/^\s*/.exec(e.state.sliceDoc(r.from,Math.min(r.from+100,r.to)))[0].length;s&&t.head!=r.from+s&&(o=b.cursor(r.from+s))}return o}const wn=e=>M(e,t=>_(e,t,!0)),Hn=e=>M(e,t=>_(e,t,!1)),Jn=e=>M(e,t=>_(e,t,!B(e))),Gn=e=>M(e,t=>_(e,t,B(e))),Pn=e=>M(e,t=>b.cursor(e.lineBlockAt(t.head).from,1)),Vn=e=>M(e,t=>b.cursor(e.lineBlockAt(t.head).to,-1));function C(e,t){let n=Se(e.state.selection,r=>{let o=t(r);return b.range(r.anchor,o.head,o.goalColumn,o.bidiLevel||void 0)});return n.eq(e.state.selection)?!1:(e.dispatch(N(e.state,n)),!0)}function at(e,t){return C(e,n=>e.moveByChar(n,t))}const ct=e=>at(e,!B(e)),ut=e=>at(e,B(e));function dt(e,t){return C(e,n=>e.moveByGroup(n,t))}const Un=e=>dt(e,!B(e)),Fn=e=>dt(e,B(e));function ft(e,t){return C(e,n=>e.moveVertically(n,t))}const ht=e=>ft(e,!1),mt=e=>ft(e,!0);function pt(e,t){return C(e,n=>e.moveVertically(n,t,it(e).height))}const Je=e=>pt(e,!1),Ge=e=>pt(e,!0),jn=e=>C(e,t=>_(e,t,!0)),qn=e=>C(e,t=>_(e,t,!1)),Kn=e=>C(e,t=>_(e,t,!B(e))),Wn=e=>C(e,t=>_(e,t,B(e))),Qn=e=>C(e,t=>b.cursor(e.lineBlockAt(t.head).from)),Xn=e=>C(e,t=>b.cursor(e.lineBlockAt(t.head).to)),Pe=({state:e,dispatch:t})=>(t(N(e,{anchor:0})),!0),Ve=({state:e,dispatch:t})=>(t(N(e,{anchor:e.doc.length})),!0),Ue=({state:e,dispatch:t})=>(t(N(e,{anchor:e.selection.main.anchor,head:0})),!0),Fe=({state:e,dispatch:t})=>(t(N(e,{anchor:e.selection.main.anchor,head:e.doc.length})),!0),Yn=({state:e,dispatch:t})=>(t(e.update({selection:{anchor:0,head:e.doc.length},userEvent:"select"})),!0);function j(e,t){if(e.state.readOnly)return!1;let n="delete.selection",{state:r}=e,o=r.changeByRange(s=>{let{from:i,to:l}=s;if(i==l){let c=t(s);c<i?(n="delete.backward",c=Q(e,c,!1)):c>i&&(n="delete.forward",c=Q(e,c,!0)),i=Math.min(i,c),l=Math.max(l,c)}else i=Q(e,i,!1),l=Q(e,l,!0);return i==l?{range:s}:{changes:{from:i,to:l},range:b.cursor(i,i<s.head?-1:1)}});return o.changes.empty?!1:(e.dispatch(r.update(o,{scrollIntoView:!0,userEvent:n,effects:n=="delete.selection"?T.announce.of(r.phrase("Selection deleted")):void 0})),!0)}function Q(e,t,n){if(e instanceof T)for(let r of e.state.facet(T.atomicRanges).map(o=>o(e)))r.between(t,t,(o,s)=>{o<t&&s>t&&(t=n?s:o)});return t}const gt=(e,t,n)=>j(e,r=>{let o=r.from,{state:s}=e,i=s.doc.lineAt(o),l,c;if(n&&!t&&o>i.from&&o<i.from+200&&!/[^ \t]/.test(l=i.text.slice(0,o-i.from))){if(l[l.length-1]=="	")return o-1;let m=qe(l,s.tabSize),f=m%Oe(s)||Oe(s);for(let y=0;y<f&&l[l.length-1-y]==" ";y++)o--;c=o}else c=F(i.text,o-i.from,t,t)+i.from,c==o&&i.number!=(t?s.doc.lines:1)?c+=t?1:-1:!t&&/[\ufe00-\ufe0f]/.test(i.text.slice(c-i.from,o-i.from))&&(c=F(i.text,c-i.from,!1,!1)+i.from);return c}),ve=e=>gt(e,!1,!0),yt=e=>gt(e,!0,!1),vt=(e,t)=>j(e,n=>{let r=n.head,{state:o}=e,s=o.doc.lineAt(r),i=o.charCategorizer(r);for(let l=null;;){if(r==(t?s.to:s.from)){r==n.head&&s.number!=(t?o.doc.lines:1)&&(r+=t?1:-1);break}let c=F(s.text,r-s.from,t)+s.from,m=s.text.slice(Math.min(r,c)-s.from,Math.max(r,c)-s.from),f=i(m);if(l!=null&&f!=l)break;(m!=" "||r!=n.head)&&(l=f),r=c}return r}),kt=e=>vt(e,!1),Zn=e=>vt(e,!0),$n=e=>j(e,t=>{let n=e.lineBlockAt(t.head).to;return t.head<n?n:Math.min(e.state.doc.length,t.head+1)}),er=e=>j(e,t=>{let n=e.moveToLineBoundary(t,!1).head;return t.head>n?n:Math.max(0,t.head-1)}),tr=e=>j(e,t=>{let n=e.moveToLineBoundary(t,!0).head;return t.head<n?n:Math.min(e.state.doc.length,t.head+1)}),nr=({state:e,dispatch:t})=>{if(e.readOnly)return!1;let n=e.changeByRange(r=>({changes:{from:r.from,to:r.to,insert:Ke.of(["",""])},range:b.cursor(r.from)}));return t(e.update(n,{scrollIntoView:!0,userEvent:"input"})),!0},rr=({state:e,dispatch:t})=>{if(e.readOnly)return!1;let n=e.changeByRange(r=>{if(!r.empty||r.from==0||r.from==e.doc.length)return{range:r};let o=r.from,s=e.doc.lineAt(o),i=o==s.from?o-1:F(s.text,o-s.from,!1)+s.from,l=o==s.to?o+1:F(s.text,o-s.from,!0)+s.from;return{changes:{from:i,to:l,insert:e.doc.slice(o,l).append(e.doc.slice(i,o))},range:b.cursor(l)}});return n.changes.empty?!1:(t(e.update(n,{scrollIntoView:!0,userEvent:"move.character"})),!0)};function or(e,t){if(/\(\)|\[\]|\{\}/.test(e.sliceDoc(t-1,t+1)))return{from:t,to:t};let n=Wt(e).resolveInner(t),r=n.childBefore(t),o=n.childAfter(t),s;return r&&o&&r.to<=t&&o.from>=t&&(s=r.type.prop(Qt.closedBy))&&s.indexOf(o.name)>-1&&e.doc.lineAt(r.to).from==e.doc.lineAt(o.from).from&&!/\S/.test(e.sliceDoc(r.to,o.from))?{from:r.to,to:o.from}:null}const je=sr(!1);function sr(e){return({state:t,dispatch:n})=>{if(t.readOnly)return!1;let r=t.changeByRange(o=>{let{from:s,to:i}=o,l=t.doc.lineAt(s),c=!e&&s==i&&or(t,s);e&&(s=i=(i<=l.to?l:t.doc.lineAt(i)).to);let m=new Ft(t,{simulateBreak:s,simulateDoubleBreak:!!c}),f=jt(m,s);for(f==null&&(f=qe(/^\s*/.exec(t.doc.lineAt(s).text)[0],t.tabSize));i<l.to&&/\s/.test(l.text[i-l.from]);)i++;c?{from:s,to:i}=c:s>l.from&&s<l.from+100&&!/\S/.test(l.text.slice(0,s))&&(s=l.from);let y=["",Ie(t,f)];return c&&y.push(Ie(t,m.lineIndent(l.from,-1))),{changes:{from:s,to:i,insert:Ke.of(y)},range:b.cursor(s+1+y[1].length)}});return n(t.update(r,{scrollIntoView:!0,userEvent:"input"})),!0}}const ir=[{key:"Ctrl-b",run:et,shift:ct,preventDefault:!0},{key:"Ctrl-f",run:tt,shift:ut},{key:"Ctrl-p",run:ot,shift:ht},{key:"Ctrl-n",run:st,shift:mt},{key:"Ctrl-a",run:Pn,shift:Qn},{key:"Ctrl-e",run:Vn,shift:Xn},{key:"Ctrl-d",run:yt},{key:"Ctrl-h",run:ve},{key:"Ctrl-k",run:$n},{key:"Ctrl-Alt-h",run:kt},{key:"Ctrl-o",run:nr},{key:"Ctrl-t",run:rr},{key:"Ctrl-v",run:ye}],lr=[{key:"ArrowLeft",run:et,shift:ct,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:Nn,shift:Un,preventDefault:!0},{mac:"Cmd-ArrowLeft",run:Jn,shift:Kn,preventDefault:!0},{key:"ArrowRight",run:tt,shift:ut,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:Rn,shift:Fn,preventDefault:!0},{mac:"Cmd-ArrowRight",run:Gn,shift:Wn,preventDefault:!0},{key:"ArrowUp",run:ot,shift:ht,preventDefault:!0},{mac:"Cmd-ArrowUp",run:Pe,shift:Ue},{mac:"Ctrl-ArrowUp",run:He,shift:Je},{key:"ArrowDown",run:st,shift:mt,preventDefault:!0},{mac:"Cmd-ArrowDown",run:Ve,shift:Fe},{mac:"Ctrl-ArrowDown",run:ye,shift:Ge},{key:"PageUp",run:He,shift:Je},{key:"PageDown",run:ye,shift:Ge},{key:"Home",run:Hn,shift:qn,preventDefault:!0},{key:"Mod-Home",run:Pe,shift:Ue},{key:"End",run:wn,shift:jn,preventDefault:!0},{key:"Mod-End",run:Ve,shift:Fe},{key:"Enter",run:je,shift:je},{key:"Mod-a",run:Yn},{key:"Backspace",run:ve,shift:ve,preventDefault:!0},{key:"Delete",run:yt,preventDefault:!0},{key:"Mod-Backspace",mac:"Alt-Backspace",run:kt,preventDefault:!0},{key:"Mod-Delete",mac:"Alt-Delete",run:Zn,preventDefault:!0},{mac:"Mod-Backspace",run:er,preventDefault:!0},{mac:"Mod-Delete",run:tr,preventDefault:!0}].concat(ir.map(e=>({mac:e.key,run:e.run,shift:e.shift})));var ar=w("<button><!></button>");function cr(e,t){ke(t,!0);let n=g(t,"class",3,void 0);const r=Re("common.minimize"),o=Re("common.maximize"),s=G(()=>t.maximized?r:o),i=G(()=>t.maximized?"minimize":"expand");var l=ar();l.__click=function(...m){var f;(f=t.onclick)==null||f.apply(this,m)};var c=z(l);gn(c,{get title(){return a(s)},get name(){return a(i)}}),E(l),Y(m=>U(l,1,m),[()=>V(R("surface-interactive-secondary m-1 border border-[transparent] bg-transparent p-1 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary/70",n()))]),O(e,l),be()}xe(["click"]);var ur=w("<div><!> <div><!> <!></div></div>");function dr(e,t){ke(t,!0);let n=g(t,"maximized",15,!1),r=g(t,"class",3,void 0),o=g(t,"enabled",3,!0),s=g(t,"actions",3,void 0),i=v=>{n()&&v.key==="Escape"&&n(!1)};const l=()=>{n(!n())},c=v=>{n()&&v.currentTarget instanceof Element&&v.relatedTarget instanceof Element&&!v.currentTarget.contains(v.relatedTarget)&&n(!1)};var m=ur();Rt("keydown",It,i),m.__focusout=c;var f=z(m);me(f,()=>t.children);var y=P(f,2),H=z(y);me(H,()=>s()??pe);var q=P(H,2);{var L=v=>{cr(v,{class:"m-0 rounded-full text-secondary",onclick:l,get maximized(){return n()}})};X(q,v=>{o()&&v(L)})}E(y),E(m),Y((v,te)=>{U(m,1,v),U(y,1,te)},[()=>V(R("relative",n()&&"fixed bottom-0 left-0 right-0 top-0 z-100 h-full w-full overflow-y-auto bg-white dark:bg-black",r())),()=>V(R("absolute",n()&&"fixed","right-2 top-2 flex items-center"))]),O(e,m),be()}xe(["focusout"]);function fr(e,t){if(!e)return"";let n="";try{const r=kn(e);n=bn(r,void 0,t)}catch{n=e}return n}var hr=w("<button> </button>"),mr=w('<div class="flex flex-row items-center justify-between border-b border-subtle bg-code-block px-3"><div class="flex flex-row items-center gap-4"></div> <div class="flex flex-row items-center gap-4"><!> <!></div></div>'),pr=w("<div></div>"),gr=w("<div><!> <!></div>");function Rr(e,t){ke(t,!0);const n=()=>_e(vn,"$useDarkMode",o),r=()=>_e(Bt,"$copied",o),[o,s]=Vt(),i=(d,h=pe)=>{var p=hr();p.__click=()=>Be(h());var x=z(p,!0);E(p),Y(A=>{U(p,1,A),wt(x,h())},[()=>V(R("h-full border-b-2 border-transparent py-2",h()===Be()?"border-brand":""))]),O(d,p)};var l;let c=g(t,"language",3,"json"),m=g(t,"class",3,void 0),f=g(t,"editable",3,!1),y=g(t,"copyable",3,!0),H=g(t,"copyIconTitle",3,""),q=g(t,"copySuccessIconTitle",3,""),L=g(t,"inline",3,!1),v=g(t,"testId",3,void 0),te=g(t,"minHeight",3,void 0),ne=g(t,"maxHeight",3,void 0),bt=g(t,"label",3,""),re=g(t,"onchange",3,void 0),Be=g(t,"activeTab",15),xt=Ut(t,["$$slots","$$events","$$legacy","content","language","class","editable","copyable","copyIconTitle","copySuccessIconTitle","inline","testId","minHeight","maxHeight","label","onchange","tabs","activeTab","headerActions"]),oe=ue(void 0),u=ue(void 0);const{copy:St,copied:Bt}=yn(),se=(d,h,p)=>h==="json"?fr(d,p?0:2):d,ie=()=>{var d;const h=(d=a(u)===null||a(u)===void 0?void 0:a(u).state)===null||d===void 0?void 0:d.doc;return h?se(h.toString(),c(),L()):""},Ae=d=>{var h;const p=(h=a(u)===null||a(u)===void 0?void 0:a(u).state)===null||h===void 0?void 0:h.doc;p&&p.toString()!==d&&(a(u)===null||a(u)===void 0||a(u).dispatch({changes:{from:0,to:p.length,insert:d}}))},At=1e5,De=()=>{if(!a(u)||c()!=="json")return;const d=a(u).state.doc.length;if(!(d<At))try{ln(a(u).state,d,2e3)}catch{}},K=G(()=>!!t.tabs);let le=ue(!1);const ae=G(()=>(l=ne()&&!a(K)&&(a(u)===null||a(u)===void 0?void 0:a(u).contentHeight)>ne())!==null&&l!==void 0?l:!1),Ce=Ot(new an),Dt=[$t.of([...lr,...zn]),en(cn,{fallback:!0}),tn.of("  "),nn(),rn(),on(),sn()];let Te=G(()=>[un(n(),a(K)),dn({hasActions:y()||a(ae)}),ze.readOnly.of(!f()),T.editable.of(f()),T.contentAttributes.of({"aria-label":bt()}),fn(f()),hn(c()),L()?void 0:T.lineWrapping,!L()&&!f()?mn():void 0,pn({maxHeight:ne(),minHeight:te(),maximized:a(le)})].filter(d=>d!=null));const Ct=()=>new T({parent:a(oe),state:ze.create({doc:se(t.content,c(),L()),extensions:[Dt,Ce.of(a(Te))]}),dispatch(d){a(u).update([d]),d.docChanged&&(re()===null||re()===void 0||re()(ie()))}});ce(()=>{a(u)===null||a(u)===void 0||a(u).dispatch({effects:Ce.reconfigure(a(Te))})}),ce(()=>{var d,h;a(ae)?(d=a(u)===null||a(u)===void 0?void 0:a(u).scrollDOM)===null||d===void 0||d.setAttribute("tabindex","0"):(h=a(u)===null||a(u)===void 0?void 0:a(u).scrollDOM)===null||h===void 0||h.removeAttribute("tabindex")}),ce(()=>{var d;const h=(d=a(u)===null||a(u)===void 0?void 0:a(u).state)===null||d===void 0?void 0:d.doc;if(!h)return;if(!(f()&&(a(u)===null||a(u)===void 0?void 0:a(u).hasFocus))){const x=se(t.content,c(),L());h.toString()!==x&&Ae(x),De()}});const Me=d=>{St(d,ie())},Le=()=>{Ae(ie())};_t(()=>(de(u,Ct(),!0),a(u).contentDOM.onblur=Le,De(),()=>{a(u)===null||a(u)===void 0||a(u).destroy()}));var W=gr(),Ee=z(W);{var Tt=d=>{var h=mr(),p=z(h);Ht(p,20,()=>t.tabs,I=>I,(I,Et)=>{i(I,()=>Et)}),E(p);var x=P(p,2),A=z(x);me(A,()=>t.headerActions??pe);var J=P(A,2);{var Lt=I=>{Ne(I,{get copyIconTitle(){return H()},get copySuccessIconTitle(){return q()},class:"m-0 rounded-full text-secondary",get copied(){return r()},$$events:{click:Me}})};X(J,I=>{y()&&I(Lt)})}E(x),E(h),O(d,h)};X(Ee,d=>{t.tabs&&t.tabs.length>0&&d(Tt)})}var Mt=P(Ee,2);dr(Mt,{get enabled(){return a(ae)},get maximized(){return a(le)},set maximized(h){de(le,h,!0)},actions:h=>{var p=zt(),x=Nt(p);{var A=J=>{Ne(J,{get copyIconTitle(){return H()},get copySuccessIconTitle(){return q()},class:"m-0 rounded-full text-secondary",get copied(){return r()},$$events:{click:Me}})};X(x,J=>{y()&&!a(K)&&J(A)})}O(h,p)},children:(h,p)=>{var x=pr();Jt(x,A=>({class:A,"data-testid":v(),...xt,onblur:Le,[Gt]:{inline:L(),editable:f(),readOnly:!f()}}),[()=>R("h-full",m())]),Pt(x,A=>de(oe,A),()=>a(oe)),O(h,x)},$$slots:{actions:!0,default:!0}}),E(W),Y(d=>U(W,1,d),[()=>V(R("min-w-[80px] grow",a(K)&&["border border-subtle"]))]),O(e,W),be(),s()}xe(["click"]);export{Rr as C};
