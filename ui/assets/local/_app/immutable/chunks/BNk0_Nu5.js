import"./CIOjDFHg.js";import"./mJ_qBz4X.js";import"./BUApaBEI.js";import"./DAcYyk2F.js";import"./Bt9FnE2Z.js";import"./DXnpB5FC.js";import"./ikbOq2O5.js";import{h as W}from"./BJzbPR4R.js";import{f as O}from"./CRRLSWYs.js";import{e as h,f as g,g as L}from"./DNNVWk-J.js";import{m as U}from"./iEPjGoii.js";const N=["workflowExecutionStartedEventAttributes","workflowExecutionCompletedEventAttributes","workflowExecutionFailedEventAttributes","workflowExecutionTimedOutEventAttributes","workflowExecutionOptionsUpdatedEventAttributes","workflowTaskStartedEventAttributes","workflowTaskScheduledEventAttributes","workflowTaskCompletedEventAttributes","workflowTaskTimedOutEventAttributes","workflowTaskFailedEventAttributes","activityTaskScheduledEventAttributes","activityTaskCompletedEventAttributes","activityTaskStartedEventAttributes","activityTaskFailedEventAttributes","activityTaskTimedOutEventAttributes","timerStartedEventAttributes","timerFiredEventAttributes","activityTaskCancelRequestedEventAttributes","activityTaskCanceledEventAttributes","timerCanceledEventAttributes","markerRecordedEventAttributes","workflowExecutionSignaledEventAttributes","workflowExecutionTerminatedEventAttributes","workflowExecutionUpdateAdmittedEventAttributes","workflowExecutionUpdateAcceptedEventAttributes","workflowExecutionUpdateCompletedEventAttributes","workflowExecutionUpdateRejectedEventAttributes","workflowExecutionCancelRequestedEventAttributes","workflowExecutionCanceledEventAttributes","requestCancelExternalWorkflowExecutionInitiatedEventAttributes","requestCancelExternalWorkflowExecutionFailedEventAttributes","externalWorkflowExecutionCancelRequestedEventAttributes","workflowExecutionContinuedAsNewEventAttributes","startChildWorkflowExecutionInitiatedEventAttributes","startChildWorkflowExecutionFailedEventAttributes","childWorkflowExecutionStartedEventAttributes","childWorkflowExecutionCompletedEventAttributes","childWorkflowExecutionFailedEventAttributes","childWorkflowExecutionCanceledEventAttributes","childWorkflowExecutionTimedOutEventAttributes","childWorkflowExecutionTerminatedEventAttributes","signalExternalWorkflowExecutionInitiatedEventAttributes","signalExternalWorkflowExecutionFailedEventAttributes","externalWorkflowExecutionSignaledEventAttributes","upsertWorkflowSearchAttributesEventAttributes","nexusOperationScheduledEventAttributes","nexusOperationStartedEventAttributes","nexusOperationCompletedEventAttributes","nexusOperationFailedEventAttributes","nexusOperationCanceledEventAttributes","nexusOperationTimedOutEventAttributes","nexusOperationCancelRequestedEventAttributes","nexusOperationCancelRequestCompletedEventAttributes","nexusOperationCancelRequestFailedEventAttributes","workflowExecutionOptionsUpdatedEventAttributes","workflowPropertiesModifiedEventAttributes"],K=["WorkflowTaskCompleted","WorkflowTaskFailed","WorkflowTaskTimedOut"],q=t=>{for(const i of N)if(i in t)return i},D=(t,i)=>t[i],H=t=>{const i=q(t),n=D(t,i);return{key:i,attributes:n}},o=t=>i=>!!(i!=null&&i[t]),C=o("workflowExecutionStartedEventAttributes"),St=o("workflowExecutionCompletedEventAttributes"),Ft=o("workflowExecutionFailedEventAttributes"),yt=o("workflowExecutionTimedOutEventAttributes"),It=o("workflowTaskScheduledEventAttributes"),ht=o("workflowTaskStartedEventAttributes"),V=o("workflowTaskCompletedEventAttributes"),gt=o("workflowTaskTimedOutEventAttributes"),R=o("workflowTaskFailedEventAttributes"),Lt=t=>{var i,n,r,s;return R(t)&&((n=(i=t.workflowTaskFailedEventAttributes)==null?void 0:i.failure)==null?void 0:n.message)!=="UnhandledCommand"&&!((s=(r=t.workflowTaskFailedEventAttributes)==null?void 0:r.failure)!=null&&s.resetWorkflowFailureInfo)},_=o("activityTaskScheduledEventAttributes"),B=o("activityTaskStartedEventAttributes"),Ut=o("activityTaskCompletedEventAttributes"),Nt=o("activityTaskFailedEventAttributes"),Kt=o("activityTaskTimedOutEventAttributes"),M=o("timerStartedEventAttributes"),qt=o("timerFiredEventAttributes"),Dt=o("activityTaskCancelRequestedEventAttributes"),Ht=o("activityTaskCanceledEventAttributes"),Vt=o("timerCanceledEventAttributes"),S=o("markerRecordedEventAttributes"),F=o("workflowExecutionOptionsUpdatedEventAttributes"),Y=o("workflowExecutionSignaledEventAttributes"),_t=o("workflowExecutionTerminatedEventAttributes"),Bt=o("workflowExecutionCanceledEventAttributes"),Mt=o("workflowExecutionContinuedAsNewEventAttributes"),P=o("startChildWorkflowExecutionInitiatedEventAttributes"),Yt=o("childWorkflowExecutionStartedEventAttributes"),Pt=o("childWorkflowExecutionCompletedEventAttributes"),Xt=o("childWorkflowExecutionFailedEventAttributes"),jt=o("childWorkflowExecutionCanceledEventAttributes"),Gt=o("childWorkflowExecutionTimedOutEventAttributes"),Jt=o("childWorkflowExecutionTerminatedEventAttributes"),Qt=o("signalExternalWorkflowExecutionInitiatedEventAttributes"),Zt=o("signalExternalWorkflowExecutionFailedEventAttributes"),$t=o("externalWorkflowExecutionSignaledEventAttributes"),X=o("upsertWorkflowSearchAttributesEventAttributes"),zt=t=>K.includes(t.eventType),j=["LocalActivity","core_local_activity"],te=t=>!(!S(t)||!j.includes(t.markerRecordedEventAttributes.markerName)),G=o("workflowExecutionUpdateAcceptedEventAttributes"),J=o("workflowExecutionUpdateRejectedEventAttributes"),Q=o("workflowExecutionUpdateCompletedEventAttributes"),ee=t=>{var i;return Q(t)&&!!((i=t.workflowExecutionUpdateCompletedEventAttributes.outcome)!=null&&i.failure)},Z=o("nexusOperationScheduledEventAttributes"),ie=o("nexusOperationStartedEventAttributes"),oe=o("nexusOperationCompletedEventAttributes"),ne=o("nexusOperationFailedEventAttributes"),re=o("nexusOperationCanceledEventAttributes"),se=o("nexusOperationTimedOutEventAttributes"),$=o("nexusOperationCancelRequestedEventAttributes"),z=t=>t.eventType==="WorkflowTaskTimedOut",y=t=>R(t)&&tt(t)==="ResetWorkflow",tt=t=>{var r;if(z(t))return"WorkflowTaskTimedOut";const{workflowTaskFailedEventAttributes:{failure:i,cause:n}={}}=t;return((r=i==null?void 0:i.applicationFailureInfo)==null?void 0:r.type)==="workflowTaskHeartbeatError"?"WorkflowTaskHeartbeatError":h(n)},et=(t,i)=>{var n,r,s,d,E,f,k,w,T,v,A,m,u,c;try{if(C(t)){const a=((n=t.attributes)==null?void 0:n.attempt)||1,l=(r=t.attributes)==null?void 0:r.firstExecutionRunId,p=(s=t.attributes)==null?void 0:s.originalExecutionRunId,I=l===p&&((f=(E=(d=t.attributes)==null?void 0:d.searchAttributes)==null?void 0:E.indexedFields)==null?void 0:f.TemporalScheduledById);return a>1?0:I?3:1}if(_(t)||M(t)||Y(t)&&t.id!=="2"||Z(t)||$(t)||G(t)||J(t)||F(t))return 1;if(X(t)){const a=Object.keys(t.attributes.searchAttributes.indexedFields);return(a==null?void 0:a.length)===1&&((T=(w=(k=t.attributes)==null?void 0:k.searchAttributes)==null?void 0:w.indexedFields)!=null&&T.TemporalChangeVersion)?0:1}if(S(t)){if(["core_patch","Version"].includes((v=t==null?void 0:t.attributes)==null?void 0:v.markerName))return 0;const l=(A=t.attributes)==null?void 0:A.workflowTaskCompletedEventId;if(l&&i)return i.has(String(l))?0:(i.add(String(l)),1);if(l)return 1}return y(t)||P(t)?1:B(t)?(((m=t.attributes)==null?void 0:m.attempt)||1)-1:V(t)?Math.min(((c=(u=t.attributes)==null?void 0:u.meteringMetadata)==null?void 0:c.nonfirstLocalActivityExecutionAttempts)||0,100):0}catch{return 0}},e={ACTIVITY:"activity",CHILD_WORKFLOW:"child-workflow",LOCAL_ACTIVITY:"local-activity",NEXUS:"nexus",SIGNAL:"signal",TIMER:"timer",UPDATE:"update",WORKFLOW:"workflow",OTHER:"other"},b={ActivityTaskCanceled:e.ACTIVITY,ActivityTaskCancelRequested:e.ACTIVITY,ActivityTaskCompleted:e.ACTIVITY,ActivityTaskFailed:e.ACTIVITY,ActivityTaskScheduled:e.ACTIVITY,ActivityTaskStarted:e.ACTIVITY,ActivityTaskTimedOut:e.ACTIVITY,ChildWorkflowExecutionCanceled:e.CHILD_WORKFLOW,ChildWorkflowExecutionCompleted:e.CHILD_WORKFLOW,ChildWorkflowExecutionFailed:e.CHILD_WORKFLOW,ChildWorkflowExecutionStarted:e.CHILD_WORKFLOW,ChildWorkflowExecutionTerminated:e.CHILD_WORKFLOW,ChildWorkflowExecutionTimedOut:e.CHILD_WORKFLOW,StartChildWorkflowExecutionFailed:e.CHILD_WORKFLOW,StartChildWorkflowExecutionInitiated:e.CHILD_WORKFLOW,SignalExternalWorkflowExecutionFailed:e.SIGNAL,SignalExternalWorkflowExecutionInitiated:e.SIGNAL,WorkflowExecutionSignaled:e.SIGNAL,ExternalWorkflowExecutionSignaled:e.SIGNAL,TimerCanceled:e.TIMER,TimerFired:e.TIMER,TimerStarted:e.TIMER,WorkflowExecutionCanceled:e.WORKFLOW,WorkflowExecutionCancelRequested:e.WORKFLOW,WorkflowExecutionCompleted:e.WORKFLOW,WorkflowExecutionContinuedAsNew:e.WORKFLOW,WorkflowExecutionFailed:e.WORKFLOW,WorkflowExecutionStarted:e.WORKFLOW,WorkflowExecutionTerminated:e.WORKFLOW,WorkflowExecutionTimedOut:e.WORKFLOW,WorkflowExecutionOptionsUpdated:e.WORKFLOW,WorkflowTaskCompleted:e.WORKFLOW,WorkflowTaskFailed:e.WORKFLOW,WorkflowTaskScheduled:e.WORKFLOW,WorkflowTaskStarted:e.WORKFLOW,WorkflowTaskTimedOut:e.WORKFLOW,ExternalWorkflowExecutionCancelRequested:e.WORKFLOW,RequestCancelExternalWorkflowExecutionFailed:e.WORKFLOW,RequestCancelExternalWorkflowExecutionInitiated:e.WORKFLOW,WorkflowExecutionUpdateAccepted:e.UPDATE,WorkflowExecutionUpdateCompleted:e.UPDATE,WorkflowExecutionUpdateRequested:e.UPDATE,WorkflowExecutionUpdateRejected:e.UPDATE,WorkflowExecutionUpdateAdmitted:e.UPDATE,NexusOperationScheduled:e.NEXUS,NexusOperationStarted:e.NEXUS,NexusOperationCompleted:e.NEXUS,NexusOperationFailed:e.NEXUS,NexusOperationCanceled:e.NEXUS,NexusOperationTimedOut:e.NEXUS,NexusOperationCancelRequested:e.NEXUS,NexusOperationCancelRequestCompleted:e.NEXUS,NexusOperationCancelRequestFailed:e.NEXUS,MarkerRecorded:e.OTHER,UpsertWorkflowSearchAttributes:e.OTHER,WorkflowPropertiesModified:e.OTHER},it=[{label:"events.category.activity",value:e.ACTIVITY,description:"events.category.activity-tooltip"},{label:"events.category.child-workflow",value:e.CHILD_WORKFLOW,description:"events.category.child-workflow-tooltip"},{label:"events.category.local-activity",value:e.LOCAL_ACTIVITY,description:"events.category.local-activity-tooltip"},{label:"events.category.signal",value:e.SIGNAL,description:"events.category.signal-tooltip"},{label:"events.category.timer",value:e.TIMER,description:"events.category.timer-tooltip"},{label:"events.category.update",value:e.UPDATE,description:"events.category.update-tooltip"},{label:"events.category.nexus",value:e.NEXUS,description:"events.category.nexus-tooltip"},{label:"events.category.workflow",value:e.WORKFLOW,description:"events.category.workflow-tooltip"},{label:"events.category.other",value:e.OTHER,description:"events.category.other-tooltip"}],ot=[e.ACTIVITY,e.LOCAL_ACTIVITY,e.CHILD_WORKFLOW,e.SIGNAL,e.TIMER,e.UPDATE,e.NEXUS,e.OTHER],ae=it.filter(({value:t})=>ot.includes(t)),nt=t=>(b==null?void 0:b[t])||e.OTHER,le=t=>{for(const i in e)if(t===e[i])return!0;return!1},rt=["Unspecified","Scheduled","Open","New","Started","Initiated","Running","Completed","Fired","CancelRequested","TimedOut","Signaled","Canceled","Failed","Terminated"],st=t=>{if(typeof t=="number")return"Unspecified";if(t.includes("RequestCancel"))return"CancelRequested";for(const i of rt)if(t.includes(i))return i;return"Unspecified"},at=["closeTime","createTime","currentAttemptScheduledTime","earliestTime","eventTime","executionTime","expirationTime","expireTime","lastAccessTime","lastHeartbeatTime","lastStartedTime","lastUpdateTime","latestTime","releaseTime","scheduledTime","startedTime","startTime","workflowExecutionExpirationTime"],lt=["backoffStartInterval","defaultWorkflowTaskTimeout","firstWorkflowTaskBackoff","heartbeatTimeout","initialInterval","maximumInterval","scheduleToCloseTimeout","scheduleToStartTimeout","startToCloseTimeout","startToFireTimeout","workflowExecutionRetentionPeriod","workflowExecutionRetentionTtl","workflowExecutionTimeout","workflowRunTimeout","workflowTaskTimeout"],ut=t=>{for(const i of at)if(i===t)return!0;return!1},ct=t=>{for(const i of lt)if(i===t)return!0;return!1},dt=t=>{if(t===null||t===void 0||typeof t!="object")return!1;const i=Object.keys(t),[n]=i;return!(i.length!==1||typeof t[n]!="string")},Et=t=>{for(const i of Object.values(t))return i};function ft(t,i=!1){for(const[n,r]of Object.entries(t))dt(r)&&(t[n]=Et(r)),ut(n)&&!i&&(t[n]=O(r)),ct(n)&&(t[n]=U(r)),n==="versioningBehavior"&&(t[n]=g(r,"VersioningBehavior"));return W(t,"workerVersion")&&W(t,"deploymentVersion")&&delete t.workerVersion,t}const kt=(t,i=()=>!1,n)=>({...t,billableActions:i(t)?0:et(t,n)}),wt=(t,i={})=>{var u,c,a,l,p,x;const n=String(t.eventId),r=L(t.eventType),s=O(String(t.eventTime)),d=st(r),E=nt(r),{key:f,attributes:k}=H(t),w=C(t)&&((a=(c=(u=t.workflowExecutionStartedEventAttributes)==null?void 0:u.completionCallbacks)==null?void 0:c[0])==null?void 0:a.links),T=F(t)&&((x=(p=(l=t.workflowExecutionOptionsUpdatedEventAttributes)==null?void 0:l.attachedCompletionCallbacks)==null?void 0:p[0])==null?void 0:x.links),v=w||T,A=(t==null?void 0:t.links)||v||[],m={...t,name:r,id:n,eventType:r,timestamp:s,classification:d,category:E,links:A,billableActions:0,attributes:ft({type:f,...k})};return kt(m,i.shouldNotAddBillableAction,i.processedWorkflowTaskIds)},ue=t=>{const i=t.findLast(y),n=s=>i?Number(s.id)<Number(i.eventId):!1,r=new Set;return t.map(s=>wt(s,{shouldNotAddBillableAction:n,processedWorkflowTaskIds:r}))},ce=t=>t===null||typeof t!="object"||Array.isArray(t)?!1:!!W(t,"eventType"),de=t=>{const i={...t};return delete i.name,delete i.id,delete i.timestamp,delete i.classification,delete i.category,delete i.attributes,i};export{ft as $,yt as A,gt as B,Lt as C,Zt as D,ee as E,ne as F,se as G,Dt as H,Ut as I,Yt as J,qt as K,Q as L,$t as M,ht as N,V as O,R as P,ie as Q,oe as R,M as S,Qt as T,Y as U,S as V,P as W,It as X,ae as Y,Mt as Z,St as _,F as a,Pt as b,Xt as c,jt as d,Gt as e,Jt as f,ce as g,te as h,C as i,G as j,Z as k,it as l,zt as m,le as n,de as o,B as p,_ as q,_t as r,Ht as s,ue as t,Vt as u,Bt as v,re as w,Kt as x,Nt as y,Ft as z};
