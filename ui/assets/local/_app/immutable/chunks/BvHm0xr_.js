import{r as d,a as A}from"./V7evSQol.js";const S=({activityPollers:n,nexusPollers:a,workflowPollers:u})=>{const p=(u==null?void 0:u.pollers)??[],T=(n==null?void 0:n.pollers)??[],m=(a==null?void 0:a.pollers)??[],Q=new Map,g=(t,s)=>{var I;if(t.identity){const c=Q.get(t.identity);c?(c.taskQueueTypes.push(s),(t==null?void 0:t.lastAccessTime)>((I=c==null?void 0:c.poller)==null?void 0:I.lastAccessTime)&&(c.poller=t)):Q.set(t.identity,{poller:t,taskQueueTypes:[s]})}};p.forEach(t=>g(t,"WORKFLOW")),T.forEach(t=>g(t,"ACTIVITY")),m.forEach(t=>g(t,"NEXUS"));const e=Array.from(Q.values()).map(({poller:t,taskQueueTypes:s})=>({...t,taskQueueTypes:s})),h=(n==null?void 0:n.versioningInfo)??(u==null?void 0:u.versioningInfo)??(a==null?void 0:a.versioningInfo),i=(n==null?void 0:n.taskQueueStatus)??(u==null?void 0:u.taskQueueStatus)??(a==null?void 0:a.taskQueueStatus);return{pollers:e,taskQueueStatus:i,versioningInfo:h}};async function L(n,a=fetch){const u=d("task-queue",n),p=await A(u,{request:a,params:{taskQueueType:"1"}}),T=await f(n,a),m=await A(u,{request:a,params:{taskQueueType:"3"}});return S({activityPollers:T,nexusPollers:m,workflowPollers:p})}async function f(n,a=fetch){const u=d("task-queue",n);return A(u,{request:a,params:{taskQueueType:"2"}})}export{f as a,L as g};
