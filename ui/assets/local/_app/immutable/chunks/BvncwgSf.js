import"./CWj6FrbW.js";import"./69_IOA4Y.js";import{p as st,l as C,a as ot,t as H,r as G,e as q,b as rt,s as n,m as p,J as m,L as at,g as t,h as nt,f as ct,i as ut,o as lt}from"./BUtADDjV.js";import{e as it}from"./BIRKK4Cx.js";import{i as ft}from"./Cx0Hed4m.js";import{e as pt}from"./Da7lzrFF.js";import{i as mt}from"./h9b1Gopq.js";import{p as wt,s as dt,e as F,a as w,b as ht}from"./B1GMiS9d.js";import{a as vt}from"./BEyRdwvQ.js";import{p as kt}from"./DL061CTb.js";import{S as yt}from"./CFDPHCnR.js";import{w as I,q as _t,r as gt,c as D,d as xt}from"./DxLL7oVp.js";import{w as K}from"./Dgc1f04S.js";import{c as St}from"./PL4gBzqq.js";import{S as Ct}from"./S6Q2Q0ub.js";import{w as L}from"./c_ldPZ8Y.js";import{b as It}from"./BuHheLF2.js";import{t as Wt,c as bt}from"./C-ruumcr.js";import{u as $t}from"./D6icQx-f.js";import{W as Et}from"./55Irp7Oo.js";const N=(i=[])=>i.map(o=>{const s=It(o==null?void 0:o.groupValues[0]),k=parseInt(o.count);return{status:s,count:k}}).sort((o,s)=>L.indexOf(o.status)-L.indexOf(s.status)),Y=(i,o,s)=>{const u=Math.pow(3600/i,1/s),y=i*Math.pow(u,o);return Math.min(3600,Math.round(y))};var Pt=H("<button><!></button>"),qt=H('<div class="flex min-h-[24px] flex-wrap items-center gap-2"></div>');function Xt(i,o){st(o,!1);const[s,k]=dt(),u=()=>w(kt,"$page",s),y=()=>w(_t,"$queryWithParentWorkflowId",s),c=()=>w(I,"$workflowCount",s),J=()=>w(xt,"$disableWorkflowCountsRefresh",s),W=()=>w(K,"$workflowFilters",s),R=()=>w(gt,"$refresh",s),d=p(),h=p(),b=p();let B=wt(o,"staticQuery",8,""),Q=p([]),_=p([]),g,v=1,x=p(!1);const A=5,$=100;vt(()=>{M()});const U=()=>{if(v+=1,clearInterval(g),v<=$){const e=Y(A,v,$)*1e3;g=setInterval(()=>O(),e)}},M=()=>{clearInterval(g),n(_,[]),F(I,m(c).newCount=0,m(c)),v=1,n(x,!0)},O=async()=>{U();try{const{count:e,groups:r}=await D({namespace:t(d),query:t(h)}).catch(a=>({count:"0",groups:[]}));F(I,m(c).newCount=parseInt(e)-c().count,m(c)),n(_,N(r))}finally{n(x,!1)}},V=async()=>{if(M(),!J()){const e=Y(A,v,$)*1e3;g=setInterval(()=>O(),e)}try{const{count:e,groups:r}=await D({namespace:t(d),query:t(h)}).catch(a=>({count:"0",groups:[]}));F(I,m(c).count=parseInt(e),m(c)),n(Q,N(r))}finally{n(x,!1)}},j=e=>{if(!W().some(a=>a.attribute==="ExecutionStatus"&&a.value===e)){const a={attribute:"ExecutionStatus",type:Ct.KEYWORD,value:e,operator:"",conditional:"=",parenthesis:""};ht(K,[...W(),a]);const l=Wt(bt(W()));$t({url:u().url,parameter:"query",value:l,clearParameters:[St]})}};C(()=>u(),()=>{n(d,u().params.namespace)}),C(()=>(at(B()),y()),()=>{n(h,B()||y())}),C(()=>u(),()=>{n(b,u().url.searchParams.get("per-page"))}),C(()=>(t(d),t(h),t(b),R()),()=>{t(d),t(h),t(b),R(),V()}),ot(),mt();var E=qt();pt(E,5,()=>t(Q),({count:e,status:r})=>r,(e,r)=>{let a=()=>t(r).count,l=()=>t(r).status;var T=nt(),z=ct(T);{var X=f=>{var S=Pt(),tt=ut(S);const et=lt(()=>t(_).find(P=>P.status===l())?t(_).find(P=>P.status===l()).count-a():0);Et(tt,{get status(){return l()},get count(){return a()},get newCount(){return t(et)},get"test-id"(){return`workflow-status-${l()??""}`}}),G(S),it("click",S,()=>j(l())),q(f,S)},Z=f=>{yt(f,{class:"h-6 w-24 rounded-sm"})};ft(z,f=>{t(x)?f(Z,!1):f(X)})}q(e,T)}),G(E),q(i,E),rt(),k()}export{Xt as W};
