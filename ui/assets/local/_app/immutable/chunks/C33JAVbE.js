import{t as m}from"./CYj54Q2q.js";import{f as I}from"./3Mk5k2eN.js";import{t as R}from"./98Dg-lgK.js";import{c as q}from"./BJzbPR4R.js";import{p as x}from"./DSm1H5X_.js";import{r as v,a as y}from"./paxNIibH.js";var N=A;function A(t,a,n){var r=null,e=null,s=n&&n.leading,o=n&&n.trailing;s==null&&(s=!0),o==null&&(o=!s),s==!0&&(o=!1);var c=function(){r&&(clearTimeout(r),r=null)},l=function(){var i=e;c(),i&&i()},u=function(){var i=s&&!r,f=this,g=arguments;if(e=function(){return t.apply(f,g)},r||(r=setTimeout(function(){if(r=null,o)return e()},a)),i)return i=!1,e()};return u.cancel=c,u.flush=l,u}const k=({namespace:t,workflowId:a,runId:n})=>v("events.raw",{namespace:t,workflowId:a,runId:n},!0),F=t=>!q(t)||t==="descending"?"events.descending":t==="ascending"?"events.ascending":"events.descending",z=async({namespace:t,workflowId:a,runId:n,sort:r,onStart:e,onUpdate:s,onComplete:o})=>{const c=F(r),l=v(c,{namespace:t,workflowId:a});return(await x(async i=>y(l,{token:i,request:fetch,params:{"execution.runId":n}}),{onStart:e,onUpdate:s,onComplete:o})).history.events},P=N(()=>{R()},5e3),B=async({namespace:t,workflowId:a,runId:n,sort:r="ascending",signal:e,historySize:s})=>{const o=()=>{e&&I.set([])},c=(d,p)=>{var w,E;if(!e)return;I.set([...m((w=d.history)==null?void 0:w.events)]);const h=(E=p==null?void 0:p.history)==null?void 0:E.events;s&&(h==null?void 0:h.every(H=>parseInt(H.eventId)>parseInt(s)))&&P()},l=()=>{e&&R()},u=F(r),i=v(u,{namespace:t,workflowId:a}),f=await x(async d=>y(i,{token:d,request:fetch,params:{"execution.runId":n,waitNewEvent:e?"true":"false"},options:{signal:e}}),{onStart:o,onUpdate:c,onComplete:l});return f!=null&&f.history?await m(f.history.events):[]},S=async({namespace:t,workflowId:a,runId:n,sort:r,maximumPageSize:e="20"})=>{const s=v(`events.${r}`,{namespace:t,workflowId:a});try{return(await y(s,{request:fetch,params:{maximumPageSize:e,"execution.runId":n}})).history.events}catch{return[]}},D=async t=>{const a=await S({...t,sort:"ascending",maximumPageSize:"1"});return(await m(a))[0]};export{D as a,z as b,B as f,k as g,P as t};
