import{w as e}from"./SxBBeV83.js";import{g as o,p as c}from"./CwzNk6iL.js";import{i as h}from"./BJzbPR4R.js";const E=e();class u{constructor(i,t,r,a,s,n){this.namespace=i,this.activityId=t,this.runId=r,this.abortController=a,this.onUpdate=s,this.onError=n}async start(){let i;try{i=await o(this.namespace,this.activityId,this.runId)}catch(t){this.onError(t)}if(this.onUpdate(i),i.info.status==="ACTIVITY_EXECUTION_STATUS_RUNNING")for(this.token=i.longPollToken;!this.abortController.signal.aborted;)try{const t=await c(this.namespace,this.activityId,this.runId,this.token,this.abortController.signal);t&&!h(t)&&(this.token=t.longPollToken,this.onUpdate(t))}catch(t){if(t instanceof Error&&t.name==="AbortError")return;this.onError(t);break}}async fetchOnce(){const i=await o(this.namespace,this.activityId,this.runId);this.onUpdate(i)}abort(){this.abortController.abort()}}export{u as S,E as a};
