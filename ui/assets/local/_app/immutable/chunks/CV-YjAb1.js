import"./DlwxxrKD.js";import"./D0Jyh3oV.js";import"./CoPSvM7r.js";import"./CH6J3VuQ.js";import{h as W}from"./BDfAQ6r3.js";import{f as C}from"./D8JWfvYP.js";import{e as L,f as U,g as N}from"./DNNVWk-J.js";import{j as K}from"./CHqpB290.js";const q=["workflowExecutionStartedEventAttributes","workflowExecutionCompletedEventAttributes","workflowExecutionFailedEventAttributes","workflowExecutionTimedOutEventAttributes","workflowExecutionOptionsUpdatedEventAttributes","workflowTaskStartedEventAttributes","workflowTaskScheduledEventAttributes","workflowTaskCompletedEventAttributes","workflowTaskTimedOutEventAttributes","workflowTaskFailedEventAttributes","activityTaskScheduledEventAttributes","activityTaskCompletedEventAttributes","activityTaskStartedEventAttributes","activityTaskFailedEventAttributes","activityTaskTimedOutEventAttributes","timerStartedEventAttributes","timerFiredEventAttributes","activityTaskCancelRequestedEventAttributes","activityTaskCanceledEventAttributes","timerCanceledEventAttributes","markerRecordedEventAttributes","workflowExecutionSignaledEventAttributes","workflowExecutionTerminatedEventAttributes","workflowExecutionUpdateAdmittedEventAttributes","workflowExecutionUpdateAcceptedEventAttributes","workflowExecutionUpdateCompletedEventAttributes","workflowExecutionUpdateRejectedEventAttributes","workflowExecutionCancelRequestedEventAttributes","workflowExecutionCanceledEventAttributes","requestCancelExternalWorkflowExecutionInitiatedEventAttributes","requestCancelExternalWorkflowExecutionFailedEventAttributes","externalWorkflowExecutionCancelRequestedEventAttributes","workflowExecutionContinuedAsNewEventAttributes","startChildWorkflowExecutionInitiatedEventAttributes","startChildWorkflowExecutionFailedEventAttributes","childWorkflowExecutionStartedEventAttributes","childWorkflowExecutionCompletedEventAttributes","childWorkflowExecutionFailedEventAttributes","childWorkflowExecutionCanceledEventAttributes","childWorkflowExecutionTimedOutEventAttributes","childWorkflowExecutionTerminatedEventAttributes","signalExternalWorkflowExecutionInitiatedEventAttributes","signalExternalWorkflowExecutionFailedEventAttributes","externalWorkflowExecutionSignaledEventAttributes","upsertWorkflowSearchAttributesEventAttributes","nexusOperationScheduledEventAttributes","nexusOperationStartedEventAttributes","nexusOperationCompletedEventAttributes","nexusOperationFailedEventAttributes","nexusOperationCanceledEventAttributes","nexusOperationTimedOutEventAttributes","nexusOperationCancelRequestedEventAttributes","nexusOperationCancelRequestCompletedEventAttributes","nexusOperationCancelRequestFailedEventAttributes","workflowExecutionOptionsUpdatedEventAttributes","workflowPropertiesModifiedEventAttributes"],D=["WorkflowTaskCompleted","WorkflowTaskFailed","WorkflowTaskTimedOut"],V=t=>{for(const o of q)if(o in t)return o},H=(t,o)=>t[o],_=t=>{const o=V(t),n=H(t,o);return{key:o,attributes:n}},i=t=>o=>!!(o!=null&&o[t]),R=i("workflowExecutionStartedEventAttributes"),Rt=i("workflowExecutionCompletedEventAttributes"),St=i("workflowExecutionFailedEventAttributes"),Ft=i("workflowExecutionTimedOutEventAttributes"),It=i("workflowTaskScheduledEventAttributes"),yt=i("workflowTaskStartedEventAttributes"),B=i("workflowTaskCompletedEventAttributes"),ht=i("workflowTaskTimedOutEventAttributes"),S=i("workflowTaskFailedEventAttributes"),gt=t=>{var o,n,r,s;return S(t)&&((n=(o=t.workflowTaskFailedEventAttributes)==null?void 0:o.failure)==null?void 0:n.message)!=="UnhandledCommand"&&!((s=(r=t.workflowTaskFailedEventAttributes)==null?void 0:r.failure)!=null&&s.resetWorkflowFailureInfo)},M=i("activityTaskScheduledEventAttributes"),Y=i("activityTaskStartedEventAttributes"),Lt=i("activityTaskCompletedEventAttributes"),Ut=i("activityTaskFailedEventAttributes"),Nt=i("activityTaskTimedOutEventAttributes"),P=i("timerStartedEventAttributes"),Kt=i("timerFiredEventAttributes"),qt=i("activityTaskCancelRequestedEventAttributes"),Dt=i("activityTaskCanceledEventAttributes"),Vt=i("timerCanceledEventAttributes"),F=i("markerRecordedEventAttributes"),I=i("workflowExecutionOptionsUpdatedEventAttributes"),X=i("workflowExecutionSignaledEventAttributes"),Ht=i("workflowExecutionTerminatedEventAttributes"),_t=i("workflowExecutionCanceledEventAttributes"),Bt=i("workflowExecutionContinuedAsNewEventAttributes"),j=i("startChildWorkflowExecutionInitiatedEventAttributes"),Mt=i("childWorkflowExecutionStartedEventAttributes"),Yt=i("childWorkflowExecutionCompletedEventAttributes"),Pt=i("childWorkflowExecutionFailedEventAttributes"),Xt=i("childWorkflowExecutionCanceledEventAttributes"),jt=i("childWorkflowExecutionTimedOutEventAttributes"),Gt=i("childWorkflowExecutionTerminatedEventAttributes"),Jt=i("signalExternalWorkflowExecutionInitiatedEventAttributes"),Qt=i("signalExternalWorkflowExecutionFailedEventAttributes"),Zt=i("externalWorkflowExecutionSignaledEventAttributes"),G=i("upsertWorkflowSearchAttributesEventAttributes"),$t=t=>D.includes(t.eventType),J=["LocalActivity","core_local_activity"],zt=t=>!(!F(t)||!J.includes(t.markerRecordedEventAttributes.markerName)),Q=i("workflowExecutionUpdateAcceptedEventAttributes"),Z=i("workflowExecutionUpdateRejectedEventAttributes"),$=i("workflowExecutionUpdateCompletedEventAttributes"),te=t=>{var o;return $(t)&&!!((o=t.workflowExecutionUpdateCompletedEventAttributes.outcome)!=null&&o.failure)},z=i("nexusOperationScheduledEventAttributes"),ee=i("nexusOperationStartedEventAttributes"),oe=i("nexusOperationCompletedEventAttributes"),ie=i("nexusOperationFailedEventAttributes"),ne=i("nexusOperationCanceledEventAttributes"),re=i("nexusOperationTimedOutEventAttributes"),tt=i("nexusOperationCancelRequestedEventAttributes"),et=t=>t.eventType==="WorkflowTaskFailed",y=t=>t.eventType==="WorkflowTaskTimedOut",ot=t=>t.eventType==="WorkflowTaskCompleted",h=t=>S(t)&&g(t)==="ResetWorkflow",g=t=>{var r;if(y(t))return"WorkflowTaskTimedOut";const{workflowTaskFailedEventAttributes:{failure:o,cause:n}={}}=t;return((r=o==null?void 0:o.applicationFailureInfo)==null?void 0:r.type)==="workflowTaskHeartbeatError"?"WorkflowTaskHeartbeatError":L(n)},O=t=>{const o=t.findIndex(et),n=t.findIndex(y),r=o<0?n:o;if(r<0)return;const s=t.findIndex(ot),u=t[r];if(g(u)!=="ResetWorkflow"&&(s<0||r<s))return u},se=(t,o)=>{if(o==="descending")return O(t);{const n=[...t].reverse();return O(n)}},it=(t,o)=>{var n,r,s,u,c,E,f,k,w,T,v,A,d;try{if(R(t)){const a=(n=t.attributes)==null?void 0:n.firstExecutionRunId,l=(r=t.attributes)==null?void 0:r.originalExecutionRunId;return a===l&&((c=(u=(s=t.attributes)==null?void 0:s.searchAttributes)==null?void 0:u.indexedFields)==null?void 0:c.TemporalScheduledById)?3:1}if(M(t)||P(t)||X(t)&&t.id!=="2"||z(t)||tt(t)||Q(t)||Z(t)||I(t))return 1;if(G(t)){const a=Object.keys(t.attributes.searchAttributes.indexedFields);return(a==null?void 0:a.length)===1&&((k=(f=(E=t.attributes)==null?void 0:E.searchAttributes)==null?void 0:f.indexedFields)!=null&&k.TemporalChangeVersion)?0:1}if(F(t)){if(["core_patch","Version"].includes((w=t==null?void 0:t.attributes)==null?void 0:w.markerName))return 0;const l=(T=t.attributes)==null?void 0:T.workflowTaskCompletedEventId;if(l&&o)return o.has(String(l))?0:(o.add(String(l)),1);if(l)return 1}return h(t)?1:j(t)?2:Y(t)?(((v=t.attributes)==null?void 0:v.attempt)||1)-1:B(t)?Math.min(((d=(A=t.attributes)==null?void 0:A.meteringMetadata)==null?void 0:d.nonfirstLocalActivityExecutionAttempts)||0,100):0}catch{return 0}},e={ACTIVITY:"activity",CHILD_WORKFLOW:"child-workflow",LOCAL_ACTIVITY:"local-activity",NEXUS:"nexus",SIGNAL:"signal",TIMER:"timer",UPDATE:"update",WORKFLOW:"workflow",OTHER:"other"},p={ActivityTaskCanceled:e.ACTIVITY,ActivityTaskCancelRequested:e.ACTIVITY,ActivityTaskCompleted:e.ACTIVITY,ActivityTaskFailed:e.ACTIVITY,ActivityTaskScheduled:e.ACTIVITY,ActivityTaskStarted:e.ACTIVITY,ActivityTaskTimedOut:e.ACTIVITY,ChildWorkflowExecutionCanceled:e.CHILD_WORKFLOW,ChildWorkflowExecutionCompleted:e.CHILD_WORKFLOW,ChildWorkflowExecutionFailed:e.CHILD_WORKFLOW,ChildWorkflowExecutionStarted:e.CHILD_WORKFLOW,ChildWorkflowExecutionTerminated:e.CHILD_WORKFLOW,ChildWorkflowExecutionTimedOut:e.CHILD_WORKFLOW,StartChildWorkflowExecutionFailed:e.CHILD_WORKFLOW,StartChildWorkflowExecutionInitiated:e.CHILD_WORKFLOW,SignalExternalWorkflowExecutionFailed:e.SIGNAL,SignalExternalWorkflowExecutionInitiated:e.SIGNAL,WorkflowExecutionSignaled:e.SIGNAL,ExternalWorkflowExecutionSignaled:e.SIGNAL,TimerCanceled:e.TIMER,TimerFired:e.TIMER,TimerStarted:e.TIMER,WorkflowExecutionCanceled:e.WORKFLOW,WorkflowExecutionCancelRequested:e.WORKFLOW,WorkflowExecutionCompleted:e.WORKFLOW,WorkflowExecutionContinuedAsNew:e.WORKFLOW,WorkflowExecutionFailed:e.WORKFLOW,WorkflowExecutionStarted:e.WORKFLOW,WorkflowExecutionTerminated:e.WORKFLOW,WorkflowExecutionTimedOut:e.WORKFLOW,WorkflowExecutionOptionsUpdated:e.WORKFLOW,WorkflowTaskCompleted:e.WORKFLOW,WorkflowTaskFailed:e.WORKFLOW,WorkflowTaskScheduled:e.WORKFLOW,WorkflowTaskStarted:e.WORKFLOW,WorkflowTaskTimedOut:e.WORKFLOW,ExternalWorkflowExecutionCancelRequested:e.WORKFLOW,RequestCancelExternalWorkflowExecutionFailed:e.WORKFLOW,RequestCancelExternalWorkflowExecutionInitiated:e.WORKFLOW,WorkflowExecutionUpdateAccepted:e.UPDATE,WorkflowExecutionUpdateCompleted:e.UPDATE,WorkflowExecutionUpdateRequested:e.UPDATE,WorkflowExecutionUpdateRejected:e.UPDATE,WorkflowExecutionUpdateAdmitted:e.UPDATE,NexusOperationScheduled:e.NEXUS,NexusOperationStarted:e.NEXUS,NexusOperationCompleted:e.NEXUS,NexusOperationFailed:e.NEXUS,NexusOperationCanceled:e.NEXUS,NexusOperationTimedOut:e.NEXUS,NexusOperationCancelRequested:e.NEXUS,NexusOperationCancelRequestCompleted:e.NEXUS,NexusOperationCancelRequestFailed:e.NEXUS,MarkerRecorded:e.OTHER,UpsertWorkflowSearchAttributes:e.OTHER,WorkflowPropertiesModified:e.OTHER},nt=[{label:"events.category.activity",value:e.ACTIVITY,description:"events.category.activity-tooltip"},{label:"events.category.child-workflow",value:e.CHILD_WORKFLOW,description:"events.category.child-workflow-tooltip"},{label:"events.category.local-activity",value:e.LOCAL_ACTIVITY,description:"events.category.local-activity-tooltip"},{label:"events.category.signal",value:e.SIGNAL,description:"events.category.signal-tooltip"},{label:"events.category.timer",value:e.TIMER,description:"events.category.timer-tooltip"},{label:"events.category.update",value:e.UPDATE,description:"events.category.update-tooltip"},{label:"events.category.nexus",value:e.NEXUS,description:"events.category.nexus-tooltip"},{label:"events.category.workflow",value:e.WORKFLOW,description:"events.category.workflow-tooltip"},{label:"events.category.other",value:e.OTHER,description:"events.category.other-tooltip"}],rt=[e.ACTIVITY,e.LOCAL_ACTIVITY,e.CHILD_WORKFLOW,e.SIGNAL,e.TIMER,e.UPDATE,e.NEXUS,e.OTHER],ae=nt.filter(({value:t})=>rt.includes(t)),st=t=>(p==null?void 0:p[t])||e.OTHER,at=["Unspecified","Scheduled","Open","New","Started","Initiated","Running","Completed","Fired","CancelRequested","TimedOut","Signaled","Canceled","Failed","Terminated"],lt=t=>{if(typeof t=="number")return"Unspecified";if(t.includes("RequestCancel"))return"CancelRequested";for(const o of at)if(t.includes(o))return o;return"Unspecified"},ut=["closeTime","createTime","currentAttemptScheduledTime","earliestTime","eventTime","executionTime","expirationTime","expireTime","lastAccessTime","lastHeartbeatTime","lastStartedTime","lastUpdateTime","latestTime","releaseTime","scheduledTime","startedTime","startTime","workflowExecutionExpirationTime"],ct=["backoffStartInterval","defaultWorkflowTaskTimeout","firstWorkflowTaskBackoff","heartbeatTimeout","initialInterval","maximumInterval","scheduleToCloseTimeout","scheduleToStartTimeout","startToCloseTimeout","startToFireTimeout","workflowExecutionRetentionPeriod","workflowExecutionRetentionTtl","workflowExecutionTimeout","workflowRunTimeout","workflowTaskTimeout"],dt=t=>{for(const o of ut)if(o===t)return!0;return!1},Et=t=>{for(const o of ct)if(o===t)return!0;return!1},ft=t=>{if(t===null||t===void 0||typeof t!="object")return!1;const o=Object.keys(t),[n]=o;return!(o.length!==1||typeof t[n]!="string")},kt=t=>{for(const o of Object.values(t))return o};function wt(t,o=!1){for(const[n,r]of Object.entries(t))ft(r)&&(t[n]=kt(r)),dt(n)&&!o&&(t[n]=C(r)),Et(n)&&(t[n]=K(r)),n==="versioningBehavior"&&(t[n]=U(r,"VersioningBehavior"));return W(t,"workerVersion")&&W(t,"deploymentVersion")&&delete t.workerVersion,t}const Tt=(t,o=()=>!1,n)=>({...t,billableActions:o(t)?0:it(t,n)}),vt=(t,o={})=>{var d,a,l,m,x,b;const n=String(t.eventId),r=N(t.eventType),s=C(String(t.eventTime)),u=lt(r),c=st(r),{key:E,attributes:f}=_(t),k=R(t)&&((l=(a=(d=t.workflowExecutionStartedEventAttributes)==null?void 0:d.completionCallbacks)==null?void 0:a[0])==null?void 0:l.links),w=I(t)&&((b=(x=(m=t.workflowExecutionOptionsUpdatedEventAttributes)==null?void 0:m.attachedCompletionCallbacks)==null?void 0:x[0])==null?void 0:b.links),T=k||w,v=(t==null?void 0:t.links)||T||[],A={...t,name:r,id:n,eventType:r,timestamp:s,classification:u,category:c,links:v,billableActions:0,attributes:wt({type:E,...f})};return Tt(A,o.shouldNotAddBillableAction,o.processedWorkflowTaskIds)},le=t=>{const o=t.findLast(h),n=s=>o?Number(s.id)<Number(o.eventId):!1,r=new Set;return t.map(s=>vt(s,{shouldNotAddBillableAction:n,processedWorkflowTaskIds:r}))},ue=t=>t===null||typeof t!="object"||Array.isArray(t)?!1:!!W(t,"eventType"),ce=t=>{const o={...t};return delete o.name,delete o.id,delete o.timestamp,delete o.classification,delete o.category,delete o.attributes,o};export{y as $,gt as A,Qt as B,te as C,ie as D,re as E,Y as F,qt as G,Lt as H,Mt as I,Kt as J,$ as K,Zt as L,yt as M,B as N,S as O,ee as P,oe as Q,P as R,Jt as S,X as T,F as U,j as V,It as W,wt as X,ae as Y,g as Z,et as _,I as a,Bt as a0,Rt as a1,se as a2,Yt as b,Pt as c,Xt as d,jt as e,Gt as f,ue as g,zt as h,R as i,Q as j,z as k,nt as l,$t as m,ce as n,M as o,Ht as p,Dt as q,Vt as r,_t as s,le as t,ne as u,Nt as v,Ut as w,St as x,Ft as y,ht as z};
