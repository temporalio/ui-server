import"./VIlvvhXR.js";import"./CfEHZ0Oq.js";import"./BUApaBEI.js";import"./DAcYyk2F.js";import"./_5ilsK-u.js";import"./CQCt9_hv.js";import"./DMvnBdKo.js";import{h as b}from"./BJzbPR4R.js";import{f as O}from"./DGYYVAig.js";import{e as L,f as U,g as N}from"./DNNVWk-J.js";import{l as K}from"./CtQjrHKC.js";const q=["workflowExecutionStartedEventAttributes","workflowExecutionCompletedEventAttributes","workflowExecutionFailedEventAttributes","workflowExecutionTimedOutEventAttributes","workflowExecutionOptionsUpdatedEventAttributes","workflowTaskStartedEventAttributes","workflowTaskScheduledEventAttributes","workflowTaskCompletedEventAttributes","workflowTaskTimedOutEventAttributes","workflowTaskFailedEventAttributes","activityTaskScheduledEventAttributes","activityTaskCompletedEventAttributes","activityTaskStartedEventAttributes","activityTaskFailedEventAttributes","activityTaskTimedOutEventAttributes","timerStartedEventAttributes","timerFiredEventAttributes","activityTaskCancelRequestedEventAttributes","activityTaskCanceledEventAttributes","timerCanceledEventAttributes","markerRecordedEventAttributes","workflowExecutionSignaledEventAttributes","workflowExecutionTerminatedEventAttributes","workflowExecutionUpdateAdmittedEventAttributes","workflowExecutionUpdateAcceptedEventAttributes","workflowExecutionUpdateCompletedEventAttributes","workflowExecutionUpdateRejectedEventAttributes","workflowExecutionCancelRequestedEventAttributes","workflowExecutionCanceledEventAttributes","requestCancelExternalWorkflowExecutionInitiatedEventAttributes","requestCancelExternalWorkflowExecutionFailedEventAttributes","externalWorkflowExecutionCancelRequestedEventAttributes","workflowExecutionContinuedAsNewEventAttributes","startChildWorkflowExecutionInitiatedEventAttributes","startChildWorkflowExecutionFailedEventAttributes","childWorkflowExecutionStartedEventAttributes","childWorkflowExecutionCompletedEventAttributes","childWorkflowExecutionFailedEventAttributes","childWorkflowExecutionCanceledEventAttributes","childWorkflowExecutionTimedOutEventAttributes","childWorkflowExecutionTerminatedEventAttributes","signalExternalWorkflowExecutionInitiatedEventAttributes","signalExternalWorkflowExecutionFailedEventAttributes","externalWorkflowExecutionSignaledEventAttributes","upsertWorkflowSearchAttributesEventAttributes","nexusOperationScheduledEventAttributes","nexusOperationStartedEventAttributes","nexusOperationCompletedEventAttributes","nexusOperationFailedEventAttributes","nexusOperationCanceledEventAttributes","nexusOperationTimedOutEventAttributes","nexusOperationCancelRequestedEventAttributes","nexusOperationCancelRequestCompletedEventAttributes","nexusOperationCancelRequestFailedEventAttributes","workflowExecutionOptionsUpdatedEventAttributes","workflowPropertiesModifiedEventAttributes"],D=["WorkflowTaskCompleted","WorkflowTaskFailed","WorkflowTaskTimedOut"],H=t=>{for(const o of q)if(o in t)return o},V=(t,o)=>t[o],_=t=>{const o=H(t),n=V(t,o);return{key:o,attributes:n}},i=t=>o=>!!(o!=null&&o[t]),C=i("workflowExecutionStartedEventAttributes"),yt=i("workflowExecutionCompletedEventAttributes"),ht=i("workflowExecutionFailedEventAttributes"),gt=i("workflowExecutionTimedOutEventAttributes"),Lt=i("workflowTaskScheduledEventAttributes"),Ut=i("workflowTaskStartedEventAttributes"),B=i("workflowTaskCompletedEventAttributes"),Nt=i("workflowTaskTimedOutEventAttributes"),R=i("workflowTaskFailedEventAttributes"),Kt=t=>{var o,n,r,s;return R(t)&&((n=(o=t.workflowTaskFailedEventAttributes)==null?void 0:o.failure)==null?void 0:n.message)!=="UnhandledCommand"&&!((s=(r=t.workflowTaskFailedEventAttributes)==null?void 0:r.failure)!=null&&s.resetWorkflowFailureInfo)},M=i("activityTaskScheduledEventAttributes"),Y=i("activityTaskStartedEventAttributes"),qt=i("activityTaskCompletedEventAttributes"),Dt=i("activityTaskFailedEventAttributes"),Ht=i("activityTaskTimedOutEventAttributes"),P=i("timerStartedEventAttributes"),Vt=i("timerFiredEventAttributes"),_t=i("activityTaskCancelRequestedEventAttributes"),Bt=i("activityTaskCanceledEventAttributes"),Mt=i("timerCanceledEventAttributes"),S=i("markerRecordedEventAttributes"),F=i("workflowExecutionOptionsUpdatedEventAttributes"),X=i("workflowExecutionSignaledEventAttributes"),Yt=i("workflowExecutionTerminatedEventAttributes"),Pt=i("workflowExecutionCanceledEventAttributes"),Xt=i("workflowExecutionContinuedAsNewEventAttributes"),j=i("startChildWorkflowExecutionInitiatedEventAttributes"),jt=i("childWorkflowExecutionStartedEventAttributes"),Gt=i("childWorkflowExecutionCompletedEventAttributes"),Jt=i("childWorkflowExecutionFailedEventAttributes"),Qt=i("childWorkflowExecutionCanceledEventAttributes"),Zt=i("childWorkflowExecutionTimedOutEventAttributes"),$t=i("childWorkflowExecutionTerminatedEventAttributes"),zt=i("signalExternalWorkflowExecutionInitiatedEventAttributes"),te=i("signalExternalWorkflowExecutionFailedEventAttributes"),ee=i("externalWorkflowExecutionSignaledEventAttributes"),G=i("upsertWorkflowSearchAttributesEventAttributes"),oe=t=>D.includes(t.eventType),J=["LocalActivity","core_local_activity"],ie=t=>!(!S(t)||!J.includes(t.markerRecordedEventAttributes.markerName)),Q=i("workflowExecutionUpdateAcceptedEventAttributes"),Z=i("workflowExecutionUpdateRejectedEventAttributes"),$=i("workflowExecutionUpdateCompletedEventAttributes"),ne=t=>{var o;return $(t)&&!!((o=t.workflowExecutionUpdateCompletedEventAttributes.outcome)!=null&&o.failure)},z=i("nexusOperationScheduledEventAttributes"),re=i("nexusOperationStartedEventAttributes"),se=i("nexusOperationCompletedEventAttributes"),ae=i("nexusOperationFailedEventAttributes"),le=i("nexusOperationCanceledEventAttributes"),ue=i("nexusOperationTimedOutEventAttributes"),tt=i("nexusOperationCancelRequestedEventAttributes"),et=t=>t.eventType==="WorkflowTaskFailed",I=t=>t.eventType==="WorkflowTaskTimedOut",ot=t=>t.eventType==="WorkflowTaskCompleted",y=t=>R(t)&&h(t)==="ResetWorkflow",h=t=>{var r;if(I(t))return"WorkflowTaskTimedOut";const{workflowTaskFailedEventAttributes:{failure:o,cause:n}={}}=t;return((r=o==null?void 0:o.applicationFailureInfo)==null?void 0:r.type)==="workflowTaskHeartbeatError"?"WorkflowTaskHeartbeatError":L(n)},it=t=>{const o=t.findIndex(et),n=t.findIndex(I),r=o<0?n:o;if(r<0)return;const s=t.findIndex(ot),u=t[r];if(h(u)!=="ResetWorkflow"&&(s<0||r<s))return u},ce=(t,o)=>{{const n=[...t].reverse();return it(n)}},nt=(t,o)=>{var n,r,s,u,c,f,k,w,T,v,A,m,d,E;try{if(C(t)){const a=((n=t.attributes)==null?void 0:n.attempt)||1,l=(r=t.attributes)==null?void 0:r.firstExecutionRunId,p=(s=t.attributes)==null?void 0:s.originalExecutionRunId,g=l===p&&((f=(c=(u=t.attributes)==null?void 0:u.searchAttributes)==null?void 0:c.indexedFields)==null?void 0:f.TemporalScheduledById);return a>1?0:g?3:1}if(M(t)||P(t)||X(t)&&t.id!=="2"||z(t)||tt(t)||Q(t)||Z(t)||F(t))return 1;if(G(t)){const a=Object.keys(t.attributes.searchAttributes.indexedFields);return(a==null?void 0:a.length)===1&&((T=(w=(k=t.attributes)==null?void 0:k.searchAttributes)==null?void 0:w.indexedFields)!=null&&T.TemporalChangeVersion)?0:1}if(S(t)){if(["core_patch","Version"].includes((v=t==null?void 0:t.attributes)==null?void 0:v.markerName))return 0;const l=(A=t.attributes)==null?void 0:A.workflowTaskCompletedEventId;if(l&&o)return o.has(String(l))?0:(o.add(String(l)),1);if(l)return 1}return y(t)||j(t)?1:Y(t)?(((m=t.attributes)==null?void 0:m.attempt)||1)-1:B(t)?Math.min(((E=(d=t.attributes)==null?void 0:d.meteringMetadata)==null?void 0:E.nonfirstLocalActivityExecutionAttempts)||0,100):0}catch{return 0}},e={ACTIVITY:"activity",CHILD_WORKFLOW:"child-workflow",LOCAL_ACTIVITY:"local-activity",NEXUS:"nexus",SIGNAL:"signal",TIMER:"timer",UPDATE:"update",WORKFLOW:"workflow",OTHER:"other"},W={ActivityTaskCanceled:e.ACTIVITY,ActivityTaskCancelRequested:e.ACTIVITY,ActivityTaskCompleted:e.ACTIVITY,ActivityTaskFailed:e.ACTIVITY,ActivityTaskScheduled:e.ACTIVITY,ActivityTaskStarted:e.ACTIVITY,ActivityTaskTimedOut:e.ACTIVITY,ChildWorkflowExecutionCanceled:e.CHILD_WORKFLOW,ChildWorkflowExecutionCompleted:e.CHILD_WORKFLOW,ChildWorkflowExecutionFailed:e.CHILD_WORKFLOW,ChildWorkflowExecutionStarted:e.CHILD_WORKFLOW,ChildWorkflowExecutionTerminated:e.CHILD_WORKFLOW,ChildWorkflowExecutionTimedOut:e.CHILD_WORKFLOW,StartChildWorkflowExecutionFailed:e.CHILD_WORKFLOW,StartChildWorkflowExecutionInitiated:e.CHILD_WORKFLOW,SignalExternalWorkflowExecutionFailed:e.SIGNAL,SignalExternalWorkflowExecutionInitiated:e.SIGNAL,WorkflowExecutionSignaled:e.SIGNAL,ExternalWorkflowExecutionSignaled:e.SIGNAL,TimerCanceled:e.TIMER,TimerFired:e.TIMER,TimerStarted:e.TIMER,WorkflowExecutionCanceled:e.WORKFLOW,WorkflowExecutionCancelRequested:e.WORKFLOW,WorkflowExecutionCompleted:e.WORKFLOW,WorkflowExecutionContinuedAsNew:e.WORKFLOW,WorkflowExecutionFailed:e.WORKFLOW,WorkflowExecutionStarted:e.WORKFLOW,WorkflowExecutionTerminated:e.WORKFLOW,WorkflowExecutionTimedOut:e.WORKFLOW,WorkflowExecutionOptionsUpdated:e.WORKFLOW,WorkflowTaskCompleted:e.WORKFLOW,WorkflowTaskFailed:e.WORKFLOW,WorkflowTaskScheduled:e.WORKFLOW,WorkflowTaskStarted:e.WORKFLOW,WorkflowTaskTimedOut:e.WORKFLOW,ExternalWorkflowExecutionCancelRequested:e.WORKFLOW,RequestCancelExternalWorkflowExecutionFailed:e.WORKFLOW,RequestCancelExternalWorkflowExecutionInitiated:e.WORKFLOW,WorkflowExecutionUpdateAccepted:e.UPDATE,WorkflowExecutionUpdateCompleted:e.UPDATE,WorkflowExecutionUpdateRequested:e.UPDATE,WorkflowExecutionUpdateRejected:e.UPDATE,WorkflowExecutionUpdateAdmitted:e.UPDATE,NexusOperationScheduled:e.NEXUS,NexusOperationStarted:e.NEXUS,NexusOperationCompleted:e.NEXUS,NexusOperationFailed:e.NEXUS,NexusOperationCanceled:e.NEXUS,NexusOperationTimedOut:e.NEXUS,NexusOperationCancelRequested:e.NEXUS,NexusOperationCancelRequestCompleted:e.NEXUS,NexusOperationCancelRequestFailed:e.NEXUS,MarkerRecorded:e.OTHER,UpsertWorkflowSearchAttributes:e.OTHER,WorkflowPropertiesModified:e.OTHER},rt=[{label:"events.category.activity",value:e.ACTIVITY,description:"events.category.activity-tooltip"},{label:"events.category.child-workflow",value:e.CHILD_WORKFLOW,description:"events.category.child-workflow-tooltip"},{label:"events.category.local-activity",value:e.LOCAL_ACTIVITY,description:"events.category.local-activity-tooltip"},{label:"events.category.signal",value:e.SIGNAL,description:"events.category.signal-tooltip"},{label:"events.category.timer",value:e.TIMER,description:"events.category.timer-tooltip"},{label:"events.category.update",value:e.UPDATE,description:"events.category.update-tooltip"},{label:"events.category.nexus",value:e.NEXUS,description:"events.category.nexus-tooltip"},{label:"events.category.workflow",value:e.WORKFLOW,description:"events.category.workflow-tooltip"},{label:"events.category.other",value:e.OTHER,description:"events.category.other-tooltip"}],st=[e.ACTIVITY,e.LOCAL_ACTIVITY,e.CHILD_WORKFLOW,e.SIGNAL,e.TIMER,e.UPDATE,e.NEXUS,e.OTHER],de=rt.filter(({value:t})=>st.includes(t)),at=t=>(W==null?void 0:W[t])||e.OTHER,lt=["Unspecified","Scheduled","Open","New","Started","Initiated","Running","Completed","Fired","CancelRequested","TimedOut","Signaled","Canceled","Failed","Terminated"],ut=t=>{if(typeof t=="number")return"Unspecified";if(t.includes("RequestCancel"))return"CancelRequested";for(const o of lt)if(t.includes(o))return o;return"Unspecified"},ct=["closeTime","createTime","currentAttemptScheduledTime","earliestTime","eventTime","executionTime","expirationTime","expireTime","lastAccessTime","lastHeartbeatTime","lastStartedTime","lastUpdateTime","latestTime","releaseTime","scheduledTime","startedTime","startTime","workflowExecutionExpirationTime"],dt=["backoffStartInterval","defaultWorkflowTaskTimeout","firstWorkflowTaskBackoff","heartbeatTimeout","initialInterval","maximumInterval","scheduleToCloseTimeout","scheduleToStartTimeout","startToCloseTimeout","startToFireTimeout","workflowExecutionRetentionPeriod","workflowExecutionRetentionTtl","workflowExecutionTimeout","workflowRunTimeout","workflowTaskTimeout"],Et=t=>{for(const o of ct)if(o===t)return!0;return!1},ft=t=>{for(const o of dt)if(o===t)return!0;return!1},kt=t=>{if(t===null||t===void 0||typeof t!="object")return!1;const o=Object.keys(t),[n]=o;return!(o.length!==1||typeof t[n]!="string")},wt=t=>{for(const o of Object.values(t))return o};function Tt(t,o=!1){for(const[n,r]of Object.entries(t))kt(r)&&(t[n]=wt(r)),Et(n)&&!o&&(t[n]=O(r)),ft(n)&&(t[n]=K(r)),n==="versioningBehavior"&&(t[n]=U(r,"VersioningBehavior"));return b(t,"workerVersion")&&b(t,"deploymentVersion")&&delete t.workerVersion,t}const vt=(t,o=()=>!1,n)=>({...t,billableActions:o(t)?0:nt(t,n)}),At=(t,o={})=>{var d,E,a,l,p,x;const n=String(t.eventId),r=N(t.eventType),s=O(String(t.eventTime)),u=ut(r),c=at(r),{key:f,attributes:k}=_(t),w=C(t)&&((a=(E=(d=t.workflowExecutionStartedEventAttributes)==null?void 0:d.completionCallbacks)==null?void 0:E[0])==null?void 0:a.links),T=F(t)&&((x=(p=(l=t.workflowExecutionOptionsUpdatedEventAttributes)==null?void 0:l.attachedCompletionCallbacks)==null?void 0:p[0])==null?void 0:x.links),v=w||T,A=(t==null?void 0:t.links)||v||[],m={...t,name:r,id:n,eventType:r,timestamp:s,classification:u,category:c,links:A,billableActions:0,attributes:Tt({type:f,...k})};return vt(m,o.shouldNotAddBillableAction,o.processedWorkflowTaskIds)},Ee=t=>{const o=t.findLast(y),n=s=>o?Number(s.id)<Number(o.eventId):!1,r=new Set;return t.map(s=>At(s,{shouldNotAddBillableAction:n,processedWorkflowTaskIds:r}))},fe=t=>t===null||typeof t!="object"||Array.isArray(t)?!1:!!b(t,"eventType"),ke=t=>{const o={...t};return delete o.name,delete o.id,delete o.timestamp,delete o.classification,delete o.category,delete o.attributes,o};export{et as $,Kt as A,te as B,ne as C,ae as D,ue as E,Y as F,_t as G,qt as H,jt as I,Vt as J,$ as K,ee as L,Ut as M,B as N,R as O,re as P,se as Q,P as R,zt as S,X as T,S as U,j as V,Lt as W,Tt as X,de as Y,h as Z,I as _,F as a,Xt as a0,yt as a1,ce as a2,Gt as b,Jt as c,Qt as d,Zt as e,$t as f,fe as g,ie as h,C as i,Q as j,z as k,rt as l,oe as m,ke as n,M as o,Yt as p,Bt as q,Mt as r,Pt as s,Ee as t,le as u,Ht as v,Dt as w,ht as x,gt as y,Nt as z};
