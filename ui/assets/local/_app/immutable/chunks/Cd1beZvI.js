import"./CWj6FrbW.js";import"./69_IOA4Y.js";import{p as tt,s as a,R as l,l as $,a as et,g as e,r as G,b as ot,m as w,ag as st,f as rt,e as at,d as nt}from"./Dv5jDC8Z.js";import{e as ct}from"./C1S4hUbu.js";import{a as E,t as Y,c as ut}from"./BM_uyzAk.js";import{i as lt}from"./FbCjvpNA.js";import{e as it}from"./CocFUsaO.js";import{i as ft}from"./CM2QeVoh.js";import{p as mt}from"./BbkaS_Cl.js";import{e as q,s as pt,a as i,b as dt}from"./CEr_ApTH.js";import{a as wt}from"./s0RhsljA.js";import{p as ht}from"./DOVEQzNU.js";import{S as vt}from"./BQyy25vA.js";import{w as C,q as gt,r as kt,b as D,d as yt}from"./yf0qLZuI.js";import{w as K}from"./BndDmdxX.js";import{c as _t}from"./Debgsfec.js";import{S as xt}from"./CDGKmauG.js";import{g as N}from"./DTyNo3th.js";import{t as Ct,c as St}from"./DqLcwcH9.js";import{u as Wt}from"./mpeXi1Gu.js";import{W as It}from"./uFOGAOV_.js";const O=(h,v,s)=>{const f=Math.pow(3600/h,1/s),g=h*Math.pow(f,v);return Math.min(3600,Math.round(g))};var bt=Y("<button><!></button>"),$t=Y('<div class="flex min-h-[24px] flex-wrap items-center gap-2"></div>');function Jt(h,v){tt(v,!1);const[s,F]=pt(),f=()=>i(ht,"$page",s),g=()=>i(gt,"$queryWithParentWorkflowId",s),r=()=>i(C,"$workflowCount",s),H=()=>i(yt,"$disableWorkflowCountsRefresh",s),S=()=>i(K,"$workflowFilters",s),P=()=>i(kt,"$refresh",s),m=w(),p=w();let R=mt(v,"staticQuery",8,""),B=w([]),k=w([]),y,d=1,_=w(!1);const Q=5,W=100;wt(()=>{A()});const L=()=>{if(d+=1,clearInterval(y),d<=W){const t=O(Q,d,W)*1e3;y=setInterval(()=>M(),t)}},A=()=>{clearInterval(y),a(k,[]),q(C,l(r).newCount=0,l(r)),d=1,a(_,!0)},M=async()=>{L();try{const{count:t,groups:o}=await D({namespace:e(m),query:e(p)});q(C,l(r).newCount=parseInt(t)-r().count,l(r)),a(k,N(o))}catch(t){console.error("Fetching workflow counts failed: ",t==null?void 0:t.message)}finally{a(_,!1)}},U=async()=>{if(A(),!H()){const t=O(Q,d,W)*1e3;y=setInterval(()=>M(),t)}try{const{count:t,groups:o}=await D({namespace:e(m),query:e(p)});q(C,l(r).count=parseInt(t),l(r)),a(B,N(o))}catch(t){console.error("Fetching workflow counts failed: ",t==null?void 0:t.message)}finally{a(_,!1)}},j=t=>{if(!S().some(n=>n.attribute==="ExecutionStatus"&&n.value===t)){const n={attribute:"ExecutionStatus",type:xt.KEYWORD,value:t,operator:"",conditional:"=",parenthesis:""};dt(K,[...S(),n]);const c=Ct(St(S()));Wt({url:f().url,parameter:"query",value:c,clearParameters:[_t]})}};$(()=>f(),()=>{a(m,f().params.namespace)}),$(()=>(st(R()),g()),()=>{a(p,R()||g())}),$(()=>(e(p),e(m),P()),()=>{e(p),e(m),P(),U()}),et(),ft();var I=$t();it(I,5,()=>e(B),({count:t,status:o})=>o,(t,o)=>{let n=()=>e(o).count,c=()=>e(o).status;var T=ut(),z=rt(T);{var J=u=>{var x=bt(),X=at(x);const Z=nt(()=>e(k).find(b=>b.status===c())?e(k).find(b=>b.status===c()).count-n():0);It(X,{get status(){return c()},get count(){return n()},get newCount(){return e(Z)},get"test-id"(){return`workflow-status-${c()??""}`}}),G(x),ct("click",x,()=>j(c())),E(u,x)},V=u=>{vt(u,{class:"h-6 w-24 rounded-sm"})};lt(z,u=>{e(_)?u(V,!1):u(J)})}E(t,T)}),G(I),E(h,I),ot(),F()}export{Jt as W};
