import{B as l}from"./CoG0geaG.js";import{g}from"./DEsUSA2c.js";import{w as R,g as I}from"./r33Ll6et.js";import{t as C}from"./BTcyvo72.js";import{h as y}from"./BJzbPR4R.js";import{i as O}from"./DRcmmJhF.js";import{u as k,v as F,d as L}from"./BwYKm2xc.js";import{i as W}from"./DPLmpjfv.js";import{p as T}from"./CIjCb9bk.js";const j=R(null),P=(i,n=C,c=j,o=l)=>{if(!(i instanceof DOMException&&i.name==="AbortError"))throw typeof i=="string"?n.push({variant:"error",message:i}):i.report=!1,i instanceof Error&&n.push({variant:"error",message:i.message}),a(i)&&o&&window.location.assign(k(i==null?void 0:i.message)),U(i)&&o&&window.location.assign(k(i==null?void 0:i.message)),O(i)&&(n.push({variant:"error",message:`${i.statusCode} ${i.statusText}`}),c.set(i)),i},tn=(i,n=l)=>{var o;const c=`${i==null?void 0:i.status} ${(o=i==null?void 0:i.body)==null?void 0:o.message}`;if(a(i)&&n){window.location.assign(k(c));return}if(U(i)&&n){window.location.assign(k(c));return}},a=i=>q(i,401),U=i=>q(i,403),q=(i,n)=>y(i,"statusCode")?i.statusCode===n:y(i,"status")?i.status===n:!1,S=15e3,un=async(i,n={})=>{const{params:c={},request:o=fetch,token:u,notifyOnError:s=!0,handleError:t=P,onError:e,isBrowser:v=l}=n;let{options:f}=n,w=new URLSearchParams;if(c!=null&&c.entries)w=c,u&&w.set("nextPageToken",u);else{const h=u?{next_page_token:u}:{};w=new URLSearchParams({...c,...h})}const x=F(i,w);try{f=_(f,v),i.endsWith("api/v1/settings")||(f=await z(f,v));const d=[...w.values()].some(A=>A.length>S)?new Response(JSON.stringify({message:"Query string is too long"}),{status:414,statusText:"URI Too Long"}):await o(x,f),$=await d.json(),{status:N,statusText:E}=d;if(!d.ok)if(e&&W(e))e({status:N,statusText:E,body:$});else throw{statusCode:d.status,statusText:d.statusText,response:d,message:($==null?void 0:$.message)??d.statusText};return $}catch(h){if(s)t(h);else throw h}},_=(i,n=l)=>{const c={credentials:"include",...i};return c.headers=M(i==null?void 0:i.headers,n),c},z=async(i,n=l)=>(globalThis!=null&&globalThis.AccessToken?i.headers=await b(i==null?void 0:i.headers,globalThis.AccessToken,n):g().accessToken&&(i.headers=await b(i==null?void 0:i.headers,async()=>g().accessToken,n),i.headers=J(i==null?void 0:i.headers,g().idToken,n)),i),b=async(i,n,c=l)=>{if(i||(i={}),!c)return i;try{const o=await n();o&&(i.Authorization=`Bearer ${o}`)}catch(o){console.error(o)}return i},J=(i={},n,c=l)=>(c&&n&&(i["Authorization-Extras"]=n),i),M=(i,n=l)=>{if(i||(i={}),i["Caller-Type"]="operator",!n)return i;const c="_csrf=",o="X-CSRF-TOKEN";try{let s=document.cookie.split(";").find(t=>t.includes(c));s&&!i[o]&&(s=s.trim().slice(c.length),i[o]=s)}catch(u){console.error(u)}return i};function B(i=l){const n="",c=!n.startsWith("http");let o="";return c?o=i?window.location.origin+n:"":o=n,o.endsWith("/")&&(o=o.slice(0,-1)),o}const en=(i,n)=>{if(!i||!n)return!1;const[c,o,u]=i.split(".").map(Number),[s,t,e]=n.split(".").map(Number);return c!==s?c>s:o!==t?o>t:u>e},H=(i,n)=>{if(!i||!n)return!1;const[c,o,u]=i.split(".").map(Number),[s,t,e]=n.split(".").map(Number);return c!==s?s>c:o!==t?o===void 0&&t||o===void 0&&t===void 0?!0:t>o:u===void 0&&e||u===void 0&&(e===void 0||isNaN(e))?!0:e>=u},Q=(i,n)=>i?i.replace("%namespace%",n):"",X=i=>{var s,t;let n="";const c=(s=I(T).data)==null?void 0:s.webUrl,o=c&&i,u=((t=globalThis==null?void 0:globalThis.AppConfig)==null?void 0:t.apiUrl)&&i;return o?n=c:u?(console.warn("Using fallback api url, web url not found"),n=Q(globalThis.AppConfig.apiUrl,i)):n=B(),n=`${n}${L("",{})}`,n.endsWith("/")&&(n=n.slice(0,-1)),n},D=i=>(i.startsWith("/")&&(i=i.slice(1)),`/api/v1/${i}`),G=(i,n)=>`${X(n)}${i}`,K=i=>{var c,o,u;const n=(u=(o=(c=I(T))==null?void 0:c.data)==null?void 0:o.settings)==null?void 0:u.version;return Object.keys(i??{}).reduce((s,t)=>(n&&H("2.23.0",n)?s[t]=encodeURIComponent(i[t]):s[t]=encodeURIComponent(encodeURIComponent(i[t])),s),{namespace:"",workflowId:"",scheduleId:"",queue:"",queryType:"",signalName:"",updateName:"",batchJobId:"",runId:"",activityId:"",endpointId:"",deploymentName:"",version:""})};function Y(i,n,c=!0){c&&(n=K(n));const o={systemInfo:"/system-info",cluster:"/cluster-info",namespaces:"/namespaces",namespace:`/namespaces/${n==null?void 0:n.namespace}`,"search-attributes":`/namespaces/${n.namespace}/search-attributes`,"events.raw":`/namespaces/${n==null?void 0:n.namespace}/workflows/${n==null?void 0:n.workflowId}/run/${n==null?void 0:n.runId}/history.json`,"events.ascending":`/namespaces/${n==null?void 0:n.namespace}/workflows/${n==null?void 0:n.workflowId}/history`,"events.descending":`/namespaces/${n==null?void 0:n.namespace}/workflows/${n==null?void 0:n.workflowId}/history-reverse`,query:`/namespaces/${n==null?void 0:n.namespace}/workflows/${n==null?void 0:n.workflowId}/query/${n.queryType}`,schedule:`/namespaces/${n==null?void 0:n.namespace}/schedules/${n==null?void 0:n.scheduleId}`,"schedule.patch":`/namespaces/${n==null?void 0:n.namespace}/schedules/${n==null?void 0:n.scheduleId}/patch`,"schedule.edit":`/namespaces/${n==null?void 0:n.namespace}/schedules/${n==null?void 0:n.scheduleId}/update`,schedules:`/namespaces/${n==null?void 0:n.namespace}/schedules`,settings:"/settings","task-queue":`/namespaces/${n==null?void 0:n.namespace}/task-queues/${n==null?void 0:n.queue}`,"task-queue.compatibility":`/namespaces/${n==null?void 0:n.namespace}/task-queues/${n==null?void 0:n.queue}/worker-build-id-compatibility`,"task-queue.rules":`/namespaces/${n==null?void 0:n.namespace}/task-queues/${n==null?void 0:n.queue}/worker-versioning-rules`,user:"/me","worker-task-reachability":`/namespaces/${n==null?void 0:n.namespace}/worker-task-reachability`,"workflow.terminate":`/namespaces/${n==null?void 0:n.namespace}/workflows/${n==null?void 0:n.workflowId}/terminate`,"workflow.cancel":`/namespaces/${n.namespace}/workflows/${n.workflowId}/cancel`,"workflow.signal":`/namespaces/${n.namespace}/workflows/${n.workflowId}/signal/${n.signalName}`,"workflow.update":`/namespaces/${n.namespace}/workflows/${n.workflowId}/update/${n.updateName}`,"workflow.reset":`/namespaces/${n.namespace}/workflows/${n.workflowId}/reset`,workflow:`/namespaces/${n==null?void 0:n.namespace}/workflows/${n==null?void 0:n.workflowId}`,workflows:`/namespaces/${n==null?void 0:n.namespace}/workflows`,"workflows.archived":`/namespaces/${n==null?void 0:n.namespace}/archived-workflows`,"workflows.count":`/namespaces/${n==null?void 0:n.namespace}/workflow-count`,"activity.complete":`/namespaces/${n.namespace}/activities/complete-by-id`,"activity.fail":`/namespaces/${n.namespace}/activities/fail-by-id`,"activity.pause":`/namespaces/${n.namespace}/activities/pause`,"activity.unpause":`/namespaces/${n.namespace}/activities/unpause`,"activity.reset":`/namespaces/${n.namespace}/activities/reset`,"activity.update-options":`/namespaces/${n.namespace}/activities/update-options`,"batch-operations.list":`/namespaces/${n.namespace}/batch-operations`,"batch-operations":`/namespaces/${n.namespace}/batch-operations/${n==null?void 0:n.batchJobId}`,"nexus-endpoints":"/nexus/endpoints","nexus-endpoint":`/nexus/endpoints/${n.endpointId}`,"nexus-endpoint.update":`/nexus/endpoints/${n.endpointId}/update`,"worker-deployments":`/namespaces/${n.namespace}/worker-deployments`,"worker-deployment":`/namespaces/${n.namespace}/worker-deployments/${n.deploymentName}`,"worker-deployment-version":`/namespaces/${n.namespace}/worker-deployment-versions/${n.version}`,"standalone-activity":`/namespaces/${n.namespace}/activities/${n.activityId}`,"standalone-activities":`/namespaces/${n.namespace}/activities`,"standalone-activities.count":`/namespaces/${n.namespace}/activity-count`,"standalone-activity.cancel":`/namespaces/${n.namespace}/activities/${n.activityId}/cancel`,"standalone-activity.terminate":`/namespaces/${n.namespace}/activities/${n.activityId}/terminate`};return D(o[i])}function ln(i,n,c=!0){const o=Y(i,n,c);return G(o,n==null?void 0:n.namespace)}export{S as M,un as a,X as b,a as c,U as d,tn as e,B as g,P as h,en as i,H as m,Y as p,ln as r};
