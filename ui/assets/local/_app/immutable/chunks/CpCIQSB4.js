import"./Bzak7iHL.js";import"./69_IOA4Y.js";import{p as ze,s as C,m as ae,g as f,l as ne,M as Ne,a as Le,t as se,aH as ke,f as _,c as B,i as J,o as N,r as G,j as ge,e as h,h as D,b as Ae}from"./DOHD4F2H.js";import{e as Ee,s as ue}from"./iKtCZmbp.js";import{i as re}from"./4jpKiR-7.js";import{i as Ke,s as I}from"./DX2YhGcN.js";import{a as Te}from"./BhNSfKsb.js";import{l as fe,p as o,a as Be,s as Fe}from"./CgvkIcHY.js";import{d as Me}from"./CoW5n_Cg.js";import{d as xe,g as Re,w as He,o as Ue}from"./BsnfN2fh.js";import{A as Oe}from"./CK5Z_5Ma.js";import{E as me}from"./CJ-14zUv.js";import{I as ve}from"./DvLoaZ6y.js";import{L as We}from"./BmQYBxoS.js";import{F as je}from"./B9aSI7yF.js";import{p as qe}from"./ZJ0rkuAy.js";import{o as Se,p as Pe,b as Ce,d as Q}from"./CyjWABYi.js";import{c as Je}from"./BDfAQ6r3.js";import{P as Ge}from"./BaUoz9-U.js";const pe={key:Pe,loading:!0,updating:!1,hasNext:!1,hasPrevious:!1,index:0,previousPageSize:Q,pageSize:Q,indexData:{},visibleItems:[],hasNextIndexData:!1,indexStart:0,indexEnd:0,activeIndex:0},he=S=>{const n=S[0];if(!n)return Q;const m=parseInt(n.toString());return isNaN(m)?Q:m},Qe=(S,n=void 0)=>{if(n){const m=parseInt(n.toString());return isNaN(m)?he(S):m}else return he(S)};function Ve(S=Se,n=void 0){const m=xe([qe],([e])=>{const t=e.url.searchParams.get(Pe);return t?Ce(t):void 0}),F=Qe(S,Re(m)||n),M=He({...pe,previousPageSize:F,pageSize:F}),{set:V,update:a}=M,{subscribe:L}=xe([M,m],([e,t])=>{var O,A,W;const l=((O=e.indexData[e.index])==null?void 0:O.items)??[],g=((A=e.indexData[e.index])==null?void 0:A.start)??0,i=((W=e.indexData[e.index])==null?void 0:W.end)??0,Z=!!e.indexData[e.index+1];return{...e,visibleItems:l,indexStart:g,indexEnd:i,hasNextIndexData:Z,pageSize:t??e.pageSize}}),k=(e,t,l)=>{const g=l.index,i={...l,indexData:{...l.indexData},hasNext:!!e,updating:!1,loading:!1};return t.length?(i.indexData[g]?(i.index=g+1,i.indexData[i.index]={nextToken:e,start:i.indexData[g].end+1,end:i.indexData[g].end+t.length,items:t},i.hasPrevious=!0):(i.indexData[g]={nextToken:e,start:1,end:t.length,items:t},i.hasPrevious=!1),i):{...i,hasNext:!1}},X=e=>{var l;const t={...e,index:e.index+1,hasPrevious:!0,loading:!1,updating:!1};return(l=t.indexData[t.index])!=null&&l.nextToken||(t.hasNext=!1),t},Y=e=>{const t={...e,hasNext:!0,updating:!1,loading:!1,index:e.index>0?e.index-1:0};return t.index===0&&(t.hasPrevious=!1),t},w=e=>{var g,i;const t={...e},l=((i=(g=t.indexData[t.index])==null?void 0:g.items)==null?void 0:i.length)??0;return t.activeIndex<l-1&&(t.activeIndex=t.activeIndex+1),t},R=e=>{const t={...e},l=t.activeIndex>=1?t.activeIndex-1:0;return t.activeIndex=l,t},H=(e,t)=>({...e,activeIndex:t}),U=(e,t)=>({...e,pageSize:t,previousPageSize:t,index:0,indexData:{},loading:!0,updating:!1});return{subscribe:L,nextPageWithItems:(e,t)=>a(l=>k(e,t,l)),nextPage:()=>a(e=>X(e)),previousPage:()=>a(e=>Y(e)),setUpdating:()=>a(e=>({...e,updating:!0})),reset:()=>V(pe),resetPageSize:e=>a(t=>U(t,e)),nextRow:()=>a(e=>w(e)),previousRow:()=>a(e=>R(e)),setActiveIndex:e=>a(t=>H(t,e))}}var Xe=se("<p> </p>"),Ye=se('<nav class="flex shrink-0 items-center gap-2" slot="actions-end"><!> <!> <div class="flex gap-1"><p> </p> <!></div> <!></nav>'),Ze=se("<!> <!>",1);function ht(S,n){const m=fe(n,["children","$$slots","$$events","$$legacy"]),F=fe(m,["id","maxHeight","onError","onFetch","onShiftUp","onShiftDown","onSpace","total","pageSizeSelectLabel","emptyStateTitle","emptyStateMessage","errorTitle","errorMessage","itemsKeyname","previousButtonLabel","nextButtonLabel","pageSizeOptions","debounceDelay"]);ze(n,!1);const[M,V]=Fe(),a=()=>Be(u,"$store",M),L=ae(),k=ae();let X=o(n,"id",8,null),Y=o(n,"maxHeight",8,""),w=o(n,"onError",8,void 0),R=o(n,"onFetch",8),H=o(n,"onShiftUp",8,void 0),U=o(n,"onShiftDown",8,void 0),e=o(n,"onSpace",8,void 0),t=o(n,"total",8,""),l=o(n,"pageSizeSelectLabel",8),g=o(n,"emptyStateTitle",8,""),i=o(n,"emptyStateMessage",8,""),Z=o(n,"errorTitle",8,""),O=o(n,"errorMessage",8,""),A=o(n,"itemsKeyname",8,"items"),W=o(n,"previousButtonLabel",8),be=o(n,"nextButtonLabel",8),$=o(n,"pageSizeOptions",8,Se),_e=o(n,"debounceDelay",8,250),u=Ve($(),$()[0]),z=ae();function Ie(){f(z)&&C(z,void 0)}Ue(()=>{j()});async function j(){const r=await R()();try{const d=await r(a().pageSize,""),{nextPageToken:s}=d,c=d[A()]||[];u.nextPageWithItems(s,c)}catch(d){C(z,d),w()&&w()(f(z))}}const ye=async()=>{try{const d=await(await R()())(a().pageSize,a().indexData[a().index].nextToken),{nextPageToken:s}=d,c=d[A()]||[];u.nextPageWithItems(s,c)}catch(r){Je(r)&&w()&&w()(r)}};async function ie(){Ie(),u.setUpdating(),a().hasNextIndexData?u.nextPage():Me(await ye,_e())()}async function De(r){if(r.repeat)return;const d=r.shiftKey;switch(r.code){case"ArrowRight":case"KeyL":a().hasNext&&!a().updating&&ie();break;case"ArrowLeft":case"KeyH":a().hasPrevious&&!a().updating&&u.previousPage();break;case"ArrowUp":case"KeyK":d&&H()?(H()(r),u.reset(),j()):u.previousRow();break;case"ArrowDown":case"KeyJ":d&&U()?(U()(r),u.reset(),j()):u.nextRow();break;case"Space":e()&&e()(r);break}}ne(()=>a(),()=>{C(L,!a().loading&&a().pageSize!==a().previousPageSize)}),ne(()=>(f(L),a()),()=>{f(L)&&(u.resetPageSize(a().pageSize),j())}),ne(()=>(a(),Ne(t())),()=>{C(k,!a().hasNext&&a().indexEnd!==t()?a().indexEnd:t())}),Le(),Ke();var oe=Ze();Ee("keydown",ke,De);var le=_(oe);I(le,n,"header",{get visibleItems(){return a().visibleItems}},null);var we=B(le,2);Ge(we,{get loading(){return a().loading},get updating(){return a().updating},get visibleItems(){return a().visibleItems},get maxHeight(){return Y()},get id(){return X()},children:(r,d)=>{var s=D(),c=_(s);I(c,n,"default",{get visibleItems(){return a().visibleItems}},null),h(r,s)},$$slots:{default:!0,caption:(r,d)=>{var s=D(),c=_(s);I(c,n,"caption",{},null),h(r,s)},headers:(r,d)=>{var s=D(),c=_(s);I(c,n,"headers",{get visibleItems(){return a().visibleItems}},null),h(r,s)},empty:(r,d)=>{var s=D(),c=_(s);{var q=v=>{var P=D(),E=_(P);I(E,n,"loading",{},K=>{We(K,{})}),h(v,P)},ee=(v,P)=>{{var E=b=>{var y=D(),T=_(y);I(T,n,"error",{},x=>{me(x,{get title(){return Z()},children:(p,de)=>{const te=N(()=>{var ce;return((ce=f(z))==null?void 0:ce.message)??O()});Oe(p,{intent:"error",get title(){return f(te)}})},$$slots:{default:!0}})}),h(b,y)},K=b=>{var y=D(),T=_(y);I(T,n,"empty",{},x=>{me(x,{get title(){return g()},get content(){return i()}})}),h(b,y)};re(v,b=>{f(z)?b(E):b(K,!1)},P)}};re(c,v=>{a().loading?v(q):v(ee,!1)})}h(r,s)},"actions-start":(r,d)=>{const s=N(()=>String(a().pageSize));je(r,{get label(){return l()},get parameter(){return a().key},get value(){return f(s)},get options(){return $()}})},"actions-end":(r,d)=>{var s=Ye(),c=J(s);I(c,n,"actions-end-additional",{get visibleItems(){return a().visibleItems},get page(){return a().index+1}},null);var q=B(c,2);const ee=N(()=>!a().hasPrevious);ve(q,{get label(){return W()},get disabled(){return f(ee)},icon:"arrow-left",$$events:{click(...x){var p;(p=u.previousPage)==null||p.apply(this,x)}}});var v=B(q,2),P=J(v),E=J(P);G(P);var K=B(P,2);{var b=x=>{var p=Xe(),de=J(p);G(p),ge(te=>ue(de,`of ${te??""}`),[()=>f(k).toLocaleString()],N),h(x,p)};re(K,x=>{f(k)&&x(b)})}G(v);var y=B(v,2);const T=N(()=>!a().hasNext||a().updating);ve(y,{get label(){return be()},get disabled(){return f(T)},icon:"arrow-right",$$events:{click:ie}}),G(s),ge((x,p)=>{Te(s,"aria-label",F["aria-label"]),ue(E,`${x??""}â€“${p??""}`)},[()=>a().indexStart.toLocaleString(),()=>a().indexEnd.toLocaleString()],N),h(r,s)}}}),h(S,oe),Ae(),V()}export{ht as A};
