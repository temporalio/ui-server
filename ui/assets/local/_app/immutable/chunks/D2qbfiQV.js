import"./CWj6FrbW.js";import"./69_IOA4Y.js";import{p as F,f as I,e as u,b as L,h as g,j as N,g as d,o as h,n as U,k as j,t as G,r as H,s as v,m as S}from"./BzuLCQNf.js";import{e as q,s as C}from"./HOnlAALn.js";import{i as P}from"./W-5sOwmb.js";import{s as R,a as T}from"./DdNojIXk.js";import{g as W}from"./BSLsaSV2.js";import{B as z}from"./BQLqgSXt.js";import{L as D}from"./DUFHtEr8.js";import{t as n}from"./DEjs8ZrU.js";import{g as J}from"./CQzS74iW.js";import{t as K}from"./Dpq9Ytb2.js";import{i as M,a as O}from"./DAXHhHtM.js";import{l as Q}from"./DuFMxN9w.js";import{t as y}from"./mTWriMIu.js";import{p as V}from"./ikbOq2O5.js";import{r as X}from"./DMWK6oI8.js";var Y=I('<div class="flex flex-col items-start gap-2 md:flex-row md:items-center"><!> <input id="import-event-history-file-upload" class="import-input block border border-slate-200 p-2" type="file" accept=".json"/> <!></div>');function gt(_,$){F($,!1);const b=()=>T(Q,"$lastUsedNamespace",x),[x,E]=R();let o,i=S(!1);const w=async t=>{var e;const s=t.target,a=(e=s==null?void 0:s.files)===null||e===void 0?void 0:e[0],r=new FileReader;a&&(r.readAsText(a),r.onload=()=>{var p,m;try{const B=(m=(p=r==null?void 0:r.result)===null||p===void 0?void 0:p.toString())!==null&&m!==void 0?m:"";o=V(B),v(i,!0)}catch{y.push({variant:"error",message:n("events.event-history-load-error")}),v(i,!1)}})},k=async()=>{try{const t=await K(Array.isArray(o)?o:o==null?void 0:o.events),e=J(t);M.set(t),O.set(e),v(i,!1);const s=X(b(),"feed");W(s)}catch(t){console.error(t),y.push({variant:"error",message:n("events.event-history-import-error")})}};P();var l=Y(),f=N(l);{let t=h(()=>n("events.import-event-history-file-upload"));D(f,{hidden:!0,for:"import-event-history-file-upload",get label(){return d(t)}})}var c=g(f,2),A=g(c,2);{let t=h(()=>!d(i));z(A,{leadingIcon:"file-upload",get disabled(){return d(t)},$$events:{click:k},children:(e,s)=>{U();var a=j();G(r=>C(a,r),[()=>n("common.import")]),u(e,a)},$$slots:{default:!0}})}H(l),q("change",c,w),u(_,l),L(),E()}export{gt as E};
