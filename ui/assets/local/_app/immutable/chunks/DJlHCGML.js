import"./CWj6FrbW.js";import"./69_IOA4Y.js";import{p as me,l as R,M as l,g as e,m as V,av as ge,a as ke,f as W,c as ue,t as O,I as s,e as $,h as F,k as te,o as m,j as J,b as fe,s as T,r as K,n as oe,i as Ve}from"./UnFCzZBm.js";import{s as G}from"./CX2avYX0.js";import{i as Fe}from"./pI5hk1MB.js";import{e as Le,i as Ne}from"./DMsHiW-d.js";import{s as ze}from"./CDVS_aRO.js";import{i as pe}from"./BBLBidKq.js";import{p as Z,a as E,s as ve,b as D}from"./GmGfGY7t.js";import{w as se,g as _e}from"./CDMQnRTF.js";import{g as ae}from"./BNf66Pw3.js";import{p as xe}from"./D-c4uq9W.js";import{C as le}from"./ZexYAmwF.js";import{I as De}from"./dWO51a22.js";import{M as Ge}from"./ByhPrr46.js";import{c as Ue,d as Be,b as ie}from"./D-f9p0-U.js";import{M as qe}from"./9amhnhok.js";import{t}from"./DEjs8ZrU.js";import{l as $e,Y as Te,Z as We,_ as Ye}from"./CA47UEEI.js";import{h as ee,g as ce,c as Ze,i as Je,j as Ie,f as Ke}from"./BKK4SAAc.js";import{t as Qe}from"./DYcGnQ6P.js";import{u as de}from"./D9L4mXfE.js";import{i as Xe}from"./HVeMsM_a.js";import{C as Pe}from"./1ErCL-Yd.js";import{M as et}from"./DElaMk6W.js";import{R as tt,a as we}from"./B8FRY-AZ.js";import{a as ot}from"./CILh1WsH.js";import{a as nt}from"./Bt9FnE2Z.js";import{c as st,d as rt}from"./Dy09lhKP.js";import{g as at,b as lt,a as it}from"./BH4j3g5Y.js";import{s as he}from"./ikbOq2O5.js";import{L as ct}from"./B7aw7opB.js";import{i as dt}from"./BNgW-vk5.js";import{d as Ae}from"./o_sTnPkO.js";import{w as ut}from"./BuXSPDAs.js";import{I as He}from"./B4QWS8RS.js";const Me=200,mt=se(0),ft=se(Me),ne=se([]),ye=se(0),go=()=>{ne.set([]),ye.set(0),mt.set(0),ft.set(Me)},pt=()=>{ne.set([]),ye.set(0)},$o=n=>{_e(ne).includes(n.id)?(ye.set(0),ne.set([])):ne.set([n.id])},vt=n=>n==null?void 0:n.nexus;var gt=W("<div><!></div>"),$t=W('<span class="hidden text-sm md:block"> </span>'),wt=W("<!> <!> <!> <!> <!>",1),_t=W("<!> <!>",1);function wo(n,r){me(r,!1);const f=()=>E(Qe,"$temporalVersion",c),u=()=>E(xe,"$page",c),o=()=>E(ee,"$eventTypeFilter",c),a=()=>E(ce,"$eventStatusFilter",c),i=()=>E(Ze,"$eventViewType",c),[c,_]=ve(),g=V(),w=V(),k=V();var M=V();let x=Z(r,"compact",8,!1),L=Z(r,"minimized",8,!0),h=se(!1);const I=({value:d})=>{pt();const N=o().some(P=>P===d)?o().filter(P=>P!==d):[...o(),d];D(ee,N),de(u().url,{categories:N.length===e(g).length?null:N},ae)},j=()=>{D(ee,e(g)),D(ce,!1),de(u().url,{categories:null,statusFilter:!1},ae)},Q=()=>{D(ee,e(g)),D(ce,!a()),de(u().url,{categories:null,statusFilter:!a()},ae)},U=()=>{D(ee,[]),D(ce,!1),de(u().url,{categories:[],statusFilter:!1},ae)};R(()=>(l(x()),$e),()=>{T(g,x()?Te.map(d=>d.value):$e.map(d=>d.value))}),R(()=>(l(x()),Pe),()=>{T(w,[...(x()?Te:$e).map(d=>({...d,label:t(d.label),icon:Pe[d.value],description:t(d.description)}))])}),R(()=>(f(),e(w)),()=>{Xe("1.21.0",f())&&T(w,e(w).filter(({value:d})=>d!=="update"))}),R(()=>(ge(M),u(),e(w)),()=>{vt(T(M,u().data.systemInfo)===null||ge(M)===void 0?void 0:ge(M).capabilities)||T(w,e(w).filter(({value:d})=>d!=="nexus"))}),R(()=>(o(),e(g)),()=>{T(k,o().length<e(g).length)}),ke(),pe(),Ue(n,{get open(){return h},children:(d,N)=>{var P=_t(),re=ue(P);Ge(re,{controls:"status-menu",size:"sm",leading:X=>{var B=gt();let A;var q=J(B);{let Y=m(()=>e(k)&&"pt-0.5 text-white");De(q,{name:"filter",get class(){return e(Y)}})}K(B),O(()=>A=ze(B,1,"flex h-6 w-6 flex-col items-center justify-center rounded-full transition-colors duration-200",null,A,{"bg-interactive":e(k)})),$(X,B)},children:(X,B)=>{var A=$t(),q=J(A,!0);K(A),O(Y=>G(q,Y),[()=>(l(t),s(()=>t("common.filter")))]),$(X,A)},$$slots:{leading:!0,default:!0}});var z=F(re,2);{let S=m(()=>L()?"top-right":"right");Be(z,{id:"event-type-menu",keepOpen:!0,get position(){return e(S)},class:"w-[220px] md:w-[360px]",children:(X,B)=>{var A=wt(),q=ue(A);{const H=C=>{{let y=m(()=>(a(),o(),e(g),s(()=>!a()&&o().length===e(g).length))),v=m(()=>(l(t),s(()=>t("common.all"))));le(C,{get checked(){return e(y)},get label(){return e(v)},labelHidden:!0,class:"mt-px",$$events:{change:j}})}};let p=m(()=>(l(t),s(()=>t("common.all"))));ie(q,{get"data-testid"(){return e(p)},onclick:j,leading:H,children:(C,y)=>{oe();var v=te();O(b=>G(v,b),[()=>(l(t),s(()=>t("common.all")))]),$(C,v)},$$slots:{leading:!0,default:!0}})}var Y=F(q,2);{var je=H=>{{const p=v=>{{let b=m(()=>(l(t),s(()=>t("common.all"))));le(v,{get checked(){return a()},get label(){return e(b)},labelHidden:!0,class:"mt-px",$$events:{change:Q}})}};let C=m(()=>(l(t),s(()=>t("common.pending-and-failed")))),y=m(()=>(l(t),s(()=>t("common.pending-and-failed-description"))));ie(H,{get"data-testid"(){return e(C)},get description(){return e(y)},onclick:Q,class:"items-start",leading:p,children:(v,b)=>{oe();var Ce=te();O(Oe=>G(Ce,Oe),[()=>(l(t),s(()=>t("common.pending-and-failed")))]),$(v,Ce)},$$slots:{leading:!0,default:!0}})}};Fe(Y,H=>{i()!=="json"&&H(je)})}var be=F(Y,2);{const H=C=>{{let y=m(()=>(a(),o(),s(()=>!a()&&!o().length))),v=m(()=>(l(t),s(()=>t("common.none"))));le(C,{get checked(){return e(y)},get label(){return e(v)},labelHidden:!0,class:"mt-px",$$events:{change:U}})}};let p=m(()=>(l(t),s(()=>t("common.none"))));ie(be,{get"data-testid"(){return e(p)},onclick:U,leading:H,children:(C,y)=>{oe();var v=te();O(b=>G(v,b),[()=>(l(t),s(()=>t("common.none")))]),$(C,v)},$$slots:{leading:!0,default:!0}})}var Ee=F(be,2);qe(Ee);var Se=F(Ee,2);Le(Se,1,()=>e(w),Ne,(H,p)=>{ie(H,{get"data-testid"(){return e(p),s(()=>e(p).label)},get description(){return e(p),s(()=>e(p).description)},onclick:()=>{I(e(p))},class:"items-start",leading:y=>{{let v=m(()=>(o(),e(p),s(()=>o().some(b=>b===e(p).value))));le(y,{get checked(){return e(v)},get label(){return e(p),s(()=>e(p).label)},labelHidden:!0,class:"mt-px",$$events:{click:()=>I(e(p))}})}},children:(y,v)=>{oe();var b=te();O(()=>G(b,(e(p),s(()=>e(p).label)))),$(y,b)},$$slots:{leading:!0,default:!0}})}),$(X,A)},$$slots:{default:!0}})}$(d,P)},$$slots:{default:!0}}),fe(),_()}const ht=async(n,r,f)=>{const u=at(r),o=lt(r),a=it(r),i={...r,codec:{...r==null?void 0:r.codec,endpoint:u,passAccessToken:o,includeCredentials:a}},c=!1;try{const _=await st(n,_e(xe).params.namespace,i,_e(nt).accessToken,f,c);return rt(_,c)}catch{return n}};function Re(n,r,f){const u=he({events:n},null,2),o=document.createElement("a"),a=new Blob([u],{type:f});o.href=URL.createObjectURL(a),o.download=r,o.click()}const kt=async({namespace:n,workflowId:r,runId:f,settings:u,decodeSetting:o})=>{try{const a=await ot({namespace:n,workflowId:r,runId:f,sort:"ascending"});if(o==="encoded")Re(a,`${f}/events.json`,"text/plain");else{const i=[];for(const c of a){const _=await ht(c,u,o);i.push(_)}Re(i,`${f}/events.json`,"text/plain")}}catch{console.error("Could not download event history")}};var xt=W('<div class="flex items-center space-x-4"><!></div>');function yt(n,r){me(r,!1);const f=()=>E(Je,"$parameters",o),u=()=>E(dt,"$isCloud",o),[o,a]=ve(),i=V(),c=V(),{namespace:_,workflowId:g,runId:w}=f();R(()=>Ae,()=>{T(i,Ae({namespace:_,workflow:g,run:w}))}),R(()=>e(i),()=>{T(c,e(i)+".json")}),ke(),pe();var k=Ve(),M=ue(k);{var x=L=>{var h=xt(),I=J(h);ct(I,{icon:"external-link",class:"whitespace-nowrap",get href(){return e(c)},newTab:!0,"data-testid":"view-raw-event-history",children:(j,Q)=>{oe();var U=te();O(d=>G(U,d),[()=>(l(t),s(()=>t("events.view-raw-history")))]),$(j,U)},$$slots:{default:!0}}),K(h),$(L,h)};Fe(M,L=>{u()||L(x)})}$(n,k),fe(),a()}var bt=W('<h3 slot="title"> </h3>'),Et=W("<!> <!> <!>",1),Ct=W('<div slot="content" class="flex flex-col gap-4"><!> <!></div>');function _o(n,r){me(r,!1);const f=()=>E(xe,"$page",o),u=()=>E(Ie,"$downloadEventHistorySetting",o),[o,a]=ve();let i=Z(r,"open",12,!1),c=Z(r,"namespace",8),_=Z(r,"workflowId",8),g=Z(r,"runId",8);const w=()=>{i(!1),kt({namespace:c(),workflowId:_(),runId:g(),settings:f().data.settings,decodeSetting:u()})};pe();{let k=m(()=>(l(t),s(()=>t("common.download")))),M=m(()=>(l(t),s(()=>t("common.cancel"))));et(n,{id:"download-history",large:!0,confirmType:"primary",get confirmText(){return e(k)},get cancelText(){return e(M)},get open(){return i()},set open(x){i(x)},$$events:{confirmModal:()=>w(),cancelModal:()=>i(!1)},$$slots:{title:(x,L)=>{var h=bt(),I=J(h,!0);K(h),O(j=>G(I,j),[()=>(l(t),s(()=>t("common.download-event-history-json")))]),$(x,h)},content:(x,L)=>{var h=Ct(),I=J(h);tt(I,{get group(){return Ie},name:"decode-setting",class:"h-auto overflow-auto",children:(Q,U)=>{var d=Et(),N=ue(d);{let z=m(()=>(l(t),s(()=>t("events.encoded")))),S=m(()=>(l(t),s(()=>t("events.encoded-description"))));we(N,{id:"use-encoded-setting","data-testid":"use-encoded-setting-input",value:"encoded",get label(){return e(z)},get description(){return e(S)}})}var P=F(N,2);{let z=m(()=>(l(t),s(()=>t("events.decoded")))),S=m(()=>(l(t),s(()=>t("events.decoded-description"))));we(P,{id:"use-decoded-setting","data-testid":"use-decoded-setting-input",value:"decoded",get label(){return e(z)},get description(){return e(S)}})}var re=F(P,2);{let z=m(()=>(l(t),s(()=>t("events.readable")))),S=m(()=>(l(t),s(()=>t("events.readable-description"))));we(re,{id:"use-readable-setting","data-testid":"use-readable-setting-input",value:"readable",get label(){return e(z)},get description(){return e(S)}})}$(Q,d)},$$slots:{default:!0}});var j=F(I,2);yt(j,{}),K(h),$(x,h)}},$$legacy:!0})}fe(),a()}const Tt=["WorkflowExecutionFailed","WorkflowExecutionCompleted","WorkflowExecutionContinuedAsNew","WorkflowExecutionTimedOut","WorkflowExecutionCanceled","WorkflowExecutionTerminated"],It=n=>!!n.workflowExecutionStartedEventAttributes,Pt=n=>{for(const r of Tt)if(n.eventType===r)return!0;return!1},At=n=>We(n)?n.attributes.input:Ye(n)?n.attributes.result===null?null:n.attributes.result:n.attributes,Ht=n=>{var i;let r,f,u=!1,o,a;for(const c of n)if(It(c)){o=c;continue}else if(Pt(c)){a=c;continue}return o&&(r=he(((i=o==null?void 0:o.workflowExecutionStartedEventAttributes)==null?void 0:i.input)??null)),a&&(u=We(a),f=he(At(a))),{input:r,results:f,contAsNew:u}};var Rt=W('<div class="flex flex-col gap-4 lg:flex-row" data-testid="input-and-result"><!> <!></div>');function ho(n,r){me(r,!1);const f=()=>E(Ke,"$fullEventHistory",o),u=()=>E(ut,"$workflowRun",o),[o,a]=ve(),i=V(),c=V();R(()=>f(),()=>{T(i,Ht(f()))}),R(()=>u(),()=>{T(c,u().workflow.isRunning)}),ke(),pe();var _=Rt(),g=J(_);{let k=m(()=>(l(t),s(()=>t("workflows.input"))));He(g,{get title(){return e(k)},get content(){return e(i),s(()=>e(i).input)},get isRunning(){return e(c)}})}var w=F(g,2);{let k=m(()=>(l(t),s(()=>t("workflows.result"))));He(w,{get title(){return e(k)},get content(){return e(i),s(()=>e(i).results)},get isRunning(){return e(c)}})}K(_),$(n,_),fe(),a()}export{_o as D,wo as E,ho as I,ye as a,ne as b,go as c,$o as s};
