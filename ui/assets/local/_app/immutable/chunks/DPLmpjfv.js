import{w as I}from"./r33Ll6et.js";import{p as S,s as p}from"./DMvnBdKo.js";const m=e=>typeof e=="function";function y(e,a,g=!1){var l,c;let i=m(a)?a():a,o;try{(l=window==null?void 0:window.localStorage)!=null&&l.getItem(e)&&(i=S(((c=window==null?void 0:window.localStorage)==null?void 0:c.getItem(e))??""))}catch{}const{subscribe:u,set:n,update:f}=I(i);if(g)try{o=new BroadcastChannel(`persist-store-${e}`),o==null||o.addEventListener("message",t=>{n(t.data)})}catch{console.error("Browser does not support BroadcastChannel")}return{subscribe:u,set:t=>{var r,s;o&&o.postMessage(t),t===null?(r=window==null?void 0:window.localStorage)==null||r.removeItem(e):(s=window==null?void 0:window.localStorage)==null||s.setItem(e,p(t)),n(t)},update:t=>{var r;(r=window==null?void 0:window.localStorage)==null||r.removeItem(e),f(s=>{var d;const w=t(s);return(d=window==null?void 0:window.localStorage)==null||d.setItem(e,p(w)),w})}}}export{m as i,y as p};
