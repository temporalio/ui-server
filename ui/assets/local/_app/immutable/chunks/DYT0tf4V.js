import{w as n}from"./DIJxQKhU.js";import{g as o,p as e}from"./CRZ--JWW.js";import{i as c}from"./BJzbPR4R.js";const d=n();class E{constructor(i,t,r,a,s){this.namespace=i,this.activityId=t,this.abortController=r,this.onUpdate=a,this.onError=s}async start(){let i;try{i=await o(this.namespace,this.activityId)}catch(t){this.onError(t)}if(this.onUpdate(i),i.info.status==="ACTIVITY_EXECUTION_STATUS_RUNNING")for(this.runId=i.runId,this.token=i.longPollToken;!this.abortController.signal.aborted;)try{const t=await e(this.namespace,this.activityId,this.runId,this.token,this.abortController.signal);t&&!c(t)&&(this.token=t.longPollToken,this.onUpdate(t))}catch(t){if(t instanceof Error&&t.name==="AbortError")return;this.onError(t);break}}async fetchOnce(){const i=await o(this.namespace,this.activityId);this.onUpdate(i)}abort(){this.abortController.abort()}}export{E as S,d as a};
