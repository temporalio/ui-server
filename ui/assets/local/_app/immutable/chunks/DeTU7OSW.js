import{d as A}from"./CvkHpCCQ.js";import{c as R}from"./DDCHKJfQ.js";import{S as f}from"./S6Q2Q0ub.js";import{g as k}from"./DIJxQKhU.js";import{s as I}from"./XyQ8w4kX.js";import{f as h,g as F,j as C,k as y,l as d,m as T,n as B,o as p,p as w,q as K,r as D,s as L}from"./BJzbPR4R.js";import{i as Q,b as P,t as S,c as N}from"./CtQjrHKC.js";import{i as g}from"./DGYYVAig.js";import{u as V}from"./DxUltYVC.js";const Y={workflowId:"WorkflowId",workflowType:"WorkflowType",timeRange:"StartTime",executionStatus:"ExecutionStatus",closeTime:"CloseTime",runId:"RunId"},q=(t,o)=>!(t===null&&!h(o)||t===void 0||t===""||typeof t=="string"&&t==="undefined"),W=({value:t,type:o,conditional:s})=>o===f.BOOL?t.toLowerCase()==="true":o===f.KEYWORDLIST&&C(s)?t:`"${t}"`,M=t=>{const o=Y[t]??t;return typeof o=="string"&&/\s/g.test(o)?"`"+o+"`":o},j=(t,o,s,r="=",e,c)=>{const i=M(t);return s==="All"?"":c?`${i} ${s}`:h(r)?`\`${i}\` ${r} ${s}`:Q(s)||P(s)?e||k(I)?`${i} ${r} "${S(s)}"`:`${i} BETWEEN "${S(s)}" AND "${N()}"`:F(r)?`\`${i}\` ${r} ${W({value:s,type:o,conditional:r})}`:`\`${i}\`${r}${W({value:s,type:o,conditional:r})}`},_=(t,o)=>t.map(({attribute:s,type:r,value:e,conditional:c,operator:i,parenthesis:n,customDate:l})=>{if(q(e,c)){let a=j(s,r,e,c,o,l);return n==="("?a=`(${a}`:n===")"&&(a=`${a})`),i&&(a=`${a} ${i} `),a}}).filter(Boolean),z=(t=[],o=!1)=>_(t,o).join(""),H=t=>{const o=[],s=()=>{r&&(o.push(r),r="")};let r="",e=0;const c=(i,n=!1)=>{for(let l=n?e:e+1;l<t.length;l++){const a=t[l];if(i(a)){n&&(r+=a),s(),e=l+1;return}r+=a}e++};for(;e<t.length;){const i=t[e];if(y(i)){const u=e===0||T(t[e-1])&&B(o[o.length-1])||d(t[e-1]),m=t.slice(e+1).includes(i);if(u&&m){s(),c(y);continue}}if(d(i)){const u=o[o.length-1];if(C(u)){c(K,!0);continue}else{r+=i,s(),e++;continue}}const n=t.slice(e,e+2),l=t.slice(e,e+3),a=t.slice(e,e+6);if(p(a)){r+=a,s(),e+=6;continue}else if(p(l)){r+=l,s(),e+=3;continue}else if(p(n)&&(T(t[e+2])||w(t[e+2])||d(t[e+2]))){r+=n,s(),e+=2;continue}else if(p(i)){s(),r+=i,e++;continue}if(w(i)){s();const u=p(t[e-1]),m=t.slice(e+1).includes(i);if(u&&m){c(b=>b===i);continue}e++;continue}if(T(i)){s(),e++;continue}r+=i,e++}return s(),o},O=t=>o=>o.toLowerCase()===t.toLowerCase(),J=(t,o)=>t[o+1],U=(t,o)=>t[o+2],G=(t,o)=>t[o+3],X=(t,o)=>t[o-2],Z=O(f.DATETIME),x=O(f.BOOL),E=()=>({attribute:"",type:f.KEYWORD,value:"",operator:"",parenthesis:"",conditional:""}),v={ExecutionStatus:f.KEYWORD,StartTime:f.DATETIME,CloseTime:f.DATETIME,WorkflowId:f.KEYWORD,WorkflowType:f.KEYWORD,RunId:f.KEYWORD},fe=(t,o=v)=>{const s=H(t),r=[];let e=E();if(!t)return[];try{return s.forEach((c,i)=>{const n=J(s,i),l=U(s,i);if(o[c])if(e.attribute=c,e.type=o[c],h(n)){const a=`${n} ${l}`,u=h(a)?G(s,i):l;e.value=u.toLocaleLowerCase()==="null"?null:u}else if(Z(o[c])){const a=l,u=g(a);if(D(n)){const m=s[i+4],$=g(m);u&&$?(e.value=`BETWEEN "${a}" AND "${m}"`,e.customDate=!0,e.conditional="BETWEEN"):console.error("Error parsing Datetime field from query")}else u?e.value=a:console.error("Error parsing Datetime field from query")}else x(e.type)?(e.value=n.replace("=",""),e.conditional="="):e.value=l;if(!e.conditional&&p(c)){const a=`${c} ${n}`;h(a)?e.conditional=a:e.conditional=c}d(c)&&(e.parenthesis=c),L(c)&&!D(X(s,i))&&(e.operator=c,r.push(e),e=E()),i===s.length-1&&(r.push(e),e=E())}),r}catch(c){return console.error("Error setting filter parameters: ",c),[]}},ee=t=>{const o=t.filter(n=>n.attribute==="ExecutionStatus"&&n.value),s=t.filter(n=>n.attribute==="WorkflowId"&&n.value),r=t.filter(n=>n.attribute==="WorkflowType"&&n.value),e=t.filter(n=>n.attribute==="RunId"&&n.value),c=t.filter(n=>(n.attribute==="StartTime"||n.attribute==="CloseTime")&&n.value),i=[o,s,e,r,c].filter(n=>n.length);return i.forEach((n,l)=>{var a,u;n.length&&((a=i[l+1])!=null&&a.length)?n[n.length-1].operator="AND":n.length&&!((u=i[l+1])!=null&&u.length)&&(n[n.length-1].operator="")}),[...o,...s,...e,...r,...c]},te=t=>(t.forEach((o,s)=>{const r=t[s-1];r&&!r.operator&&(r.operator="AND");const e=t[s+1];e||(o.operator=""),o.operator==="OR"&&(e==null?void 0:e.attribute)!==o.attribute?(o.parenthesis="",o.operator=""):o.operator==="OR"&&(r==null?void 0:r.operator)!=="OR"?o.parenthesis="(":(r==null?void 0:r.operator)==="OR"&&o.operator!=="OR"?o.parenthesis=")":o.parenthesis=""}),t),me=A((t,o,s=!1)=>{const r=s?ee(o):te(o),e=z(r);V({url:t,parameter:"query",value:e,allowEmpty:!1,clearParameters:[R]})},300);export{fe as a,te as c,E as e,z as t,me as u};
