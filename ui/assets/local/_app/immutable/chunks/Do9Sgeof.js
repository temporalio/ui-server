import"./CWj6FrbW.js";import"./69_IOA4Y.js";import{p as ye,s as ee,g as p,l as le,a as De,aJ as we,f as I,c as B,e as q,r as C,t as de,b as ze,m as ce,d as j}from"./Dv5jDC8Z.js";import{s as ge}from"./CnnFVxmh.js";import{i as te}from"./FbCjvpNA.js";import{c as w,a as v,t as ae}from"./BM_uyzAk.js";import{s as y}from"./CevXMagP.js";import{a as Ne}from"./wdddUT-U.js";import{e as ke}from"./C1S4hUbu.js";import{i as Le}from"./CM2QeVoh.js";import{l as ue,p as o}from"./BbkaS_Cl.js";import{s as Ae,a as Ke}from"./CEr_ApTH.js";import{d as fe,w as Ee,o as Be}from"./s0RhsljA.js";import{A as Fe}from"./CXRblWjG.js";import{E as me}from"./lbyfKwPg.js";import{I as xe}from"./IiW_QMEH.js";import{L as Te}from"./CKG0nj-D.js";import{F as Me}from"./BMSErf4c.js";import{p as Re}from"./DOVEQzNU.js";import{p as he,b as Ue,o as Se,d as G}from"./Debgsfec.js";import{m as He}from"./HNIa2swf.js";import{P as Oe}from"./Dr4KenId.js";const pe={key:he,loading:!0,updating:!1,hasNext:!1,hasPrevious:!1,index:0,previousPageSize:G,pageSize:G,indexData:{},visibleItems:[],hasNextIndexData:!1,indexStart:0,indexEnd:0,activeIndex:0},ve=S=>{const a=S[0];if(!a)return G;const f=parseInt(a.toString());return isNaN(f)?G:f},We=(S,a=void 0)=>{if(a){const f=parseInt(a.toString());return isNaN(f)?ve(S):f}else return ve(S)};function Je(S=Se,a=void 0){const f=We(S,a),F=Ee({...pe,previousPageSize:f,pageSize:f}),{set:Q,update:m}=F,n=fe([Re],([e])=>{const t=e.url.searchParams.get(he);return t?Ue(t):void 0}),{subscribe:k}=fe([F,n],([e,t])=>{var L,H,O;const l=((L=e.indexData[e.index])==null?void 0:L.items)??[],g=((H=e.indexData[e.index])==null?void 0:H.start)??0,i=((O=e.indexData[e.index])==null?void 0:O.end)??0,Y=!!e.indexData[e.index+1];return{...e,visibleItems:l,indexStart:g,indexEnd:i,hasNextIndexData:Y,pageSize:t??e.pageSize}}),V=(e,t,l)=>{const g=l.index,i={...l,indexData:{...l.indexData},hasNext:!!e,updating:!1,loading:!1};return t.length?(i.indexData[g]?(i.index=g+1,i.indexData[i.index]={nextToken:e,start:i.indexData[g].end+1,end:i.indexData[g].end+t.length,items:t},i.hasPrevious=!0):(i.indexData[g]={nextToken:e,start:1,end:t.length,items:t},i.hasPrevious=!1),i):{...i,hasNext:!1}},X=e=>{var l;const t={...e,index:e.index+1,hasPrevious:!0,loading:!1,updating:!1};return(l=t.indexData[t.index])!=null&&l.nextToken||(t.hasNext=!1),t},z=e=>{const t={...e,hasNext:!0,updating:!1,loading:!1,index:e.index>0?e.index-1:0};return t.index===0&&(t.hasPrevious=!1),t},T=e=>{var g,i;const t={...e},l=((i=(g=t.indexData[t.index])==null?void 0:g.items)==null?void 0:i.length)??0;return t.activeIndex<l-1&&(t.activeIndex=t.activeIndex+1),t},M=e=>{const t={...e},l=t.activeIndex>=1?t.activeIndex-1:0;return t.activeIndex=l,t},R=(e,t)=>({...e,activeIndex:t}),U=(e,t)=>({...e,pageSize:t,previousPageSize:t,index:0,indexData:{},loading:!0,updating:!1});return{subscribe:k,nextPageWithItems:(e,t)=>m(l=>V(e,t,l)),nextPage:()=>m(e=>X(e)),previousPage:()=>m(e=>z(e)),setUpdating:()=>m(e=>({...e,updating:!0})),reset:()=>Q(pe),resetPageSize:e=>m(t=>U(t,e)),nextRow:()=>m(e=>T(e)),previousRow:()=>m(e=>M(e)),setActiveIndex:e=>m(t=>R(t,e))}}var qe=ae("<p> </p>"),Ce=ae('<nav class="flex shrink-0 items-center gap-2" slot="actions-end"><!> <!> <div class="flex gap-1"><p> </p> <!></div> <!></nav>'),je=ae("<!> <!>",1);function xt(S,a){const f=ue(a,["children","$$slots","$$events","$$legacy"]),F=ue(f,["id","maxHeight","onError","onFetch","onShiftUp","onShiftDown","onSpace","total","pageSizeSelectLabel","emptyStateTitle","emptyStateMessage","errorTitle","errorMessage","itemsKeyname","previousButtonLabel","nextButtonLabel","pageSizeOptions"]);ye(a,!1);const[Q,m]=Ae(),n=()=>Ke(u,"$store",Q),k=ce();let V=o(a,"id",8,null),X=o(a,"maxHeight",8,""),z=o(a,"onError",8,void 0),T=o(a,"onFetch",8),M=o(a,"onShiftUp",8,void 0),R=o(a,"onShiftDown",8,void 0),U=o(a,"onSpace",8,void 0),e=o(a,"total",8,""),t=o(a,"pageSizeSelectLabel",8),l=o(a,"emptyStateTitle",8,""),g=o(a,"emptyStateMessage",8,""),i=o(a,"errorTitle",8,""),Y=o(a,"errorMessage",8,""),L=o(a,"itemsKeyname",8,"items"),H=o(a,"previousButtonLabel",8),O=o(a,"nextButtonLabel",8),Z=o(a,"pageSizeOptions",8,Se),u=Je(Z(),Z()[0]),N=ce();function Pe(){p(N)&&ee(N,void 0)}Be(()=>{W()});async function W(){const r=await T()();try{const d=await r(n().pageSize,""),{nextPageToken:s}=d,c=d[L()]||[];u.nextPageWithItems(s,c)}catch(d){ee(N,d),z()&&z()(p(N))}}async function ne(){if(Pe(),u.setUpdating(),n().hasNextIndexData)u.nextPage();else try{const d=await(await T()())(n().pageSize,n().indexData[n().index].nextToken),{nextPageToken:s}=d,c=d[L()]||[];u.nextPageWithItems(s,c)}catch(r){He(r)&&z()&&z()(r)}}async function _e(r){const d=r.shiftKey;switch(r.code){case"ArrowRight":case"KeyL":n().hasNext&&!n().updating&&ne();break;case"ArrowLeft":case"KeyH":n().hasPrevious&&!n().updating&&u.previousPage();break;case"ArrowUp":case"KeyK":d&&M()?(M()(r),u.reset(),W()):u.previousRow();break;case"ArrowDown":case"KeyJ":d&&R()?(R()(r),u.reset(),W()):u.nextRow();break;case"Space":U()&&U()(r);break}}le(()=>n(),()=>{ee(k,!n().loading&&n().pageSize!==n().previousPageSize)}),le(()=>(p(k),n()),()=>{p(k)&&(u.resetPageSize(n().pageSize),W())}),De(),Le();var re=je();ke("keydown",we,_e);var se=I(re);y(se,a,"header",{get visibleItems(){return n().visibleItems}},null);var be=B(se,2);Oe(be,{get updating(){return n().updating},get visibleItems(){return n().visibleItems},get maxHeight(){return X()},get id(){return V()},children:(r,d)=>{var s=w(),c=I(s);y(c,a,"default",{get visibleItems(){return n().visibleItems}},null),v(r,s)},$$slots:{default:!0,caption:(r,d)=>{var s=w(),c=I(s);y(c,a,"caption",{},null),v(r,s)},headers:(r,d)=>{var s=w(),c=I(s);y(c,a,"headers",{get visibleItems(){return n().visibleItems}},null),v(r,s)},empty:(r,d)=>{var s=w(),c=I(s);{var J=x=>{var P=w(),A=I(P);y(A,a,"loading",{},K=>{Te(K,{})}),v(x,P)},$=(x,P)=>{{var A=_=>{var D=w(),E=I(D);y(E,a,"error",{},h=>{me(h,{get title(){return i()},children:(b,ie)=>{const Ie=j(()=>{var oe;return((oe=p(N))==null?void 0:oe.message)??Y()});Fe(b,{intent:"error",get title(){return p(Ie)}})},$$slots:{default:!0}})}),v(_,D)},K=_=>{var D=w(),E=I(D);y(E,a,"empty",{},h=>{me(h,{get title(){return l()},get content(){return g()}})}),v(_,D)};te(x,_=>{p(N)?_(A):_(K,!1)},P)}};te(c,x=>{n().loading?x(J):x($,!1)})}v(r,s)},"actions-start":(r,d)=>{const s=j(()=>String(n().pageSize));Me(r,{get label(){return t()},get parameter(){return n().key},get value(){return p(s)},get options(){return Z()}})},"actions-end":(r,d)=>{var s=Ce(),c=q(s);y(c,a,"actions-end-additional",{},null);var J=B(c,2);const $=j(()=>!n().hasPrevious);xe(J,{get label(){return H()},get disabled(){return p($)},icon:"arrow-left",$$events:{click(...h){var b;(b=u.previousPage)==null||b.apply(this,h)}}});var x=B(J,2),P=q(x),A=q(P);C(P);var K=B(P,2);{var _=h=>{var b=qe(),ie=q(b);C(b),de(()=>ge(ie,`of ${e()??""}`)),v(h,b)};te(K,h=>{e()&&h(_)})}C(x);var D=B(x,2);const E=j(()=>!n().hasNext);xe(D,{get label(){return O()},get disabled(){return p(E)},icon:"arrow-right",$$events:{click:ne}}),C(s),de(()=>{Ne(s,"aria-label",F["aria-label"]),ge(A,`${n().indexStart??""}â€“${n().indexEnd??""}`)}),v(r,s)}}}),v(S,re),ze(),m()}export{xt as A};
