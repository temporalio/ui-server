import"./CWj6FrbW.js";import"./69_IOA4Y.js";import{d as le,g as we,w as ze,o as Ne}from"./DIJxQKhU.js";import{p as Le,s as q,m as ae,g as f,l as ne,M as re,a as ke,aN as Ae,f as ve,j as C,I as l,h as J,o as G,r as Q,t as de,e as P,i as I,c as y,b as Ee}from"./DPYmeJXN.js";import{e as Ke,s as ce}from"./DtOlEDQN.js";import{i as se}from"./DqIiO-ir.js";import{s as z}from"./B2YVu2ra.js";import{s as Te}from"./DyeK8I2b.js";import{i as Be}from"./VvTteBni.js";import{l as ge,p as o,a as Fe,s as Me}from"./BkgVXhYA.js";import{d as Re}from"./BLzybqHd.js";import{A as Ue}from"./a_Pwoeun.js";import{E as ue}from"./Cok7MrH_.js";import{I as fe}from"./DZ9dFbJm.js";import{L as He}from"./EH2gHEyt.js";import{F as Oe}from"./BclpDv3g.js";import{p as We}from"./BeufIIjt.js";import{o as pe,p as he,b as je,d as V}from"./DDCHKJfQ.js";import{d as qe}from"./BJzbPR4R.js";import{P as Ce}from"./B3JhRSQd.js";const xe={key:he,loading:!0,updating:!1,hasNext:!1,hasPrevious:!1,index:0,previousPageSize:V,pageSize:V,indexData:{},visibleItems:[],hasNextIndexData:!1,indexStart:0,indexEnd:0,activeIndex:0},me=b=>{const n=b[0];if(!n)return V;const p=parseInt(n.toString());return isNaN(p)?V:p},Je=(b,n=void 0)=>{if(n){const p=parseInt(n.toString());return isNaN(p)?me(b):p}else return me(b)};function Ge(b=pe,n=void 0){const p=le([We],([t])=>{const a=t.url.searchParams.get(he);return a?je(a):void 0}),k=Je(b,we(p)||n),e=ze({...xe,previousPageSize:k,pageSize:k}),{set:X,update:h}=e,{subscribe:A}=le([e,p],([t,a])=>{var E,K,O;const d=((E=t.indexData[t.index])==null?void 0:E.items)??[],m=((K=t.indexData[t.index])==null?void 0:K.start)??0,i=((O=t.indexData[t.index])==null?void 0:O.end)??0,$=!!t.indexData[t.index+1];return{...t,visibleItems:d,indexStart:m,indexEnd:i,hasNextIndexData:$,pageSize:a??t.pageSize}}),N=(t,a,d)=>{const m=d.index,i={...d,indexData:{...d.indexData},hasNext:!!t,updating:!1,loading:!1};return a.length?(i.indexData[m]?(i.index=m+1,i.indexData[i.index]={nextToken:t,start:i.indexData[m].end+1,end:i.indexData[m].end+a.length,items:a},i.hasPrevious=!0):(i.indexData[m]={nextToken:t,start:1,end:a.length,items:a},i.hasPrevious=!1),i):{...i,hasNext:!1}},Y=t=>{var d;const a={...t,index:t.index+1,hasPrevious:!0,loading:!1,updating:!1};return(d=a.indexData[a.index])!=null&&d.nextToken||(a.hasNext=!1),a},Z=t=>{const a={...t,hasNext:!0,updating:!1,loading:!1,index:t.index>0?t.index-1:0};return a.index===0&&(a.hasPrevious=!1),a},L=t=>{var m,i;const a={...t},d=((i=(m=a.indexData[a.index])==null?void 0:m.items)==null?void 0:i.length)??0;return a.activeIndex<d-1&&(a.activeIndex=a.activeIndex+1),a},R=t=>{const a={...t},d=a.activeIndex>=1?a.activeIndex-1:0;return a.activeIndex=d,a},U=(t,a)=>({...t,activeIndex:a}),H=(t,a)=>({...t,pageSize:a,previousPageSize:a,index:0,indexData:{},loading:!0,updating:!1});return{subscribe:A,nextPageWithItems:(t,a)=>h(d=>N(t,a,d)),nextPage:()=>h(t=>Y(t)),previousPage:()=>h(t=>Z(t)),setUpdating:()=>h(t=>({...t,updating:!0})),reset:()=>X(xe),resetPageSize:t=>h(a=>H(a,t)),nextRow:()=>h(t=>L(t)),previousRow:()=>h(t=>R(t)),setActiveIndex:t=>h(a=>U(a,t))}}var Qe=ve("<p> </p>"),Ve=ve('<nav class="flex shrink-0 items-center gap-2" slot="actions-end"><!> <!> <div class="flex gap-1"><p> </p> <!></div> <!></nav>');function pt(b,n){const p=ge(n,["children","$$slots","$$events","$$legacy"]),k=ge(p,["id","maxHeight","onError","onFetch","onShiftUp","onShiftDown","onSpace","total","pageSizeSelectLabel","emptyStateTitle","emptyStateMessage","errorTitle","errorMessage","itemsKeyname","previousButtonLabel","nextButtonLabel","pageSizeOptions","debounceDelay"]);Le(n,!1);const e=()=>Fe(v,"$store",X),[X,h]=Me(),A=ae(),N=ae();let Y=o(n,"id",8,null),Z=o(n,"maxHeight",8,""),L=o(n,"onError",8,void 0),R=o(n,"onFetch",8),U=o(n,"onShiftUp",8,void 0),H=o(n,"onShiftDown",8,void 0),t=o(n,"onSpace",8,void 0),a=o(n,"total",8,""),d=o(n,"pageSizeSelectLabel",8),m=o(n,"emptyStateTitle",8,""),i=o(n,"emptyStateMessage",8,""),$=o(n,"errorTitle",8,""),E=o(n,"errorMessage",8,""),K=o(n,"itemsKeyname",8,"items"),O=o(n,"previousButtonLabel",8),Se=o(n,"nextButtonLabel",8),ee=o(n,"pageSizeOptions",8,pe),Pe=o(n,"debounceDelay",8,250),v=Ge(ee(),ee()[0]),D=ae();function be(){f(D)&&q(D,void 0)}Ne(()=>{W()});async function W(){const r=await R()();try{const c=await r(e().pageSize,""),{nextPageToken:s}=c,u=c[K()]||[];v.nextPageWithItems(s,u)}catch(c){q(D,c),L()&&L()(f(D))}}const _e=async()=>{try{const c=await(await R()())(e().pageSize,e().indexData[e().index].nextToken),{nextPageToken:s}=c,u=c[K()]||[];v.nextPageWithItems(s,u)}catch(r){qe(r)&&L()&&L()(r)}};async function ie(){be(),v.setUpdating(),e().hasNextIndexData?v.nextPage():Re(await _e,Pe())()}async function Ie(r){if(r.repeat)return;const c=r.shiftKey;switch(r.code){case"ArrowRight":case"KeyL":e().hasNext&&!e().updating&&ie();break;case"ArrowLeft":case"KeyH":e().hasPrevious&&!e().updating&&v.previousPage();break;case"ArrowUp":case"KeyK":c&&U()?(U()(r),v.reset(),W()):v.previousRow();break;case"ArrowDown":case"KeyJ":c&&H()?(H()(r),v.reset(),W()):v.nextRow();break;case"Space":t()&&t()(r);break}}ne(()=>e(),()=>{q(A,!e().loading&&e().pageSize!==e().previousPageSize)}),ne(()=>(f(A),e()),()=>{f(A)&&(v.resetPageSize(e().pageSize),W())}),ne(()=>(e(),re(a())),()=>{q(N,!e().hasNext&&e().indexEnd!==a()?e().indexEnd:a())}),ke(),Be(),Ke("keydown",Ae,Ie),Ce(b,{get loading(){return e(),l(()=>e().loading)},get updating(){return e(),l(()=>e().updating)},get visibleItems(){return e(),l(()=>e().visibleItems)},get maxHeight(){return Z()},get id(){return Y()},children:(r,c)=>{var s=I(),u=y(s);z(u,n,"default",{get visibleItems(){return e(),l(()=>e().visibleItems)}},null),P(r,s)},$$slots:{default:!0,caption:(r,c)=>{var s=I(),u=y(s);z(u,n,"caption",{},null),P(r,s)},headers:(r,c)=>{var s=I(),u=y(s);z(u,n,"headers",{get visibleItems(){return e(),l(()=>e().visibleItems)}},null),P(r,s)},empty:(r,c)=>{var s=I(),u=y(s);{var j=S=>{var w=I(),B=y(w);z(B,n,"loading",{},F=>{He(F,{})}),P(S,w)},T=S=>{var w=I(),B=y(w);{var F=g=>{var x=I(),_=y(x);z(_,n,"error",{},M=>{ue(M,{get title(){return $()},children:(ye,Xe)=>{{let De=G(()=>(f(D),re(E()),l(()=>{var oe;return((oe=f(D))==null?void 0:oe.message)??E()})));Ue(ye,{intent:"error",get title(){return f(De)}})}},$$slots:{default:!0}})}),P(g,x)},te=g=>{var x=I(),_=y(x);z(_,n,"empty",{},M=>{ue(M,{get title(){return m()},get content(){return i()}})}),P(g,x)};se(B,g=>{f(D)?g(F):g(te,!1)},!0)}P(S,w)};se(u,S=>{e(),l(()=>e().loading)?S(j):S(T,!1)})}P(r,s)},"actions-start":(r,c)=>{{let s=G(()=>(e(),l(()=>String(e().pageSize))));Oe(r,{get label(){return d()},get parameter(){return e(),l(()=>e().key)},get value(){return f(s)},get options(){return ee()}})}},"actions-end":(r,c)=>{var s=Ve(),u=C(s);z(u,n,"actions-end-additional",{get visibleItems(){return e(),l(()=>e().visibleItems)},get page(){return e(),l(()=>e().index+1)}},null);var j=J(u,2);{let g=G(()=>(e(),l(()=>!e().hasPrevious)));fe(j,{get label(){return O()},get disabled(){return f(g)},icon:"arrow-left",$$events:{click(...x){var _;(_=v.previousPage)==null||_.apply(this,x)}}})}var T=J(j,2),S=C(T),w=C(S);Q(S);var B=J(S,2);{var F=g=>{var x=Qe(),_=C(x);Q(x),de(M=>ce(_,`of ${M??""}`),[()=>(f(N),l(()=>f(N).toLocaleString()))]),P(g,x)};se(B,g=>{f(N)&&g(F)})}Q(T);var te=J(T,2);{let g=G(()=>(e(),l(()=>!e().hasNext||e().updating)));fe(te,{get label(){return Se()},get disabled(){return f(g)},icon:"arrow-right",$$events:{click:ie}})}Q(s),de((g,x)=>{Te(s,"aria-label",(re(k),l(()=>k["aria-label"]))),ce(w,`${g??""}â€“${x??""}`)},[()=>(e(),l(()=>e().indexStart.toLocaleString())),()=>(e(),l(()=>e().indexEnd.toLocaleString()))]),P(r,s)}}}),Ee(),h()}export{pt as A};
