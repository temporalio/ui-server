import"./CWj6FrbW.js";import"./69_IOA4Y.js";import{p as st,l as C,a as ot,t as H,r as G,d as q,b as rt,s as n,m,O as p,ac as at,g as t,e as nt,f as ct,h as ut,j as lt}from"./CtXwlho8.js";import{e as it}from"./BXc8M6y4.js";import{i as ft}from"./yjFgoZ2z.js";import{e as mt}from"./DN_bdWMP.js";import{i as pt}from"./D4D3ThYu.js";import{p as wt}from"./DdhuX4yd.js";import{s as dt,e as F,a as w,b as ht}from"./CI9zuxJp.js";import{a as vt}from"./BBGlwGsK.js";import{p as kt}from"./JbyttEuE.js";import{S as yt}from"./CTZ78y2A.js";import{w as I,q as _t,r as gt,c as D,d as xt}from"./DXxZqu-r.js";import{w as K}from"./Bj9-Wo8k.js";import{c as St}from"./90HwOBhi.js";import{S as Ct}from"./S6Q2Q0ub.js";import{w as N}from"./BzDsXp5j.js";import{b as It}from"./CbuO6hwR.js";import{t as Wt,c as bt}from"./C7UfhFbc.js";import{u as $t}from"./DnOd8PWE.js";import{W as Et}from"./Bk85UM9I.js";const Y=(i=[])=>i.map(o=>{const s=It(o==null?void 0:o.groupValues[0]),k=parseInt(o.count);return{status:s,count:k}}).sort((o,s)=>N.indexOf(o.status)-N.indexOf(s.status)),j=(i,o,s)=>{const u=Math.pow(3600/i,1/s),y=i*Math.pow(u,o);return Math.min(3600,Math.round(y))};var Pt=H("<button><!></button>"),qt=H('<div class="flex min-h-[24px] flex-wrap items-center gap-2"></div>');function Zt(i,o){st(o,!1);const[s,k]=dt(),u=()=>w(kt,"$page",s),y=()=>w(_t,"$queryWithParentWorkflowId",s),c=()=>w(I,"$workflowCount",s),L=()=>w(xt,"$disableWorkflowCountsRefresh",s),W=()=>w(K,"$workflowFilters",s),R=()=>w(gt,"$refresh",s),d=m(),h=m(),b=m();let B=wt(o,"staticQuery",8,""),O=m([]),_=m([]),g,v=1,x=m(!1);const Q=5,$=100;vt(()=>{A()});const U=()=>{if(v+=1,clearInterval(g),v<=$){const e=j(Q,v,$)*1e3;g=setInterval(()=>M(),e)}},A=()=>{clearInterval(g),n(_,[]),F(I,p(c).newCount=0,p(c)),v=1,n(x,!0)},M=async()=>{U();try{const{count:e,groups:r}=await D({namespace:t(d),query:t(h)}).catch(a=>({count:"0",groups:[]}));F(I,p(c).newCount=parseInt(e)-c().count,p(c)),n(_,Y(r))}finally{n(x,!1)}},V=async()=>{if(A(),!L()){const e=j(Q,v,$)*1e3;g=setInterval(()=>M(),e)}try{const{count:e,groups:r}=await D({namespace:t(d),query:t(h)}).catch(a=>({count:"0",groups:[]}));F(I,p(c).count=parseInt(e),p(c)),n(O,Y(r))}finally{n(x,!1)}},z=e=>{if(!W().some(a=>a.attribute==="ExecutionStatus"&&a.value===e)){const a={attribute:"ExecutionStatus",type:Ct.KEYWORD,value:e,operator:"",conditional:"=",parenthesis:""};ht(K,[...W(),a]);const l=Wt(bt(W()));$t({url:u().url,parameter:"query",value:l,clearParameters:[St]})}};C(()=>u(),()=>{n(d,u().params.namespace)}),C(()=>(at(B()),y()),()=>{n(h,B()||y())}),C(()=>u(),()=>{n(b,u().url.searchParams.get("per-page"))}),C(()=>(t(d),t(h),t(b),R()),()=>{t(d),t(h),t(b),R(),V()}),ot(),pt();var E=qt();mt(E,5,()=>t(O),({count:e,status:r})=>r,(e,r)=>{let a=()=>t(r).count,l=()=>t(r).status;var T=nt(),J=ct(T);{var X=f=>{var S=Pt(),tt=ut(S);const et=lt(()=>t(_).find(P=>P.status===l())?t(_).find(P=>P.status===l()).count-a():0);Et(tt,{get status(){return l()},get count(){return a()},get newCount(){return t(et)},get"test-id"(){return`workflow-status-${l()??""}`}}),G(S),it("click",S,()=>z(l())),q(f,S)},Z=f=>{yt(f,{class:"h-6 w-24 rounded-sm"})};ft(J,f=>{t(x)?f(Z,!1):f(X)})}q(e,T)}),G(E),q(i,E),rt(),k()}export{Zt as W};
