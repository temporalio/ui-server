import{d as p,w as B}from"./index-01673112.js";import{p as S}from"./stores-450871c1.js";import{e as O}from"./event-view-e18ef071.js";import{m as P}from"./route-for-0206cbc8.js";import{r as V}from"./workflow-run-86d8ad16.js";import{a as W}from"./auth-user-60d5655d.js";import{S as Y,i as Z,s as U,M as q,k as E,a as z,q as x,l as k,m as y,c as N,r as $,h,n as A,P as C,Q as w,b as H,K as b,f as v,g as G,t as g,d as K,u as ee,T as te,X as M,ae as se,N as ne,w as ae,x as re,y as oe,z as le,F as ie,G as ce,H as fe,I as ue}from"./index-b87195f7.js";import{I as me}from"./icon-0d1d09cf.js";import{p as J}from"./paginated-4ef05d2b.js";import{r as R,a as T}from"./route-for-api-1ff0909c.js";import{t as F}from"./index-fdaba712.js";import{b as de}from"./has-48bed8a5.js";const _e=p([S],([t])=>t.params.namespace?P(t.params.namespace):""),ve=p([S],([t])=>t.params.workflow?P(t.params.workflow):""),he=p([S],([t])=>t.params.run?P(t.params.run):""),pe=p([S],([t])=>{var e;return(e=t.data)==null?void 0:e.settings}),ge=p([W],([t])=>t==null?void 0:t.accessToken),be=p([_e,ve,he,O],([t,e,n,o])=>({namespace:t,workflowId:e,runId:n,sort:o}));p([be,pe,ge,V],([t,e,n,o])=>({...t,settings:e,accessToken:n,refresh:V,$refresh:o}));const Ee={start:[],end:[]},ze=B(Ee),Ne=B(null);function Q(t){let e,n,o;return n=new me({props:{name:t[2]}}),{c(){e=E("div"),ae(n.$$.fragment)},l(s){e=k(s,"DIV",{});var r=y(e);re(n.$$.fragment,r),r.forEach(h)},m(s,r){H(s,e,r),oe(n,e,null),o=!0},p(s,r){const c={};r&4&&(c.name=s[2]),n.$set(c)},i(s){o||(v(n.$$.fragment,s),o=!0)},o(s){g(n.$$.fragment,s),o=!1},d(s){s&&h(e),le(n)}}}function X(t){let e,n;const o=t[8].default,s=ie(o,t,t[7],null);return{c(){e=E("div"),s&&s.c(),this.h()},l(r){e=k(r,"DIV",{class:!0});var c=y(e);s&&s.l(c),c.forEach(h),this.h()},h(){A(e,"class","content svelte-19bo4l1")},m(r,c){H(r,e,c),s&&s.m(e,null),n=!0},p(r,c){s&&s.p&&(!n||c&128)&&ce(s,o,r,r[7],n?ue(o,r[7],c,null):fe(r[7]),null)},i(r){n||(v(s,r),n=!0)},o(r){g(s,r),n=!1},d(r){r&&h(e),s&&s.d(r)}}}function ke(t){let e,n,o,s,r,c,m,u,i=t[2]&&Q(t),l=t[6].default&&X(t),d=[{class:m="alert "+t[0]+" "+t[4]},{role:"alert"},t[5]],_={};for(let a=0;a<d.length;a+=1)_=q(_,d[a]);return{c(){e=E("div"),i&&i.c(),n=z(),o=E("div"),s=E("h5"),r=x(t[1]),c=z(),l&&l.c(),this.h()},l(a){e=k(a,"DIV",{class:!0,role:!0});var f=y(e);i&&i.l(f),n=N(f),o=k(f,"DIV",{class:!0});var I=y(o);s=k(I,"H5",{class:!0});var D=y(s);r=$(D,t[1]),D.forEach(h),c=N(I),l&&l.l(I),I.forEach(h),f.forEach(h),this.h()},h(){A(s,"class","font-semibold leading-6"),A(o,"class","ml-1"),C(e,_),w(e,"bold",t[3]),w(e,"svelte-19bo4l1",!0)},m(a,f){H(a,e,f),i&&i.m(e,null),b(e,n),b(e,o),b(o,s),b(s,r),b(o,c),l&&l.m(o,null),u=!0},p(a,[f]){a[2]?i?(i.p(a,f),f&4&&v(i,1)):(i=Q(a),i.c(),v(i,1),i.m(e,n)):i&&(G(),g(i,1,1,()=>{i=null}),K()),(!u||f&2)&&ee(r,a[1]),a[6].default?l?(l.p(a,f),f&64&&v(l,1)):(l=X(a),l.c(),v(l,1),l.m(o,null)):l&&(G(),g(l,1,1,()=>{l=null}),K()),C(e,_=te(d,[(!u||f&17&&m!==(m="alert "+a[0]+" "+a[4]))&&{class:m},{role:"alert"},f&32&&a[5]])),w(e,"bold",a[3]),w(e,"svelte-19bo4l1",!0)},i(a){u||(v(i),v(l),u=!0)},o(a){g(i),g(l),u=!1},d(a){a&&h(e),i&&i.d(),l&&l.d()}}}function ye(t,e,n){const o=["intent","title","icon","bold","class"];let s=M(e,o),{$$slots:r={},$$scope:c}=e;const m=se(r);let{intent:u}=e,{title:i}=e,{icon:l=null}=e,{bold:d=!1}=e,{class:_=""}=e;return t.$$set=a=>{e=q(q({},e),ne(a)),n(5,s=M(e,o)),"intent"in a&&n(0,u=a.intent),"title"in a&&n(1,i=a.title),"icon"in a&&n(2,l=a.icon),"bold"in a&&n(3,d=a.bold),"class"in a&&n(4,_=a.class),"$$scope"in a&&n(7,c=a.$$scope)},[u,i,l,d,_,s,m,c,r]}class Ce extends Y{constructor(e){super(),Z(this,e,ye,ke,U,{intent:0,title:1,icon:2,bold:3,class:4})}}const L=t=>!de(t)||t==="descending"?"events.descending":t==="ascending"?"events.ascending":"events.descending",Ge=async({namespace:t,workflowId:e,runId:n,sort:o,onStart:s,onUpdate:r,onComplete:c})=>{const m=L(o),u=R(m,{namespace:t,workflowId:e,runId:n});return(await J(async l=>T(u,{token:l,request:fetch}),{onStart:s,onUpdate:r,onComplete:c})).history.events},Ke=async({namespace:t,workflowId:e,runId:n,sort:o,settings:s,accessToken:r,onStart:c,onUpdate:m,onComplete:u})=>{const i=L(o),l=R(i,{namespace:t,workflowId:e,runId:n}),d=await J(async a=>T(l,{token:a,request:fetch}),{onStart:c,onUpdate:m,onComplete:u});return await F({response:d.history.events,namespace:t,settings:s,accessToken:r})},j=async({namespace:t,workflowId:e,runId:n,sort:o})=>{const s=R(`events.${o}`,{namespace:t,workflowId:e,runId:n});try{return(await T(s,{request:fetch,params:{maximumPageSize:"20"}})).history.events}catch{return[]}},Me=async t=>{const{settings:e,namespace:n,accessToken:o}=t,s=await j({...t,sort:"ascending"}),r=await j({...t,sort:"descending"}),[c,m]=await Promise.all([F({response:s,namespace:n,settings:e,accessToken:o}),F({response:r,namespace:n,settings:e,accessToken:o})]);return{start:c,end:m}};export{Ce as A,Ge as a,Ke as b,ze as e,Me as f,Ee as i,Ne as t};
