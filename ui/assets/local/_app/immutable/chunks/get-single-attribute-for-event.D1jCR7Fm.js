import{i as T}from"./index.C2kKV7nE.js";import{c as x}from"./format-camel-case.ByTIZu23.js";import{b as I,i as S}from"./decode-payload.CY9DxnVf.js";import{h as o,j as E}from"./has.BnvKvYqj.js";import{f as R,g as D}from"./get-event-categorization.BIiaO7R2.js";const L=t=>t===null||typeof t!="object"||Array.isArray(t)?!1:!!o(t,"activityType"),K=t=>t===null||typeof t!="object"||Array.isArray(t)?!1:!!(o(t,"operation")&&o(t,"endpoint")),f={key:"",value:""},g=new Set(["suggestContinueAsNew","historySizeBytes"]),c=(t,r)=>!(r===null||r===void 0||r===""||r==="0s"||t==="type"||(!r||r==="0")&&g.has(t)),j=["attempt","maximumAttempts","heartbeatDetails","lastHeartbeatTime","lastFailure","lastStartedTime","scheduledTime","expirationTime","lastWorkerIdentity"],v=t=>j.includes(t),tt=(t,r)=>!(r===null||r===void 0||r===""||r==="0s"||t==="type"||t==="workflowId"||t==="initiatedEventId"||t==="startedEventId"||t==="scheduledEventId"||t==="activityId"||t==="namespace"||t==="namespaceId"||t==="workflowTaskCompletedEventId"||t==="taskQueueKind"||(!r||r==="0")&&g.has(t)),rt=t=>!(t===null||t===void 0||t===""||Array.isArray(t)&&!t.length),et=t=>typeof t=="string"?t:[t==null?void 0:t.payloads,t==null?void 0:t.indexedFields,t==null?void 0:t.points,t].find(r=>r!==void 0),W=t=>{if(E(t)){if(o(t,"stackTrace")&&t.stackTrace)return t.stackTrace;for(const r in t)if(E(t[r]))return W(t[r])}},N=["baseRunId","continuedExecutionRunId","firstExecutionRunId","newExecutionRunId","newRunId","originalExecutionRunId"],it=(t,r)=>O(t)?"execution":C(t)?"task-queue":Q(t,r)?"child-workflow":q(t)?"nexus-endpoint":"none",O=t=>{for(const r of N)if(t===r)return!0;return!1},P=["taskQueueName"],C=t=>{for(const r of P)if(t===r)return!0;return!1},F=["workflowExecutionWorkflowId","workflowExecutionRunId"],Q=(t,r)=>{const e=!!(r!=null&&r.workflowExecutionWorkflowId&&(r!=null&&r.workflowExecutionRunId));for(const i of F)if(t===i&&e)return!0;return!1},B=["endpointId"],q=t=>{for(const r of B)if(t===r)return!0;return!1},nt=t=>{var r;return(r=t==null?void 0:t.toLowerCase())==null?void 0:r.endsWith("time")},a=(t,r)=>{if(typeof r=="object"){if(S(r))return{key:t,value:r};const[e]=Object.keys(r);return e?e==="payloads"?{key:t,value:r}:{key:t+x(e),value:r[e]}:{key:t,value:{}}}else return{key:t,value:r.toString()}},h=["activityType","signalName","workflowType","result","failure","input","outcome","workflowExecution","taskQueue","startToFireTimeout","attempt","historySizeBytes","identity","parentInitiatedEventId","endpointId"],z=({attributes:t})=>{for(const[r,e]of Object.entries(t))if(c(r,e))return a(r,e)},V=t=>{if(o(t,"ActivityType"))return t.ActivityType;if(o(t,"activity_type"))return t.activity_type},_=t=>{var r,e,i;return!!((i=(e=(r=t.markerRecordedEventAttributes)==null?void 0:r.details)==null?void 0:e.type)!=null&&i.payloads)},G=t=>{var e,i,u,d,l,p,y,m,k;const r=z(t);if(R(t)){const n=(((u=(i=(e=t.markerRecordedEventAttributes)==null?void 0:e.details)==null?void 0:i.data)==null?void 0:u.payloads)||((p=(l=(d=t.markerRecordedEventAttributes)==null?void 0:d.details)==null?void 0:l.type)==null?void 0:p.payloads)||[]).map(b=>I(b)),s=n==null?void 0:n[0];if(_(t)&&s)return a("ActivityType",s);const w=V(s);if(w)return a("ActivityType",w)}if(D(t)&&(k=(m=(y=t.attributes)==null?void 0:y.acceptedRequest)==null?void 0:m.input)!=null&&k.name)return{key:"name",value:t.attributes.acceptedRequest.input.name};for(const A of h)for(const[n,s]of Object.entries(t.attributes))if(n===A&&c(n,s))return a(n,s);return r||f},H=t=>({key:"attempt",value:t.attempt.toString()}),J=t=>t.attempt?{key:"attempt",value:t.attempt.toString()}:f,M=t=>T(t)?G(t):L(t)?H(t):K(t)?J(t):f,st=t=>t?M(t):f,ot=(t,r)=>{if(!t||!(t!=null&&t.attributes))return f;for(const e of h)for(const[i,u]of Object.entries(t.attributes))if(i===e&&i!==r&&c(i,u))return a(i,u);return f};export{rt as a,tt as b,v as c,K as d,et as e,W as f,M as g,it as h,L as i,nt as j,st as k,ot as l,j as p,c as s};
