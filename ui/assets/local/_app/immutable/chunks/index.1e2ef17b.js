import{c as y,p as T,i as g}from"./is-http.5869dfb4.js";import{c as v,a as k,d as w}from"./decode-payload.28a1fd15.js";import{b as P}from"./format-date.c58d555d.js";import{g as S,a as R,b as q}from"./get-codec.e9ddeec4.js";import{f as E}from"./is-event-type.3574dcf0.js";import{g as I}from"./get-event-categorization.35f43125.js";import{s as W}from"./simplify-attributes.26aa39ce.js";const F=["Unspecified","Scheduled","Open","New","Started","Initiated","Running","Completed","Fired","CancelRequested","TimedOut","Signaled","Canceled","Failed","Terminated"],J=e=>{if(e.includes("RequestCancel"))return"CancelRequested";for(const n of F)if(e.includes(n))return n};async function O({historyEvent:e,namespace:n,settings:t,accessToken:s},{convertWithCodec:a=v,convertWithWebsocket:o=k,decodeAttributes:c=w,encoderEndpoint:i=y,codecPassAccessToken:d=T,codecIncludeCredentials:r=g}={}){const{key:l,attributes:u}=E(e),m=S(t,i),p=R(t,d),f=q(t,r),C={...t,codec:{...t==null?void 0:t.codec,endpoint:m,passAccessToken:p,includeCredentials:f}},b=m?await a({attributes:u,namespace:n,settings:C,accessToken:s}):await o(u),A=c(b);return{type:l,...A}}const x=async({historyEvent:e,namespace:n,settings:t,accessToken:s})=>{const a=String(e.eventId),o=e.eventType,c=P(String(e.eventTime)),i=J(o),d=I(o),r=await O({historyEvent:e,namespace:n,settings:t,accessToken:s}).then(l=>W(l));return{...e,name:o,id:a,eventType:o,timestamp:c,classification:i,category:d,attributes:r}},j=async({response:e,namespace:n,settings:t,accessToken:s})=>await Promise.all(e.map(a=>x({historyEvent:a,namespace:n,settings:t,accessToken:s})));export{j as t};
