import{c as y,p as T,i as g}from"./is-http.1e6b12cd.js";import{g as v,a as k,b as w,c as P,d as S,e as R}from"./get-codec.ef173a79.js";import{f as q}from"./format-date.7c274b02.js";import{f as E}from"./is-event-type.763b5d4b.js";import{g as I}from"./get-event-categorization.d6ff7ec7.js";import{s as W}from"./simplify-attributes.ba9e7501.js";const F=["Unspecified","Scheduled","Open","New","Started","Initiated","Running","Completed","Fired","CancelRequested","TimedOut","Signaled","Canceled","Failed","Terminated"],J=e=>{if(e.includes("RequestCancel"))return"CancelRequested";for(const n of F)if(e.includes(n))return n};async function O({historyEvent:e,namespace:n,settings:t,accessToken:o},{convertWithCodec:a=P,convertWithWebsocket:s=S,decodeAttributes:c=R,encoderEndpoint:i=y,codecPassAccessToken:d=T,codecIncludeCredentials:r=g}={}){const{key:l,attributes:u}=E(e),m=v(t,i),p=k(t,d),f=w(t,r),C={...t,codec:{...t==null?void 0:t.codec,endpoint:m,passAccessToken:p,includeCredentials:f}},A=m?await a({attributes:u,namespace:n,settings:C,accessToken:o}):await s(u),b=c(A);return{type:l,...b}}const x=async({historyEvent:e,namespace:n,settings:t,accessToken:o})=>{const a=String(e.eventId),s=e.eventType,c=q(String(e.eventTime)),i=J(s),d=I(s),r=await O({historyEvent:e,namespace:n,settings:t,accessToken:o}).then(l=>W(l));return{...e,name:s,id:a,eventType:s,timestamp:c,classification:i,category:d,attributes:r}},h=async({response:e,namespace:n,settings:t,accessToken:o})=>await Promise.all(e.map(a=>x({historyEvent:a,namespace:n,settings:t,accessToken:o})));export{h as t};
