import{d as A}from"./CoW5n_Cg.js";import{c as C}from"./CyjWABYi.js";import{S as f}from"./S6Q2Q0ub.js";import{g as R}from"./BsnfN2fh.js";import{s as k}from"./DabnXCTi.js";import{e as p,f as I,j as b,k as y,l as h,m as E,n as F,o as m,q as w,r as B,t as D,u as K}from"./BDfAQ6r3.js";import{i as L,a as Q,t as S,b as P}from"./D1mJS6mY.js";import{i as W}from"./BDFbSVAj.js";import{u as N}from"./DZX0XlwG.js";const V={workflowId:"WorkflowId",workflowType:"WorkflowType",timeRange:"StartTime",executionStatus:"ExecutionStatus",closeTime:"CloseTime",runId:"RunId"},Y=(e,o)=>!(e===null&&!p(o)||e===void 0||e===""||typeof e=="string"&&e==="undefined"),O=({value:e,type:o,conditional:s})=>o===f.BOOL?e.toLowerCase()==="true":o===f.KEYWORDLIST&&b(s)?e:`"${e}"`,q=e=>{const o=V[e]??e;return typeof o=="string"&&/\s/g.test(o)?"`"+o+"`":o},M=(e,o,s,r="=",t,c)=>{const a=q(e);return s==="All"?"":c?`${a} ${s}`:p(r)?`\`${a}\` ${r} ${s}`:L(s)||Q(s)?t||R(k)?`${a} ${r} "${S(s)}"`:`${a} BETWEEN "${S(s)}" AND "${P()}"`:I(r)?`\`${a}\` ${r} ${O({value:s,type:o,conditional:r})}`:`\`${a}\`${r}${O({value:s,type:o,conditional:r})}`},j=(e,o)=>e.map(({attribute:s,type:r,value:t,conditional:c,operator:a,parenthesis:n,customDate:u})=>{if(Y(t,c)){let i=M(s,r,t,c,o,u);return n==="("?i=`(${i}`:n===")"&&(i=`${i})`),a&&(i=`${i} ${a} `),i}}).filter(Boolean),_=(e=[],o=!1)=>j(e,o).join(""),z=e=>{const o=[],s=()=>{r&&(o.push(r),r="")};let r="",t=0;const c=(a,n=!1)=>{for(let u=n?t:t+1;u<e.length;u++){const i=e[u];if(a(i)){n&&(r+=i),s(),t=u+1;return}r+=i}t++};for(;t<e.length;){const a=e[t];if(y(a)){const i=t===0||E(e[t-1])&&F(o[o.length-1])||h(e[t-1]),l=e.slice(t+1).includes(a);if(i&&l){s(),c(y);continue}}if(h(a)){const i=o[o.length-1];if(b(i)){c(B,!0);continue}else{r+=a,s(),t++;continue}}const n=`${e[t]}${e[t+1]}`,u=`${e[t]}${e[t+1]}${e[t+2]}`;if(m(u)){r+=u,s(),t+=3;continue}else if(m(n)&&(E(e[t+2])||w(e[t+2])||h(e[t+2]))){r+=n,s(),t+=2;continue}else if(m(a)){s(),r+=a,t++;continue}if(w(a)){s();const i=m(e[t-1]),l=e.slice(t+1).includes(a);if(i&&l){c(d=>d===a);continue}t++;continue}if(E(a)){s(),t++;continue}r+=a,t++}return s(),o},g=e=>o=>o.toLowerCase()===e.toLowerCase(),H=(e,o)=>e[o+1],J=(e,o)=>e[o+2],U=(e,o)=>e[o+3],G=(e,o)=>e[o-2],X=g(f.DATETIME),Z=g(f.BOOL),$=()=>({attribute:"",type:f.KEYWORD,value:"",operator:"",parenthesis:"",conditional:""}),x={ExecutionStatus:f.KEYWORD,StartTime:f.DATETIME,CloseTime:f.DATETIME,WorkflowId:f.KEYWORD,WorkflowType:f.KEYWORD,RunId:f.KEYWORD},lt=(e,o=x)=>{const s=z(e),r=[];let t=$();if(!e)return[];try{return s.forEach((c,a)=>{const n=H(s,a),u=J(s,a);if(o[c])if(t.attribute=c,t.type=o[c],p(n)){const i=`${n} ${u}`,l=p(i)?U(s,a):u;t.value=l.toLocaleLowerCase()==="null"?null:l}else if(X(o[c])){const i=u,l=W(i);if(D(n)){const T=s[a+4],d=W(T);l&&d?(t.value=`BETWEEN "${i}" AND "${T}"`,t.customDate=!0,t.conditional="BETWEEN"):console.error("Error parsing Datetime field from query")}else l?t.value=i:console.error("Error parsing Datetime field from query")}else Z(t.type)?(t.value=n.replace("=",""),t.conditional="="):t.value=u;if(!t.conditional&&m(c)){const i=`${c} ${n}`;p(i)?t.conditional=i:t.conditional=c}h(c)&&(t.parenthesis=c),K(c)&&!D(G(s,a))&&(t.operator=c,r.push(t),t=$()),a===s.length-1&&(r.push(t),t=$())}),r}catch(c){return console.error("Error setting filter parameters: ",c),[]}},v=e=>{const o=e.filter(n=>n.attribute==="ExecutionStatus"&&n.value),s=e.filter(n=>n.attribute==="WorkflowId"&&n.value),r=e.filter(n=>n.attribute==="WorkflowType"&&n.value),t=e.filter(n=>n.attribute==="RunId"&&n.value),c=e.filter(n=>(n.attribute==="StartTime"||n.attribute==="CloseTime")&&n.value),a=[o,s,t,r,c].filter(n=>n.length);return a.forEach((n,u)=>{var i,l;n.length&&((i=a[u+1])!=null&&i.length)?n[n.length-1].operator="AND":n.length&&!((l=a[u+1])!=null&&l.length)&&(n[n.length-1].operator="")}),[...o,...s,...t,...r,...c]},tt=e=>(e.forEach((o,s)=>{const r=e[s-1];r&&!r.operator&&(r.operator="AND");const t=e[s+1];t||(o.operator=""),o.operator==="OR"&&(t==null?void 0:t.attribute)!==o.attribute?(o.parenthesis="",o.operator=""):o.operator==="OR"&&(r==null?void 0:r.operator)!=="OR"?o.parenthesis="(":(r==null?void 0:r.operator)==="OR"&&o.operator!=="OR"?o.parenthesis=")":o.parenthesis=""}),e),ft=A((e,o,s=!1)=>{const r=s?v(o):tt(o),t=_(r);N({url:e,parameter:"query",value:t,allowEmpty:!1,clearParameters:[C]})},300);export{lt as a,tt as c,$ as e,_ as t,ft as u};
