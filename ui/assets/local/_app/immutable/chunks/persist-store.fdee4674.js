import{w as I}from"./index.169c571c.js";import{p as S,s as p}from"./parse-with-big-int.02af2f95.js";const m=e=>typeof e=="function";function y(e,a=null,u=!1){var l,c;let n=m(a)?a():a,o;try{(l=window==null?void 0:window.localStorage)!=null&&l.getItem(e)&&(n=S(((c=window==null?void 0:window.localStorage)==null?void 0:c.getItem(e))??""))}catch{n=null}const{subscribe:g,set:i,update:f}=I(n);if(u)try{o=new BroadcastChannel(`persist-store-${e}`),o==null||o.addEventListener("message",t=>{i(t.data)})}catch{console.error("Browser does not support BroadcastChannel")}return{subscribe:g,set:t=>{var r,s;o&&o.postMessage(t),t===null?(r=window==null?void 0:window.localStorage)==null||r.removeItem(e):(s=window==null?void 0:window.localStorage)==null||s.setItem(e,p(t)),i(t)},update:t=>{var r;(r=window==null?void 0:window.localStorage)==null||r.removeItem(e),f(s=>{var d;const w=t(s);return(d=window==null?void 0:window.localStorage)==null||d.setItem(e,p(w)),w})}}}export{m as i,y as p};
