import"./CWj6FrbW.js";import"./69_IOA4Y.js";import{p as ze,s as q,m as ae,g as f,l as ne,ah as Ne,a as Le,aJ as ke,f as I,c as F,e as C,d as L,r as G,t as ge,b as Ae}from"./DYX0w8bX.js";import{s as ue}from"./CxFVcq4O.js";import{i as re}from"./B_BuKjdB.js";import{t as se,a as S,c as w}from"./Bz76f8pg.js";import{s as y}from"./CFGOF_JX.js";import{a as Ee}from"./BoNO6UAY.js";import{e as Ke}from"./B8vPeB6P.js";import{i as Te}from"./CZRFLhJG.js";import{l as fe,p as o}from"./BrXzBH3h.js";import{a as Be,s as Fe}from"./CgU0heln.js";import{d as Me}from"./BGl1DbLa.js";import{w as Re,d as me,o as Ue}from"./DsexP6Wk.js";import{A as He}from"./5uztS7tZ.js";import{E as xe}from"./mx1MzmJ5.js";import{I as pe}from"./DdlJDo7u.js";import{L as Oe}from"./724y1XB3.js";import{F as We}from"./JYy17XAK.js";import{p as Je}from"./D-_b-SJL.js";import{o as Se,p as Pe,b as je,d as Q}from"./DDAxnLud.js";import{m as qe}from"./BqNaQ_Wm.js";import{P as Ce}from"./BpWjuiDO.js";const ve={key:Pe,loading:!0,updating:!1,hasNext:!1,hasPrevious:!1,index:0,previousPageSize:Q,pageSize:Q,indexData:{},visibleItems:[],hasNextIndexData:!1,indexStart:0,indexEnd:0,activeIndex:0},he=P=>{const n=P[0];if(!n)return Q;const x=parseInt(n.toString());return isNaN(x)?Q:x},Ge=(P,n=void 0)=>{if(n){const x=parseInt(n.toString());return isNaN(x)?he(P):x}else return he(P)};function Qe(P=Se,n=void 0){const x=Ge(P,n),M=Re({...ve,previousPageSize:x,pageSize:x}),{set:V,update:p}=M,a=me([Je],([e])=>{const t=e.url.searchParams.get(Pe);return t?je(t):void 0}),{subscribe:k}=me([M,a],([e,t])=>{var O,E,W;const l=((O=e.indexData[e.index])==null?void 0:O.items)??[],g=((E=e.indexData[e.index])==null?void 0:E.start)??0,i=((W=e.indexData[e.index])==null?void 0:W.end)??0,Z=!!e.indexData[e.index+1];return{...e,visibleItems:l,indexStart:g,indexEnd:i,hasNextIndexData:Z,pageSize:t??e.pageSize}}),A=(e,t,l)=>{const g=l.index,i={...l,indexData:{...l.indexData},hasNext:!!e,updating:!1,loading:!1};return t.length?(i.indexData[g]?(i.index=g+1,i.indexData[i.index]={nextToken:e,start:i.indexData[g].end+1,end:i.indexData[g].end+t.length,items:t},i.hasPrevious=!0):(i.indexData[g]={nextToken:e,start:1,end:t.length,items:t},i.hasPrevious=!1),i):{...i,hasNext:!1}},X=e=>{var l;const t={...e,index:e.index+1,hasPrevious:!0,loading:!1,updating:!1};return(l=t.indexData[t.index])!=null&&l.nextToken||(t.hasNext=!1),t},Y=e=>{const t={...e,hasNext:!0,updating:!1,loading:!1,index:e.index>0?e.index-1:0};return t.index===0&&(t.hasPrevious=!1),t},z=e=>{var g,i;const t={...e},l=((i=(g=t.indexData[t.index])==null?void 0:g.items)==null?void 0:i.length)??0;return t.activeIndex<l-1&&(t.activeIndex=t.activeIndex+1),t},R=e=>{const t={...e},l=t.activeIndex>=1?t.activeIndex-1:0;return t.activeIndex=l,t},U=(e,t)=>({...e,activeIndex:t}),H=(e,t)=>({...e,pageSize:t,previousPageSize:t,index:0,indexData:{},loading:!0,updating:!1});return{subscribe:k,nextPageWithItems:(e,t)=>p(l=>A(e,t,l)),nextPage:()=>p(e=>X(e)),previousPage:()=>p(e=>Y(e)),setUpdating:()=>p(e=>({...e,updating:!0})),reset:()=>V(ve),resetPageSize:e=>p(t=>H(t,e)),nextRow:()=>p(e=>z(e)),previousRow:()=>p(e=>R(e)),setActiveIndex:e=>p(t=>U(t,e))}}var Ve=se("<p> </p>"),Xe=se('<nav class="flex shrink-0 items-center gap-2" slot="actions-end"><!> <!> <div class="flex gap-1"><p> </p> <!></div> <!></nav>'),Ye=se("<!> <!>",1);function bt(P,n){const x=fe(n,["children","$$slots","$$events","$$legacy"]),M=fe(x,["id","maxHeight","onError","onFetch","onShiftUp","onShiftDown","onSpace","total","pageSizeSelectLabel","emptyStateTitle","emptyStateMessage","errorTitle","errorMessage","itemsKeyname","previousButtonLabel","nextButtonLabel","pageSizeOptions","debounceDelay"]);ze(n,!1);const[V,p]=Fe(),a=()=>Be(u,"$store",V),k=ae(),A=ae();let X=o(n,"id",8,null),Y=o(n,"maxHeight",8,""),z=o(n,"onError",8,void 0),R=o(n,"onFetch",8),U=o(n,"onShiftUp",8,void 0),H=o(n,"onShiftDown",8,void 0),e=o(n,"onSpace",8,void 0),t=o(n,"total",8,""),l=o(n,"pageSizeSelectLabel",8),g=o(n,"emptyStateTitle",8,""),i=o(n,"emptyStateMessage",8,""),Z=o(n,"errorTitle",8,""),O=o(n,"errorMessage",8,""),E=o(n,"itemsKeyname",8,"items"),W=o(n,"previousButtonLabel",8),be=o(n,"nextButtonLabel",8),$=o(n,"pageSizeOptions",8,Se),_e=o(n,"debounceDelay",8,250),u=Qe($(),$()[0]),N=ae();function Ie(){f(N)&&q(N,void 0)}Ue(()=>{J()});async function J(){const r=await R()();try{const d=await r(a().pageSize,""),{nextPageToken:s}=d,c=d[E()]||[];u.nextPageWithItems(s,c)}catch(d){q(N,d),z()&&z()(f(N))}}const ye=async()=>{try{const d=await(await R()())(a().pageSize,a().indexData[a().index].nextToken),{nextPageToken:s}=d,c=d[E()]||[];u.nextPageWithItems(s,c)}catch(r){qe(r)&&z()&&z()(r)}};async function ie(){Ie(),u.setUpdating(),a().hasNextIndexData?u.nextPage():Me(await ye,_e())()}async function De(r){if(r.repeat)return;const d=r.shiftKey;switch(r.code){case"ArrowRight":case"KeyL":a().hasNext&&!a().updating&&ie();break;case"ArrowLeft":case"KeyH":a().hasPrevious&&!a().updating&&u.previousPage();break;case"ArrowUp":case"KeyK":d&&U()?(U()(r),u.reset(),J()):u.previousRow();break;case"ArrowDown":case"KeyJ":d&&H()?(H()(r),u.reset(),J()):u.nextRow();break;case"Space":e()&&e()(r);break}}ne(()=>a(),()=>{q(k,!a().loading&&a().pageSize!==a().previousPageSize)}),ne(()=>(f(k),a()),()=>{f(k)&&(u.resetPageSize(a().pageSize),J())}),ne(()=>(a(),Ne(t())),()=>{q(A,!a().hasNext&&a().indexEnd!==t()?a().indexEnd:t())}),Le(),Te();var oe=Ye();Ke("keydown",ke,De);var le=I(oe);y(le,n,"header",{get visibleItems(){return a().visibleItems}},null);var we=F(le,2);Ce(we,{get loading(){return a().loading},get updating(){return a().updating},get visibleItems(){return a().visibleItems},get maxHeight(){return Y()},get id(){return X()},children:(r,d)=>{var s=w(),c=I(s);y(c,n,"default",{get visibleItems(){return a().visibleItems}},null),S(r,s)},$$slots:{default:!0,caption:(r,d)=>{var s=w(),c=I(s);y(c,n,"caption",{},null),S(r,s)},headers:(r,d)=>{var s=w(),c=I(s);y(c,n,"headers",{get visibleItems(){return a().visibleItems}},null),S(r,s)},empty:(r,d)=>{var s=w(),c=I(s);{var j=v=>{var b=w(),K=I(b);y(K,n,"loading",{},T=>{Oe(T,{})}),S(v,b)},ee=(v,b)=>{{var K=_=>{var D=w(),B=I(D);y(B,n,"error",{},m=>{xe(m,{get title(){return Z()},children:(h,de)=>{const te=L(()=>{var ce;return((ce=f(N))==null?void 0:ce.message)??O()});He(h,{intent:"error",get title(){return f(te)}})},$$slots:{default:!0}})}),S(_,D)},T=_=>{var D=w(),B=I(D);y(B,n,"empty",{},m=>{xe(m,{get title(){return g()},get content(){return i()}})}),S(_,D)};re(v,_=>{f(N)?_(K):_(T,!1)},b)}};re(c,v=>{a().loading?v(j):v(ee,!1)})}S(r,s)},"actions-start":(r,d)=>{const s=L(()=>String(a().pageSize));We(r,{get label(){return l()},get parameter(){return a().key},get value(){return f(s)},get options(){return $()}})},"actions-end":(r,d)=>{var s=Xe(),c=C(s);y(c,n,"actions-end-additional",{get visibleItems(){return a().visibleItems},get page(){return a().index+1}},null);var j=F(c,2);const ee=L(()=>!a().hasPrevious);pe(j,{get label(){return W()},get disabled(){return f(ee)},icon:"arrow-left",$$events:{click(...m){var h;(h=u.previousPage)==null||h.apply(this,m)}}});var v=F(j,2),b=C(v),K=C(b);G(b);var T=F(b,2);{var _=m=>{var h=Ve(),de=C(h);G(h),ge(te=>ue(de,`of ${te??""}`),[()=>f(A).toLocaleString()],L),S(m,h)};re(T,m=>{f(A)&&m(_)})}G(v);var D=F(v,2);const B=L(()=>!a().hasNext||a().updating);pe(D,{get label(){return be()},get disabled(){return f(B)},icon:"arrow-right",$$events:{click:ie}}),G(s),ge((m,h)=>{Ee(s,"aria-label",M["aria-label"]),ue(K,`${m??""}â€“${h??""}`)},[()=>a().indexStart.toLocaleString(),()=>a().indexEnd.toLocaleString()],L),S(r,s)}}}),S(P,oe),Ae(),p()}export{bt as A};
