import{r as D,t as W,b as k,i as F,c as C,d as T,e as N}from"./format-time.6TuExJAg.js";import{d as $}from"./index.i9NI_-YN.js";import{c as B}from"./pagination.CBBVToGe.js";import{S as c}from"./time-picker.C3GWBgVS.js";import{C as K,s as L,x as g,i as S,f as A,a as q,u as P,g as Q,e as V,t as Y,l as M,q as H,v as h}from"./scheduler.BTg3iwM1.js";import{i as v}from"./workflows.RmhwnVnF.js";import{l as m,m as U,n as E,b as j,a as z,o as J}from"./has.BWrERxPV.js";import{t as G}from"./tokenize.bmJ3_w3l.js";import{i as w}from"./time-format.mc3rVUkB.js";import{u as X}from"./update-query-parameters.BVSg7Pmt.js";import{S as Z,i as x,g as ee,b as p,e as te,t as _}from"./index.64bqrcBm.js";import{t as re}from"./translate.BBe5dcco.js";function oe(t,e){D(2,arguments);var r=W(t).getTime(),o=k(e);return new Date(r+o)}var se=36e5;function Ke(t,e){D(2,arguments);var r=k(e);return oe(t,r*se)}const ae={workflowId:"WorkflowId",workflowType:"WorkflowType",timeRange:"StartTime",executionStatus:"ExecutionStatus",closeTime:"CloseTime",runId:"RunId"},ne=(t,e)=>!(t===null&&!m(e)||t===void 0||t===""||typeof t=="string"&&t==="undefined"),b=(t,e)=>e===c.BOOL?t.toLowerCase()==="true":`"${t}"`,ie=t=>{const e=ae[t]??t;return typeof e=="string"&&/\s/g.test(e)?"`"+e+"`":e},le=(t,e,r,o="=",s,l)=>{const i=ie(t);return r==="All"?"":l?`${i} ${r}`:m(o)?`\`${i}\` ${o} ${r}`:F(r)||C(r)?s||K(v)?`${i} ${o} "${T(r)}"`:`${i} BETWEEN "${T(r)}" AND "${N()}"`:U(o)?`\`${i}\` ${o} ${b(r,e)}`:`\`${i}\`${o}${b(r,e)}`},ue=(t,e)=>t.map(({attribute:r,type:o,value:s,conditional:l,operator:i,parenthesis:a,customDate:u})=>{if(ne(s,l)){let n=le(r,o,s,l,e,u);return a==="("?n=`(${n}`:a===")"&&(n=`${n})`),i&&(n=`${n} ${i} `),n}}).filter(Boolean),ce=(t=[],e=!1)=>ue(t,e).join(""),O=t=>e=>e.toLowerCase()===t.toLowerCase(),fe=(t,e)=>t[e+1],me=(t,e)=>t[e+2],de=(t,e)=>t[e+3],pe=(t,e)=>t[e-2],_e=O(c.DATETIME),ye=O(c.BOOL),d=()=>({attribute:"",type:c.KEYWORD,value:"",operator:"",parenthesis:"",conditional:""}),Te={ExecutionStatus:c.KEYWORD,StartTime:c.DATETIME,CloseTime:c.DATETIME,WorkflowId:c.KEYWORD,WorkflowType:c.KEYWORD,RunId:c.KEYWORD},Le=(t,e=Te)=>{const r=G(t),o=[];let s=d();if(!t)return[];try{return r.forEach((l,i)=>{const a=fe(r,i),u=me(r,i);if(e[l])if(s.attribute=l,s.type=e[l],m(a)){const n=`${a} ${u}`;s.value=m(n)?de(r,i):u}else if(_e(e[l])){const n=u,f=w(n);if(E(a)){const y=r[i+4],I=w(y);f&&I?(s.value=`BETWEEN "${n}" AND "${y}"`,s.customDate=!0):console.error("Error parsing Datetime field from query")}else f?s.value=n:console.error("Error parsing Datetime field from query")}else ye(s.type)?(s.value=a.replace("=",""),s.conditional="="):s.value=u;if(j(l)){const n=`${l} ${a}`;m(n)?s.conditional=n:s.conditional=l}z(l)&&(s.parenthesis=l),J(l)&&!E(pe(r,i))&&(s.operator=l,o.push(s),s=d()),i===r.length-1&&(o.push(s),s=d())}),o}catch(l){return console.error("Error setting filter parameters: ",l),[]}},ge=t=>{const e=t.filter(a=>a.attribute==="ExecutionStatus"&&a.value),r=t.filter(a=>a.attribute==="WorkflowId"&&a.value),o=t.filter(a=>a.attribute==="WorkflowType"&&a.value),s=t.filter(a=>a.attribute==="RunId"&&a.value),l=t.filter(a=>(a.attribute==="StartTime"||a.attribute==="CloseTime")&&a.value),i=[e,r,s,o,l].filter(a=>a.length);return i.forEach((a,u)=>{var n,f;a.length&&((n=i[u+1])!=null&&n.length)?a[a.length-1].operator="AND":a.length&&!((f=i[u+1])!=null&&f.length)&&(a[a.length-1].operator="")}),[...e,...r,...s,...o,...l]},he=t=>(t.forEach((e,r)=>{const o=t[r-1];o&&!o.operator&&(o.operator="AND");const s=t[r+1];s||(e.operator=""),e.operator==="OR"&&(s==null?void 0:s.attribute)!==e.attribute?(e.parenthesis="",e.operator=""):e.operator==="OR"&&(o==null?void 0:o.operator)!=="OR"?e.parenthesis="(":(o==null?void 0:o.operator)==="OR"&&e.operator!=="OR"?e.parenthesis=")":e.parenthesis=""}),t),qe=$((t,e,r=!1)=>{const o=r?ge(e):he(e),s=ce(o);X({url:t,parameter:"query",value:s,allowEmpty:!1,clearParameters:[B]})},300),R=["Running","TimedOut","Completed","Failed","ContinuedAsNew","Canceled","Terminated"];function Pe(t){return R.includes(t)}const Qe=["All",...R];function Ee(t){let e;const r=t[5].default,o=q(r,t,t[4],null);return{c(){o&&o.c()},l(s){o&&o.l(s)},m(s,l){o&&o.m(s,l),e=!0},p(s,l){o&&o.p&&(!e||l&16)&&P(o,r,s,s[4],e?V(r,s[4],l,null):Q(s[4]),null)},i(s){e||(_(o,s),e=!0)},o(s){p(o,s),e=!1},d(s){o&&o.d(s)}}}function we(t){let e;return{c(){e=Y(t[1])},l(r){e=M(r,t[1])},m(r,o){S(r,e,o)},p(r,o){o&2&&H(e,r[1])},i:h,o:h,d(r){r&&A(e)}}}function be(t){let e,r,o,s;const l=[we,Ee],i=[];function a(u,n){return u[1]!==u[0]?0:1}return e=a(t),r=i[e]=l[e](t),{c(){r.c(),o=g()},l(u){r.l(u),o=g()},m(u,n){i[e].m(u,n),S(u,o,n),s=!0},p(u,[n]){let f=e;e=a(u),e===f?i[e].p(u,n):(ee(),p(i[f],1,1,()=>{i[f]=null}),te(),r=i[e],r?r.p(u,n):(r=i[e]=l[e](u),r.c()),_(r,1),r.m(o.parentNode,o))},i(u){s||(_(r),s=!0)},o(u){p(r),s=!1},d(u){u&&A(o),i[e].d(u)}}}function De(t,e,r){let o,{$$slots:s={},$$scope:l}=e,{key:i}=e,{count:a=void 0}=e,{replace:u=void 0}=e;return t.$$set=n=>{"key"in n&&r(0,i=n.key),"count"in n&&r(2,a=n.count),"replace"in n&&r(3,u=n.replace),"$$scope"in n&&r(4,l=n.$$scope)},t.$$.update=()=>{t.$$.dirty&13&&r(1,o=re(i,{...u,count:a}))},[i,o,a,u,l,s]}class Ve extends Z{constructor(e){super(),x(this,e,De,be,L,{key:0,count:2,replace:3})}}export{Ve as T,Le as a,Ke as b,he as c,oe as d,d as e,Qe as f,Pe as i,ce as t,qe as u,R as w};
