import"../chunks/Bzak7iHL.js";import"../chunks/69_IOA4Y.js";import{p as M,u as r,ag as ne,aH as le,t as R,i as y,r as b,e as p,b as N,g as e,s as ie,h as Q,f as T,c as _,j as W,n as ce,k as me,o as fe}from"../chunks/DtSMpxPp.js";import{i as pe}from"../chunks/DM92YGvC.js";import{s as O,a as $}from"../chunks/QkTQNHha.js";import{p as ue}from"../chunks/BfwrTvVC.js";import{P as ve}from"../chunks/zuYibhCe.js";import{t as o}from"../chunks/BXv1jDVW.js";import{s as U}from"../chunks/ChP_J8fE.js";import{a as we}from"../chunks/BXR8ESKi.js";import{i as j}from"../chunks/BUX2ey9N.js";import{p as G}from"../chunks/BgStGd3J.js";import{A as J}from"../chunks/8O0Bfit0.js";import{C as ke}from"../chunks/DUeYNCR-.js";import{E as K}from"../chunks/D2B4GuyQ.js";import{L as _e}from"../chunks/82j0Gii5.js";import{S as H}from"../chunks/DzBtnuBY.js";import{g as de}from"../chunks/Di6DEDIJ.js";import{a as ge}from"../chunks/CoPSvM7r.js";import{f as $e,r as he,t as xe}from"../chunks/D8JWfvYP.js";import{w as ye,r as be}from"../chunks/C2Ppw083.js";var Te=R('<!> <p> </p> <div class="my-2 flex h-full items-start"><!></div>',1),Re=R('<div class="flex flex-col gap-2"><!> <!> <!></div>'),Se=R("<p> <!> </p>"),qe=R("<section><!></section>");function De(A,C){M(C,!0);const[w,E]=O(),h=()=>$(ye,"$workflowRun",w),S=()=>$(be,"$refresh",w),q=()=>$(xe,"$timeFormat",w),D=()=>$(he,"$relativeTime",w),x=()=>$(ge,"$authUser",w);let i=r(()=>h().workflow),z=r(()=>h().workers);const V=r(()=>G.params.namespace);let B=ne(void 0),X=r(()=>$e(S()?new Date(S()):new Date,q(),{relative:D(),abbrFormat:!0}));const Y=()=>{var n;return de({workflow:e(i),namespace:e(V)},(n=G.data)===null||n===void 0?void 0:n.settings,x()===null||x()===void 0?void 0:x().accessToken)};le(()=>{!(e(i)===null||e(i)===void 0)&&e(i).isRunning&&ie(B,Y(),!0)});var L=qe(),Z=y(L);{var ee=n=>{var k=Q(),d=T(k);we(d,()=>e(B),c=>{var s=Re(),m=y(s);H(m,{class:"h-16 w-1/3 rounded-sm"});var u=_(m,2);H(u,{class:"h-3 w-32"});var f=_(u,2);H(f,{class:"h-48 w-full rounded-sm"}),b(s),p(c,s)},(c,s)=>{var m=Q(),u=T(m);{var f=t=>{var l=Te(),F=T(l);const v=r(()=>o("workflows.call-stack-alert"));J(F,{intent:"info",get title(){return e(v)},class:"mb-4 w-fit"});var g=_(F,2),I=y(g);b(g);var P=_(g,2),re=y(P);const oe=r(()=>o("common.copy-icon-title")),se=r(()=>o("common.copy-success-icon-title"));ke(re,{get content(){return e(s)},language:"text",testId:"query-call-stack",get copyIconTitle(){return e(oe)},get copySuccessIconTitle(){return e(se)}}),b(P),W(ae=>U(I,`${ae??""}
          ${e(X)??""}`),[()=>o("workflows.call-stack-at")]),p(t,l)},a=t=>{const l=r(()=>o("workflows.call-stack-error"));J(t,{intent:"warning",get title(){return e(l)},class:"mb-4 w-fit"})};j(u,t=>{typeof e(s)=="string"?t(f):t(a,!1)})}p(c,m)},(c,s)=>{const m=r(()=>o("common.error-occurred")),u=r(()=>o("workflows.no-workers-running-message")),f=r(()=>{var a;return(a=e(s))==null?void 0:a.message});K(c,{get title(){return e(m)},get content(){return e(u)},get error(){return e(f)}})}),p(n,k)},te=n=>{const k=r(()=>o("workflows.call-stack-empty-state"));K(n,{get title(){return e(k)},testId:"query-call-stack-empty",children:(d,c)=>{var s=Q(),m=T(s);{var u=f=>{var a=Se(),t=y(a,!0),l=_(t);_e(l,{newTab:!0,href:"https://docs.temporal.io/workflows#stack-trace-query",children:(v,g)=>{ce();var I=me();W(P=>U(I,P),[()=>o("workflows.call-stack-link")]),p(v,I)},$$slots:{default:!0}});var F=_(l,1,!0);b(a),W((v,g)=>{U(t,v),U(F,g)},[()=>o("workflows.call-stack-link-preface"),()=>{var v;return o("workflows.call-stack-link-postface",{taskQueue:(v=e(i))==null?void 0:v.taskQueue})}]),p(f,a)};j(m,f=>{var a,t,l;(a=e(i))!=null&&a.isRunning&&((l=(t=e(z))==null?void 0:t.pollers)==null?void 0:l.length)===0&&f(u)})}p(d,s)},$$slots:{default:!0}})};j(Z,n=>{var k,d,c;(k=e(i))!=null&&k.isRunning&&((c=(d=e(z))==null?void 0:d.pollers)==null?void 0:c.length)>0?n(ee):n(te,!1)})}b(L),p(A,L),N(),E()}var Fe=R("<!> <!>",1);function Ye(A,C){M(C,!1);const[w,E]=O(),h=()=>$(ue,"$page",w),S=h().params.workflow;pe();var q=Fe(),D=T(q);const x=fe(()=>`${o("workflows.call-stack-tab")} | ${S}`);ve(D,{get title(){return e(x)},get url(){return h().url.href}});var i=_(D,2);De(i,{}),p(A,q),N(),E()}export{Ye as component};
