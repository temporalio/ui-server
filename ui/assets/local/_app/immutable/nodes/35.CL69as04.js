import"../chunks/Bzak7iHL.js";import"../chunks/69_IOA4Y.js";import{p as M,u as r,ag as ne,aH as le,t as R,i as y,r as T,e as p,b as N,g as e,s as ie,h as Q,f as b,c as _,j as W,n as ce,k as me,o as fe}from"../chunks/C-0kx8Rl.js";import{i as pe}from"../chunks/DFzl7kYA.js";import{s as O,a as $}from"../chunks/B0Wc33k0.js";import{p as ue}from"../chunks/xRv_ndOd.js";import{P as ve}from"../chunks/DMOchDbk.js";import{t as o}from"../chunks/BXv1jDVW.js";import{s as U}from"../chunks/B-1TjF6E.js";import{a as we}from"../chunks/D7Rg7Pz7.js";import{i as j}from"../chunks/DIXBMONz.js";import{p as G}from"../chunks/d2aJgQU1.js";import{A as J}from"../chunks/LaSHB24F.js";import{C as ke}from"../chunks/CjXSN14h.js";import{E as K}from"../chunks/gfJM6Lr5.js";import{L as _e}from"../chunks/Bqf9ItQ6.js";import{S as H}from"../chunks/BDh4L5mi.js";import{g as de}from"../chunks/CxkFmDR2.js";import{a as ge}from"../chunks/CugiL4oY.js";import{f as $e,r as he,a as xe}from"../chunks/BnZXuwac.js";import{w as ye,r as Te}from"../chunks/D3po6tj5.js";var be=R('<!> <p> </p> <div class="my-2 flex h-full items-start"><!></div>',1),Re=R('<div class="flex flex-col gap-2"><!> <!> <!></div>'),Se=R("<p> <!> </p>"),qe=R("<section><!></section>");function De(A,C){M(C,!0);const[w,E]=O(),h=()=>$(ye,"$workflowRun",w),S=()=>$(Te,"$refresh",w),q=()=>$(xe,"$timeFormat",w),D=()=>$(he,"$relativeTime",w),x=()=>$(ge,"$authUser",w);let i=r(()=>h().workflow),z=r(()=>h().workers);const V=r(()=>G.params.namespace);let B=ne(void 0),X=r(()=>$e(S()?new Date(S()):new Date,q(),{relative:D(),format:"short"}));const Y=()=>{var n;return de({workflow:e(i),namespace:e(V)},(n=G.data)===null||n===void 0?void 0:n.settings,x()===null||x()===void 0?void 0:x().accessToken)};le(()=>{!(e(i)===null||e(i)===void 0)&&e(i).isRunning&&ie(B,Y(),!0)});var L=qe(),Z=y(L);{var ee=n=>{var k=Q(),d=b(k);we(d,()=>e(B),c=>{var s=Re(),m=y(s);H(m,{class:"h-16 w-1/3 rounded-sm"});var u=_(m,2);H(u,{class:"h-3 w-32"});var f=_(u,2);H(f,{class:"h-48 w-full rounded-sm"}),T(s),p(c,s)},(c,s)=>{var m=Q(),u=b(m);{var f=t=>{var l=be(),I=b(l);const v=r(()=>o("workflows.call-stack-alert"));J(I,{intent:"info",get title(){return e(v)},class:"mb-4 w-fit"});var g=_(I,2),P=y(g);T(g);var F=_(g,2),re=y(F);const oe=r(()=>o("common.copy-icon-title")),se=r(()=>o("common.copy-success-icon-title"));ke(re,{get content(){return e(s)},language:"text",testId:"query-call-stack",get copyIconTitle(){return e(oe)},get copySuccessIconTitle(){return e(se)}}),T(F),W(ae=>U(P,`${ae??""}
          ${e(X)??""}`),[()=>o("workflows.call-stack-at")]),p(t,l)},a=t=>{const l=r(()=>o("workflows.call-stack-error"));J(t,{intent:"warning",get title(){return e(l)},class:"mb-4 w-fit"})};j(u,t=>{typeof e(s)=="string"?t(f):t(a,!1)})}p(c,m)},(c,s)=>{const m=r(()=>o("common.error-occurred")),u=r(()=>o("workflows.no-workers-running-message")),f=r(()=>{var a;return(a=e(s))==null?void 0:a.message});K(c,{get title(){return e(m)},get content(){return e(u)},get error(){return e(f)}})}),p(n,k)},te=n=>{const k=r(()=>o("workflows.call-stack-empty-state"));K(n,{get title(){return e(k)},testId:"query-call-stack-empty",children:(d,c)=>{var s=Q(),m=b(s);{var u=f=>{var a=Se(),t=y(a,!0),l=_(t);_e(l,{newTab:!0,href:"https://docs.temporal.io/workflows#stack-trace-query",children:(v,g)=>{ce();var P=me();W(F=>U(P,F),[()=>o("workflows.call-stack-link")]),p(v,P)},$$slots:{default:!0}});var I=_(l,1,!0);T(a),W((v,g)=>{U(t,v),U(I,g)},[()=>o("workflows.call-stack-link-preface"),()=>{var v;return o("workflows.call-stack-link-postface",{taskQueue:(v=e(i))==null?void 0:v.taskQueue})}]),p(f,a)};j(m,f=>{var a,t,l;(a=e(i))!=null&&a.isRunning&&((l=(t=e(z))==null?void 0:t.pollers)==null?void 0:l.length)===0&&f(u)})}p(d,s)},$$slots:{default:!0}})};j(Z,n=>{var k,d,c;(k=e(i))!=null&&k.isRunning&&((c=(d=e(z))==null?void 0:d.pollers)==null?void 0:c.length)>0?n(ee):n(te,!1)})}T(L),p(A,L),N(),E()}var Ie=R("<!> <!>",1);function Ye(A,C){M(C,!1);const[w,E]=O(),h=()=>$(ue,"$page",w),S=h().params.workflow;pe();var q=Ie(),D=b(q);const x=fe(()=>`${o("workflows.call-stack-tab")} | ${S}`);ve(D,{get title(){return e(x)},get url(){return h().url.href}});var i=_(D,2);De(i,{}),p(A,q),N(),E()}export{Ye as component};
