import"../chunks/CWj6FrbW.js";import"../chunks/69_IOA4Y.js";import{p as ee,l as M,a as pe,g as e,b as te,m as A,e as w,f as B,c as v,n as N,t as T,d as s,r as g,s as L}from"../chunks/Dv5jDC8Z.js";import{a as u,t as P,c as O,b as V}from"../chunks/BM_uyzAk.js";import{i as re}from"../chunks/CM2QeVoh.js";import{s as oe,a as C}from"../chunks/CEr_ApTH.js";import{p as se}from"../chunks/DOVEQzNU.js";import{P as me}from"../chunks/PLLlBlGt.js";import{t as a}from"../chunks/CZMG2GAD.js";import{W as ue}from"../chunks/wRxKVmx6.js";import{s as y}from"../chunks/CnnFVxmh.js";import{a as de}from"../chunks/Cr1-wnh-.js";import{i as X}from"../chunks/FbCjvpNA.js";import{A as ke}from"../chunks/CXRblWjG.js";import{B as _e}from"../chunks/59-RDtFO.js";import{C as we}from"../chunks/uEljFHmr.js";import{E as Y}from"../chunks/lbyfKwPg.js";import{L as ge}from"../chunks/DukiyZiS.js";import{L as ve}from"../chunks/CKG0nj-D.js";import{g as Z}from"../chunks/BAJF9p7R.js";import{a as $e}from"../chunks/Cf9asbMp.js";import{w as xe}from"../chunks/D6vOFxie.js";var he=P('<!> <div class="flex items-center gap-4"><!> <p> </p></div> <div class="my-2 flex h-full items-start"><!></div>',1),ye=P('<div class="text-center"><!> <p> </p></div>'),be=P("<p> <!> </p>"),Te=P("<section><!></section>");function Le(D,E){ee(E,!1);const[b,Q]=oe(),$=()=>C(se,"$page",b),R=()=>C(xe,"$workflowRun",b),l=()=>C($e,"$authUser",b),o=A(),x=A(),{namespace:I}=$().params;let S=A(new Date),H=!1;const ae=()=>{var t;return Z({workflow:e(o),namespace:I},(t=$().data)===null||t===void 0?void 0:t.settings,l()===null||l()===void 0?void 0:l().accessToken)};let q=A();const ne=()=>{var t;L(q,Z({workflow:e(o),namespace:I},(t=$().data)===null||t===void 0?void 0:t.settings,l()===null||l()===void 0?void 0:l().accessToken)),e(q).then(()=>{L(S,new Date)})};M(()=>(e(o),e(x),R()),()=>{(t=>(L(o,t.workflow),L(x,t.workers)))(R())}),M(()=>e(o),()=>{!(e(o)===null||e(o)===void 0)&&e(o).isRunning&&L(q,ae())}),pe(),re();var j=Te(),le=w(j);{var ce=t=>{var _=O(),h=B(_);de(h,()=>e(q),c=>{var n=ye(),i=w(n);ve(i,{});var f=v(i,2),p=w(f,!0);g(f),g(n),T(r=>y(p,r),[()=>a("workflows.no-workers-failure-message")],s),u(c,n)},(c,n)=>{var i=he(),f=B(i);const p=s(()=>a("workflows.call-stack-alert"));ke(f,{intent:"info",icon:"info",get title(){return e(p)},class:"mb-4 w-fit"});var r=v(f,2),d=w(r);_e(d,{leadingIcon:"retry",loading:H,$$events:{click:ne},children:(G,J)=>{N();var K=V();T(fe=>y(K,fe),[()=>a("common.refresh")],s),u(G,K)},$$slots:{default:!0}});var k=v(d,2),z=w(k);g(k),g(r);var m=v(r,2),W=w(m);const U=s(()=>a("common.copy-icon-title")),F=s(()=>a("common.copy-success-icon-title"));we(W,{get content(){return e(n)},language:"text",testId:"query-call-stack",get copyIconTitle(){return e(U)},get copySuccessIconTitle(){return e(F)}}),g(m),T((G,J)=>y(z,`${G??""}
          ${J??""}`),[()=>a("workflows.call-stack-at"),()=>e(S).toLocaleTimeString()],s),u(c,i)},(c,n)=>{const i=s(()=>a("common.error-occurred")),f=s(()=>a("workflows.no-workers-running-message")),p=s(()=>{var r;return(r=e(n))==null?void 0:r.message});Y(c,{get title(){return e(i)},get content(){return e(f)},get error(){return e(p)}})}),u(t,_)},ie=t=>{const _=s(()=>a("workflows.call-stack-empty-state"));Y(t,{get title(){return e(_)},testId:"query-call-stack-empty",children:(h,c)=>{var n=O(),i=B(n);{var f=p=>{var r=be(),d=w(r,!0),k=v(d);ge(k,{newTab:!0,href:"https://docs.temporal.io/workflows#stack-trace-query",children:(m,W)=>{N();var U=V();T(F=>y(U,F),[()=>a("workflows.call-stack-link")],s),u(m,U)},$$slots:{default:!0}});var z=v(k,1,!0);g(r),T((m,W)=>{y(d,m),y(z,W)},[()=>a("workflows.call-stack-link-preface"),()=>{var m;return a("workflows.call-stack-link-postface",{taskQueue:(m=e(o))==null?void 0:m.taskQueue})}],s),u(p,r)};X(i,p=>{var r,d,k;(r=e(o))!=null&&r.isRunning&&((k=(d=e(x))==null?void 0:d.pollers)==null?void 0:k.length)===0&&p(f)})}u(h,n)},$$slots:{default:!0}})};X(le,t=>{var _,h,c;(_=e(o))!=null&&_.isRunning&&((c=(h=e(x))==null?void 0:h.pollers)==null?void 0:c.length)>0?t(ce):t(ie,!1)})}g(j),u(D,j),te(),Q()}var Pe=P("<!> <!>",1);function Ve(D,E){ee(E,!1);const[b,Q]=oe(),$=()=>C(se,"$page",b),R=$().params.workflow;re();var l=Pe(),o=B(l);const x=s(()=>`${a("workflows.call-stack-tab")} | ${R}`);me(o,{get title(){return e(x)},get url(){return $().url.href}});var I=v(o,2);ue(I,{children:(S,H)=>{Le(S,{})},$$slots:{default:!0}}),u(D,l),te(),Q()}export{Ve as component};
