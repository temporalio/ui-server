import"../chunks/Bzak7iHL.js";import"../chunks/69_IOA4Y.js";import{p as we,b as ke,g as e,o as r,l as I,a as Fe,t as q,f as re,i as b,r as h,c as i,e as l,s as u,m as p,aj as te,M as ae,n as me,k as ve,j as O,h as Le,b8 as je,aO as fr,q as Ct,u as pe,d as gr,ac as mr}from"../chunks/CYx2j9em.js";import{i as Ee,s as Ye}from"../chunks/HoZrOv-6.js";import{a as Q,s as We,c as xe,m as pr,p as F,l as wt}from"../chunks/DnRAdnAf.js";import{p as Je}from"../chunks/CidsXpNP.js";import{P as _r}from"../chunks/DN2Bw11a.js";import{t as w}from"../chunks/BXv1jDVW.js";import{s as M,e as kt}from"../chunks/BjCW00Pv.js";import{i as X}from"../chunks/DeQvpgQS.js";import{a as Ne,s as ue,d as xr}from"../chunks/CHX8vcg8.js";import{b as wr}from"../chunks/D3mPUXmH.js";import{E as kr,C as ct,L as Ve,T as rt,D as ht,t as hr,g as $r}from"../chunks/DHdNSZUZ.js";import{T as yr,a as Et}from"../chunks/DSfKuCb0.js";import{W as br}from"../chunks/jSJ9zdgj.js";import{T as Tr}from"../chunks/CjUqx4mN.js";import{b as Yt,d as zt,a as Er,e as at,f as $t,h as tt,i as Ge,c as Ue,p as it,j as Pr,k as Rt,m as Lt,g as Ir}from"../chunks/Dq5Her8r.js";import{w as yt}from"../chunks/WemCyz5V.js";import{e as ot,i as bt}from"../chunks/C1OgRA7l.js";import{w as dt,g as Ht,a as Ar,o as Hr}from"../chunks/CzTm8X19.js";import{C as ft}from"../chunks/M2gwvNzl.js";import{I as Be}from"../chunks/Cgy7lDWn.js";import{M as Wr}from"../chunks/3r6Rhf0H.js";import{c as Sr,d as Cr,b as gt}from"../chunks/DejKAeDH.js";import{M as Fr}from"../chunks/_-wcB0IB.js";import{Y as Ot,l as Pt,I as Mt,F as Dt,o as jr,Z as zr,_ as Rr,$ as Lr,a0 as Jt,a1 as Or,a2 as Mr}from"../chunks/sRVd6Rmn.js";import{t as Dr}from"../chunks/CGaaisA-.js";import{i as Gr}from"../chunks/DhtFMaPc.js";import{k as Ft}from"../chunks/Hbsv0g-K.js";import{b as Qt}from"../chunks/Cv4YkRYF.js";import{T as Wt}from"../chunks/C5Sw_ggu.js";import{i as Xt}from"../chunks/Dzb719w0.js";import{D as _t,y as Zt}from"../chunks/2uWpc1Jl.js";import{b as Ur,g as Nr,d as Vr,c as mt}from"../chunks/CYKMiHV8.js";import{W as Br}from"../chunks/C6aklHeg.js";import{B as qr}from"../chunks/B9yPLxZj.js";import{a as Yr}from"../chunks/LxxMQusO.js";import{g as Kt}from"../chunks/drGXGwXq.js";import{f as Jr,b as Qr}from"../chunks/B-ivEPEH.js";import{x as Xr}from"../chunks/BcIOdc2R.js";import{p as Gt}from"../chunks/B74WkODG.js";import{M as Zr}from"../chunks/BuC9wgS4.js";import{a as er}from"../chunks/DTBKjfP9.js";import{b as Kr}from"../chunks/B6Quk8MY.js";import{A as jt}from"../chunks/TlAHMYQ6.js";import{L as tr}from"../chunks/okl5SrKR.js";import{s as en}from"../chunks/ByTIZu23.js";import{A as rr}from"../chunks/CnoPspYK.js";import{C as xt}from"../chunks/CfzT86F3.js";import{B as Re}from"../chunks/B5FQmuB7.js";import{f as lt,a as nr,r as or,t as sr}from"../chunks/Cted96qS.js";import{M as tn}from"../chunks/vBRT9TDL.js";import{R as rn,a as It}from"../chunks/UShUVu_D.js";import{c as nn,d as on}from"../chunks/pbvGJLXG.js";import{g as sn,b as an,a as ln}from"../chunks/C0WTfrz8.js";import{s as St}from"../chunks/BDfAQ6r3.js";import{i as cn}from"../chunks/BV56P59L.js";import{c as Ut,a as Nt}from"../chunks/yeH8K6Zf.js";import{I as Vt}from"../chunks/De5Dg-u2.js";import{t as dn,a as vn}from"../chunks/D_UiT1nZ.js";import{T as un,a as pt}from"../chunks/CpZNWXTt.js";import{T as fn}from"../chunks/BgyxhB8O.js";function gn(k,t){we(t,!1);const[o,P]=We(),c=()=>Q(Yt,"$filteredEventHistory",o),a=()=>Q(zt,"$decodeEventHistory",o);Ee(),br(k,{get events(){return c()},decode:n=>{const _=r(()=>w("events.decode-event-history"));Tr(n,{get label(){return e(_)},id:"decode-event-history","data-testid":"decode-event-history-toggle",get checked(){return pr(),a()},set checked(g){xe(zt,g)},$$legacy:!0})},$$slots:{decode:!0}}),ke(),P()}var mn=q("<!> <!> <!>",1),pn=q('<div class="border-t border-subtle px-4"><!></div>'),_n=q('<div data-testid="event-summary-table"><!></div>'),xn=q('<div class="flex items-center justify-end gap-4 pt-4 lg:pt-8"><div class="flex items-center gap-2 px-4"><!></div></div> <!>',1);function wn(k,t){we(t,!1);const[o,P]=We(),c=()=>Q(yt,"$workflowRun",o),a=()=>Q(at,"$eventFilterSort",o),s=()=>Q($t,"$fullEventHistory",o),n=()=>Q(tt,"$eventViewType",o),_=()=>Q(Je,"$page",o),g=p(),f=p(),H=p(),$=p(),d=p(),v=p(),x=p();var C=p(),E=p(),y=p(),m=p();let W=F(t,"history",8),V=F(t,"groups",8),Y=F(t,"minimized",8,!0);const R=()=>{xe(tt,"feed")},B=()=>{xe(tt,"compact")},D=()=>{xe(tt,"json")};I(()=>(e(g),c()),()=>{(L=>u(g,L.workflow))(c())}),I(()=>a(),()=>{u(f,a()==="descending")}),I(()=>s(),()=>{u(H,!s().length)}),I(()=>n(),()=>{u($,n()==="compact")}),I(()=>(te(E),te(C),_(),te(m),te(y)),()=>{xe(Er,!(u(E,u(C,_().url)===null||te(C)===void 0?void 0:te(C).searchParams)===null||te(E)===void 0)&&te(E).get("category")?u(m,u(y,_().url)===null||te(y)===void 0?void 0:te(y).searchParams)===null||te(m)===void 0?void 0:te(m).get("category").split(","):void 0)}),I(()=>e(g),()=>{u(d,e(g).pendingActivities)}),I(()=>e(g),()=>{u(v,e(g).pendingNexusOperations)}),I(()=>(e($),ae(V()),e(f),e(v),e(d),ae(W())),()=>{u(x,e($)?V():e(f)?[...e(v),...e(d),...W()]:[...W(),...e(d),...e(v)])}),Fe(),Ee();var G=xn(),T=re(G),A=b(T),j=b(A);yr(j,{children:(L,z)=>{var K=mn(),U=re(K);const S=r(()=>n()==="feed");Et(U,{get active(){return e(S)},"data-testid":"feed",icon:"feed",class:"h-10",$$events:{click:R},children:(Pe,Ie)=>{me();var Ae=ve("All");l(Pe,Ae)},$$slots:{default:!0}});var J=i(U,2);const ie=r(()=>n()==="compact");Et(J,{get active(){return e(ie)},"data-testid":"compact",icon:"compact",class:"h-10",$$events:{click:B},children:(Pe,Ie)=>{me();var Ae=ve("Compact");l(Pe,Ae)},$$slots:{default:!0}});var le=i(J,2);const _e=r(()=>n()==="json");Et(le,{get active(){return e(_e)},"data-testid":"json",icon:"json",class:"h-10",$$events:{click:D},children:(Pe,Ie)=>{me();var Ae=ve("JSON");l(Pe,Ae)},$$slots:{default:!0}}),l(L,K)},$$slots:{default:!0}}),h(A),h(T);var ne=i(T,2);{var de=L=>{var z=pn(),K=b(z);gn(K,{}),h(z),l(L,z)},he=L=>{var z=_n(),K=b(z);kr(K,{get updating(){return e(H)},get items(){return e(x)},get groups(){return V()},get compact(){return e($)},get minimized(){return Y()}}),h(z),l(L,z)};X(ne,L=>{n()==="json"?L(de):L(he,!1)})}l(k,G),ke(),P()}const ar=200,kn=dt(0),hn=dt(ar),nt=dt([]),vt=dt(0),At=()=>{nt.set([]),vt.set(0),kn.set(0),hn.set(ar)},$n=()=>{nt.set([]),vt.set(0)},ir=k=>{Ht(nt).includes(k.id)?(vt.set(0),nt.set([])):nt.set([k.id])},yn=k=>k==null?void 0:k.nexus;var bn=q('<span class="hidden text-sm md:block"> </span>'),Tn=q('<div slot="leading"><!></div>'),En=q("<!> <!> <!> <!> <!>",1),Pn=q("<!> <!>",1);function In(k,t){we(t,!1);const[o,P]=We(),c=()=>Q(Dr,"$temporalVersion",o),a=()=>Q(Je,"$page",o),s=()=>Q(Ge,"$eventTypeFilter",o),n=()=>Q(Ue,"$eventStatusFilter",o),_=()=>Q(tt,"$eventViewType",o),g=p(),f=p(),H=p();var $=p();let d=F(t,"compact",8,!1),v=F(t,"minimized",8,!0),x=dt(!1);const C=({value:E})=>{$n(),xe(Ge,s().some(y=>y===E)?s().filter(y=>y!==E):[...s(),E])};I(()=>(ae(d()),Pt),()=>{u(g,d()?Ot.map(E=>E.value):Pt.map(E=>E.value))}),I(()=>(ae(d()),ct),()=>{u(f,[...(d()?Ot:Pt).map(E=>({...E,label:w(E.label),icon:ct[E.value],description:w(E.description)}))])}),I(()=>(c(),e(f)),()=>{Gr("1.21.0",c())&&u(f,e(f).filter(({value:E})=>E!=="update"))}),I(()=>(te($),a(),e(f)),()=>{yn(u($,a().data.systemInfo)===null||te($)===void 0?void 0:te($).capabilities)||u(f,e(f).filter(({value:E})=>E!=="nexus"))}),I(()=>(s(),e(g)),()=>{u(H,s().length<e(g).length)}),Fe(),Ee(),Sr(k,{open:x,children:(E,y)=>{var m=Pn(),W=re(m);Wr(W,{controls:"status-menu",size:"sm",children:(R,B)=>{var D=bn(),G=b(D,!0);h(D),O(T=>M(G,T),[()=>w("common.filter")],r),l(R,D)},$$slots:{default:!0,leading:(R,B)=>{var D=Tn();let G;var T=b(D);const A=r(()=>e(H)&&"pt-0.5 text-white");Be(T,{name:"filter",get class(){return e(A)}}),h(D),O(j=>G=Ne(D,1,"flex h-6 w-6 flex-col items-center justify-center rounded-full transition-colors duration-200",null,G,j),[()=>({"bg-interactive":e(H)})],r),l(R,D)}}});var V=i(W,2);const Y=r(()=>v()?"top-right":"right");Cr(V,{id:"event-type-menu",keepOpen:!0,get position(){return e(Y)},class:"w-[220px] md:w-[360px]",children:(R,B)=>{var D=En(),G=re(D);const T=r(()=>w("common.all"));gt(G,{get"data-testid"(){return e(T)},$$events:{click:()=>{xe(Ge,e(g)),xe(Ue,!1)}},children:(z,K)=>{me();var U=ve();O(S=>M(U,S),[()=>w("common.all")],r),l(z,U)},$$slots:{default:!0,leading:(z,K)=>{const U=r(()=>!n()&&s().length===e(g).length),S=r(()=>w("common.all"));ft(z,{slot:"leading",get checked(){return e(U)},get label(){return e(S)},labelHidden:!0,class:"mt-px",$$events:{change:()=>{xe(Ge,e(g)),xe(Ue,!1)}}})}}});var A=i(G,2);{var j=z=>{const K=r(()=>w("common.pending-and-failed")),U=r(()=>w("common.pending-and-failed-description"));gt(z,{get"data-testid"(){return e(K)},get description(){return e(U)},class:"items-start",$$events:{click:()=>{xe(Ge,e(g)),xe(Ue,!n())}},children:(S,J)=>{me();var ie=ve();O(le=>M(ie,le),[()=>w("common.pending-and-failed")],r),l(S,ie)},$$slots:{default:!0,leading:(S,J)=>{const ie=r(()=>w("common.all"));ft(S,{slot:"leading",get checked(){return n()},get label(){return e(ie)},labelHidden:!0,class:"mt-px",$$events:{change:()=>{xe(Ge,e(g)),xe(Ue,!n())}}})}}})};X(A,z=>{_()!=="json"&&z(j)})}var ne=i(A,2);const de=r(()=>w("common.none"));gt(ne,{get"data-testid"(){return e(de)},$$events:{click:()=>{xe(Ge,[]),xe(Ue,!1)}},children:(z,K)=>{me();var U=ve();O(S=>M(U,S),[()=>w("common.none")],r),l(z,U)},$$slots:{default:!0,leading:(z,K)=>{const U=r(()=>!n()&&!s().length),S=r(()=>w("common.none"));ft(z,{slot:"leading",get checked(){return e(U)},get label(){return e(S)},labelHidden:!0,class:"mt-px",$$events:{change:()=>{xe(Ge,[]),xe(Ue,!1)}}})}}});var he=i(ne,2);Fr(he);var L=i(he,2);ot(L,1,()=>e(f),bt,(z,K)=>{gt(z,{get"data-testid"(){return e(K).label},get description(){return e(K).description},class:"items-start",$$events:{click:()=>{C(e(K))}},children:(U,S)=>{me();var J=ve();O(()=>M(J,e(K).label)),l(U,J)},$$slots:{default:!0,leading:(U,S)=>{const J=r(()=>s().some(ie=>ie===e(K).value));ft(U,{slot:"leading",get checked(){return e(J)},get label(){return e(K).label},labelHidden:!0,class:"mt-px",$$events:{click:()=>C(e(K))}})}}})}),l(R,D)},$$slots:{default:!0}}),l(E,m)},$$slots:{default:!0}}),ke(),P()}function An(k,t){we(t,!1);const[o,P]=We(),c=()=>Q(it,"$pauseLiveUpdates",o),a=p(),s=p();let n=F(t,"workflow",8),_=F(t,"startTime",8);const g=()=>{const x=new Date;return x.setSeconds(x.getSeconds()+1),x};let f;const H=x=>{x&&(clearInterval(f),f=null)},$=x=>{x?(clearInterval(f),f=null):!f&&n().isRunning&&(f=setInterval(()=>{u(a,g())},1e3))};Ar(()=>{clearInterval(f),f=null,xe(it,!1)}),I(()=>ae(n()),()=>{u(a,(n()===null||n()===void 0?void 0:n().endTime)||g())}),I(()=>(ae(_()),e(a)),()=>{u(s,_t({start:_(),end:e(a),onlyUnderSecond:!1}))}),I(()=>ae(n()),()=>{H(n().endTime)}),I(()=>c(),()=>{$(c())}),Fe(),Ee();var d=Le(),v=re(d);Ye(v,t,"default",{get endTime(){return e(a)},get duration(){return e(s)}},null),l(k,d),ke(),P()}var Hn=q("<div><!></div>");function Wn(k,t){const o=wt(t,["children","$$slots","$$events","$$legacy"]),P=wt(o,["namespace","workflowId","runId","viewportHeight","onLoad"]);we(t,!1);let c=F(t,"namespace",8),a=F(t,"workflowId",8),s=F(t,"runId",8,""),n=F(t,"viewportHeight",8,360),_=F(t,"onLoad",8,()=>{});const g=async()=>{const[d,v]=await Promise.all([Xr({namespace:c(),workflowId:a(),runId:s()}),Jr({namespace:c(),workflowId:a(),runId:s()})]);return{workflow:d.workflow,history:v}},f=(d,v)=>{var x;_()();const C=(x=d==null?void 0:d.pendingActivities)!==null&&x!==void 0?x:[];return Kt(v,"ascending",C)};Ee();var H=Le(),$=re(H);Yr($,g,null,(d,v)=>{var x=r(()=>{var{workflow:V,history:Y}=e(v);return{workflow:V,history:Y}}),C=r(()=>e(x).workflow),E=r(()=>e(x).history),y=Hn(),m=b(y);const W=r(()=>f(e(C),e(E)));lr(m,{get viewportHeight(){return n()},get workflow(){return e(C)},get groups(){return e(W)},readOnly:!0}),h(y),O(()=>Ne(y,1,`cursor-pointer overflow-auto ${P.class??""}`)),l(d,y)}),l(k,H),ke()}var Sn=q('<div class="flex items-center gap-1"><!> </div>'),Cn=q(" <!>",1),Fn=q('<div class="surface-primary p-4"><div class="font-medium leading-4 text-secondary">Child Workflow</div> <!></div>'),jn=je('<g role="button" tabindex="0" class="relative z-50 svelte-1gmju38"><foreignObject><div class="flex flex-col"><div class="relative flex h-full items-center justify-between bg-slate-50 text-sm dark:bg-slate-800"><div class="flex h-full items-center gap-4 px-2"><!> <!></div> <div class="flex items-center gap-4"><!></div></div> <div class="surface-primary"><!></div> <!></div></foreignObject></g>');function zn(k,t){we(t,!1);const[o,P]=We(),c=()=>Q(Je,"$page",o),a=p(),s=p(),n=p(),_=p(),g=p(),f=p(),H=p();var $=p(),d=p();let v=F(t,"group",8),x=F(t,"canvasWidth",8),C=F(t,"x",8,0),E=F(t,"y",8),y=p();const m=S=>{xe(vt,S)},W=async()=>{await fr(),u(a,e(y))};I(()=>e(y),()=>{u(a,e(y)||0)}),I(()=>e(a),()=>{m(e(a)||0)}),I(()=>ae(v()),()=>{u(s,(v()===null||v()===void 0?void 0:v().finalClassification)||(v()===null||v()===void 0?void 0:v().classification))}),I(()=>(e(n),c()),()=>{(S=>u(n,S.namespace))(c().params)}),I(()=>ae(x()),()=>{u(_,x())}),I(()=>ae(v()),()=>{u(g,v().displayName)}),I(()=>(ae(v()),Mt),()=>{u(f,v()&&v().eventList.find(Mt))}),I(()=>(te($),ae(v()),te(d)),()=>{u(H,Zt({start:u($,v()===null||v()===void 0?void 0:v().initialEvent)===null||te($)===void 0?void 0:te($).eventTime,end:u(d,v()===null||v()===void 0?void 0:v().lastEvent)===null||te(d)===void 0?void 0:te(d).eventTime,includeMilliseconds:!0}))}),I(()=>(ae(v()),w),()=>{!(v()===null||v()===void 0)&&v().pendingActivity&&(v().pendingActivity.paused?u(s,w("workflows.paused")):v().pendingActivity.attempt>1?u(s,w("events.event-classification.retrying")):u(s,w("events.event-classification.pending")))}),Fe(),Ee();var V=jn(),Y=b(V),R=b(Y),B=b(R),D=b(B),G=b(D);{var T=S=>{Br(S,{get status(){return e(s)}})};X(G,S=>{e(s)&&S(T)})}var A=i(G),j=i(A);{var ne=S=>{var J=Sn(),ie=b(J);Be(ie,{name:"clock"});var le=i(ie);h(J),O(()=>M(le,` ${e(H)??""}`)),l(S,J)};X(j,S=>{e(H)&&S(ne)})}h(D);var de=i(D,2),he=b(de);qr(he,{variant:"ghost",size:"xs",$$events:{click:()=>ir(v())},children:(S,J)=>{me();var ie=Cn(),le=re(ie),_e=i(le);Be(_e,{name:"close"}),O(Pe=>M(le,`${Pe??""} `),[()=>w("common.close")],r),l(S,ie)},$$slots:{default:!0}}),h(de),h(B);var L=i(B,2),z=b(L);Ur(z,{get group(){return v()},get event(){return v().initialEvent}}),h(L);var K=i(L,2);{var U=S=>{var J=Fn(),ie=i(b(J),2);Ft(ie,()=>v().eventList.length,le=>{Wn(le,{get namespace(){return e(n)},get workflowId(){return e(f).attributes.workflowExecution.workflowId},get runId(){return e(f).attributes.workflowExecution.runId},viewportHeight:320,class:"surface-primary overflow-x-hidden border-t border-subtle",onLoad:W})}),h(J),l(S,J)};X(K,S=>{e(f)&&S(U)})}h(R),h(Y),h(V),O(()=>{ue(Y,"x",C()),ue(Y,"y",E()),ue(Y,"width",e(_)),ue(Y,"height",e(a)),M(A,` ${e(g)??""} `)}),Qt(R,"offsetHeight",S=>u(y,S)),l(k,V),ke(),P()}var Rn=je('<text fill="#fff" font-size="12" class="svelte-1huxcs7"> </text>'),Ln=je("<!><!>",1),On=je("<!><!>",1);function Mn(k,t){we(t,!1);const o=p(),P=p();let c=F(t,"x1",8,0),a=F(t,"x2",8,1e3),s=F(t,"timelineHeight",8,1e3),n=F(t,"startTime",8),_=F(t,"duration",8);const{radius:g}=rt,f=20;I(()=>(ae(a()),ae(c())),()=>{u(o,a()-c())}),I(()=>e(o),()=>{u(P,e(o)/f)}),Fe(),Ee();var H=On(),$=re(H);const d=r(()=>[c(),s()]),v=r(()=>[c()+e(o),s()]);Ve($,{strokeWidth:g/2,get startPoint(){return e(d)},get endPoint(){return e(v)}});var x=i($);ot(x,1,()=>Array(f),bt,(C,E,y)=>{var m=Ln();const W=r(()=>c()+y*e(P)),V=r(()=>s()+g*2);var Y=re(m);{var R=G=>{const T=r(()=>[e(W),0]),A=r(()=>[e(W),s()]);Ve(G,{strokeWidth:.5,get startPoint(){return e(T)},get endPoint(){return e(A)}})};X(Y,G=>{y!==0&&G(R)})}var B=i(Y);{var D=G=>{var T=Rn(),A=b(T,!0);h(T),O(j=>{ue(T,"transform",`rotate(90, ${e(W)??""}, ${e(V)??""})`),ue(T,"x",e(W)-g),ue(T,"y",e(V)),M(A,j)},[()=>Zt({start:n(),end:new Date(new Date(n().toString()).getTime()+_()/f*y),includeMilliseconds:_()/f<1e3})],r),l(G,T)};X(B,G=>{y!==0&&G(D)})}l(C,m)}),l(k,H),ke()}var Dn=je("<text><!></text>"),Gn=je("<!><!><!>",1);function Un(k,t){we(t,!1);const o=p(),P=p(),c=p(),a=p(),s=p(),n=p();var _=p();let g=F(t,"point",24,()=>[0,0]),f=F(t,"category",8,void 0),H=F(t,"status",8,"none"),$=F(t,"fontSize",8,"13px"),d=F(t,"fontWeight",8,"400"),v=F(t,"textAnchor",8,"start"),x=F(t,"backdrop",8,!1),C=F(t,"backdropHeight",8,0),E=F(t,"icon",8,void 0),y=F(t,"config",8,void 0),m=F(t,"label",8,!1),W=p();I(()=>(e(o),e(P),ae(g())),()=>{(T=>(u(o,T[0]),u(P,T[1])))(g())}),I(()=>(ae(E()),ae(y())),()=>{u(c,E()&&y())}),I(()=>(te(_),e(W)),()=>{u(a,(u(_,e(W)===null||e(W)===void 0?void 0:e(W).getBBox())===null||te(_)===void 0?void 0:te(_).width)||0)}),I(()=>(e(c),e(a)),()=>{u(s,e(c)?e(a)+36:e(a)+12)}),I(()=>(e(c),ae(v()),e(o),ae(y())),()=>{u(n,e(c)&&v()==="start"?e(o)+y().radius*2:e(o))}),Fe(),Ee();var V=Gn(),Y=re(V);{var R=T=>{const A=r(()=>[e(o)-C(),e(P)]),j=r(()=>[e(o)+e(s),e(P)]);Ve(T,{get startPoint(){return e(A)},get endPoint(){return e(j)},get status(){return H()},get strokeWidth(){return C()}})};X(Y,T=>{x()&&T(R)})}var B=i(Y);{var D=T=>{const A=r(()=>v()==="end"?e(o)-e(a)-C():e(o)),j=r(()=>e(P)-8),ne=r(()=>x()?"text-white":"text-primary");Be(T,{get name(){return E()},get x(){return e(A)},get y(){return e(j)},get class(){return e(ne)}})};X(B,T=>{e(c)&&T(D)})}var G=i(B);Ft(G,()=>e(n),T=>{var A=Dn();let j;var ne=b(A);Ye(ne,t,"default",{},null),h(A),Kr(A,de=>u(W,de),()=>e(W)),O(de=>{j=Ne(A,0,`cursor-pointer select-none outline-none ${f()??""} text-primary`,"svelte-ja82h2",j,de),ue(A,"x",e(n)),ue(A,"y",e(P)+1),ue(A,"font-size",$()),ue(A,"font-weight",d()),ue(A,"text-anchor",v())},[()=>({label:m(),backdrop:x()})],r),l(T,A)}),l(k,V),ke()}var Nn=je('<rect fill="transparent" pointer-events="all"></rect>'),Vn=je("<!><!>",1),Bn=je("<!><!><!><!>",1),qn=je('<g role="button" tabindex="0" class="relative cursor-pointer svelte-1gmju38"><!><!></g>');function Yn(k,t){we(t,!1);const[o,P]=We(),c=()=>Q(er,"$authUser",o),a=p(),s=p(),n=p(),_=p(),g=p(),f=p(),H=p(),$=p(),d=p(),v=p(),x=p();var C=p(),E=p();let y=F(t,"y",8,0),m=F(t,"group",12),W=F(t,"activeGroups",24,()=>[]),V=F(t,"startTime",8),Y=F(t,"endTime",8),R=F(t,"canvasWidth",8),B=F(t,"active",12,!0),D=F(t,"readOnly",8,!1);const{height:G,gutter:T,radius:A}=rt;let j=p();Hr(async()=>{const U=Nr(m());if(U)try{u(j,await Vr(U,{namespace:Gt.params.namespace,settings:Gt.data.settings,accessToken:c().accessToken})),e(j)&&m(m().decodedLocalActivity=e(j),!0)}catch(S){console.warn("Failed to decode local activity:",S)}});const ne=(U,S,J)=>{const ie=_t({start:V(),end:U,onlyUnderSecond:!1}),le=m().eventList.map(ze=>{const N=_t({start:V(),end:ze.eventTime,onlyUnderSecond:!1})/ie;return Math.round(N*S)+T});if(e(n)){const fe=_t({start:V(),end:e(n),onlyUnderSecond:!1})/ie,N=Math.round(fe*S)+T;le.push(N)}const{textAnchor:_e,textIndex:Pe,textPosition:Ie,backdrop:Ae}=hr(le,J,S,m().isPending,rt);return{points:le,textAnchor:_e,textIndex:Pe,textPosition:Ie,backdrop:Ae}},de=()=>{D()||ir(m())};I(()=>ae(R()),()=>{u(a,R()-2*T)}),I(()=>(ae(W()),ae(m())),()=>{B(!W().length||W().includes(m().id))}),I(()=>ae(m()),()=>{u(s,m()===null||m()===void 0?void 0:m().pendingActivity)}),I(()=>(e(s),te(C)),()=>{u(n,e(s)&&(u(C,e(s).pauseInfo)===null||te(C)===void 0?void 0:te(C).pauseTime))}),I(()=>(e(_),e(g),e(f),e(H),e($),ae(Y()),e(a),ae(y())),()=>{(U=>(u(_,U.points),u(g,U.textAnchor),u(f,U.textIndex),u(H,U.textPosition),u($,U.backdrop)))(ne(Y(),e(a),y()))}),I(()=>(ae(m()),Dt),()=>{u(d,m().eventList.find(Dt))}),I(()=>(e(d),te(E)),()=>{u(v,e(d)&&(u(E,e(d).attributes)===null||te(E)===void 0?void 0:te(E).attempt)>1)}),I(()=>(ae(m()),e(n)),()=>{u(x,m().isPending||!!e(n))}),Fe(),Ee();var he=qn();ue(he,"height",G);var L=b(he);{var z=U=>{var S=Nn();const J=r(()=>e(n)?e(_)[1]-e(_)[0]:R()-2*T);ue(S,"height",G),O(()=>{ue(S,"y",y()-G/2),ue(S,"x",e(_)[0]),ue(S,"width",e(J))}),l(U,S)};X(L,U=>{e(x)&&U(z)})}var K=i(L);ot(K,1,()=>e(_),bt,(U,S,J)=>{var ie=Bn();const le=r(()=>e(_)[J+1]),_e=r(()=>e(f)===J);var Pe=re(ie);{var Ie=se=>{const oe=r(()=>[e(S),y()]),$e=r(()=>[e(le),y()]),ye=r(()=>!!e(n)),be=r(()=>!!e(n)),Se=r(()=>J===0&&m().lastEvent.classification==="Completed");Ve(se,{get startPoint(){return e(oe)},get endPoint(){return e($e)},get category(){return m().category},get classification(){return m().lastEvent.classification},get pending(){return e(ye)},get paused(){return e(be)},strokeWidth:A*2,get retried(){return e(v)},get scheduling(){return e(Se)}})};X(Pe,se=>{e(le)&&se(Ie)})}var Ae=i(Pe);{var ze=se=>{var oe=Vn(),$e=re(oe);const ye=r(()=>[e(S),y()]),be=r(()=>[R()-T,y()]),Se=r(()=>e(s)?e(s).attempt>1?"retry":"pending":m().category),Te=r(()=>!!e(n));Ve($e,{get startPoint(){return e(ye)},get endPoint(){return e(be)},get category(){return e(Se)},get classification(){return m().lastEvent.classification},pending:!0,get paused(){return e(Te)},strokeWidth:A*2});var Ce=i($e);const He=r(()=>[e(S),y()]);ht(Ce,{get point(){return e(He)},get classification(){return m().lastEvent.classification},icon:"retry",r:A}),l(se,oe)};X(Ae,se=>{!e(le)&&m().isPending&&!e(n)&&se(ze)})}var fe=i(Ae);{var N=se=>{const oe=r(()=>{var be,Se;return(Se=(be=m())==null?void 0:be.userMetadata)==null?void 0:Se.summary}),$e=r(()=>{var be;return jr(m().initialEvent)?(be=m())==null?void 0:be.displayName:""}),ye=r(()=>{var be;return e(j)?w("events.category.local-activity"):(be=m())==null?void 0:be.displayName});Zr(se,{get value(){return e(oe)},get prefix(){return e($e)},get fallback(){return e(ye)},children:Ct,$$slots:{default:(be,Se)=>{const Te=r(()=>Se.decodedValue),Ce=r(()=>e(s)&&!e(s).paused||e(v)?"retry":void 0);Un(be,{get point(){return e(H)},get textAnchor(){return e(g)},get backdrop(){return e($)},backdropHeight:A*2,config:rt,get icon(){return e(Ce)},children:(He,qe)=>{var Me=Le(),Qe=re(Me);{var Oe=De=>{var Ze=ve();O(Tt=>M(Ze,`${Tt??""}
            ${e(s).attempt??""} / ${e(s).maximumAttempts||"∞"}
            • 
            ${e(Te)??""}`),[()=>w("workflows.attempt")],r),l(De,Ze)},Xe=(De,Ze)=>{{var Tt=Ke=>{var ut=ve();O(()=>M(ut,`${e(d).attributes.attempt??""} • ${e(Te)??""}`)),l(Ke,ut)},dr=(Ke,ut)=>{{var vr=et=>{var st=ve();O(()=>M(st,e(j).value)),l(et,st)},ur=et=>{var st=ve();O(()=>M(st,e(Te))),l(et,st)};X(Ke,et=>{e(j)?et(vr):et(ur,!1)},ut)}};X(De,Ke=>{e(v)?Ke(Tt):Ke(dr,!1)},Ze)}};X(Qe,De=>{e(s)?De(Oe):De(Xe,!1)})}l(He,Me)},$$slots:{default:!0}})}}})};X(fe,se=>{e(_e)&&se(N)})}var Z=i(fe);const ce=r(()=>[e(S),y()]),ge=r(()=>{var se;return(se=m().eventList[J])==null?void 0:se.classification}),ee=r(()=>e(n)&&J!==0?"pause":e(j)?ct["local-activity"]:ct[m().category]);ht(Z,{get point(){return e(ce)},get classification(){return e(ge)},get icon(){return e(ee)},r:A}),l(U,ie)}),h(he),kt("click",he,de),kt("keypress",he,de),l(k,he),ke(),P()}var Jn=je('<g role="button" tabindex="0" class="relative cursor-pointer svelte-k9v32"><!><!><!><!><!></g>');function Qn(k,t){we(t,!1);const o=p(),P=p();let c=F(t,"workflow",8),a=F(t,"length",8),s=F(t,"y",8);const{radius:n,height:_,gutter:g}=rt;I(()=>{},()=>{u(o,g)}),I(()=>(e(o),ae(a())),()=>{u(P,e(o)+a()-2*g)}),Fe(),Ee();var f=Jn();ue(f,"height",_);var H=b(f);const $=r(()=>[e(o),s()]),d=r(()=>[e(P),s()]),v=r(()=>Xt(c()));Ve(H,{get startPoint(){return e($)},get endPoint(){return e(d)},get classification(){return c().status},strokeWidth:n*2,get pending(){return c().isRunning},get delayed(){return e(v)}});var x=i(H);const C=r(()=>[e(o),s()]);ht(x,{get point(){return e(C)},get classification(){return c().status},r:n});var E=i(x);const y=r(()=>e(o)-n/2),m=r(()=>s()-n/2);Be(E,{name:"workflow",get x(){return e(y)},get y(){return e(m)},width:n,height:n,strokeWidth:"4",class:"text-black"});var W=i(E);const V=r(()=>[e(P),s()]);ht(W,{get point(){return e(V)},get classification(){return c().status},r:n});var Y=i(W);const R=r(()=>e(P)-n/2),B=r(()=>s()-n/2);Be(Y,{name:"workflow",get x(){return e(R)},get y(){return e(B)},width:n,height:n,strokeWidth:"4",class:"text-black"}),h(f),l(k,f),ke()}var Xn=je("<!><!>",1),Zn=q('<div><div class="flex w-full justify-between text-xs"><!> <!></div></div> <svg><!><!><!><!><!></svg>',1),Kn=q('<div id="event-history-timeline-graph" class="relative h-auto overflow-auto border border-t-0 border-subtle bg-primary"><!></div>');function lr(k,t){we(t,!1);const[o,P]=We(),c=()=>Q(vt,"$activeGroupHeight",o),a=()=>Q(Ue,"$eventStatusFilter",o),s=()=>Q($t,"$fullEventHistory",o),n=()=>Q(nt,"$activeGroups",o),_=()=>Q(at,"$eventFilterSort",o),g=p(),f=p(),H=p(),$=p(),d=p(),v=p(),x=p();var C=p(),E=p();let y=F(t,"x",8,0),m=F(t,"y",8,0),W=F(t,"workflow",8),V=F(t,"groups",8),Y=F(t,"viewportHeight",8),R=F(t,"readOnly",8,!1),B=F(t,"error",8,!1);const{height:D,gutter:G,radius:T}=rt;let A=p(0),j=p(0);const ne=L=>{var z;u(j,(z=L==null?void 0:L.target)===null||z===void 0?void 0:z.scrollTop)};I(()=>(ae(R()),c()),()=>{u(g,R()?0:c())}),I(()=>(ae(V()),a()),()=>{u(f,$r(V(),a()))}),I(()=>(te(C),s(),ae(W()),te(E)),()=>{u(H,(u(C,s()[0])===null||te(C)===void 0?void 0:te(C).eventTime)<W().executionTime?u(E,s()[0])===null||te(E)===void 0?void 0:te(E).eventTime:W().executionTime)}),I(()=>(ae(W()),e(H)),()=>{u($,!Xt(W())&&e(H)||W().startTime)}),I(()=>(e(f),e(g)),()=>{u(d,Math.max(D*(e(f).length+2),120)+e(g))}),I(()=>e(d),()=>{u(v,e(d)+120)}),I(()=>(n(),_(),e(g)),()=>{u(x,L=>{const z=n()===null||n()===void 0?void 0:n().filter(K=>_()==="ascending"?parseInt(K)<parseInt(L.id):parseInt(K)>parseInt(L.id));return z!=null&&z.length?e(g):0})}),Fe(),Ee();var de=Kn(),he=b(de);An(he,{get workflow(){return W()},get startTime(){return e($)},children:Ct,$$slots:{default:(L,z)=>{const K=r(()=>z.endTime),U=r(()=>z.duration);var S=Zn(),J=re(S);let ie;var le=b(J),_e=b(le);Wt(_e,{as:"p",class:"w-60 -translate-x-24 rotate-90",get dateTime(){return e($)}});var Pe=i(_e,2);Wt(Pe,{as:"p",class:"w-60 translate-x-24 rotate-90",get dateTime(){return e(K)}}),h(le),h(J);var Ie=i(J,2);let Ae;var ze=b(Ie);const fe=r(()=>[G,e(d)]);Ve(ze,{startPoint:[G,0],get endPoint(){return e(fe)},strokeWidth:T/2});var N=i(ze);const Z=r(()=>[e(A)-G,0]),ce=r(()=>[e(A)-G,e(d)]);Ve(N,{get startPoint(){return e(Z)},get endPoint(){return e(ce)},strokeWidth:T/2});var ge=i(N);const ee=r(()=>e(A)-G+T/4);Mn(ge,{x1:G-T/4,get x2(){return e(ee)},get timelineHeight(){return e(d)},get startTime(){return e($)},get duration(){return e(U)}});var se=i(ge);Qn(se,{get workflow(){return W()},y:D,get length(){return e(A)}});var oe=i(se);ot(oe,3,()=>e(f),$e=>$e.id,($e,ye,be,Se)=>{var Te=Xn();const Ce=r(()=>(e(be)+2)*D+e(x)(e(ye)));var He=re(Te);{var qe=Oe=>{var Xe=Le(),De=re(Xe);Ft(De,()=>e(ye).eventList.length,Ze=>{Yn(Ze,{get y(){return e(Ce)},get group(){return e(ye)},get activeGroups(){return n()},get canvasWidth(){return e(A)},get startTime(){return e($)},get endTime(){return e(K)},get readOnly(){return R()}})}),l(Oe,Xe)};X(He,Oe=>{(!Y()||e(Ce)>e(j)-2*D&&e(Ce)<e(j)+Y()*D)&&Oe(qe)})}var Me=i(He);{var Qe=Oe=>{const Xe=r(()=>e(Ce)+1.33*T);zn(Oe,{get y(){return e(Xe)},get group(){return e(ye)},get canvasWidth(){return e(A)}})};X(Me,Oe=>{!R()&&n().includes(e(ye).id)&&Oe(Qe)})}l($e,Te)}),h(Ie),O(($e,ye)=>{ie=Ne(J,1,"pointer-events-none sticky top-[120px]",null,ie,$e),ue(Ie,"x",y()),ue(Ie,"y",m()),ue(Ie,"viewBox",`0 0 ${e(A)??""} ${e(v)??""}`),ue(Ie,"height",e(v)),ue(Ie,"width",e(A)),Ae=Ne(Ie,0,"-mt-4 svelte-ta6k80",null,Ae,ye)},[()=>({invisible:!!n().length}),()=>({error:B()})],r),l(L,S)}}}),h(de),O(()=>xr(de,Y()?`max-height: ${Y()}px;`:"")),Qt(de,"clientWidth",L=>u(A,L)),kt("scroll",de,ne),l(k,de),ke(),P()}var eo=q('<div class="*:border-t-0 [&amp;>*:first-child]:border-t"><!></div>');function to(k,t){var o=eo(),P=b(o);Ye(P,t,"default",{},null),h(o),l(k,o)}var ro=q("<p> </p> <!>",1),no=q("<p> </p> <!>",1),oo=q('<div class="flex flex-col gap-2"><p> </p> <!> <!> <!></div>'),so=q('<div class="w-full text-right text-xs" slot="summary"> </div>'),ao=q("<!> <!>",1);function cr(k,t){we(t,!1);let o=F(t,"failure",8,void 0);Ee();var P=ao(),c=re(P);{var a=_=>{const g=r(()=>w("common.failure"));rr(_,{get title(){return e(g)},class:"text-sm",children:(f,H)=>{var $=oo(),d=b($),v=b(d,!0);h(d);var x=i(d,2);const C=r(()=>{var R;return((R=o())==null?void 0:R.message)||""}),E=r(()=>w("common.copy-icon-title")),y=r(()=>w("common.copy-success-icon-title"));xt(x,{get content(){return e(C)},language:"text",get copyIconTitle(){return e(E)},get copySuccessIconTitle(){return e(y)}});var m=i(x,2);{var W=R=>{var B=ro(),D=re(B),G=b(D,!0);h(D);var T=i(D,2);const A=r(()=>w("common.copy-icon-title")),j=r(()=>w("common.copy-success-icon-title"));xt(T,{get content(){return o().source},language:"text",get copyIconTitle(){return e(A)},get copySuccessIconTitle(){return e(j)}}),O(ne=>M(G,ne),[()=>w("common.source")],r),l(R,B)};X(m,R=>{var B;(B=o())!=null&&B.source&&R(W)})}var V=i(m,2);{var Y=R=>{var B=no(),D=re(B),G=b(D,!0);h(D);var T=i(D,2);const A=r(()=>w("common.copy-icon-title")),j=r(()=>w("common.copy-success-icon-title"));xt(T,{get content(){return o().stackTrace},language:"text",get copyIconTitle(){return e(A)},get copySuccessIconTitle(){return e(j)}}),O(ne=>M(G,ne),[()=>w("common.stack-trace")],r),l(R,B)};X(V,R=>{var B;(B=o())!=null&&B.stackTrace&&R(Y)})}h($),O(R=>M(v,R),[()=>w("common.message")],r),l(f,$)},$$slots:{default:!0,summary:(f,H)=>{var $=so(),d=b($,!0);h($),O(()=>{var v;return M(d,(v=o())==null?void 0:v.message)}),l(f,$)}}})};X(c,_=>{o()&&_(a)})}var s=i(c,2);{var n=_=>{var g=Le(),f=re(g);cr(f,{get failure(){return o().cause}}),l(_,g)};X(s,_=>{var g;(g=o())!=null&&g.cause&&_(n)})}l(k,P),ke()}var io=q('<div class="flex flex-col gap-2"><p class="flex items-center gap-4"> <!></p> <p class="flex items-center gap-4"> <!></p> <p class="flex items-center gap-4"> <!></p> <p class="flex items-center gap-4"> <!></p> <p class="flex items-center gap-4"> <!></p></div>');function lo(k,t){we(t,!1);const[o,P]=We(),c=()=>Q(nr,"$timeFormat",o),a=()=>Q(or,"$relativeTime",o),s=()=>Q(sr,"$timestampFormat",o);let n=F(t,"pendingTask",8,void 0);Ee();const _=r(()=>w("workflows.pending-workflow-task"));rr(k,{get title(){return e(_)},children:(g,f)=>{var H=io(),$=b(H),d=b($),v=i(d);Re(v,{children:(T,A)=>{me();var j=ve();O(()=>M(j,n().state)),l(T,j)},$$slots:{default:!0}}),h($);var x=i($,2),C=b(x),E=i(C);Re(E,{children:(T,A)=>{me();var j=ve();O(()=>M(j,n().attempt)),l(T,j)},$$slots:{default:!0}}),h(x);var y=i(x,2),m=b(y),W=i(m);Re(W,{children:(T,A)=>{me();var j=ve();O(ne=>M(j,ne),[()=>lt(n().originalScheduledTime,c(),{relative:a(),format:s()})],r),l(T,j)},$$slots:{default:!0}}),h(y);var V=i(y,2),Y=b(V),R=i(Y);Re(R,{children:(T,A)=>{me();var j=ve();O(ne=>M(j,ne),[()=>lt(n().scheduledTime,c(),{relative:a(),format:s()})],r),l(T,j)},$$slots:{default:!0}}),h(V);var B=i(V,2),D=b(B),G=i(D);Re(G,{children:(T,A)=>{me();var j=ve();O(ne=>M(j,ne),[()=>lt(n().startedTime,c(),{relative:a(),format:s()})],r),l(T,j)},$$slots:{default:!0}}),h(B),h(H),O((T,A,j,ne,de)=>{M(d,`${T??""} `),M(C,`${A??""} `),M(m,`${j??""} `),M(Y,`${ne??""} `),M(D,`${de??""} `)},[()=>w("common.state"),()=>w("common.attempt"),()=>w("workflows.original-scheduled-time"),()=>w("workflows.scheduled-time"),()=>w("workflows.started-time")],r),l(g,H)},$$slots:{default:!0}}),ke(),P()}var co=q("<p> <!>.</p>"),vo=q('<p><span class="mr-2 text-secondary">Timeout Type</span> </p>'),uo=q("<!> <!>",1),fo=q('<p> </p> <!> <div class="mt-2 flex w-full flex-col gap-0 overflow-hidden border border-danger"><div class="flex items-center justify-between gap-2 bg-danger px-2 py-2"><div class="flex items-center gap-2"> <!> <span class="font-semibold text-danger"> </span></div> <!></div> <div class="flex flex-col gap-2 bg-primary p-4"><!> <!></div></div>',1);function go(k,t){we(t,!0);var o,P;let c=pe(()=>zr(t.error)),a=pe(()=>Rr(t.error)&&((o=t.error.attributes)===null||o===void 0?void 0:o.failure)),s=pe(()=>Lr(t.error)&&((P=t.error.attributes)===null||P===void 0?void 0:P.timeoutType));var n=Le(),_=re(n);{var g=f=>{const H=pe(()=>w(`typed-errors.${e(c)}.title`));jt(f,{icon:"warning",intent:"warning",get title(){return e(H)},children:($,d)=>{var v=fo(),x=re(v),C=b(x,!0);h(x);var E=i(x,2);{var y=L=>{var z=co(),K=b(z,!0),U=i(K);const S=pe(()=>w(`typed-errors.${e(c)}.link`));tr(U,{newTab:!0,get href(){return e(S)},children:(J,ie)=>{me();var le=ve();O(_e=>M(le,_e),[()=>w(`typed-errors.${e(c)}.action`)]),l(J,le)},$$slots:{default:!0}}),me(),h(z),O(J=>M(K,J),[()=>w("typed-errors.link-preface")]),l(L,z)};X(E,L=>{(e(c)==="NonDeterministicError"||e(c)==="BadSearchAttributes")&&L(y)})}var m=i(E,2),W=b(m),V=b(W),Y=b(V),R=i(Y);Be(R,{get name(){return ct[t.error.category]}});var B=i(R,2),D=b(B,!0);h(B),h(V);var G=i(V,2);const T=pe(()=>{var L;return(L=t.error)==null?void 0:L.eventTime});Wt(G,{get dateTime(){return e(T)}}),h(W);var A=i(W,2),j=b(A);{var ne=L=>{var z=vo(),K=i(b(z));h(z),O(()=>M(K,` ${e(s)??""}`)),l(L,z)};X(j,L=>{e(s)&&L(ne)})}var de=i(j,2);{var he=L=>{to(L,{children:(z,K)=>{var U=uo(),S=re(U);{var J=_e=>{cr(_e,{get failure(){return e(a)}})};X(S,_e=>{e(a)&&_e(J)})}var ie=i(S,2);{var le=_e=>{lo(_e,{get pendingTask(){return t.pendingTask}})};X(ie,_e=>{t.pendingTask&&_e(le)})}l(z,U)},$$slots:{default:!0}})};X(de,L=>{(e(a)||t.pendingTask)&&L(he)})}h(A),h(m),O((L,z)=>{M(C,L),M(Y,`${t.error.id??""} `),M(D,z)},[()=>w(`typed-errors.${e(c)}.description`),()=>{var L;return en((L=t.error)==null?void 0:L.name)}]),l($,v)},$$slots:{default:!0}})};X(_,f=>{e(c)&&e(c)!=="ResetWorkflow"&&f(g)})}l(k,n),ke()}const mo=async(k,t,o)=>{const P=sn(t),c=an(t),a=ln(t),s={...t,codec:{...t==null?void 0:t.codec,endpoint:P,passAccessToken:c,includeCredentials:a}},n=!1;try{const _=await nn(k,Ht(Je).params.namespace,s,Ht(er).accessToken,o,n);return on(_,n)}catch{return k}};function Bt(k,t,o){const P=St({events:k},null,2),c=document.createElement("a"),a=new Blob([P],{type:o});c.href=URL.createObjectURL(a),c.download=t,c.click()}const po=async({namespace:k,workflowId:t,runId:o,settings:P,decodeSetting:c})=>{try{const a=await Qr({namespace:k,workflowId:t,runId:o,sort:"ascending"});if(c==="encoded")Bt(a,`${o}/events.json`,"text/plain");else{const s=[];for(const n of a){const _=await mo(n,P,c);s.push(_)}Bt(s,`${o}/events.json`,"text/plain")}}catch{console.error("Could not download event history")}};var _o=q('<div class="flex items-center space-x-4"><!></div>');function xo(k,t){we(t,!1);const[o,P]=We(),c=()=>Q(Pr,"$parameters",o),a=()=>Q(cn,"$isCloud",o),s=p(),n=p(),{namespace:_,workflowId:g,runId:f}=c();I(()=>Ut,()=>{u(s,Ut({namespace:_,workflow:g,run:f}))}),I(()=>e(s),()=>{u(n,e(s)+".json")}),Fe(),Ee();var H=Le(),$=re(H);{var d=v=>{var x=_o(),C=b(x);tr(C,{icon:"external-link",class:"whitespace-nowrap",get href(){return e(n)},newTab:!0,"data-testid":"view-raw-event-history",children:(E,y)=>{me();var m=ve();O(W=>M(m,W),[()=>w("events.view-raw-history")],r),l(E,m)},$$slots:{default:!0}}),h(x),l(v,x)};X($,v=>{a()||v(d)})}l(k,H),ke(),P()}var wo=q('<h3 slot="title"> </h3>'),ko=q("<!> <!> <!>",1),ho=q('<div slot="content" class="flex flex-col gap-4"><!> <!></div>');function $o(k,t){we(t,!1);const[o,P]=We(),c=()=>Q(Je,"$page",o),a=()=>Q(Rt,"$downloadEventHistorySetting",o);let s=F(t,"open",12,!1),n=F(t,"namespace",8),_=F(t,"workflowId",8),g=F(t,"runId",8);const f=()=>{s(!1),po({namespace:n(),workflowId:_(),runId:g(),settings:c().data.settings,decodeSetting:a()})};Ee();const H=r(()=>w("common.download")),$=r(()=>w("common.cancel"));tn(k,{id:"download-history",large:!0,confirmType:"primary",get confirmText(){return e(H)},get cancelText(){return e($)},get open(){return s()},set open(d){s(d)},$$events:{confirmModal:()=>f(),cancelModal:()=>s(!1)},$$slots:{title:(d,v)=>{var x=wo(),C=b(x,!0);h(x),O(E=>M(C,E),[()=>w("common.download-event-history-json")],r),l(d,x)},content:(d,v)=>{var x=ho(),C=b(x);rn(C,{group:Rt,name:"decode-setting",class:"h-auto overflow-auto",children:(y,m)=>{var W=ko(),V=re(W);const Y=r(()=>w("events.encoded"));It(V,{id:"use-encoded-setting","data-testid":"use-encoded-setting-input",value:"encoded",get label(){return e(Y)}});var R=i(V,2);const B=r(()=>w("events.decoded")),D=r(()=>w("events.decoded-description"));It(R,{id:"use-decoded-setting","data-testid":"use-decoded-setting-input",value:"decoded",get label(){return e(B)},get description(){return e(D)}});var G=i(R,2);const T=r(()=>w("events.readable")),A=r(()=>w("events.readable-description"));It(G,{id:"use-readable-setting","data-testid":"use-readable-setting-input",value:"readable",get label(){return e(T)},get description(){return e(A)}}),l(y,W)},$$slots:{default:!0}});var E=i(C,2);xo(E,{}),h(x),l(d,x)}},$$legacy:!0}),ke(),P()}const yo=["WorkflowExecutionFailed","WorkflowExecutionCompleted","WorkflowExecutionContinuedAsNew","WorkflowExecutionTimedOut","WorkflowExecutionCanceled","WorkflowExecutionTerminated"],bo=k=>!!k.workflowExecutionStartedEventAttributes,To=k=>{for(const t of yo)if(k.eventType===t)return!0;return!1},Eo=k=>Jt(k)?k.attributes.input:Or(k)?k.attributes.result===null?null:k.attributes.result:k.attributes,Po=k=>{var s;let t,o,P=!1,c,a;for(const n of k)if(bo(n)){c=n;continue}else if(To(n)){a=n;continue}return c&&(t=St(((s=c==null?void 0:c.workflowExecutionStartedEventAttributes)==null?void 0:s.input)??null)),a&&(P=Jt(a),o=St(Eo(a))),{input:t,results:o,contAsNew:P}};var Io=q('<div class="flex flex-col gap-4 lg:flex-row" data-testid="input-and-result"><!> <!></div>');function Ao(k,t){we(t,!1);const[o,P]=We(),c=()=>Q($t,"$fullEventHistory",o),a=()=>Q(yt,"$workflowRun",o),s=p(),n=p();I(()=>c(),()=>{u(s,Po(c()))}),I(()=>a(),()=>{u(n,a().workflow.isRunning)}),Fe(),Ee();var _=Io(),g=b(_);const f=r(()=>w("workflows.input"));Vt(g,{get title(){return e(f)},get content(){return e(s).input},get isRunning(){return e(n)}});var H=i(g,2);const $=r(()=>w("workflows.result"));Vt(H,{get title(){return e($)},get content(){return e(s).results},get isRunning(){return e(n)}}),h(_),l(k,_),ke(),P()}var Ho=q('<div class="mb-4"><!></div>');function Wo(k,t){we(t,!1);const[o,P]=We(),c=()=>Q(yt,"$workflowRun",o),a=p(),s=p(),n=p();var _=p();I(()=>(e(a),e(s),c()),()=>{($=>(u(a,$.workflow),u(s,$.workers)))(c())}),I(()=>(e(a),te(_),e(s)),()=>{u(n,(e(a)===null||e(a)===void 0?void 0:e(a).isRunning)&&!(!(u(_,e(s)===null||e(s)===void 0?void 0:e(s).pollers)===null||te(_)===void 0)&&te(_).length))}),Fe(),Ee();var g=Le(),f=re(g);{var H=$=>{var d=Ho(),v=b(d);const x=r(()=>w("workflows.workflow-error-no-workers-title"));jt(v,{icon:"warning",intent:"warning",get title(){return e(x)},children:(C,E)=>{me();var y=ve();O(m=>M(y,m),[()=>{var m;return w("workflows.workflow-error-no-workers-description",{taskQueue:(m=e(a))==null?void 0:m.taskQueue})}],r),l(C,y)},$$slots:{default:!0}}),h(d),dn(1,d,()=>vn,()=>({duration:200,delay:100})),l($,d)};X(f,$=>{e(n)&&$(H)})}l(k,g),ke(),P()}var So=q('<div><button class="focus-visible:outline-interactive w-full cursor-pointer hover:bg-interactive-secondary-hover" type="button"><div class="flex w-full flex-row items-center justify-between gap-2 pr-4"><!> <!> <div class="flex items-center gap-4"><!> <!></div></div></button> <div><!></div></div>');function Co(k,t){const o=wt(t,["children","$$slots","$$events","$$legacy"]),P=wt(o,["id","open","onToggle","icon"]);we(t,!1);let c=F(t,"id",24,()=>crypto.randomUUID()),a=F(t,"open",12,!1),s=F(t,"onToggle",8,void 0),n=F(t,"icon",8,void 0);const _=async()=>{s()&&await s()(),a(!a())};Ee();var g=So(),f=b(g),H=b(f),$=b(H);Ye($,t,"title",{},null);var d=i($,2);Ye(d,t,"description",{},null);var v=i(d,2),x=b(v);Ye(x,t,"action",{},null);var C=i(x,2);const E=r(()=>n()?n():a()?"arrow-down":"arrow-right");Be(C,{get name(){return e(E)}}),h(v),h(H),h(f);var y=i(f,2);let m;var W=b(y);Ye(W,t,"default",{get open(){return a()}},null),h(y),h(g),O(V=>{Ne(g,1,`w-full ${P.class??""}`),ue(f,"id",`${c()??""}-trigger`),ue(f,"aria-expanded",a()),ue(f,"aria-controls",`${c()??""}-content`),ue(y,"id",`${c()??""}-content`),ue(y,"aria-labelledby",`${c()??""}-trigger`),m=Ne(y,1,"block w-full bg-primary p-2",null,m,V)},[()=>({hidden:!a()})],r),kt("click",f,_),l(k,g),ke()}var Fo=q("<!> <!>",1),jo=q("<!> <!>",1),zo=q('<p class="flex items-center gap-2"> <!></p>'),Ro=q('<p class="flex items-center gap-2"> <!></p>'),Lo=q('<p class="flex items-center gap-2"> <!></p>'),Oo=q('<p class="flex items-center gap-2"> <!></p>'),Mo=q('<p class="flex items-center gap-2"> <!></p>'),Do=q('<div class="flex flex-col gap-2"><p> </p> <!></div>'),Go=q('<div class="flex flex-col gap-2 pt-2"><!> <div class="flex flex-col items-start gap-2 md:flex-row md:items-center"><p class="flex items-center gap-2"> <!></p> <!> <!> <!></div> <!> <!> <!></div> <!>',1);function qt(k,t){we(t,!0);const[o,P]=We(),c=()=>Q(nr,"$timeFormat",o),a=()=>Q(or,"$relativeTime",o),s=()=>Q(sr,"$timestampFormat",o);var n,_,g,f;const H=pe(()=>lt(t.callback.lastAttemptCompleteTime,c(),{relative:a(),format:s()})),$=pe(()=>lt(t.callback.nextAttemptScheduleTime,c(),{relative:a(),format:s()})),d=pe(()=>(n=t.callback===null||t.callback===void 0?void 0:t.callback.lastAttemptFailure)===null||n===void 0?void 0:n.message),v=pe(()=>t.callback===null||t.callback===void 0?void 0:t.callback.blockedReason),x=pe(()=>(g=(_=t.callback===null||t.callback===void 0?void 0:t.callback.callback)===null||_===void 0?void 0:_.nexus)===null||g===void 0?void 0:g.url),C={Standby:w("nexus.callback.standby"),Scheduled:w("nexus.callback.scheduled"),"Backing Off":w("nexus.callback.backing-off"),Failed:w("nexus.callback.failed"),Succeeded:w("nexus.callback.succeeded")},E="Failed",y=pe(()=>t.callback.state===E),m=pe(()=>C[t.callback.state]||w("nexus.nexus-callback")),W=pe(()=>((f=t.callback===null||t.callback===void 0?void 0:t.callback.callback)===null||f===void 0?void 0:f.links)||[]),V=pe(()=>!e(W).length&&!t.link&&e(x)),Y=pe(()=>e(y)?"error":"info");jt(k,{icon:"nexus",get intent(){return e(Y)},get title(){return e(m)},children:(R,B)=>{var D=Go(),G=re(D),T=b(G);{var A=N=>{var Z=Le(),ce=re(Z);ot(ce,17,()=>e(W),ge=>{var ee,se,oe;return((se=(ee=ge.workflowEvent)==null?void 0:ee.eventRef)==null?void 0:se.eventId)||((oe=ge.workflowEvent)==null?void 0:oe.requestIdRef.requestId)},(ge,ee,se,oe)=>{var $e=Fo(),ye=re($e);mt(ye,{get link(){return e(ee)}});var be=i(ye,2);const Se=pe(()=>w("nexus.link-namespace")),Te=pe(()=>Nt({namespace:e(ee).workflowEvent.namespace}));mt(be,{get link(){return e(ee)},get label(){return e(Se)},get value(){return e(ee).workflowEvent.namespace},get href(){return e(Te)}}),l(ge,$e)}),l(N,Z)},j=(N,Z)=>{{var ce=ge=>{var ee=jo(),se=re(ee);mt(se,{get link(){return t.link}});var oe=i(se,2);const $e=pe(()=>w("nexus.link-namespace")),ye=pe(()=>Nt({namespace:t.link.workflowEvent.namespace}));mt(oe,{get link(){return t.link},get label(){return e($e)},get value(){return t.link.workflowEvent.namespace},get href(){return e(ye)}}),l(ge,ee)};X(N,ge=>{t.link&&ge(ce)},Z)}};X(T,N=>{e(W).length?N(A):N(j,!1)})}var ne=i(T,2),de=b(ne),he=b(de,!0),L=i(he);Re(L,{type:"subtle",children:(N,Z)=>{me();var ce=ve();O(()=>M(ce,t.callback.state)),l(N,ce)},$$slots:{default:!0}}),h(de);var z=i(de,2);{var K=N=>{var Z=zo(),ce=b(Z),ge=i(ce);Re(ge,{type:"subtle",children:(ee,se)=>{me();var oe=ve();O(()=>M(oe,t.callback.attempt)),l(ee,oe)},$$slots:{default:!0}}),h(Z),O(ee=>M(ce,`${ee??""} `),[()=>w("common.attempt")]),l(N,Z)};X(z,N=>{t.callback.attempt&&N(K)})}var U=i(z,2);{var S=N=>{var Z=Ro(),ce=b(Z),ge=i(ce);Re(ge,{type:"subtle",children:(ee,se)=>{me();var oe=ve();O(()=>M(oe,e(H))),l(ee,oe)},$$slots:{default:!0}}),h(Z),O(ee=>M(ce,`${ee??""} `),[()=>w("nexus.last-attempt-completed-time")]),l(N,Z)};X(U,N=>{t.callback.lastAttemptCompleteTime&&N(S)})}var J=i(U,2);{var ie=N=>{var Z=Lo(),ce=b(Z),ge=i(ce);Re(ge,{type:"subtle",children:(ee,se)=>{me();var oe=ve();O(()=>M(oe,e($))),l(ee,oe)},$$slots:{default:!0}}),h(Z),O(ee=>M(ce,`${ee??""} `),[()=>w("nexus.next-attempt-scheduled-time")]),l(N,Z)};X(J,N=>{t.callback.nextAttemptScheduleTime&&N(ie)})}h(ne);var le=i(ne,2);{var _e=N=>{var Z=Oo(),ce=b(Z),ge=i(ce);Re(ge,{type:"subtle",children:(ee,se)=>{me();var oe=ve();O(()=>M(oe,e(x))),l(ee,oe)},$$slots:{default:!0}}),h(Z),O(ee=>M(ce,`${ee??""} `),[()=>w("nexus.callback-url")]),l(N,Z)};X(le,N=>{e(V)&&N(_e)})}var Pe=i(le,2);{var Ie=N=>{var Z=Mo(),ce=b(Z),ge=i(ce);Re(ge,{type:"subtle",children:(ee,se)=>{me();var oe=ve();O(()=>M(oe,e(v))),l(ee,oe)},$$slots:{default:!0}}),h(Z),O(ee=>M(ce,`${ee??""} `),[()=>w("nexus.blocked-reason")]),l(N,Z)};X(Pe,N=>{e(v)&&N(Ie)})}var Ae=i(Pe,2);{var ze=N=>{var Z=Do(),ce=b(Z),ge=b(ce,!0);h(ce);var ee=i(ce,2);const se=pe(()=>w("common.copy-icon-title")),oe=pe(()=>w("common.copy-success-icon-title"));xt(ee,{get content(){return e(d)},language:"text",get copyIconTitle(){return e(se)},get copySuccessIconTitle(){return e(oe)}}),h(Z),O($e=>M(ge,$e),[()=>w("nexus.last-attempt-failure")]),l(N,Z)};X(Ae,N=>{e(d)&&N(ze)})}h(G);var fe=i(G,2);gr(fe,()=>t.children??mr),O(N=>M(he,N),[()=>w("common.state")]),l(R,D)},$$slots:{default:!0}}),ke(),P()}var Uo=q('<div class="flex flex-col gap-2"></div>'),No=q('<p class="p-1" slot="title"> </p>'),Vo=q('<div class="py-2"><!></div>');function Bo(k,t){we(t,!0);const[o,P]=We(),c=()=>Q($t,"$fullEventHistory",o);var a;const s=pe(()=>c()[0]),n=pe(()=>(a=e(s)===null||e(s)===void 0?void 0:e(s).links)===null||a===void 0?void 0:a[0]),_=pe(()=>t.callbacks[0]);qt(k,{get callback(){return e(_)},get link(){return e(n)},children:(g,f)=>{var H=Le(),$=re(H);{var d=v=>{var x=Vo(),C=b(x);Co(C,{children:Ct,$$slots:{default:(E,y)=>{const m=pe(()=>y.open);var W=Le(),V=re(W);{var Y=R=>{var B=Uo();ot(B,21,()=>t.callbacks.slice(1),bt,(D,G)=>{qt(D,{get callback(){return e(G)}})}),h(B),l(R,B)};X(V,R=>{e(m)&&R(Y)})}l(E,W)},title:(E,y)=>{var m=No(),W=b(m);h(m),O(()=>M(W,`View ${t.callbacks.length-1} other Callbacks`)),l(E,m)}}}),h(x),l(v,x)};X($,v=>{t.callbacks.length>1&&v(d)})}l(g,H)},$$slots:{default:!0}}),ke(),P()}var qo=q("<!> <!> <!> <!> <!>",1),Yo=q('<div class="flex flex-col gap-0 pt-4"><!> <div class="flex flex-col gap-2"><!> <!> <!></div></div> <div class="relative pb-24"><div><h2> </h2> <div class="flex items-center gap-2"><!></div></div> <div class="flex w-full flex-col"><!> <!></div></div> <!>',1);function Jo(k,t){we(t,!1);const[o,P]=We(),c=()=>Q(Je,"$page",o),a=()=>Q(yt,"$workflowRun",o),s=()=>Q(at,"$eventFilterSort",o),n=()=>Q(tt,"$eventViewType",o),_=()=>Q(Yt,"$filteredEventHistory",o),g=()=>Q(Ir,"$currentEventHistory",o),f=()=>Q(it,"$pauseLiveUpdates",o),H=()=>Q(Lt,"$minimizeEventView",o),$=p(),d=p(),v=p(),x=p(),C=p(),E=p(),y=p(),m=p(),W=p(),V=p();wr(()=>{At()});let Y=p(!1);const R=()=>{e(C)?xe(at,"ascending"):xe(at,"descending")};I(()=>(e($),c()),()=>{(fe=>u($,fe.namespace))(c().params)}),I(()=>(e(d),a()),()=>{(fe=>u(d,fe.workflow))(a())}),I(()=>e(d),()=>{u(v,e(d)===null||e(d)===void 0?void 0:e(d).pendingActivities)}),I(()=>e(d),()=>{u(x,e(d)===null||e(d)===void 0?void 0:e(d).pendingNexusOperations)}),I(()=>s(),()=>{u(C,s()==="descending")}),I(()=>n(),()=>{u(E,n()==="compact")}),I(()=>(_(),e(v),e(x)),()=>{u(y,Kt(_(),"ascending",e(v),e(x)))}),I(()=>(e(C),e(y)),()=>{u(m,e(C)?[...e(y)].reverse():e(y))}),I(()=>(e(C),_()),()=>{u(W,e(C)?[..._()].reverse():_())}),I(()=>g(),()=>{u(V,Mr(g(),"ascending"))}),I(()=>(n(),At),()=>{n(),At()}),I(()=>(e(d),f()),()=>{!e(d).isRunning&&f()&&xe(it,!1)}),Fe(),Ee();var B=Yo(),D=re(B),G=b(D);Wo(G,{});var T=i(G,2),A=b(T);Ao(A,{});var j=i(A,2);{var ne=fe=>{const N=r(()=>{var Z;return(Z=e(d))==null?void 0:Z.pendingWorkflowTask});go(fe,{get error(){return e(V)},get pendingTask(){return e(N)}})};X(j,fe=>{e(V)&&fe(ne)})}var de=i(j,2);{var he=fe=>{Bo(fe,{get callbacks(){return e(d).callbacks}})};X(de,fe=>{var N,Z;(Z=(N=e(d))==null?void 0:N.callbacks)!=null&&Z.length&&fe(he)})}h(T),h(D);var L=i(D,2),z=b(L);let K;var U=b(z),S=b(U,!0);h(U);var J=i(U,2),ie=b(J);un(ie,{children:(fe,N)=>{var Z=qo(),ce=re(Z);{var ge=Te=>{const Ce=r(()=>e(C)?"descending":"ascending");pt(Te,{get leadingIcon(){return e(Ce)},"data-testid":"zoom-in",size:"sm",$$events:{click:R},children:(He,qe)=>{me();var Me=ve();O(()=>M(Me,e(C)?"Descending":"Ascending")),l(He,Me)},$$slots:{default:!0}})};X(ce,Te=>{n()!=="json"&&Te(ge)})}var ee=i(ce,2);const se=r(()=>H()?"Timeline and Event History are collapsed to minimized height":"Timeline and Event History are expanded to full height");fn(ee,{get text(){return e(se)},top:!0,children:(Te,Ce)=>{const He=r(()=>H()?"minimize":"expand");pt(Te,{get leadingIcon(){return e(He)},"data-testid":"expandAll",size:"sm",$$events:{click:()=>xe(Lt,!H())},children:(qe,Me)=>{me();var Qe=ve();O(()=>M(Qe,H()?"Minimized":"Expanded")),l(qe,Qe)},$$slots:{default:!0}})},$$slots:{default:!0}});var oe=i(ee,2);In(oe,{get compact(){return e(E)},get minimized(){return H()}});var $e=i(oe,2);const ye=r(()=>!e(d).isRunning),be=r(()=>f()?"play":"pause");pt($e,{get disabled(){return e(ye)},get leadingIcon(){return e(be)},"data-testid":"pause",class:"border-l-0",size:"sm",$$events:{click:()=>xe(it,!f())},children:(Te,Ce)=>{me();var He=ve();O(()=>M(He,f()?"Unfreeze":"Freeze")),l(Te,He)},$$slots:{default:!0}});var Se=i($e,2);pt(Se,{"data-testid":"download",leadingIcon:"download",size:"sm",$$events:{click:()=>u(Y,!0)},children:(Te,Ce)=>{me();var He=ve();O(qe=>M(He,qe),[()=>w("common.download")],r),l(Te,He)},$$slots:{default:!0}}),l(fe,Z)},$$slots:{default:!0}}),h(J),h(z);var le=i(z,2),_e=b(le);const Pe=r(()=>!!e(V)),Ie=r(()=>H()?360:void 0);lr(_e,{get workflow(){return e(d)},get groups(){return e(m)},get error(){return e(Pe)},get viewportHeight(){return e(Ie)}});var Ae=i(_e,2);wn(Ae,{get groups(){return e(m)},get history(){return e(W)},get minimized(){return H()}}),h(le),h(L);var ze=i(L,2);$o(ze,{get namespace(){return e($)},get workflowId(){return e(d).id},get runId(){return e(d).runId},get open(){return e(Y)},set open(fe){u(Y,fe)},$$legacy:!0}),O((fe,N)=>{K=Ne(z,1,"surface-background flex flex-wrap items-center justify-between gap-2 border-b border-subtle py-2 xl:gap-8 svelte-18jakp5",null,K,fe),M(S,N)},[()=>({"sticky-header":!H()}),()=>w("workflows.event-history")],r),l(k,B),ke(),P()}var Qo=q("<!> <!>",1);function sa(k,t){we(t,!1);const[o,P]=We(),c=()=>Q(Je,"$page",o),a=c().params.workflow;Ee();var s=Qo(),n=re(s);const _=r(()=>`${w("workflows.workflow-history")} | ${a}`);_r(n,{get title(){return e(_)},get url(){return c().url.href}});var g=i(n,2);Jo(g,{}),l(k,s),ke(),P()}export{sa as component};
