import"../chunks/CWj6FrbW.js";import"../chunks/69_IOA4Y.js";import{p as N,az as r,aC as ne,a9 as le,g as e,s as ie,t as R,h as y,r as b,d as p,b as O,e as Q,f as T,c as d,i as j,n as ce,k as me,j as fe}from"../chunks/CtXwlho8.js";import{i as pe}from"../chunks/D4D3ThYu.js";import{a as $,s as V}from"../chunks/CI9zuxJp.js";import{p as ue}from"../chunks/B2sskHD-.js";import{P as ve}from"../chunks/BYpUB0sF.js";import{t as o}from"../chunks/D2OY9xdY.js";import{W as we}from"../chunks/Bqnuktlx.js";import{s as C}from"../chunks/BXc8M6y4.js";import{a as ke}from"../chunks/CHlFt2el.js";import{i as z}from"../chunks/yjFgoZ2z.js";import{p as J}from"../chunks/CM5Ti_6v.js";import{A as K}from"../chunks/Cb-Z4thM.js";import{C as de}from"../chunks/Ck_UWq5r.js";import{E as M}from"../chunks/Dij6HiAt.js";import{L as _e}from"../chunks/DJrJRaJj.js";import{S as B}from"../chunks/CTZ78y2A.js";import{g as ge}from"../chunks/CdmJos1h.js";import{a as $e}from"../chunks/Ip-blrGX.js";import{f as he,t as xe,r as ye}from"../chunks/cq7hwzrg.js";import{w as be,r as Te}from"../chunks/D9pSO_rq.js";var Re=R('<!> <p> </p> <div class="my-2 flex h-full items-start"><!></div>',1),Pe=R('<div class="flex flex-col gap-2"><!> <!> <!></div>'),Se=R("<p> <!> </p>"),qe=R("<section><!></section>");function De(U,A){N(A,!0);const[w,E]=V(),h=()=>$(be,"$workflowRun",w),P=()=>$(Te,"$refresh",w),S=()=>$(xe,"$timeFormat",w),q=()=>$(ye,"$relativeTime",w),x=()=>$($e,"$authUser",w);let i=r(()=>h().workflow),D=r(()=>h().workers);const G=r(()=>J.params.namespace);let H=ne(void 0),X=r(()=>he(P()?new Date(P()):new Date,S(),{relative:q(),abbrFormat:!0}));const Y=()=>{var n;return ge({workflow:e(i),namespace:e(G)},(n=J.data)===null||n===void 0?void 0:n.settings,x()===null||x()===void 0?void 0:x().accessToken)};le(()=>{!(e(i)===null||e(i)===void 0)&&e(i).isRunning&&ie(H,Y(),!0)});var L=qe(),Z=y(L);{var ee=n=>{var k=Q(),_=T(k);ke(_,()=>e(H),c=>{var s=Pe(),m=y(s);B(m,{class:"h-16 w-1/3 rounded-sm"});var u=d(m,2);B(u,{class:"h-3 w-32"});var f=d(u,2);B(f,{class:"h-48 w-full rounded-sm"}),b(s),p(c,s)},(c,s)=>{var m=Q(),u=T(m);{var f=t=>{var l=Re(),F=T(l);const v=r(()=>o("workflows.call-stack-alert"));K(F,{intent:"info",get title(){return e(v)},class:"mb-4 w-fit"});var g=d(F,2),I=y(g);b(g);var W=d(g,2),re=y(W);const oe=r(()=>o("common.copy-icon-title")),se=r(()=>o("common.copy-success-icon-title"));de(re,{get content(){return e(s)},language:"text",testId:"query-call-stack",get copyIconTitle(){return e(oe)},get copySuccessIconTitle(){return e(se)}}),b(W),j(ae=>C(I,`${ae??""}
          ${e(X)??""}`),[()=>o("workflows.call-stack-at")]),p(t,l)},a=t=>{const l=r(()=>o("workflows.call-stack-error"));K(t,{intent:"warning",get title(){return e(l)},class:"mb-4 w-fit"})};z(u,t=>{typeof e(s)=="string"?t(f):t(a,!1)})}p(c,m)},(c,s)=>{const m=r(()=>o("common.error-occurred")),u=r(()=>o("workflows.no-workers-running-message")),f=r(()=>{var a;return(a=e(s))==null?void 0:a.message});M(c,{get title(){return e(m)},get content(){return e(u)},get error(){return e(f)}})}),p(n,k)},te=n=>{const k=r(()=>o("workflows.call-stack-empty-state"));M(n,{get title(){return e(k)},testId:"query-call-stack-empty",children:(_,c)=>{var s=Q(),m=T(s);{var u=f=>{var a=Se(),t=y(a,!0),l=d(t);_e(l,{newTab:!0,href:"https://docs.temporal.io/workflows#stack-trace-query",children:(v,g)=>{ce();var I=me();j(W=>C(I,W),[()=>o("workflows.call-stack-link")]),p(v,I)},$$slots:{default:!0}});var F=d(l,1,!0);b(a),j((v,g)=>{C(t,v),C(F,g)},[()=>o("workflows.call-stack-link-preface"),()=>{var v;return o("workflows.call-stack-link-postface",{taskQueue:(v=e(i))==null?void 0:v.taskQueue})}]),p(f,a)};z(m,f=>{var a,t,l;(a=e(i))!=null&&a.isRunning&&((l=(t=e(D))==null?void 0:t.pollers)==null?void 0:l.length)===0&&f(u)})}p(_,s)},$$slots:{default:!0}})};z(Z,n=>{var k,_,c;(k=e(i))!=null&&k.isRunning&&((c=(_=e(D))==null?void 0:_.pollers)==null?void 0:c.length)>0?n(ee):n(te,!1)})}b(L),p(U,L),O(),E()}var Fe=R("<!> <!>",1);function et(U,A){N(A,!1);const[w,E]=V(),h=()=>$(ue,"$page",w),P=h().params.workflow;pe();var S=Fe(),q=T(S);const x=fe(()=>`${o("workflows.call-stack-tab")} | ${P}`);ve(q,{get title(){return e(x)},get url(){return h().url.href}});var i=d(q,2);we(i,{children:(D,G)=>{De(D,{})},$$slots:{default:!0}}),p(U,S),O(),E()}export{et as component};
