import"../chunks/CWj6FrbW.js";import"../chunks/69_IOA4Y.js";import{p as j,f as G,e as m,b as M,k as R,g as t,u as s,j as q,h as g,s as z,n as B,r as E,c as et,o as ot}from"../chunks/CckrFwdx.js";import{i as st}from"../chunks/ebNgFJjp.js";import{s as W,a as $,c as O}from"../chunks/BioCYJcK.js";import{p as rt}from"../chunks/D0bZBjsq.js";import{P as nt}from"../chunks/CuqmI6m2.js";import{t as it}from"../chunks/DEjs8ZrU.js";import{o as at}from"../chunks/DsVF0eUi.js";import{e as lt,i as dt}from"../chunks/BTEtt5uP.js";import{p as pt}from"../chunks/Bw3VOosG.js";import{E as ct}from"../chunks/DW3_1p6W.js";import{B as T}from"../chunks/Cbg44LbG.js";import{g as vt}from"../chunks/CvC6W0AE.js";import{g as ft}from"../chunks/B2wrew68.js";import{f as ut}from"../chunks/CKvxbvLq.js";import{f as S,e as mt}from"../chunks/DdDlMjtY.js";import{w as gt}from"../chunks/DiTAogHV.js";var $t=G('<div class="flex flex-col gap-2 px-8 pb-24 pt-2" data-testid="event-summary-log"><!> <table><thead></thead><tbody class="svelte-b1glyn"></tbody></table> <!></div>');function wt(w,h){j(h,!0);const i=()=>$(S,"$fullEventHistory",c),_=()=>$(gt,"$workflowRun",c),x=()=>$(mt,"$eventFilterSort",c),[c,I]=W();var p;const l=s(()=>pt.params),v=s(()=>t(l).id),k=s(()=>t(l).namespace),C=s(()=>t(l).workflow),D=s(()=>t(l).run);let a=s(()=>[t(v)]);const J=()=>{O(S,[])},K=async(r,e,n)=>{i().length||(J(),O(S,await ut({namespace:r,workflowId:e,runId:n})))};at(()=>{K(t(k),t(C),t(D))});const d=s(()=>_().workflow),L=s(()=>t(d)===null||t(d)===void 0?void 0:t(d).pendingActivities),Q=s(()=>t(d)===null||t(d)===void 0?void 0:t(d).pendingNexusOperations),P=s(()=>vt(i(),"ascending",t(L),t(Q))),U=s(()=>x()==="ascending"?t(P):[...t(P)].reverse()),f=s(()=>i().find(r=>{var e,n,o;return r.id===t(v)||r.id===String((o=(n=(e=t(d).workflowExtendedInfo)===null||e===void 0?void 0:e.requestIdInfos)===null||n===void 0?void 0:n[t(v)])===null||o===void 0?void 0:o.eventId)})),F=s(()=>i().filter(r=>t(a).includes(r.id)||r.id===(t(f)===null||t(f)===void 0?void 0:t(f).id))),H=s(()=>!t(F).length),V=s(()=>(p=i()[i().length-1])===null||p===void 0?void 0:p.id),X=()=>{const r=parseInt(t(a)[0]),e=[],n=r-10;for(let o=0;o<10;o++)n+o>0&&e.push((n+o).toString());z(a,[...e,...t(a)])},Y=()=>{const r=parseInt(t(a)[t(a).length-1]),e=[],n=r+1;for(let o=0;o<10;o++)n+o<=i().length&&e.push((n+o).toString());z(a,[...t(a),...e])};var y=$t(),N=q(y);{let r=s(()=>t(a)[0]==="1"||t(H));T(N,{variant:"secondary",size:"xs",leadingIcon:"arrow-up",get disabled(){return t(r)},"data-testid":"load-previous",$$events:{click:X},children:(e,n)=>{B();var o=R("Show Previous 10");m(e,o)},$$slots:{default:!0}})}var b=g(N,2),A=g(q(b));lt(A,21,()=>t(F),dt,(r,e,n)=>{{let o=s(()=>{var u;return t(e).id===((u=t(f))==null?void 0:u.id)}),tt=s(()=>t(U).find(u=>ft(t(e))&&u.eventIds.has(t(e).id)));ct(r,{get event(){return t(e)},index:n,get expanded(){return t(o)},get group(){return t(tt)},get initialItem(){return i()[0]}})}}),E(A),E(b);var Z=g(b,2);{let r=s(()=>t(a)[t(a).length-1]===t(V)||t(H));T(Z,{variant:"secondary",size:"xs",leadingIcon:"arrow-down",get disabled(){return t(r)},"data-testid":"load-next",$$events:{click:Y},children:(e,n)=>{B();var o=R("Show Next 10");m(e,o)},$$slots:{default:!0}})}E(y),m(w,y),M(),I()}var ht=G("<!> <!>",1);function Tt(w,h){j(h,!1);const i=()=>$(rt,"$page",_),[_,x]=W(),c=i().params.workflow,I=i().params.id;st();var p=ht(),l=et(p);{let k=ot(()=>`${it("workflows.workflow-history")} | ${c} | Event ${I}`);nt(l,{get title(){return t(k)},get url(){return i().url.href}})}var v=g(l,2);wt(v,{}),m(w,p),M(),x()}export{Tt as component};
