import{s as ee,h as T,j,k as C,f as m,i as _,c as U,v as I,b as O,d as W,m as S,n as Q,N as H,O as J,t as F,l as z,x as K,y as ie,q as ce}from"../chunks/scheduler.C46pS-76.js";import{S as te,i as re,t as $,b as g,c as h,a as w,m as k,d as b,f as M,g as me,e as pe}from"../chunks/index.dOVbn71B.js";import{p as ne}from"../chunks/stores.Dz3tjJrH.js";import{P as $e}from"../chunks/page-title.DNhqE1Lj.js";import{t as d}from"../chunks/translate.BBe5dcco.js";import{W as ge}from"../chunks/workflow-padded-layout.DTPWvpOw.js";import{h as A,u as oe}from"../chunks/await_block.BfN27BCg.js";import{e as X}from"../chunks/each.C6O0oV7R.js";import{P as de}from"../chunks/payload-input.Q-qTrfqr.js";import{B as _e}from"../chunks/button.loCtcN8Q.js";import{C as he}from"../chunks/card.DbXyfCsc.js";import{C as we}from"../chunks/code-block.QzabFnLT.js";import{E as le}from"../chunks/empty-state.BO9uOKUe.js";import{L as ke}from"../chunks/loading.BLsNkl8r.js";import{S as be,O as ve}from"../chunks/option.BSq2_A3G.js";import{T as ye}from"../chunks/toggle-switch.C9lxIG0w.js";import{a as qe,b as Ie}from"../chunks/query-service.DK4Vr_6i.js";import{a as Pe}from"../chunks/auth-user.DHlZJ20V.js";import{e as Ee}from"../chunks/encode-payload.DBRO7gnv.js";import{s as Te}from"../chunks/parse-with-big-int.BKSBwM2t.js";function Y(a){a[24]=a[26][0],a[25]=a[26][1];const e=typeof a[24]!="string"?Te(a[24]):a[24];a[27]=e}function Z(a,e,n){const r=a.slice();return r[26]=e[n].name,r[29]=e[n].description!==void 0?e[n].description:"",r}function je(a){var r,t;let e,n;return e=new le({props:{title:d("common.error-occurred"),content:d("workflows.no-workers-running-message"),error:(t=(r=a[28])==null?void 0:r.body)==null?void 0:t.message}}),{c(){h(e.$$.fragment)},l(o){w(e.$$.fragment,o)},m(o,l){k(e,o,l),n=!0},p:I,i(o){n||($(e.$$.fragment,o),n=!0)},o(o){g(e.$$.fragment,o),n=!1},d(o){b(e,o)}}}function Ce(a){let e,n,r,t,o,l;n=new he({props:{class:"mt-7 flex h-fit w-full flex-col gap-2",$$slots:{default:[Be]},$$scope:{ctx:a}}});let s={ctx:a,current:null,token:null,hasCatch:!0,pending:Ne,then:We,catch:Oe,value:26,error:28,blocks:[,,,]};return A(o=Promise.all([a[4],a[5]]),s),{c(){e=T("div"),h(n.$$.fragment),r=O(),t=T("div"),s.block.c(),this.h()},l(u){e=j(u,"DIV",{class:!0});var f=C(e);w(n.$$.fragment,f),r=W(f),t=j(f,"DIV",{class:!0});var p=C(t);s.block.l(p),p.forEach(m),f.forEach(m),this.h()},h(){S(t,"class","flex w-full flex-col gap-2"),S(e,"class","flex w-3/4 gap-4 max-2xl:w-full max-lg:flex-col")},m(u,f){_(u,e,f),k(n,e,null),Q(e,r),Q(e,t),s.block.m(t,s.anchor=null),s.mount=()=>t,s.anchor=null,l=!0},p(u,f){a=u;const p={};f[0]&71|f[1]&2&&(p.$$scope={dirty:f,ctx:a}),n.$set(p),s.ctx=a,f[0]&48&&o!==(o=Promise.all([a[4],a[5]]))&&A(o,s)||oe(s,a,f)},i(u){l||($(n.$$.fragment,u),$(s.block),l=!0)},o(u){g(n.$$.fragment,u);for(let f=0;f<3;f+=1){const p=s.blocks[f];g(p)}l=!1},d(u){u&&m(e),b(n),s.block.d(),s.token=null,s=null}}}function De(a){let e=a[26]+"",n;return{c(){n=F(e)},l(r){n=z(r,e)},m(r,t){_(r,n,t)},p:I,d(r){r&&m(n)}}}function x(a){let e,n;return e=new ve({props:{value:a[26],description:a[29],$$slots:{default:[De]},$$scope:{ctx:a}}}),{c(){h(e.$$.fragment)},l(r){w(e.$$.fragment,r)},m(r,t){k(e,r,t),n=!0},p(r,t){const o={};t[1]&2&&(o.$$scope={dirty:t,ctx:r}),e.$set(o)},i(r){n||($(e.$$.fragment,r),n=!0)},o(r){g(e.$$.fragment,r),n=!1},d(r){b(e,r)}}}function Se(a){let e,n,r=X(a[23]),t=[];for(let l=0;l<r.length;l+=1)t[l]=x(Z(a,r,l));const o=l=>g(t[l],1,1,()=>{t[l]=null});return{c(){for(let l=0;l<t.length;l+=1)t[l].c();e=K()},l(l){for(let s=0;s<t.length;s+=1)t[s].l(l);e=K()},m(l,s){for(let u=0;u<t.length;u+=1)t[u]&&t[u].m(l,s);_(l,e,s),n=!0},p(l,s){if(s[0]&128){r=X(l[23]);let u;for(u=0;u<r.length;u+=1){const f=Z(l,r,u);t[u]?(t[u].p(f,s),$(t[u],1)):(t[u]=x(f),t[u].c(),$(t[u],1),t[u].m(e.parentNode,e))}for(me(),u=r.length;u<t.length;u+=1)o(u);pe()}},i(l){if(!n){for(let s=0;s<r.length;s+=1)$(t[s]);n=!0}},o(l){t=t.filter(Boolean);for(let s=0;s<t.length;s+=1)g(t[s]);n=!1},d(l){l&&m(e),ie(t,l)}}}function Ve(a){let e=(a[6]?d("workflows.run-query"):d("workflows.refresh-query"))+"",n;return{c(){n=F(e)},l(r){n=z(r,e)},m(r,t){_(r,n,t)},p(r,t){t[0]&64&&e!==(e=(r[6]?d("workflows.run-query"):d("workflows.refresh-query"))+"")&&ce(n,e)},d(r){r&&m(n)}}}function Be(a){let e,n,r,t,o,l,s,u,f,p;function y(i){a[11](i)}let V={id:"query-select",label:d("workflows.query-type"),class:"min-w-fit","data-testid":"query-select",required:!0,$$slots:{default:[Se]},$$scope:{ctx:a}};a[0]!==void 0&&(V.value=a[0]),e=new be({props:V}),H.push(()=>M(e,"value",y));function P(i){a[12](i)}let B={label:d("workflows.query-arg")};return a[1]!==void 0&&(B.input=a[1]),o=new de({props:B}),H.push(()=>M(o,"input",P)),f=new _e({props:{loading:a[2],variant:a[6]?"primary":"secondary",leadingIcon:a[6]?null:"retry",disabled:a[2],$$slots:{default:[Ve]},$$scope:{ctx:a}}}),f.$on("click",a[13]),{c(){h(e.$$.fragment),r=O(),t=T("div"),h(o.$$.fragment),s=O(),u=T("div"),h(f.$$.fragment),this.h()},l(i){w(e.$$.fragment,i),r=W(i),t=j(i,"DIV",{class:!0});var c=C(t);w(o.$$.fragment,c),c.forEach(m),s=W(i),u=j(i,"DIV",{class:!0});var E=C(u);w(f.$$.fragment,E),E.forEach(m),this.h()},h(){S(t,"class","flex flex-col gap-1"),S(u,"class","flex w-full flex-wrap items-end justify-end gap-4")},m(i,c){k(e,i,c),_(i,r,c),_(i,t,c),k(o,t,null),_(i,s,c),_(i,u,c),k(f,u,null),p=!0},p(i,c){const E={};c[1]&2&&(E.$$scope={dirty:c,ctx:i}),!n&&c[0]&1&&(n=!0,E.value=i[0],J(()=>n=!1)),e.$set(E);const N={};!l&&c[0]&2&&(l=!0,N.input=i[1],J(()=>l=!1)),o.$set(N);const q={};c[0]&4&&(q.loading=i[2]),c[0]&64&&(q.variant=i[6]?"primary":"secondary"),c[0]&64&&(q.leadingIcon=i[6]?null:"retry"),c[0]&4&&(q.disabled=i[2]),c[0]&64|c[1]&2&&(q.$$scope={dirty:c,ctx:i}),f.$set(q)},i(i){p||($(e.$$.fragment,i),$(o.$$.fragment,i),$(f.$$.fragment,i),p=!0)},o(i){g(e.$$.fragment,i),g(o.$$.fragment,i),g(f.$$.fragment,i),p=!1},d(i){i&&(m(r),m(t),m(s),m(u)),b(e,i),b(o),b(f)}}}function Oe(a){var r;let e,n;return e=new le({props:{title:d("common.error-occurred"),error:(r=a[28])==null?void 0:r.message}}),{c(){h(e.$$.fragment)},l(t){w(e.$$.fragment,t)},m(t,o){k(e,t,o),n=!0},p(t,o){var s;const l={};o[0]&48&&(l.error=(s=t[28])==null?void 0:s.message),e.$set(l)},i(t){n||($(e.$$.fragment,t),n=!0)},o(t){g(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function We(a){Y(a);let e,n,r,t,o;return n=new ye({props:{label:d("workflows.json-formatting"),labelPosition:"left",id:"json-formatting",checked:a[3]}}),n.$on("change",a[14]),t=new we({props:{content:a[27],language:a[3]?"json":"text",copyIconTitle:d("common.copy-icon-title"),copySuccessIconTitle:d("common.copy-success-icon-title"),testId:"query-result",class:a[6]&&"opacity-50"}}),{c(){e=T("div"),h(n.$$.fragment),r=O(),h(t.$$.fragment),this.h()},l(l){e=j(l,"DIV",{class:!0});var s=C(e);w(n.$$.fragment,s),s.forEach(m),r=W(l),w(t.$$.fragment,l),this.h()},h(){S(e,"class","ml-auto")},m(l,s){_(l,e,s),k(n,e,null),_(l,r,s),k(t,l,s),o=!0},p(l,s){Y(l);const u={};s[0]&8&&(u.checked=l[3]),n.$set(u);const f={};s[0]&48&&(f.content=l[27]),s[0]&8&&(f.language=l[3]?"json":"text"),s[0]&64&&(f.class=l[6]&&"opacity-50"),t.$set(f)},i(l){o||($(n.$$.fragment,l),$(t.$$.fragment,l),o=!0)},o(l){g(n.$$.fragment,l),g(t.$$.fragment,l),o=!1},d(l){l&&(m(e),m(r)),b(n),b(t,l)}}}function Ne(a){return{c:I,l:I,m:I,p:I,i:I,o:I,d:I}}function Qe(a){let e,n,r,t,o=d("workflows.no-workers-failure-message")+"",l,s;return n=new ke({}),{c(){e=T("div"),h(n.$$.fragment),r=O(),t=T("p"),l=F(o),this.h()},l(u){e=j(u,"DIV",{class:!0});var f=C(e);w(n.$$.fragment,f),r=W(f),t=j(f,"P",{class:!0});var p=C(t);l=z(p,o),p.forEach(m),f.forEach(m),this.h()},h(){S(t,"class","-mt-10"),S(e,"class","text-center")},m(u,f){_(u,e,f),k(n,e,null),Q(e,r),Q(e,t),Q(t,l),s=!0},p:I,i(u){s||($(n.$$.fragment,u),s=!0)},o(u){g(n.$$.fragment,u),s=!1},d(u){u&&m(e),b(n)}}}function Le(a){let e,n,r={ctx:a,current:null,token:null,hasCatch:!0,pending:Qe,then:Ce,catch:je,value:23,error:28,blocks:[,,,]};return A(a[7],r),{c(){e=T("section"),r.block.c()},l(t){e=j(t,"SECTION",{});var o=C(e);r.block.l(o),o.forEach(m)},m(t,o){_(t,e,o),r.block.m(e,r.anchor=null),r.mount=()=>e,r.anchor=null,n=!0},p(t,o){a=t,oe(r,a,o)},i(t){n||($(r.block),n=!0)},o(t){for(let o=0;o<3;o+=1){const l=r.blocks[o];g(l)}n=!1},d(t){t&&m(e),r.block.d(),r.token=null,r=null}}}function Re(a,e,n){let r,t,o;U(a,Pe,v=>n(16,t=v)),U(a,ne,v=>n(17,o=v));var l;const{namespace:s,workflow:u,run:f}=o.params,p={id:u,runId:f};let y,V,P="",B="",i=!1,c=!0,E=qe({namespace:s,workflow:p},(l=o.data)===null||l===void 0?void 0:l.settings,t==null?void 0:t.accessToken).then(v=>{var D;return n(0,y=y||((D=v[0])===null||D===void 0?void 0:D.name)),L(y),v}),N,q;const G=()=>{n(2,i=!1),n(9,V=y),n(10,B=P)},L=async v=>{var D;n(2,i=!0);let R;try{n(5,q=P?Ee(P,"json/plain",!1):Promise.resolve(null)),R=await q}catch{G();return}n(4,N=Ie({namespace:s,workflow:p,queryType:v,queryArgs:R?{payloads:R}:null},(D=o.data)===null||D===void 0?void 0:D.settings,t==null?void 0:t.accessToken).finally(()=>{G()}))};function ae(v){y=v,n(0,y)}function se(v){P=v,n(1,P)}const ue=()=>L(y),fe=()=>n(3,c=!c);return a.$$.update=()=>{a.$$.dirty[0]&1539&&n(6,r=V!==y||P!==B)},[y,P,i,c,N,q,r,E,L,V,B,ae,se,ue,fe]}class Ue extends te{constructor(e){super(),re(this,e,Re,Le,ee,{},null,[-1,-1])}}function Ae(a){let e,n;return e=new Ue({}),{c(){h(e.$$.fragment)},l(r){w(e.$$.fragment,r)},m(r,t){k(e,r,t),n=!0},i(r){n||($(e.$$.fragment,r),n=!0)},o(r){g(e.$$.fragment,r),n=!1},d(r){b(e,r)}}}function Fe(a){let e,n,r,t;return e=new $e({props:{title:`${d("workflows.queries-tab")} | ${a[1]}`,url:a[0].url.href}}),r=new ge({props:{$$slots:{default:[Ae]},$$scope:{ctx:a}}}),{c(){h(e.$$.fragment),n=O(),h(r.$$.fragment)},l(o){w(e.$$.fragment,o),n=W(o),w(r.$$.fragment,o)},m(o,l){k(e,o,l),_(o,n,l),k(r,o,l),t=!0},p(o,[l]){const s={};l&1&&(s.url=o[0].url.href),e.$set(s);const u={};l&4&&(u.$$scope={dirty:l,ctx:o}),r.$set(u)},i(o){t||($(e.$$.fragment,o),$(r.$$.fragment,o),t=!0)},o(o){g(e.$$.fragment,o),g(r.$$.fragment,o),t=!1},d(o){o&&m(n),b(e,o),b(r,o)}}}function ze(a,e,n){let r;U(a,ne,o=>n(0,r=o));const t=r.params.workflow;return[r,t]}class mt extends te{constructor(e){super(),re(this,e,ze,Fe,ee,{})}}export{mt as component};
