import"../chunks/CWj6FrbW.js";import"../chunks/69_IOA4Y.js";import{p as ie,b as le,g as e,o as Te,aS as D,f as h,c as A,t as L,e as l,v as o,h as n,s as ke,k as R,ax as Me,j as f,r as p,n as C}from"../chunks/DZ1-1a5q.js";import{i as Pe}from"../chunks/Bby3K3wO.js";import{a as c,s as de,b as _,m as Qe}from"../chunks/TaaIktnz.js";import{p as Xe}from"../chunks/BrSpNkAu.js";import{P as Ye}from"../chunks/BvHFjIFb.js";import{t as w}from"../chunks/DEjs8ZrU.js";import{s as U}from"../chunks/DxwvfIkW.js";import{i as J}from"../chunks/DnKg3jxh.js";import{s as Ze}from"../chunks/B3h3Bc2r.js";import{b as et,g as he}from"../chunks/BU6dkjX5.js";import{p as I}from"../chunks/D_t7VQAt.js";import{E as tt}from"../chunks/1st0o9on.js";import{c as be,I as rt,D as ot,E as st,W as at,a as nt}from"../chunks/CDIaMONP.js";import{T as it,a as se}from"../chunks/BbI4CwVT.js";import{T as lt,a as ae}from"../chunks/B_9qPKbe.js";import{g as dt}from"../chunks/Bj7Nai57.js";import{n as ct,o as vt}from"../chunks/DqAvNQgh.js";import{W as ut}from"../chunks/D8-9VWHH.js";import{T as ft}from"../chunks/BZoQ2uf-.js";import{b as He,d as ye,a as pt,p as ne,c as q,e as Ee,m as mt,g as gt,f as $t}from"../chunks/DptMbTYu.js";import{w as _t}from"../chunks/D3HmRl1U.js";import{p as wt,u as xe}from"../chunks/BkXlVQuq.js";function kt(E,x){ie(x,!1);const b=()=>c(He,"$filteredEventHistory",u),T=()=>c(ye,"$decodeEventHistory",u),[u,d]=de();Pe(),ut(E,{get events(){return b()},decode:m=>{{let H=Te(()=>w("events.decode-event-history"));ft(m,{get label(){return e(H)},id:"decode-event-history","data-testid":"decode-event-history-toggle",get checked(){return Qe(),T()},set checked(j){_(ye,j)},$$legacy:!0})}},$$slots:{decode:!0}}),le(),d()}var ht=h("<!> <!> <!>",1),bt=h("<span></span> ",1),yt=h("<!> <!> <!> <!>",1),Et=h('<div class="border-t border-subtle px-4"><!></div>'),xt=h('<div data-testid="event-summary-table"><!></div>'),Tt=h('<!> <div class="flex flex-col gap-2"><!> <!></div> <div class="relative"><div class="surface-background sticky top-0 z-[11] flex flex-wrap-reverse items-center justify-between gap-2 border-b border-subtle md:top-12 md:pt-2 xl:gap-8"><div class="items-bottom flex gap-4 pt-2"><h2> </h2> <!></div> <div class="flex items-center gap-2 pb-2"><!></div></div> <div class="flex w-full flex-col"><!></div></div> <!>',1);function Pt(E,x){ie(x,!0);const b=()=>c(_t,"$workflowRun",g),T=()=>c(Ee,"$eventFilterSort",g),u=()=>c(ne,"$pauseLiveUpdates",g),d=()=>c(q,"$eventViewType",g),P=()=>c($t,"$fullEventHistory",g),m=()=>c(He,"$filteredEventHistory",g),H=()=>c(gt,"$currentEventHistory",g),j=()=>c(mt,"$minimizeEventView",g),[g,je]=de();var G,B;const ze=o(()=>I.params),Se=o(()=>e(ze).namespace),a=o(()=>b().workflow),K=o(()=>(G=e(a)===null||e(a)===void 0?void 0:e(a).pendingActivities)!==null&&G!==void 0?G:[]),M=o(()=>(B=e(a)===null||e(a)===void 0?void 0:e(a).pendingNexusOperations)!==null&&B!==void 0?B:[]);D(()=>{const t=wt(I.url);_(Ee,t.sort),_(ne,t.refresh_off)}),D(()=>{var t,s;const r=(s=(t=I.url)===null||t===void 0?void 0:t.searchParams)===null||s===void 0?void 0:s.get("category");_(pt,r?r.split(",").filter(ct):void 0)});let y=o(()=>T()==="descending"),Q=o(()=>d()==="compact"),We=o(()=>!P().length),ce=o(()=>dt(m(),"ascending",e(K),e(M)));const ve=o(()=>vt(H(),"ascending"));let ue=o(()=>e(y)?[...e(ce)].reverse():e(ce)),fe=o(()=>e(y)?[...m()].reverse():m()),Fe=o(()=>e(Q)?e(ue):e(y)?[...e(M),...e(K),...e(fe)]:[...e(fe),...e(K),...e(M)]);D(()=>{d(),be()}),et(()=>{be()}),D(()=>{!(!(e(a)===null||e(a)===void 0)&&e(a).isRunning)&&u()&&_(ne,!1)});let X=Me(!1);const Re=()=>{const t=e(y)?"ascending":"descending";xe(I.url,{sort:t},he)},Ce=()=>{xe(I.url,{refresh_off:!u()},he)},Ie=()=>{_(q,"feed")},Ae=()=>{_(q,"compact")},Ve=()=>{_(q,"json")};var pe=Tt(),me=A(pe);rt(me,{});var Y=n(me,2),ge=f(Y);{var Ne=t=>{{let s=o(()=>{var r;return(r=e(a))==null?void 0:r.pendingWorkflowTask});at(t,{get error(){return e(ve)},get pendingTask(){return e(s)}})}};J(ge,t=>{e(ve)&&t(Ne)})}var Oe=n(ge,2);{var De=t=>{nt(t,{get callbacks(){return e(a).callbacks}})};J(Oe,t=>{var s,r;(r=(s=e(a))==null?void 0:s.callbacks)!=null&&r.length&&t(De)})}p(Y);var Z=n(Y,2),ee=f(Z),te=f(ee),re=f(te),Le=f(re,!0);p(re);var Ue=n(re,2);it(Ue,{class:"relative",children:(t,s)=>{var r=ht(),z=A(r);{let $=o(()=>d()==="feed");se(z,{get active(){return e($)},"data-testid":"feed",icon:"feed",class:"h-10",$$events:{click:Ie},children:(k,v)=>{C();var i=R("All");l(k,i)},$$slots:{default:!0}})}var V=n(z,2);{let $=o(()=>d()==="compact");se(V,{get active(){return e($)},"data-testid":"compact",icon:"compact",class:"h-10",$$events:{click:Ae},children:(k,v)=>{C();var i=R("Compact");l(k,i)},$$slots:{default:!0}})}var N=n(V,2);{let $=o(()=>d()==="json");se(N,{get active(){return e($)},"data-testid":"json",icon:"json",class:"h-10",$$events:{click:Ve},children:(k,v)=>{C();var i=R("JSON");l(k,i)},$$slots:{default:!0}})}l(t,r)},$$slots:{default:!0}}),p(te);var $e=n(te,2),Je=f($e);lt(Je,{children:(t,s)=>{var r=yt(),z=A(r);{var V=v=>{{let i=o(()=>e(y)?"descending":"ascending");ae(v,{get leadingIcon(){return e(i)},"data-testid":"zoom-in",size:"sm",$$events:{click:Re},children:(S,W)=>{C();var F=R();L(oe=>U(F,oe),[()=>e(y)?w("common.descending"):w("common.ascending")]),l(S,F)},$$slots:{default:!0}})}};J(z,v=>{d()!=="json"&&v(V)})}var N=n(z,2);st(N,{get compact(){return e(Q)},get minimized(){return j()}});var $=n(N,2);{let v=o(()=>{var i;return!((i=e(a))!=null&&i.isRunning)});ae($,{get disabled(){return e(v)},"data-testid":"pause",class:"border-l-0",size:"sm",$$events:{click:Ce},children:(i,S)=>{var W=bt(),F=A(W),oe=n(F);L(O=>{var we;Ze(F,1,`h-1.5 w-1.5 rounded-full ${u()||!((we=e(a))!=null&&we.isRunning)?"bg-slate-300":"bg-green-600"}`),U(oe,` ${O??""}`)},[()=>{var O;return u()||!((O=e(a))!=null&&O.isRunning)?w("workflows.auto-refresh-off"):w("workflows.auto-refresh-on")}]),l(i,W)},$$slots:{default:!0}})}var k=n($,2);ae(k,{"data-testid":"download",leadingIcon:"download",size:"sm",$$events:{click:()=>ke(X,!0)},children:(v,i)=>{C();var S=R();L(W=>U(S,W),[()=>w("common.download")]),l(v,S)},$$slots:{default:!0}}),l(t,r)},$$slots:{default:!0}}),p($e),p(ee);var _e=n(ee,2),qe=f(_e);{var Ge=t=>{var s=Et(),r=f(s);kt(r,{}),p(s),l(t,s)},Be=t=>{var s=xt(),r=f(s);tt(r,{get updating(){return e(We)},get items(){return e(Fe)},get groups(){return e(ue)},get compact(){return e(Q)}}),p(s),l(t,s)};J(qe,t=>{d()==="json"?t(Ge):t(Be,!1)})}p(_e),p(Z);var Ke=n(Z,2);{let t=o(()=>{var r;return(r=e(a))==null?void 0:r.id}),s=o(()=>{var r;return(r=e(a))==null?void 0:r.runId});ot(Ke,{get namespace(){return e(Se)},get workflowId(){return e(t)},get runId(){return e(s)},get open(){return e(X)},set open(r){ke(X,r,!0)}})}L(t=>U(Le,t),[()=>w("workflows.history-tab")]),l(E,pe),le(),je()}var Ht=h("<!> <!>",1);function Zt(E,x){ie(x,!1);const b=()=>c(Xe,"$page",T),[T,u]=de(),d=b().params.workflow;Pe();var P=Ht(),m=A(P);{let j=Te(()=>`${w("workflows.workflow-history")} | ${d}`);Ye(m,{get title(){return e(j)},get url(){return b().url.href}})}var H=n(m,2);Pt(H,{}),l(E,P),le(),u()}export{Zt as component};
