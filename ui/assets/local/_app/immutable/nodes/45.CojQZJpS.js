import"../chunks/CWj6FrbW.js";import"../chunks/69_IOA4Y.js";import{p as ne,b as ie,g as e,o as Ee,aO as G,f as E,c as O,t as A,e as i,v as o,h as l,j as h,k as H,s as $e,at as qe,r as k,n as j}from"../chunks/UnFCzZBm.js";import{i as ze,t as Ge}from"../chunks/BBLBidKq.js";import{a as m,s as le,b as $,m as Me}from"../chunks/GmGfGY7t.js";import{p as Be}from"../chunks/BUvCWaxB.js";import{P as Ke}from"../chunks/Bu3uT3O7.js";import{t as d}from"../chunks/DEjs8ZrU.js";import{s as V}from"../chunks/CX2avYX0.js";import{i as ge}from"../chunks/pI5hk1MB.js";import{s as _e,c as Qe}from"../chunks/CDVS_aRO.js";import{b as Xe,g as we}from"../chunks/0yRjIPlZ.js";import{p as N}from"../chunks/QW_PJOzq.js";import{E as Ye}from"../chunks/olZUqtOn.js";import{c as he,I as Ze,D as et,E as tt}from"../chunks/COByzZPg.js";import{T as ot,a as se}from"../chunks/DWyol8Mt.js";import{T as rt,a as M}from"../chunks/DwHvmDl2.js";import{T as st}from"../chunks/BV10CEsJ.js";import{g as at}from"../chunks/B8DrZma3.js";import{n as nt}from"../chunks/3U6EwEZE.js";import{W as it}from"../chunks/DLn7n4Ga.js";import{T as lt}from"../chunks/E1oxHDTl.js";import{b as Pe,d as ke,a as dt,p as ae,c as B,e as ye,m as be,f as ct}from"../chunks/CI00K0Ip.js";import{w as vt}from"../chunks/BuXSPDAs.js";import{p as pt,u as xe}from"../chunks/CH7hQqhy.js";function mt(I,S){ne(S,!1);const z=()=>m(Pe,"$filteredEventHistory",u),C=()=>m(ke,"$decodeEventHistory",u),[u,c]=le();ze(),it(I,{get events(){return z()},decode:g=>{{let p=Ee(()=>d("events.decode-event-history"));lt(g,{get label(){return e(p)},id:"decode-event-history","data-testid":"decode-event-history-toggle",get checked(){return Me(),C()},set checked(v){$(ke,v)},$$legacy:!0})}},$$slots:{decode:!0}}),ie(),c()}var ut=E("<!> <!> <!>",1),ft=E("<span></span> ",1),$t=E("<!> <!> <!> <!> <!>",1),gt=E('<div class="border-t border-subtle px-4"><!></div>'),_t=E('<div data-testid="event-summary-table"><!></div>'),wt=E('<!> <div class="relative"><div><div class="items-bottom flex gap-4"><h2> </h2> <!></div> <div class="flex items-center gap-2 pb-2"><!></div></div> <div class="flex w-full flex-col"><!></div></div> <!>',1);function ht(I,S){ne(S,!0);const z=()=>m(vt,"$workflowRun",v),C=()=>m(ye,"$eventFilterSort",v),u=()=>m(ae,"$pauseLiveUpdates",v),c=()=>m(B,"$eventViewType",v),F=()=>m(ct,"$fullEventHistory",v),g=()=>m(Pe,"$filteredEventHistory",v),p=()=>m(be,"$minimizeEventView",v),[v,Te]=le();var K,Q;const He=o(()=>N.params),je=o(()=>e(He).namespace),n=o(()=>z().workflow),X=o(()=>(K=e(n)===null||e(n)===void 0?void 0:e(n).pendingActivities)!==null&&K!==void 0?K:[]),Y=o(()=>(Q=e(n)===null||e(n)===void 0?void 0:e(n).pendingNexusOperations)!==null&&Q!==void 0?Q:[]);G(()=>{const t=pt(N.url);$(ye,t.sort),$(ae,t.frozen)}),G(()=>{var t,s;const r=(s=(t=N.url)===null||t===void 0?void 0:t.searchParams)===null||s===void 0?void 0:s.get("category");$(dt,r?r.split(",").filter(nt):void 0)});let P=o(()=>C()==="descending"),Z=o(()=>c()==="compact"),Ie=o(()=>!F().length),de=o(()=>at(g(),"ascending",e(X),e(Y))),ce=o(()=>e(P)?[...e(de)].reverse():e(de)),ve=o(()=>e(P)?[...g()].reverse():g()),Se=o(()=>e(Z)?e(ce):e(P)?[...e(Y),...e(X),...e(ve)]:[...e(ve),...e(X),...e(Y)]);G(()=>{c(),he()}),Xe(()=>{he()}),G(()=>{!(!(e(n)===null||e(n)===void 0)&&e(n).isRunning)&&u()&&$(ae,!1)});let ee=qe(!1);const Ce=()=>{const t=e(P)?"ascending":"descending";xe(N.url,{sort:t},we)},Fe=()=>{xe(N.url,{frozen:!u()},we)},Re=()=>{$(B,"feed")},Ae=()=>{$(B,"compact")},Ve=()=>{$(B,"json")};var pe=wt(),me=O(pe);Ze(me,{});var te=l(me,2),W=h(te),oe=h(W),re=h(oe),Ne=h(re,!0);k(re);var Oe=l(re,2);ot(Oe,{class:"relative top-[2px]",children:(t,s)=>{var r=ut(),R=O(r);{let _=o(()=>c()==="feed");se(R,{get active(){return e(_)},"data-testid":"feed",icon:"feed",class:"h-10",$$events:{click:Re},children:(w,U)=>{j();var a=H("All");i(w,a)},$$slots:{default:!0}})}var D=l(R,2);{let _=o(()=>c()==="compact");se(D,{get active(){return e(_)},"data-testid":"compact",icon:"compact",class:"h-10",$$events:{click:Ae},children:(w,U)=>{j();var a=H("Compact");i(w,a)},$$slots:{default:!0}})}var L=l(D,2);{let _=o(()=>c()==="json");se(L,{get active(){return e(_)},"data-testid":"json",icon:"json",class:"h-10",$$events:{click:Ve},children:(w,U)=>{j();var a=H("JSON");i(w,a)},$$slots:{default:!0}})}i(t,r)},$$slots:{default:!0}}),k(oe);var ue=l(oe,2),We=h(ue);rt(We,{children:(t,s)=>{var r=$t(),R=O(r);{var D=a=>{{let f=o(()=>e(P)?"descending":"ascending");M(a,{get leadingIcon(){return e(f)},"data-testid":"zoom-in",size:"sm",$$events:{click:Ce},children:(T,y)=>{j();var b=H();A(J=>V(b,J),[()=>e(P)?d("common.descending"):d("common.ascending")]),i(T,b)},$$slots:{default:!0}})}};ge(R,a=>{c()!=="json"&&a(D)})}var L=l(R,2);{let a=o(()=>p()?d("workflows.timeline-minimized"):d("workflows.timeline-expanded"));st(L,{get text(){return e(a)},top:!0,children:(f,T)=>{{let y=o(()=>p()?"minimize":"expand");M(f,{get leadingIcon(){return e(y)},"data-testid":"expandAll",size:"sm",$$events:{click:()=>$(be,!p())},children:(b,J)=>{j();var x=H();A(q=>V(x,q),[()=>p()?d("workflows.minimized"):d("workflows.expanded")]),i(b,x)},$$slots:{default:!0}})}},$$slots:{default:!0}})}var _=l(L,2);tt(_,{get compact(){return e(Z)},get minimized(){return p()}});var w=l(_,2);{let a=o(()=>{var f;return!((f=e(n))!=null&&f.isRunning)});M(w,{get disabled(){return e(a)},"data-testid":"pause",class:"border-l-0",size:"sm",$$events:{click:Fe},children:(f,T)=>{var y=ft(),b=O(y),J=l(b);A(x=>{var q;_e(b,1,`h-1.5 w-1.5 rounded-full ${u()||!((q=e(n))!=null&&q.isRunning)?"bg-slate-300":"bg-green-600"}`),V(J,` ${x??""}`)},[()=>{var x;return u()||!((x=e(n))!=null&&x.isRunning)?d("workflows.auto-refresh-off"):d("workflows.auto-refresh-on")}]),i(f,y)},$$slots:{default:!0}})}var U=l(w,2);M(U,{"data-testid":"download",leadingIcon:"download",size:"sm",$$events:{click:()=>$e(ee,!0)},children:(a,f)=>{j();var T=H();A(y=>V(T,y),[()=>d("common.download")]),i(a,T)},$$slots:{default:!0}}),i(t,r)},$$slots:{default:!0}}),k(ue),k(W);var fe=l(W,2),De=h(fe);{var Le=t=>{var s=gt(),r=h(s);mt(r,{}),k(s),i(t,s)},Ue=t=>{var s=_t(),r=h(s);Ye(r,{get updating(){return e(Ie)},get items(){return e(Se)},get groups(){return e(ce)},get compact(){return e(Z)},minimized:!0}),k(s),i(t,s)};ge(De,t=>{c()==="json"?t(Le):t(Ue,!1)})}k(fe),k(te);var Je=l(te,2);{let t=o(()=>{var r;return(r=e(n))==null?void 0:r.id}),s=o(()=>{var r;return(r=e(n))==null?void 0:r.runId});et(Je,{get namespace(){return e(je)},get workflowId(){return e(t)},get runId(){return e(s)},get open(){return e(ee)},set open(r){$e(ee,r,!0)}})}A((t,s)=>{_e(W,1,t),V(Ne,s)},[()=>Qe(Ge("surface-background flex flex-wrap items-center justify-between gap-2 border-b border-subtle py-2 xl:gap-8",!p()&&"sticky top-0 z-30 md:top-12")),()=>d("workflows.history-tab")]),i(I,pe),ie(),Te()}var kt=E("<!> <!>",1);function Mt(I,S){ne(S,!1);const z=()=>m(Be,"$page",C),[C,u]=le(),c=z().params.workflow;ze();var F=kt(),g=O(F);{let v=Ee(()=>`${d("workflows.workflow-history")} | ${c}`);Ke(g,{get title(){return e(v)},get url(){return z().url.href}})}var p=l(g,2);ht(p,{}),i(I,F),ie(),u()}export{Mt as component};
