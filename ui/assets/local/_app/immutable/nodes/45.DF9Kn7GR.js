import"../chunks/CWj6FrbW.js";import"../chunks/69_IOA4Y.js";import{p as se,b as ae,g as e,o as ke,aO as D,f as b,c as V,t as L,e as i,v as r,h as l,j as $,s as fe,k as F,at as Ue,r as g,n as I}from"../chunks/UnFCzZBm.js";import{i as xe,t as Je}from"../chunks/BBLBidKq.js";import{a as p,s as ne,b as _,m as qe}from"../chunks/GmGfGY7t.js";import{p as Ge}from"../chunks/aJg2w3Uz.js";import{P as Me}from"../chunks/Bu3uT3O7.js";import{t as w}from"../chunks/DEjs8ZrU.js";import{s as U}from"../chunks/CX2avYX0.js";import{i as $e}from"../chunks/pI5hk1MB.js";import{s as ge,c as Be}from"../chunks/CDVS_aRO.js";import{b as Ke,g as _e}from"../chunks/CkTjtdG2.js";import{p as R}from"../chunks/CfIc1Vtw.js";import{E as Qe}from"../chunks/DiwP5CwE.js";import{c as we,I as Xe,D as Ye,E as Ze}from"../chunks/CBgSOzaG.js";import{T as et,a as te}from"../chunks/D_D1fnmZ.js";import{T as tt,a as oe}from"../chunks/vs5LFmHh.js";import{g as ot}from"../chunks/DCC7K_zt.js";import{n as rt}from"../chunks/vaFzaDe7.js";import{W as st}from"../chunks/BLbc2IOe.js";import{T as at}from"../chunks/E1oxHDTl.js";import{b as Ee,d as he,a as nt,p as re,c as J,e as be,m as it,f as lt}from"../chunks/BhFZKDwp.js";import{w as dt}from"../chunks/BuXSPDAs.js";import{p as ct,u as ye}from"../chunks/CfWaTjWi.js";function vt(E,P){se(P,!1);const y=()=>p(Ee,"$filteredEventHistory",u),z=()=>p(he,"$decodeEventHistory",u),[u,d]=ne();xe(),st(E,{get events(){return y()},decode:m=>{{let k=ke(()=>w("events.decode-event-history"));at(m,{get label(){return e(k)},id:"decode-event-history","data-testid":"decode-event-history-toggle",get checked(){return qe(),z()},set checked(c){_(he,c)},$$legacy:!0})}},$$slots:{decode:!0}}),ae(),d()}var pt=b("<!> <!> <!>",1),ut=b("<span></span> ",1),mt=b("<!> <!> <!> <!>",1),ft=b('<div class="border-t border-subtle px-4"><!></div>'),$t=b('<div data-testid="event-summary-table"><!></div>'),gt=b('<!> <div class="relative"><div><div class="items-bottom flex gap-4"><h2> </h2> <!></div> <div class="flex items-center gap-2 pb-2"><!></div></div> <div class="flex w-full flex-col"><!></div></div> <!>',1);function _t(E,P){se(P,!0);const y=()=>p(dt,"$workflowRun",c),z=()=>p(be,"$eventFilterSort",c),u=()=>p(re,"$pauseLiveUpdates",c),d=()=>p(J,"$eventViewType",c),T=()=>p(lt,"$fullEventHistory",c),m=()=>p(Ee,"$filteredEventHistory",c),k=()=>p(it,"$minimizeEventView",c),[c,Pe]=ne();var q,G;const ze=r(()=>R.params),Te=r(()=>e(ze).namespace),a=r(()=>y().workflow),M=r(()=>(q=e(a)===null||e(a)===void 0?void 0:e(a).pendingActivities)!==null&&q!==void 0?q:[]),B=r(()=>(G=e(a)===null||e(a)===void 0?void 0:e(a).pendingNexusOperations)!==null&&G!==void 0?G:[]);D(()=>{const t=ct(R.url);_(be,t.sort),_(re,t.frozen)}),D(()=>{var t,s;const o=(s=(t=R.url)===null||t===void 0?void 0:t.searchParams)===null||s===void 0?void 0:s.get("category");_(nt,o?o.split(",").filter(rt):void 0)});let x=r(()=>z()==="descending"),K=r(()=>d()==="compact"),He=r(()=>!T().length),ie=r(()=>ot(m(),"ascending",e(M),e(B))),le=r(()=>e(x)?[...e(ie)].reverse():e(ie)),de=r(()=>e(x)?[...m()].reverse():m()),je=r(()=>e(K)?e(le):e(x)?[...e(B),...e(M),...e(de)]:[...e(de),...e(M),...e(B)]);D(()=>{d(),we()}),Ke(()=>{we()}),D(()=>{!(!(e(a)===null||e(a)===void 0)&&e(a).isRunning)&&u()&&_(re,!1)});let Q=Ue(!1);const Se=()=>{const t=e(x)?"ascending":"descending";ye(R.url,{sort:t},_e)},Ce=()=>{ye(R.url,{frozen:!u()},_e)},Fe=()=>{_(J,"feed")},Ie=()=>{_(J,"compact")},Re=()=>{_(J,"json")};var ce=gt(),ve=V(ce);Xe(ve,{});var X=l(ve,2),A=$(X),Y=$(A),Z=$(Y),Ve=$(Z,!0);g(Z);var Ae=l(Z,2);et(Ae,{class:"relative top-[2px]",children:(t,s)=>{var o=pt(),H=V(o);{let f=r(()=>d()==="feed");te(H,{get active(){return e(f)},"data-testid":"feed",icon:"feed",class:"h-10",$$events:{click:Fe},children:(h,v)=>{I();var n=F("All");i(h,n)},$$slots:{default:!0}})}var N=l(H,2);{let f=r(()=>d()==="compact");te(N,{get active(){return e(f)},"data-testid":"compact",icon:"compact",class:"h-10",$$events:{click:Ie},children:(h,v)=>{I();var n=F("Compact");i(h,n)},$$slots:{default:!0}})}var O=l(N,2);{let f=r(()=>d()==="json");te(O,{get active(){return e(f)},"data-testid":"json",icon:"json",class:"h-10",$$events:{click:Re},children:(h,v)=>{I();var n=F("JSON");i(h,n)},$$slots:{default:!0}})}i(t,o)},$$slots:{default:!0}}),g(Y);var pe=l(Y,2),Ne=$(pe);tt(Ne,{children:(t,s)=>{var o=mt(),H=V(o);{var N=v=>{{let n=r(()=>e(x)?"descending":"ascending");oe(v,{get leadingIcon(){return e(n)},"data-testid":"zoom-in",size:"sm",$$events:{click:Se},children:(j,S)=>{I();var C=F();L(ee=>U(C,ee),[()=>e(x)?w("common.descending"):w("common.ascending")]),i(j,C)},$$slots:{default:!0}})}};$e(H,v=>{d()!=="json"&&v(N)})}var O=l(H,2);Ze(O,{get compact(){return e(K)},get minimized(){return k()}});var f=l(O,2);{let v=r(()=>{var n;return!((n=e(a))!=null&&n.isRunning)});oe(f,{get disabled(){return e(v)},"data-testid":"pause",class:"border-l-0",size:"sm",$$events:{click:Ce},children:(n,j)=>{var S=ut(),C=V(S),ee=l(C);L(W=>{var me;ge(C,1,`h-1.5 w-1.5 rounded-full ${u()||!((me=e(a))!=null&&me.isRunning)?"bg-slate-300":"bg-green-600"}`),U(ee,` ${W??""}`)},[()=>{var W;return u()||!((W=e(a))!=null&&W.isRunning)?w("workflows.auto-refresh-off"):w("workflows.auto-refresh-on")}]),i(n,S)},$$slots:{default:!0}})}var h=l(f,2);oe(h,{"data-testid":"download",leadingIcon:"download",size:"sm",$$events:{click:()=>fe(Q,!0)},children:(v,n)=>{I();var j=F();L(S=>U(j,S),[()=>w("common.download")]),i(v,j)},$$slots:{default:!0}}),i(t,o)},$$slots:{default:!0}}),g(pe),g(A);var ue=l(A,2),Oe=$(ue);{var We=t=>{var s=ft(),o=$(s);vt(o,{}),g(s),i(t,s)},De=t=>{var s=$t(),o=$(s);Qe(o,{get updating(){return e(He)},get items(){return e(je)},get groups(){return e(le)},get compact(){return e(K)},minimized:!0}),g(s),i(t,s)};$e(Oe,t=>{d()==="json"?t(We):t(De,!1)})}g(ue),g(X);var Le=l(X,2);{let t=r(()=>{var o;return(o=e(a))==null?void 0:o.id}),s=r(()=>{var o;return(o=e(a))==null?void 0:o.runId});Ye(Le,{get namespace(){return e(Te)},get workflowId(){return e(t)},get runId(){return e(s)},get open(){return e(Q)},set open(o){fe(Q,o,!0)}})}L((t,s)=>{ge(A,1,t),U(Ve,s)},[()=>Be(Je("surface-background flex flex-wrap items-center justify-between gap-2 border-b border-subtle xl:gap-8",!k()&&"sticky top-0 z-30 md:top-12")),()=>w("workflows.history-tab")]),i(E,ce),ae(),Pe()}var wt=b("<!> <!>",1);function Jt(E,P){se(P,!1);const y=()=>p(Ge,"$page",z),[z,u]=ne(),d=y().params.workflow;xe();var T=wt(),m=V(T);{let c=ke(()=>`${w("workflows.workflow-history")} | ${d}`);Me(m,{get title(){return e(c)},get url(){return y().url.href}})}var k=l(m,2);_t(k,{}),i(E,T),ae(),u()}export{Jt as component};
