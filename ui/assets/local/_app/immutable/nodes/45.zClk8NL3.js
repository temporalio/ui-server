import"../chunks/CWj6FrbW.js";import"../chunks/69_IOA4Y.js";import{p as ie,b as le,g as e,o as xe,aS as D,f as b,c as A,t as L,e as i,v as o,h as n,s as we,k as F,ax as Ke,j as p,r as u,n as C}from"../chunks/DZ1-1a5q.js";import{i as Pe}from"../chunks/Bby3K3wO.js";import{a as d,s as de,b as _,m as Me}from"../chunks/TaaIktnz.js";import{p as Qe}from"../chunks/Bm0Gpem_.js";import{P as Xe}from"../chunks/BvHFjIFb.js";import{t as w}from"../chunks/DEjs8ZrU.js";import{s as U}from"../chunks/DxwvfIkW.js";import{i as J}from"../chunks/DnKg3jxh.js";import{s as Ye}from"../chunks/B3h3Bc2r.js";import{b as Ze,g as ke}from"../chunks/sYf44qfu.js";import{p as I}from"../chunks/CxQ66pXP.js";import{E as et}from"../chunks/C9MCQ4Zp.js";import{c as he,I as tt,D as rt,E as ot,W as st,a as at}from"../chunks/BNKHdFhV.js";import{T as nt,a as se}from"../chunks/gqqTBIKH.js";import{T as it,a as ae}from"../chunks/CQbmFksZ.js";import{g as lt}from"../chunks/BiZw4PW5.js";import{n as dt,o as ct}from"../chunks/De7-tgDK.js";import{W as vt}from"../chunks/ZrTmTNmk.js";import{T as ft}from"../chunks/BZoQ2uf-.js";import{b as Te,d as be,a as pt,p as ne,c as q,e as ye,m as ut,g as mt,f as gt}from"../chunks/CfU7pSof.js";import{w as $t}from"../chunks/D3HmRl1U.js";import{p as _t,u as Ee}from"../chunks/ButyAEiD.js";function wt(x,P){ie(P,!1);const y=()=>d(Te,"$filteredEventHistory",v),T=()=>d(be,"$decodeEventHistory",v),[v,l]=de();Pe(),vt(x,{get events(){return y()},decode:m=>{{let j=xe(()=>w("events.decode-event-history"));ft(m,{get label(){return e(j)},id:"decode-event-history","data-testid":"decode-event-history-toggle",get checked(){return Me(),T()},set checked(z){_(be,z)},$$legacy:!0})}},$$slots:{decode:!0}}),le(),l()}var kt=b("<!> <!> <!>",1),ht=b("<span></span> ",1),bt=b("<!> <!> <!> <!>",1),yt=b('<div class="border-t border-subtle px-4"><!></div>'),Et=b('<div data-testid="event-summary-table"><!></div>'),xt=b('<!> <div class="flex flex-col gap-2"><!> <!></div> <div class="relative"><div class="surface-background sticky top-0 z-[11] flex flex-wrap-reverse items-center justify-between gap-2 border-b border-subtle md:top-12 md:pt-2 xl:gap-8"><div class="items-bottom flex gap-4 pt-2"><h2> </h2> <!></div> <div class="flex items-center gap-2 pb-2"><!></div></div> <div class="flex w-full flex-col"><!></div></div> <!>',1);function Pt(x,P){ie(P,!0);const y=()=>d($t,"$workflowRun",g),T=()=>d(ye,"$eventFilterSort",g),v=()=>d(ne,"$pauseLiveUpdates",g),l=()=>d(q,"$eventViewType",g),H=()=>d(gt,"$fullEventHistory",g),m=()=>d(Te,"$filteredEventHistory",g),j=()=>d(mt,"$currentEventHistory",g),z=()=>d(ut,"$minimizeEventView",g),[g,He]=de();var G,B;const je=o(()=>I.params),ze=o(()=>e(je).namespace),a=o(()=>y().workflow),K=o(()=>(G=e(a)===null||e(a)===void 0?void 0:e(a).pendingActivities)!==null&&G!==void 0?G:[]),M=o(()=>(B=e(a)===null||e(a)===void 0?void 0:e(a).pendingNexusOperations)!==null&&B!==void 0?B:[]);D(()=>{const t=_t(I.url);_(ye,t.sort),_(ne,t.refresh_off)}),D(()=>{var t,s;const r=(s=(t=I.url)===null||t===void 0?void 0:t.searchParams)===null||s===void 0?void 0:s.get("category");_(pt,r?r.split(",").filter(dt):void 0)});let E=o(()=>T()==="descending"),Q=o(()=>l()==="compact"),Se=o(()=>!H().length),ce=o(()=>lt(m(),"ascending",e(K),e(M)));const ve=o(()=>ct(j(),"ascending")),N=o(()=>e(a)&&!e(a).isRunning&&!e(a).isPaused);let fe=o(()=>e(E)?[...e(ce)].reverse():e(ce)),pe=o(()=>e(E)?[...m()].reverse():m()),We=o(()=>e(Q)?e(fe):e(E)?[...e(M),...e(K),...e(pe)]:[...e(pe),...e(K),...e(M)]);D(()=>{l(),he()}),Ze(()=>{he()}),D(()=>{e(N)&&v()&&_(ne,!1)});let X=Ke(!1);const Fe=()=>{const t=e(E)?"ascending":"descending";Ee(I.url,{sort:t},ke)},Ce=()=>{Ee(I.url,{refresh_off:!v()},ke)},Ie=()=>{_(q,"feed")},Ae=()=>{_(q,"compact")},Ne=()=>{_(q,"json")};var ue=xt(),me=A(ue);tt(me,{});var Y=n(me,2),ge=p(Y);{var Ve=t=>{{let s=o(()=>{var r;return(r=e(a))==null?void 0:r.pendingWorkflowTask});st(t,{get error(){return e(ve)},get pendingTask(){return e(s)}})}};J(ge,t=>{e(ve)&&t(Ve)})}var Re=n(ge,2);{var Oe=t=>{at(t,{get callbacks(){return e(a).callbacks}})};J(Re,t=>{var s,r;(r=(s=e(a))==null?void 0:s.callbacks)!=null&&r.length&&t(Oe)})}u(Y);var Z=n(Y,2),ee=p(Z),te=p(ee),re=p(te),De=p(re,!0);u(re);var Le=n(re,2);nt(Le,{class:"relative",children:(t,s)=>{var r=kt(),S=A(r);{let $=o(()=>l()==="feed");se(S,{get active(){return e($)},"data-testid":"feed",icon:"feed",class:"h-10",$$events:{click:Ie},children:(k,c)=>{C();var f=F("All");i(k,f)},$$slots:{default:!0}})}var V=n(S,2);{let $=o(()=>l()==="compact");se(V,{get active(){return e($)},"data-testid":"compact",icon:"compact",class:"h-10",$$events:{click:Ae},children:(k,c)=>{C();var f=F("Compact");i(k,f)},$$slots:{default:!0}})}var R=n(V,2);{let $=o(()=>l()==="json");se(R,{get active(){return e($)},"data-testid":"json",icon:"json",class:"h-10",$$events:{click:Ne},children:(k,c)=>{C();var f=F("JSON");i(k,f)},$$slots:{default:!0}})}i(t,r)},$$slots:{default:!0}}),u(te);var $e=n(te,2),Ue=p($e);it(Ue,{children:(t,s)=>{var r=bt(),S=A(r);{var V=c=>{{let f=o(()=>e(E)?"descending":"ascending");ae(c,{get leadingIcon(){return e(f)},"data-testid":"zoom-in",size:"sm",$$events:{click:Fe},children:(h,W)=>{C();var O=F();L(oe=>U(O,oe),[()=>e(E)?w("common.descending"):w("common.ascending")]),i(h,O)},$$slots:{default:!0}})}};J(S,c=>{l()!=="json"&&c(V)})}var R=n(S,2);ot(R,{get compact(){return e(Q)},get minimized(){return z()}});var $=n(R,2);ae($,{get disabled(){return e(N)},"data-testid":"pause",class:"border-l-0",size:"sm",$$events:{click:Ce},children:(c,f)=>{var h=ht(),W=A(h),O=n(W);L(oe=>{Ye(W,1,`h-1.5 w-1.5 rounded-full ${v()||e(N)?"bg-slate-300":"bg-green-600"}`),U(O,` ${oe??""}`)},[()=>v()||e(N)?w("workflows.auto-refresh-off"):w("workflows.auto-refresh-on")]),i(c,h)},$$slots:{default:!0}});var k=n($,2);ae(k,{"data-testid":"download",leadingIcon:"download",size:"sm",$$events:{click:()=>we(X,!0)},children:(c,f)=>{C();var h=F();L(W=>U(h,W),[()=>w("common.download")]),i(c,h)},$$slots:{default:!0}}),i(t,r)},$$slots:{default:!0}}),u($e),u(ee);var _e=n(ee,2),Je=p(_e);{var qe=t=>{var s=yt(),r=p(s);wt(r,{}),u(s),i(t,s)},Ge=t=>{var s=Et(),r=p(s);et(r,{get updating(){return e(Se)},get items(){return e(We)},get groups(){return e(fe)},get compact(){return e(Q)}}),u(s),i(t,s)};J(Je,t=>{l()==="json"?t(qe):t(Ge,!1)})}u(_e),u(Z);var Be=n(Z,2);{let t=o(()=>{var r;return(r=e(a))==null?void 0:r.id}),s=o(()=>{var r;return(r=e(a))==null?void 0:r.runId});rt(Be,{get namespace(){return e(ze)},get workflowId(){return e(t)},get runId(){return e(s)},get open(){return e(X)},set open(r){we(X,r,!0)}})}L(t=>U(De,t),[()=>w("workflows.history-tab")]),i(x,ue),le(),He()}var Tt=b("<!> <!>",1);function Yt(x,P){ie(P,!1);const y=()=>d(Qe,"$page",T),[T,v]=de(),l=y().params.workflow;Pe();var H=Tt(),m=A(H);{let z=xe(()=>`${w("workflows.workflow-history")} | ${l}`);Xe(m,{get title(){return e(z)},get url(){return y().url.href}})}var j=n(m,2);Pt(j,{}),i(x,H),le(),v()}export{Yt as component};
