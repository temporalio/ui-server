import"../chunks/CWj6FrbW.js";import"../chunks/69_IOA4Y.js";import{p as j,f as G,e as m,b as M,k as R,g as t,v as s,j as q,h as g,s as z,n as B,r as E,c as et,o as ot}from"../chunks/UnFCzZBm.js";import{i as st}from"../chunks/BBLBidKq.js";import{s as W,a as $,b as O}from"../chunks/GmGfGY7t.js";import{p as rt}from"../chunks/DT8WZi1w.js";import{P as nt}from"../chunks/Bu3uT3O7.js";import{t as it}from"../chunks/DEjs8ZrU.js";import{o as at}from"../chunks/CDMQnRTF.js";import{e as lt,i as dt}from"../chunks/DMsHiW-d.js";import{p as pt}from"../chunks/DKbQLkcO.js";import{E as vt}from"../chunks/DjffHoAt.js";import{B as T}from"../chunks/hhvRCP5Q.js";import{g as ct}from"../chunks/AJoj88qV.js";import{g as ft}from"../chunks/BNk0_Nu5.js";import{f as ut}from"../chunks/04DozndO.js";import{f as S,e as mt}from"../chunks/DYE6MmLA.js";import{w as gt}from"../chunks/BuXSPDAs.js";var $t=G('<div class="flex flex-col gap-2 px-8 pb-24 pt-2" data-testid="event-summary-log"><!> <table><thead></thead><tbody class="svelte-b1glyn"></tbody></table> <!></div>');function wt(w,h){j(h,!0);const i=()=>$(S,"$fullEventHistory",v),_=()=>$(gt,"$workflowRun",v),x=()=>$(mt,"$eventFilterSort",v),[v,I]=W();var p;const l=s(()=>pt.params),c=s(()=>t(l).id),k=s(()=>t(l).namespace),C=s(()=>t(l).workflow),D=s(()=>t(l).run);let a=s(()=>[t(c)]);const J=()=>{O(S,[])},K=async(r,e,n)=>{i().length||(J(),O(S,await ut({namespace:r,workflowId:e,runId:n})))};at(()=>{K(t(k),t(C),t(D))});const d=s(()=>_().workflow),L=s(()=>t(d)===null||t(d)===void 0?void 0:t(d).pendingActivities),Q=s(()=>t(d)===null||t(d)===void 0?void 0:t(d).pendingNexusOperations),P=s(()=>ct(i(),"ascending",t(L),t(Q))),U=s(()=>x()==="ascending"?t(P):[...t(P)].reverse()),f=s(()=>i().find(r=>{var e,n,o;return r.id===t(c)||r.id===String((o=(n=(e=t(d).workflowExtendedInfo)===null||e===void 0?void 0:e.requestIdInfos)===null||n===void 0?void 0:n[t(c)])===null||o===void 0?void 0:o.eventId)})),F=s(()=>i().filter(r=>t(a).includes(r.id)||r.id===(t(f)===null||t(f)===void 0?void 0:t(f).id))),H=s(()=>!t(F).length),V=s(()=>(p=i()[i().length-1])===null||p===void 0?void 0:p.id),X=()=>{const r=parseInt(t(a)[0]),e=[],n=r-10;for(let o=0;o<10;o++)n+o>0&&e.push((n+o).toString());z(a,[...e,...t(a)])},Y=()=>{const r=parseInt(t(a)[t(a).length-1]),e=[],n=r+1;for(let o=0;o<10;o++)n+o<=i().length&&e.push((n+o).toString());z(a,[...t(a),...e])};var b=$t(),N=q(b);{let r=s(()=>t(a)[0]==="1"||t(H));T(N,{variant:"secondary",size:"xs",leadingIcon:"arrow-up",get disabled(){return t(r)},"data-testid":"load-previous",$$events:{click:X},children:(e,n)=>{B();var o=R("Show Previous 10");m(e,o)},$$slots:{default:!0}})}var y=g(N,2),A=g(q(y));lt(A,21,()=>t(F),dt,(r,e,n)=>{{let o=s(()=>{var u;return t(e).id===((u=t(f))==null?void 0:u.id)}),tt=s(()=>t(U).find(u=>ft(t(e))&&u.eventIds.has(t(e).id)));vt(r,{get event(){return t(e)},index:n,get expanded(){return t(o)},get group(){return t(tt)},get initialItem(){return i()[0]}})}}),E(A),E(y);var Z=g(y,2);{let r=s(()=>t(a)[t(a).length-1]===t(V)||t(H));T(Z,{variant:"secondary",size:"xs",leadingIcon:"arrow-down",get disabled(){return t(r)},"data-testid":"load-next",$$events:{click:Y},children:(e,n)=>{B();var o=R("Show Next 10");m(e,o)},$$slots:{default:!0}})}E(b),m(w,b),M(),I()}var ht=G("<!> <!>",1);function Tt(w,h){j(h,!1);const i=()=>$(rt,"$page",_),[_,x]=W(),v=i().params.workflow,I=i().params.id;st();var p=ht(),l=et(p);{let k=ot(()=>`${it("workflows.workflow-history")} | ${v} | Event ${I}`);nt(l,{get title(){return t(k)},get url(){return i().url.href}})}var c=g(l,2);wt(c,{}),m(w,p),M(),x()}export{Tt as component};
