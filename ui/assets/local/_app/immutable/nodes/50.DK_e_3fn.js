import"../chunks/CWj6FrbW.js";import"../chunks/69_IOA4Y.js";import{p as K,f as _,t as q,e as p,b as O,aM as aa,h as l,j as t,g as a,al as X,u as w,s as L,G as Y,r as e,c as Z,q as ea,o as ta}from"../chunks/CckrFwdx.js";import{i as ra}from"../chunks/ebNgFJjp.js";import{p as V}from"../chunks/8kE4LfTI.js";import{P as sa}from"../chunks/CuqmI6m2.js";import{t as D}from"../chunks/DEjs8ZrU.js";import{o as oa}from"../chunks/DsVF0eUi.js";import{e as ia,s as I}from"../chunks/_IQD3yTx.js";import{i as A}from"../chunks/CoMawi-e.js";import{k as la}from"../chunks/DLKvYI2j.js";import{s as S,a as N,e as da}from"../chunks/BioCYJcK.js";import{T as na}from"../chunks/Buiq-mNa.js";import{B as va}from"../chunks/DhT67ZcD.js";import{I as fa}from"../chunks/POwFeHBs.js";import{P as Q}from"../chunks/D2Ez6PGG.js";import{a as ma}from"../chunks/Btw6l70F.js";import{a as ua}from"../chunks/Bp7uNEFS.js";import{w as F}from"../chunks/DiTAogHV.js";import{e as ca,i as pa}from"../chunks/BTEtt5uP.js";import{M as wa}from"../chunks/fXyrq3y1.js";import{W as _a}from"../chunks/DMYAVgzQ.js";import{g as xa}from"../chunks/zMMgtnG8.js";import{f as ha}from"../chunks/D58M1Wqc.js";var ga=_('<div class="flex flex-1 flex-col border-l border-subtle"><div class="surface-information w-full px-6 py-2"><div class="flex items-center justify-between"><h3> </h3> <div class="flex flex-row items-center gap-2 lg:flex-col xl:flex-row"><p class="hidden sm:block">Press the <span class="mx-1 rounded bg-subtle px-1 text-sm font-medium leading-4">R</span> for freshness</p> <div class="flex items-center sm:hidden"><p>Press for freshness</p> <!></div> <!></div></div></div> <!></div>');function ya(x,f){K(f,!0);const r=()=>N(F,"$workflowRun",h),v=()=>N(ua,"$authUser",h),[h,g]=S();var d;const P=w(()=>V.params),T=w(()=>a(P).namespace),c=w(()=>r().workflow),b=w(()=>((d=r()===null||r()===void 0?void 0:r().metadata)===null||d===void 0?void 0:d.currentDetails)||"");let m=X(!1),n=X(null);const i=async()=>{var o;if(!(!a(c)||a(m))){L(m,!0);try{const{settings:s}=V.data,u=await ma({namespace:a(T),workflow:{id:a(c).id,runId:a(c).runId}},s,(o=v()===null||v()===void 0?void 0:v().accessToken)!==null&&o!==void 0?o:"");da(F,Y(r).metadata=u,Y(r)),L(n,new Date,!0)}catch(s){console.error("Error fetching current details:",s)}finally{L(m,!1)}}};oa(()=>{i()});const E=o=>{(o.key==="r"||o.key==="R")&&(o.preventDefault(),i())};var y=ga();ia("keydown",aa,E);var $=t(y),M=t($),k=t(M),j=t(k,!0);e(k);var H=l(k,2),W=l(t(H),2),B=l(t(W),2);va(B,{variant:"ghost",get disabled(){return a(m)},$$events:{click:i},children:(o,s)=>{fa(o,{name:"retry"})},$$slots:{default:!0}}),e(W);var C=l(W,2);{var R=o=>{na(o,{as:"p",class:"text-xs text-secondary",get dateTime(){return a(n)}})};A(C,o=>{a(n)&&o(R)})}e(H),e(M),e($);var U=l($,2);la(U,()=>a(b),o=>{Q(o,{class:"p-3",overrideTheme:"primary",get content(){return a(b)}})}),e(y),q(o=>I(j,o),[()=>D("workflows.current-details")]),p(x,y),O(),g()}var $a=_('<div class="px-6 text-secondary/70"><p class="text-sm italic">No events with metadata</p></div>'),ka=_('<span class="text-sm"> </span>'),ba=_('<div class="flex items-center justify-between gap-4 border-b border-subtle px-3 pb-1 text-lg"><div class="flex items-center gap-2"><p class="w-32 min-w-32 text-sm font-medium"> </p> <!></div> <!></div>'),Ma=_('<!> <div class="flex flex-col gap-2"></div>',1);function Ra(x,f){K(f,!0);const r=()=>N(F,"$workflowRun",h),v=()=>N(ha,"$fullEventHistory",h),[h,g]=S(),d=w(()=>r().workflow),P=w(()=>xa(v(),"ascending",a(d)===null||a(d)===void 0?void 0:a(d).pendingActivities,a(d)===null||a(d)===void 0?void 0:a(d).pendingNexusOperations).filter(n=>{var i;return(i=n.userMetadata)===null||i===void 0?void 0:i.summary}));var T=Ma(),c=Z(T);{var b=n=>{var i=$a();p(n,i)};A(c,n=>{a(P).length||n(b)})}var m=l(c,2);ca(m,21,()=>a(P),pa,(n,i)=>{var E=ba(),y=t(E),$=t(y),M=t($,!0);e($);var k=l($,2);{let H=w(()=>D("events.decode-failed"));wa(k,{get value(){return a(i).userMetadata.summary},get fallback(){return a(H)},children:ea,$$slots:{default:(W,B)=>{const C=w(()=>B.decodedValue);var R=ka(),U=t(R,!0);e(R),q(()=>I(U,a(C))),p(W,R)}}})}e(y);var j=l(y,2);_a(j,{get status(){return a(i).finalClassification}}),e(E),q(()=>I(M,a(i).label)),p(n,E)}),e(m),p(x,T),O(),g()}var Pa=_('<div class="py-6 pl-6 text-secondary/70"><p class="text-sm italic"> </p></div>'),Ta=_('<div class="py-6 pl-6 text-secondary/70"><p class="text-sm italic"> </p></div>'),Ea=_('<div class="flex h-full flex-1 flex-col bg-primary"><div><div class="surface-information w-full px-6 py-2"><h3 data-testid="user-metadata-summary-heading"> </h3></div> <!></div> <div><div class="surface-information w-full px-6 py-2"><h3 data-testid="user-metadata-summary-heading"> </h3></div> <!></div> <div><div class="surface-information w-full px-6 py-2"><h3 data-testid="user-metadata-summary-heading">Events with Metadata</h3></div> <div class="py-6"><!></div></div></div>');function Wa(x,f){K(f,!0);const r=()=>N(F,"$workflowRun",v),[v,h]=S();var g,d;const P=w(()=>(g=r()===null||r()===void 0?void 0:r().userMetadata)===null||g===void 0?void 0:g.summary),T=w(()=>(d=r()===null||r()===void 0?void 0:r().userMetadata)===null||d===void 0?void 0:d.details);var c=Ea(),b=t(c),m=t(b),n=t(m),i=t(n,!0);e(n),e(m);var E=l(m,2);{var y=s=>{Q(s,{class:"p-3",overrideTheme:"primary",get content(){return a(P)}})},$=s=>{var u=Pa(),G=t(u),z=t(G,!0);e(G),e(u),q(J=>I(z,J),[()=>D("workflows.no-summary-available")]),p(s,u)};A(E,s=>{a(P)?s(y):s($,!1)})}e(b);var M=l(b,2),k=t(M),j=t(k),H=t(j,!0);e(j),e(k);var W=l(k,2);{var B=s=>{Q(s,{class:"p-3",overrideTheme:"primary",get content(){return a(T)}})},C=s=>{var u=Ta(),G=t(u),z=t(G,!0);e(G),e(u),q(J=>I(z,J),[()=>D("workflows.no-details-available")]),p(s,u)};A(W,s=>{a(T)?s(B):s(C,!1)})}e(M);var R=l(M,2),U=l(t(R),2),o=t(U);Ra(o,{}),e(U),e(R),e(c),q((s,u)=>{I(i,s),I(H,u)},[()=>D("workflows.summary"),()=>D("workflows.details")]),p(x,c),O(),h()}var Da=_('<div class="flex flex-col bg-primary lg:flex-row"><!> <!></div>');function Ia(x){var f=Da(),r=t(f);Wa(r,{});var v=l(r,2);ya(v,{}),e(f),p(x,f)}var ja=_("<!> <!>",1);function se(x,f){K(f,!1),ra();var r=ja(),v=Z(r);{let g=ta(()=>`${D("workflows.user-metadata-tab")} | ${V.params.workflow}`);sa(v,{get title(){return a(g)},get url(){return V.url.href}})}var h=l(v,2);Ia(h),p(x,r),O()}export{se as component};
