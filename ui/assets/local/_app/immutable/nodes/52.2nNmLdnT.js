import{r as mt}from"../chunks/pfMRWl6z.js";import{f as We,c as Pe,k as Re}from"../chunks/C0I8grq9.js";import"../chunks/CWj6FrbW.js";import"../chunks/69_IOA4Y.js";import{p as Je,l as Z,a as wt,f as W,e as m,b as Ge,g as e,m as u,k as oe,t as R,G as i,L as d,o as k,j as c,h as s,c as q,s as r,n as V,r as f,i as pt}from"../chunks/CckrFwdx.js";import{i as Ke}from"../chunks/ebNgFJjp.js";import{s as Xe,a as se,d as vt}from"../chunks/BioCYJcK.js";import{p as Ye}from"../chunks/CZEQpY6k.js";import{P as $t}from"../chunks/CuqmI6m2.js";import{o as gt,w as kt}from"../chunks/DsVF0eUi.js";import{s as F}from"../chunks/_IQD3yTx.js";import{i as fe}from"../chunks/CoMawi-e.js";import{C as _t}from"../chunks/DFHKI2l9.js";import{P as ht,s as yt,c as xt,e as bt}from"../chunks/Do4O9NAB.js";import{A as It}from"../chunks/DERfo0Kx.js";import{A as Ve}from"../chunks/DQoxx6p8.js";import{B as Te}from"../chunks/o-mz833o.js";import{C as me}from"../chunks/DFcCgIa_.js";import{I as qe}from"../chunks/POwFeHBs.js";import{I as we}from"../chunks/BKWrgaSv.js";import{L as Se}from"../chunks/CAyssMxo.js";import{L as Ae}from"../chunks/CIZY4fME.js";import{M as Ue}from"../chunks/BOnD5uCe.js";import{T as Pt}from"../chunks/IF1TuVBO.js";import{t as a}from"../chunks/DEjs8ZrU.js";import{g as Tt}from"../chunks/sJn348-C.js";import{c as St}from"../chunks/DlFjUWrg.js";import{t as Me}from"../chunks/CLoECSqK.js";import{g as At}from"../chunks/Dja_hTL6.js";import{c as Wt,d as ze}from"../chunks/EZHNhN5g.js";import{p as Be}from"../chunks/756y7qLl.js";import{u as He}from"../chunks/BT8t7aT9.js";import{w as Qt}from"../chunks/uGkXP0vd.js";const jt=async function({params:ee,parent:te}){var U,O;const l=await te();if(((U=l==null?void 0:l.settings)==null?void 0:U.disableWriteActions)||((O=l==null?void 0:l.settings)==null?void 0:O.startWorkflowDisabled)){const{namespace:S}=ee;mt(302,We({namespace:S}))}},br=Object.freeze(Object.defineProperty({__proto__:null,load:jt},Symbol.toStringTag,{value:"Module"}));var Dt=W('<div class="flex w-full items-center justify-between"><p> </p> <!></div>'),Ct=W(`<div><h3> </h3> <p class="text-xs text-secondary">Indexed fields used in a List Filter to filter a list of Workflow
            Executions.</p></div> <!>`,1),Ft=W('<div><!> <p class="text-xs text-secondary">Time to wait before dispatching the first workflow task.</p></div> <div class="flex flex-wrap items-center gap-2"><!> <p class="text-nowrap text-secondary"> </p></div>',1),Ot=W(`<div class="flex flex-wrap justify-between"><div><h3> </h3> <p class="text-xs text-secondary">Add context to Workflow Execution to help identity and understand
              its operations.</p></div> <p class="flex items-center gap-1 text-sm text-secondary"> <!></p></div> <!> <!> <!> <!>`,1),Et=W("<!> <!> <!>",1),Lt=W("<!> ",1),Nt=W('<div class="mt-2"><!></div>'),Rt=W('<div class="flex w-full flex-col justify-between gap-2 sm:items-center md:flex-row md:gap-4"><!> <!></div> <div class="flex w-full items-center justify-between gap-4"><!></div> <!> <!> <!> <!> <div class="mt-4 flex w-full flex-row justify-between gap-4 max-sm:flex-col"><!> <!></div> <!> <!>',1),Vt=W('<div class="flex w-full flex-col gap-4 pb-20"><!> <h1 class="mb-4 overflow-hidden" data-testid="start-workflow">Start a Workflow</h1> <!></div>');function qt(ee,te){Je(te,!1);const l=()=>se(Ye,"$page",S),le=()=>se(e(ue),"$encoding",S),U=()=>se(St,"$customSearchAttributes",S),O=()=>se(bt,"$workflowsSearchParams",S),[S,pe]=Xe(),y=u(),M=u(),ve=u(),$e=u(),Qe=u(),Ze=At();let Q=u(""),E=u(""),G=u(""),z=u(""),ne=u(""),ie=u(""),ue=u(kt("json/plain")),de=u(""),B=u(""),ge="",ke="",_e="",K=u(""),H=u(void 0),re=u(!1),ae=u([]);function et(n){var _,x;if(!n)return{};const p=n.match(/WorkflowId: (.+?), RunId: (.+?)\.?$/);if(!p)return{};const o=(_=p[1])===null||_===void 0?void 0:_.trim(),X=(x=p[2])===null||x===void 0?void 0:x.trim();return!o||!X?{}:{workflowId:o,runId:X}}gt(()=>{r(Q,l().url.searchParams.get("workflowId")||""),r(E,l().url.searchParams.get("taskQueue")||""),r(G,l().url.searchParams.get("workflowType")||""),ge=l().url.searchParams.get("runId")||"",ke=l().url.searchParams.get("workflowId")||"",_e=l().url.searchParams.get("workflowType")||"",(ke||_e||ge)&&ot({runId:ge,workflowId:ke,workflowType:_e})});const tt=async()=>{try{r(K,"");const{runId:n}=await yt({namespace:e(y),workflowId:e(Q),taskQueue:e(E),workflowType:e(G),input:e(z),summary:e(ne),details:e(ie),encoding:le(),messageType:e(de),searchAttributes:e(ae),identity:Ze,workflowStartDelay:Wt(e(B))});Me.push({variant:"success",duration:5e3,message:a("workflows.start-workflow-success"),link:Pe({namespace:e(y),workflow:e(Q),run:n})})}catch(n){r(K,(n==null?void 0:n.message)||a("workflows.start-workflow-error")),Me.push({variant:"error",message:a("workflows.start-workflow-error")})}},rt=()=>{r(Q,crypto.randomUUID()),He({parameter:"workflowId",value:e(Q),url:l().url,allowEmpty:!0,options:{keepFocus:!0,noScroll:!0,replaceState:!0}})},at=async n=>{if(n){const{pollers:_}=await Tt({namespace:e(y),queue:n});r(H,_.length)}},ot=async({runId:n,workflowId:_,workflowType:x})=>{var p;const o=await xt({namespace:e(y),runId:n,workflowId:_,workflowType:x});if(r(z,o.input),e(ue).set(o.encoding),r(de,o.messageType),r(ne,o.summary),r(ie,o.details),o!=null&&o.searchAttributes){const X=Object.keys(U());Object.entries(o.searchAttributes).forEach(([J,xe])=>{X.includes(J)&&r(ae,[...e(ae),{label:J,value:xe,type:U()[J]}])})}(Object.keys((p=o==null?void 0:o.searchAttributes)!==null&&p!==void 0?p:{}).length||o!=null&&o.summary||o!=null&&o.details)&&r(re,!0)},he=(n,_)=>{const x=n.target.value;He({parameter:_,value:x,url:l().url,allowEmpty:!0,options:{keepFocus:!0,noScroll:!0,replaceState:!0}})},st=n=>{try{return JSON.parse(n),!0}catch{return!1}};Z(()=>(e(y),l()),()=>{(n=>{r(y,n.namespace)})(l().params)}),Z(()=>e(K),()=>{r(M,et(e(K)))}),Z(()=>l(),()=>{r(ve,l().url.searchParams.get("taskQueue"))}),Z(()=>e(z),()=>{r($e,!e(z)||st(e(z)))}),Z(()=>(e(Q),e(E),e(G),e($e),l()),()=>{r(Qe,!!e(Q)&&!!e(E)&&!!e(G)&&!!e($e)&&!Qt(l()))}),Z(()=>e(ve),()=>{at(e(ve))}),wt(),Ke();var ye=Vt(),je=c(ye);{let n=k(()=>(d(We),e(y),O(),i(()=>`${We({namespace:e(y)})}?${O()}`)));Ae(je,{get href(){return e(n)},"data-testid":"back-to-workflows",icon:"chevron-left",children:(_,x)=>{V();var p=oe();R(o=>F(p,o),[()=>(d(a),i(()=>a("workflows.back-to-workflows")))]),m(_,p)},$$slots:{default:!0}})}var lt=s(je,4);me(lt,{class:"flex w-full flex-col gap-4 xl:w-3/4 2xl:w-1/2",children:(n,_)=>{var x=Rt(),p=q(x),o=c(p);we(o,{id:"workflowId",required:!0,label:"Workflow ID",class:"w-full grow",get value(){return e(Q)},set value(t){r(Q,t)},$$events:{blur:t=>he(t,"workflowId")},$$legacy:!0});var X=s(o,2);Te(X,{class:"mt-0 md:mt-6",variant:"secondary",leadingIcon:"retry",$$events:{click:rt},children:(t,b)=>{V();var j=oe("Random UUID");m(t,j)},$$slots:{default:!0}}),f(p);var J=s(p,2),xe=c(J);we(xe,{id:"taskQueue",required:!0,label:"Task Queue",class:"grow",get value(){return e(E)},set value(t){r(E,t)},$$events:{blur:t=>he(t,"taskQueue")},$$legacy:!0}),f(J);var De=s(J,2);{var nt=t=>{{let b=k(()=>e(H)>0?"success":"warning"),j=k(()=>e(H)?"Task Queue is Active":"Task Queue is Inactive");Ve(t,{get intent(){return e(b)},get title(){return e(j)},children:(h,L)=>{var I=Dt(),A=c(I),v=c(A);f(A);var w=s(A,2);{let $=k(()=>(d(Re),e(y),e(E),i(()=>Re({namespace:e(y),queue:e(E)}))));Ae(w,{get href(){return e($)},newTab:!0,children:(P,N)=>{V();var g=oe("View Task Queue");m(P,g)},$$slots:{default:!0}})}f(I),R($=>F(v,`${e(H)??""}
            ${$??""}`),[()=>(d(Be),e(H),i(()=>Be("Worker",e(H))))]),m(h,I)},$$slots:{default:!0}})}};fe(De,t=>{e(H)!==void 0&&t(nt)})}var Ce=s(De,2);we(Ce,{id:"workflowType",required:!0,label:"Workflow Type",get value(){return e(G)},set value(t){r(G,t)},$$events:{blur:t=>he(t,"workflowType")},$$legacy:!0});var Fe=s(Ce,2);ht(Fe,{get input(){return e(z)},set input(t){r(z,t)},get encoding(){return e(ue)},set encoding(t){vt(r(ue,t),"$encoding",S)},get messageType(){return e(de)},set messageType(t){r(de,t)},$$legacy:!0});var Oe=s(Fe,2);{var it=t=>{var b=Et(),j=q(b);me(j,{class:"flex flex-col gap-2",children:(I,A)=>{var v=Ct(),w=q(v),$=c(w),P=c($,!0);f($),V(2),f(w);var N=s(w,2);{let g=k(()=>(d(a),i(()=>a("common.add"))));It(N,{get buttonCopy(){return e(g)},variant:"secondary",get attributesToAdd(){return e(ae)},set attributesToAdd(D){r(ae,D)},$$legacy:!0})}R(g=>F(P,g),[()=>(d(a),i(()=>a("search-attributes.custom-search-attributes")))]),m(I,v)},$$slots:{default:!0}});var h=s(j,2);me(h,{class:"flex flex-col gap-2",children:(I,A)=>{var v=Ft(),w=q(v),$=c(w);{let C=k(()=>(d(a),i(()=>a("workflows.workflow-start-delay"))));Se($,{for:"workflow-start-delay",get label(){return e(C)},class:"text-xl"})}V(2),f(w);var P=s(w,2),N=c(P);{let C=k(()=>(d(a),i(()=>a("workflows.workflow-start-delay")))),Y=k(()=>(e(B),i(()=>isNaN(Number(e(B))))));we(N,{id:"workflow-start-delay",get label(){return e(C)},labelHidden:!0,suffix:"sec",class:"w-36",get error(){return e(Y)},get value(){return e(B)},set value(ce){r(B,ce)},$$legacy:!0})}var g=s(N,2),D=c(g,!0);f(g),f(P),R(C=>F(D,C),[()=>(d(ze),e(B),i(()=>ze(e(B))))]),m(I,v)},$$slots:{default:!0}});var L=s(h,2);me(L,{class:"flex flex-col gap-2",children:(I,A)=>{var v=Ot(),w=q(v),$=c(w),P=c($),N=c(P,!0);f(P),V(2),f($);var g=s($,2),D=c(g),C=s(D);{let T=k(()=>(d(a),i(()=>a("workflows.markdown-description"))));Pt(C,{topRight:!0,width:200,get text(){return e(T)},children:(Ie,Mt)=>{qe(Ie,{name:"info"})},$$slots:{default:!0}})}f(g),f(w);var Y=s(w,2);{let T=k(()=>(d(a),i(()=>a("workflows.summary"))));Se(Y,{get label(){return e(T)},for:"summary"})}var ce=s(Y,2);Ue(ce,{get content(){return e(ne)},set content(T){r(ne,T)},$$legacy:!0});var Ne=s(ce,2);{let T=k(()=>(d(a),i(()=>a("workflows.details"))));Se(Ne,{get label(){return e(T)},for:"details"})}var ft=s(Ne,2);Ue(ft,{get content(){return e(ie)},set content(T){r(ie,T)},$$legacy:!0}),R((T,Ie)=>{F(N,T),F(D,`${Ie??""} `)},[()=>(d(a),i(()=>a("workflows.user-metadata"))),()=>(d(a),i(()=>a("workflows.markdown-supported")))]),m(I,v)},$$slots:{default:!0}}),m(t,b)};fe(Oe,t=>{e(re)&&t(it)})}var be=s(Oe,2),Ee=c(be);{let t=k(()=>e(re)?"chevron-up":"chevron-down");Te(Ee,{variant:"ghost",class:"max-sm:w-full",get trailingIcon(){return e(t)},$$events:{click:()=>r(re,!e(re))},children:(b,j)=>{V();var h=oe();R(L=>F(h,L),[()=>(d(a),i(()=>a("common.more-options")))]),m(b,h)},$$slots:{default:!0}})}var ut=s(Ee,2);{let t=k(()=>!e(Qe));Te(ut,{get disabled(){return e(t)},"data-testid":"start-workflow-button",class:"max-sm:w-full",$$events:{click:tt},children:(b,j)=>{V();var h=oe();R(L=>F(h,L),[()=>(d(a),i(()=>a("workflows.start-workflow")))]),m(b,h)},$$slots:{default:!0}})}f(be);var Le=s(be,2);{var dt=t=>{Ve(t,{intent:"error",get title(){return e(K)},children:(b,j)=>{var h=pt(),L=q(h);{var I=A=>{var v=Nt(),w=c(v);{let $=k(()=>(d(Pe),e(y),e(M),i(()=>Pe({namespace:e(y),workflow:e(M).workflowId,run:e(M).runId}))));Ae(w,{get href(){return e($)},class:"inline-flex items-center gap-1",children:(P,N)=>{var g=Lt(),D=q(g);qe(D,{name:"external-link",class:"h-4 w-4"});var C=s(D);R(Y=>F(C,` ${Y??""}`),[()=>(d(a),i(()=>a("workflows.view-running-workflow")))]),m(P,g)},$$slots:{default:!0}})}f(v),m(A,v)};fe(L,A=>{e(M),i(()=>e(M).workflowId&&e(M).runId)&&A(I)})}m(b,h)},$$slots:{default:!0}})};fe(Le,t=>{e(K)&&t(dt)})}var ct=s(Le,2);_t(ct,{}),m(n,x)},$$slots:{default:!0}}),f(ye),m(ee,ye),Ge(),pe()}var Ut=W("<!> <!>",1);function Ir(ee,te){Je(te,!1);const l=()=>se(Ye,"$page",le),[le,U]=Xe();Ke();var O=Ut(),S=q(O);$t(S,{title:"Start Workflow",get url(){return l().url.href}});var pe=s(S,2);qt(pe,{}),m(ee,O),Ge(),U()}export{Ir as component,br as universal};
