import{r as pt}from"../chunks/hUONLBj8.js";import{e as Re,c as Oe,i as mt}from"../chunks/B-pZrLC2.js";import"../chunks/Bzak7iHL.js";import"../chunks/69_IOA4Y.js";import{p as Ue,l as B,a as wt,t as P,i as u,c as s,r as c,e as f,b as Me,n as D,k as re,j as C,o as l,g as e,f as F,s as r,m as i,h as vt}from"../chunks/CeuSLZ0_.js";import{i as ze}from"../chunks/Bs0RATCS.js";import{s as Be,d as _t,a as oe}from"../chunks/BqQLnCe4.js";import{p as He}from"../chunks/Tpv3VmCk.js";import{P as gt}from"../chunks/ROT02nYq.js";import{s as W}from"../chunks/BWPCX_-J.js";import{i as de}from"../chunks/CRQEv5x5.js";import{o as $t,w as kt}from"../chunks/B9uAqm1w.js";import{C as xt}from"../chunks/pY5EKtH2.js";import{P as ht,s as yt,c as bt,e as It}from"../chunks/QoU0jI6n.js";import{A as Pt}from"../chunks/BycRNXJ6.js";import{A as Ee}from"../chunks/DcDJ5ze9.js";import{B as he}from"../chunks/DGmPcK68.js";import{C as fe}from"../chunks/_0sdwlgf.js";import{I as Ne}from"../chunks/ClThC-d1.js";import{I as pe}from"../chunks/CHK9WlO8.js";import{L as ye}from"../chunks/PV4uXEXA.js";import{L as be}from"../chunks/c2zJRY5O.js";import{M as Le}from"../chunks/DhESw1TI.js";import{T as Tt}from"../chunks/BD4-loF-.js";import{t as d}from"../chunks/BXv1jDVW.js";import{g as St}from"../chunks/DhwOfjzD.js";import{c as At}from"../chunks/DFnzOsKj.js";import{t as Ve}from"../chunks/Dm9NLqzZ.js";import{g as Wt}from"../chunks/DJd7JLh1.js";import{c as Qt,d as jt}from"../chunks/CHqpB290.js";import{p as Dt}from"../chunks/756y7qLl.js";import{u as qe}from"../chunks/D4_LfkBe.js";import{w as Ct}from"../chunks/BtksiGs2.js";const Ft=async function({params:H,parent:J}){var n,O;const w=await J();if(((n=w==null?void 0:w.settings)==null?void 0:n.disableWriteActions)||((O=w==null?void 0:w.settings)==null?void 0:O.startWorkflowDisabled)){const{namespace:E}=H;pt(302,Re({namespace:E}))}},Pr=Object.freeze(Object.defineProperty({__proto__:null,load:Ft},Symbol.toStringTag,{value:"Module"}));var Ot=P('<div class="flex w-full items-center justify-between"><p> </p> <!></div>'),Et=P(`<div><h3> </h3> <p class="text-xs text-secondary">Indexed fields used in a List Filter to filter a list of Workflow
            Executions.</p></div> <!>`,1),Nt=P('<div><!> <p class="text-xs text-secondary">Time to wait before dispatching the first workflow task.</p></div> <div class="flex flex-wrap items-center gap-2"><!> <p class="text-nowrap text-secondary"> </p></div>',1),Lt=P(`<div class="flex flex-wrap justify-between"><div><h3> </h3> <p class="text-xs text-secondary">Add context to Workflow Execution to help identity and understand
              its operations.</p></div> <p class="flex items-center gap-1 text-sm text-secondary"> <!></p></div> <!> <!> <!> <!>`,1),Vt=P("<!> <!> <!>",1),qt=P("<!> ",1),Rt=P('<div class="mt-2"><!></div>'),Ut=P('<div class="flex w-full flex-col justify-between gap-2 sm:items-center md:flex-row md:gap-4"><!> <!></div> <div class="flex w-full items-center justify-between gap-4"><!></div> <!> <!> <!> <!> <div class="mt-4 flex w-full flex-row justify-between gap-4 max-sm:flex-col"><!> <!></div> <!> <!>',1),Mt=P('<div class="flex w-full flex-col gap-4 pb-20"><!> <h1 class="mb-4 overflow-hidden" data-testid="start-workflow">Start a Workflow</h1> <!></div>');function zt(H,J){Ue(J,!1);const[w,se]=Be(),n=()=>oe(He,"$page",w),O=()=>oe(e(ne),"$encoding",w),E=()=>oe(At,"$customSearchAttributes",w),me=()=>oe(It,"$workflowsSearchParams",w),T=i(),K=i(),we=i(),ve=i(),Ie=i(),Je=Wt();let S=i(""),N=i(""),R=i(""),L=i(""),ae=i(""),le=i(""),ne=i(kt("json/plain")),ie=i(""),G=i(""),_e="",ge="",U=i(""),M=i(void 0),X=i(!1),Y=i([]);function Ke(a){var g,p;if(!a)return{};const o=a.match(/WorkflowId: (.+?), RunId: (.+?)\.?$/);if(!o)return{};const V=(g=o[1])===null||g===void 0?void 0:g.trim(),Q=(p=o[2])===null||p===void 0?void 0:p.trim();return!V||!Q?{}:{workflowId:V,runId:Q}}$t(()=>{r(S,n().url.searchParams.get("workflowId")||""),r(N,n().url.searchParams.get("taskQueue")||""),r(R,n().url.searchParams.get("workflowType")||""),_e=n().url.searchParams.get("workflowId")||"",ge=n().url.searchParams.get("workflowType")||"",(_e||ge)&&Ze(_e,ge)});const Ge=async()=>{try{r(U,"");const{runId:a}=await yt({namespace:e(T),workflowId:e(S),taskQueue:e(N),workflowType:e(R),input:e(L),summary:e(ae),details:e(le),encoding:O(),messageType:e(ie),searchAttributes:e(Y),identity:Je,workflowStartDelay:Qt(e(G))});Ve.push({variant:"success",duration:5e3,message:d("workflows.start-workflow-success"),link:Oe({namespace:e(T),workflow:e(S),run:a})})}catch(a){r(U,(a==null?void 0:a.message)||d("workflows.start-workflow-error")),Ve.push({variant:"error",message:d("workflows.start-workflow-error")})}},Xe=()=>{r(S,crypto.randomUUID()),qe({parameter:"workflowId",value:e(S),url:n().url,allowEmpty:!0,options:{keepFocus:!0,noScroll:!0,replaceState:!0}})},Ye=async a=>{if(a){const{pollers:g}=await St({namespace:e(T),queue:a});r(M,g.length)}},Ze=async(a,g)=>{var p;const o=await bt({namespace:e(T),workflowId:a,workflowType:g});if(r(L,o.input),e(ne).set(o.encoding),r(ie,o.messageType),r(ae,o.summary),r(le,o.details),o!=null&&o.searchAttributes){const V=Object.keys(E());Object.entries(o.searchAttributes).forEach(([Q,Z])=>{V.includes(Q)&&r(Y,[...e(Y),{label:Q,value:Z,type:E()[Q]}])})}(Object.keys((p=o==null?void 0:o.searchAttributes)!==null&&p!==void 0?p:{}).length||o!=null&&o.summary||o!=null&&o.details)&&r(X,!0)},$e=(a,g)=>{const p=a.target.value;qe({parameter:g,value:p,url:n().url,allowEmpty:!0,options:{keepFocus:!0,noScroll:!0,replaceState:!0}})},et=a=>{try{return JSON.parse(a),!0}catch{return!1}};B(()=>(e(T),n()),()=>{(a=>r(T,a.namespace))(n().params)}),B(()=>e(U),()=>{r(K,Ke(e(U)))}),B(()=>n(),()=>{r(we,n().url.searchParams.get("taskQueue"))}),B(()=>e(L),()=>{r(ve,!e(L)||et(e(L)))}),B(()=>(e(S),e(N),e(R),e(ve),n()),()=>{r(Ie,!!e(S)&&!!e(N)&&!!e(R)&&!!e(ve)&&!Ct(n()))}),B(()=>e(we),()=>{Ye(e(we))}),wt(),ze();var ke=Mt(),Pe=u(ke);const tt=l(()=>`${Re({namespace:e(T)})}?${me()}`);be(Pe,{get href(){return e(tt)},"data-testid":"back-to-workflows",icon:"chevron-left",children:(a,g)=>{D();var p=re();C(o=>W(p,o),[()=>d("workflows.back-to-workflows")],l),f(a,p)},$$slots:{default:!0}});var rt=s(Pe,4);fe(rt,{class:"flex w-full flex-col gap-4 xl:w-3/4 2xl:w-1/2",children:(a,g)=>{var p=Ut(),o=F(p),V=u(o);pe(V,{id:"workflowId",required:!0,label:"Workflow ID",class:"w-full grow",get value(){return e(S)},set value(t){r(S,t)},$$events:{blur:t=>$e(t,"workflowId")},$$legacy:!0});var Q=s(V,2);he(Q,{class:"mt-0 md:mt-6",variant:"secondary",leadingIcon:"retry",$$events:{click:Xe},children:(t,A)=>{D();var _=re("Random UUID");f(t,_)},$$slots:{default:!0}}),c(o);var Z=s(o,2),ot=u(Z);pe(ot,{id:"taskQueue",required:!0,label:"Task Queue",class:"grow",get value(){return e(N)},set value(t){r(N,t)},$$events:{blur:t=>$e(t,"taskQueue")},$$legacy:!0}),c(Z);var Te=s(Z,2);{var st=t=>{const A=l(()=>e(M)>0?"success":"warning"),_=l(()=>e(M)?"Task Queue is Active":"Task Queue is Inactive");Ee(t,{get intent(){return e(A)},get title(){return e(_)},children:(h,ue)=>{var y=Ot(),I=u(y),v=u(I);c(I);var m=s(I,2);const $=l(()=>mt({namespace:e(T),queue:e(N)}));be(m,{get href(){return e($)},newTab:!0,children:(k,j)=>{D();var x=re("View Task Queue");f(k,x)},$$slots:{default:!0}}),c(y),C(k=>W(v,`${e(M)??""}
            ${k??""}`),[()=>Dt("Worker",e(M))],l),f(h,y)},$$slots:{default:!0}})};de(Te,t=>{e(M)!==void 0&&t(st)})}var Se=s(Te,2);pe(Se,{id:"workflowType",required:!0,label:"Workflow Type",get value(){return e(R)},set value(t){r(R,t)},$$events:{blur:t=>$e(t,"workflowType")},$$legacy:!0});var Ae=s(Se,2);ht(Ae,{get input(){return e(L)},set input(t){r(L,t)},get encoding(){return e(ne)},set encoding(t){_t(r(ne,t),"$encoding",w)},get messageType(){return e(ie)},set messageType(t){r(ie,t)},$$legacy:!0});var We=s(Ae,2);{var at=t=>{var A=Vt(),_=F(A);fe(_,{class:"flex flex-col gap-2",children:(y,I)=>{var v=Et(),m=F(v),$=u(m),k=u($,!0);c($),D(2),c(m);var j=s(m,2);const x=l(()=>d("common.add"));Pt(j,{get buttonCopy(){return e(x)},variant:"secondary",get attributesToAdd(){return e(Y)},set attributesToAdd(b){r(Y,b)},$$legacy:!0}),C(b=>W(k,b),[()=>d("search-attributes.custom-search-attributes")],l),f(y,v)},$$slots:{default:!0}});var h=s(_,2);fe(h,{class:"flex flex-col gap-2",children:(y,I)=>{var v=Nt(),m=F(v),$=u(m);const k=l(()=>d("workflows.workflow-start-delay"));ye($,{for:"workflow-start-delay",get label(){return e(k)},class:"text-xl"}),D(2),c(m);var j=s(m,2),x=u(j);const b=l(()=>d("workflows.workflow-start-delay")),ee=l(()=>isNaN(Number(e(G))));pe(x,{id:"workflow-start-delay",get label(){return e(b)},labelHidden:!0,suffix:"sec",class:"w-36",get error(){return e(ee)},get value(){return e(G)},set value(te){r(G,te)},$$legacy:!0});var z=s(x,2),ce=u(z,!0);c(z),c(j),C(te=>W(ce,te),[()=>jt(e(G))],l),f(y,v)},$$slots:{default:!0}});var ue=s(h,2);fe(ue,{class:"flex flex-col gap-2",children:(y,I)=>{var v=Lt(),m=F(v),$=u(m),k=u($),j=u(k,!0);c(k),D(2),c($);var x=s($,2),b=u(x),ee=s(b);const z=l(()=>d("workflows.markdown-description"));Tt(ee,{topRight:!0,width:200,get text(){return e(z)},children:(q,Fe)=>{Ne(q,{name:"info"})},$$slots:{default:!0}}),c(x),c(m);var ce=s(m,2);const te=l(()=>d("workflows.summary"));ye(ce,{get label(){return e(te)},for:"summary"});var De=s(ce,2);Le(De,{get content(){return e(ae)},set content(q){r(ae,q)},$$legacy:!0});var Ce=s(De,2);const dt=l(()=>d("workflows.details"));ye(Ce,{get label(){return e(dt)},for:"details"});var ft=s(Ce,2);Le(ft,{get content(){return e(le)},set content(q){r(le,q)},$$legacy:!0}),C((q,Fe)=>{W(j,q),W(b,`${Fe??""} `)},[()=>d("workflows.user-metadata"),()=>d("workflows.markdown-supported")],l),f(y,v)},$$slots:{default:!0}}),f(t,A)};de(We,t=>{e(X)&&t(at)})}var xe=s(We,2),Qe=u(xe);const lt=l(()=>e(X)?"chevron-up":"chevron-down");he(Qe,{variant:"ghost",class:"max-sm:w-full",get trailingIcon(){return e(lt)},$$events:{click:()=>r(X,!e(X))},children:(t,A)=>{D();var _=re();C(h=>W(_,h),[()=>d("common.more-options")],l),f(t,_)},$$slots:{default:!0}});var nt=s(Qe,2);const it=l(()=>!e(Ie));he(nt,{get disabled(){return e(it)},"data-testid":"start-workflow-button",class:"max-sm:w-full",$$events:{click:Ge},children:(t,A)=>{D();var _=re();C(h=>W(_,h),[()=>d("workflows.start-workflow")],l),f(t,_)},$$slots:{default:!0}}),c(xe);var je=s(xe,2);{var ut=t=>{Ee(t,{intent:"error",get title(){return e(U)},children:(A,_)=>{var h=vt(),ue=F(h);{var y=I=>{var v=Rt(),m=u(v);const $=l(()=>Oe({namespace:e(T),workflow:e(K).workflowId,run:e(K).runId}));be(m,{get href(){return e($)},class:"inline-flex items-center gap-1",children:(k,j)=>{var x=qt(),b=F(x);Ne(b,{name:"external-link",class:"h-4 w-4"});var ee=s(b);C(z=>W(ee,` ${z??""}`),[()=>d("workflows.view-running-workflow")],l),f(k,x)},$$slots:{default:!0}}),c(v),f(I,v)};de(ue,I=>{e(K).workflowId&&e(K).runId&&I(y)})}f(A,h)},$$slots:{default:!0}})};de(je,t=>{e(U)&&t(ut)})}var ct=s(je,2);xt(ct,{}),f(a,p)},$$slots:{default:!0}}),c(ke),f(H,ke),Me(),se()}var Bt=P("<!> <!>",1);function Tr(H,J){Ue(J,!1);const[w,se]=Be(),n=()=>oe(He,"$page",w);ze();var O=Bt(),E=F(O);gt(E,{title:"Start Workflow",get url(){return n().url.href}});var me=s(E,2);zt(me,{}),f(H,O),Me(),se()}export{Tr as component,Pr as universal};
