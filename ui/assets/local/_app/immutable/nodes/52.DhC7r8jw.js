import"../chunks/CWj6FrbW.js";import"../chunks/69_IOA4Y.js";import{p as I,l as J,a as O,t as y,b as Q,d as o,g as l,e as w,c as g,m as b,s as x,n as T,r as L,f as ee}from"../chunks/BZ1i_Yzi.js";import{t as G,a as v,b as Z}from"../chunks/B11KKQxI.js";import{i as K}from"../chunks/EXou6kTq.js";import{s as M,a as k}from"../chunks/nHCSEYHe.js";import{g as U}from"../chunks/B3qFhz4N.js";import{p as te}from"../chunks/ViSjBWlS.js";import{P as ae}from"../chunks/BSbw5w3E.js";import{t as i}from"../chunks/D2OY9xdY.js";import{s as P}from"../chunks/BtIgVYD3.js";import{p as s}from"../chunks/DQFlnzBt.js";import{B as D}from"../chunks/X7p--4Xd.js";import{L as re}from"../chunks/C3a70atb.js";import{N as se,e as V}from"../chunks/Ckikhe4S.js";import{h as B}from"../chunks/DiIlwB2l.js";import{c as ne}from"../chunks/BbyEZDox.js";import{n as oe}from"../chunks/D6bk2mRZ.js";import{e as ie}from"../chunks/0zP2RAmK.js";var le=G('<div class="flex w-full flex-col gap-8"><div class="text-sm"><!></div> <h1 data-testid="namespace-selector-title"> </h1> <!> <div class="flex flex-row items-center gap-4 max-sm:flex-col"><!> <!></div></div>');function ce(C,t){I(t,!1);const[c,F]=M(),n=()=>k(V,"$endpointForm",c),m=b();let A=s(t,"onCreate",8),_=s(t,"targetNamespaceList",24,()=>[]),h=s(t,"callerNamespaceList",24,()=>[]),p=s(t,"error",8,void 0),z=s(t,"loading",8,!1),$=s(t,"isCloud",8,!1),N=s(t,"nameRegexPattern",8,/^[a-zA-Z][a-zA-Z0-9-]*[a-zA-Z0-9]$/),H=s(t,"nameHintText",24,()=>i("nexus.endpoint-name-hint-with-dash"));J(()=>n(),()=>{x(m,n().spec.name===""||n().spec.target.worker.namespace===""||n().spec.target.worker.taskQueue==="")}),O(),K();var d=le(),e=w(d),R=w(e);const W=o(B);re(R,{get href(){return l(W)},icon:"chevron-left",children:(a,u)=>{T();var r=Z();y(f=>P(r,f),[()=>i("nexus.back-to-endpoints")],o),v(a,r)},$$slots:{default:!0}}),L(e);var S=g(e,2),X=w(S,!0);L(S);var E=g(S,2);se(E,{get nameRegexPattern(){return N()},get nameHintText(){return H()},get error(){return p()},get targetNamespaceList(){return _()},get callerNamespaceList(){return h()},get isCloud(){return $()}});var j=g(E,2),q=w(j);D(q,{variant:"primary",get disabled(){return l(m)},class:"max-sm:w-full",get loading(){return z()},$$events:{click(...a){var u;(u=A())==null||u.apply(this,a)}},children:(a,u)=>{T();var r=Z();y(f=>P(r,f),[()=>i("nexus.create-endpoint")],o),v(a,r)},$$slots:{default:!0}});var Y=g(q,2);D(Y,{variant:"ghost",class:"max-sm:w-full",$$events:{click:()=>U(B())},children:(a,u)=>{T();var r=Z();y(f=>P(r,f),[()=>i("common.cancel")],o),v(a,r)},$$slots:{default:!0}}),L(j),L(d),y(a=>P(X,a),[()=>i("nexus.create-endpoint")],o),v(C,d),Q(),F()}var me=G("<!> <!>",1);function Ae(C,t){I(t,!1);const[c,F]=M(),n=()=>k(V,"$endpointForm",c),m=()=>k(oe,"$namespaces",c),A=()=>k(te,"$page",c),_=b();let h=b(void 0),p=b(!1);const z=async()=>{x(p,!0);try{const e={...n()},R=await ie({input:JSON.stringify(e.spec.descriptionString),encoding:"json/plain"});e.spec.description=R[0],delete e.spec.allowedCallerNamespaces,delete e.spec.descriptionString,await ne(e),U(B(),{invalidateAll:!0})}catch(e){x(h,e),console.error("Error creating endpoint",e)}finally{x(p,!1)}};J(()=>m(),()=>{x(_,m().map(e=>({namespace:e.namespaceInfo.name})))}),O(),K();var $=me(),N=ee($);const H=o(()=>i("nexus.create-endpoint"));ae(N,{get title(){return l(H)},get url(){return A().url.href}});var d=g(N,2);ce(d,{onCreate:z,get targetNamespaceList(){return l(_)},get error(){return l(h)},get loading(){return l(p)}}),v(C,$),Q(),F()}export{Ae as component};
