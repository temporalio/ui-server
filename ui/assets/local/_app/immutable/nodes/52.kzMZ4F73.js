import{r as mt}from"../chunks/hUONLBj8.js";import{f as Me,c as Ne,k as wt}from"../chunks/Ri2stLMz.js";import"../chunks/Bzak7iHL.js";import"../chunks/69_IOA4Y.js";import{p as ze,l as H,a as vt,t as T,i as u,c as o,r as c,e as f,b as Be,n as D,k as re,j as C,o as l,g as e,f as F,s as r,m as i,h as gt}from"../chunks/C-0kx8Rl.js";import{i as He}from"../chunks/DFzl7kYA.js";import{s as Je,d as _t,a as oe}from"../chunks/B0Wc33k0.js";import{p as Ke}from"../chunks/Bk7ZBJgR.js";import{P as $t}from"../chunks/DMOchDbk.js";import{s as Q}from"../chunks/B-1TjF6E.js";import{i as de}from"../chunks/DIXBMONz.js";import{o as kt,w as xt}from"../chunks/Dl-yZlXH.js";import{C as ht}from"../chunks/Mf4L9d6p.js";import{P as yt,s as bt,c as It,e as Pt}from"../chunks/D1_XGivl.js";import{A as Tt}from"../chunks/LhWZ8BQA.js";import{A as Le}from"../chunks/LaSHB24F.js";import{B as be}from"../chunks/DvJlO_uk.js";import{C as fe}from"../chunks/WYfh_BGa.js";import{I as Re}from"../chunks/BQ19dEFL.js";import{I as pe}from"../chunks/V1C1zvl_.js";import{L as Ie}from"../chunks/CGLMDN_1.js";import{L as Pe}from"../chunks/ChvstbSQ.js";import{M as Ve}from"../chunks/Dpb446C_.js";import{T as St}from"../chunks/D7zMa2zU.js";import{t as d}from"../chunks/BXv1jDVW.js";import{g as At}from"../chunks/LO6fhLna.js";import{c as Wt}from"../chunks/CFk5eimv.js";import{t as qe}from"../chunks/DHNhp-3A.js";import{g as Qt}from"../chunks/BduMvSVJ.js";import{c as jt,d as Dt}from"../chunks/2uWpc1Jl.js";import{p as Ct}from"../chunks/756y7qLl.js";import{u as Ue}from"../chunks/C3qqsvX9.js";import{w as Ft}from"../chunks/Ce7bUHmR.js";const Ot=async function({params:J,parent:K}){var n,O;const m=await K();if(((n=m==null?void 0:m.settings)==null?void 0:n.disableWriteActions)||((O=m==null?void 0:m.settings)==null?void 0:O.startWorkflowDisabled)){const{namespace:E}=J;mt(302,Me({namespace:E}))}},Tr=Object.freeze(Object.defineProperty({__proto__:null,load:Ot},Symbol.toStringTag,{value:"Module"}));var Et=T('<div class="flex w-full items-center justify-between"><p> </p> <!></div>'),Nt=T(`<div><h3> </h3> <p class="text-xs text-secondary">Indexed fields used in a List Filter to filter a list of Workflow
            Executions.</p></div> <!>`,1),Lt=T('<div><!> <p class="text-xs text-secondary">Time to wait before dispatching the first workflow task.</p></div> <div class="flex flex-wrap items-center gap-2"><!> <p class="text-nowrap text-secondary"> </p></div>',1),Rt=T(`<div class="flex flex-wrap justify-between"><div><h3> </h3> <p class="text-xs text-secondary">Add context to Workflow Execution to help identity and understand
              its operations.</p></div> <p class="flex items-center gap-1 text-sm text-secondary"> <!></p></div> <!> <!> <!> <!>`,1),Vt=T("<!> <!> <!>",1),qt=T("<!> ",1),Ut=T('<div class="mt-2"><!></div>'),Mt=T('<div class="flex w-full flex-col justify-between gap-2 sm:items-center md:flex-row md:gap-4"><!> <!></div> <div class="flex w-full items-center justify-between gap-4"><!></div> <!> <!> <!> <!> <div class="mt-4 flex w-full flex-row justify-between gap-4 max-sm:flex-col"><!> <!></div> <!> <!>',1),zt=T('<div class="flex w-full flex-col gap-4 pb-20"><!> <h1 class="mb-4 overflow-hidden" data-testid="start-workflow">Start a Workflow</h1> <!></div>');function Bt(J,K){ze(K,!1);const[m,se]=Je(),n=()=>oe(Ke,"$page",m),O=()=>oe(e(ne),"$encoding",m),E=()=>oe(Wt,"$customSearchAttributes",m),me=()=>oe(Pt,"$workflowsSearchParams",m),S=i(),G=i(),we=i(),ve=i(),Te=i(),Ge=Qt();let A=i(""),N=i(""),q=i(""),L=i(""),ae=i(""),le=i(""),ne=i(xt("json/plain")),ie=i(""),X=i(""),ge="",_e="",$e="",U=i(""),M=i(void 0),Y=i(!1),Z=i([]);function Xe(a){var $,v;if(!a)return{};const g=a.match(/WorkflowId: (.+?), RunId: (.+?)\.?$/);if(!g)return{};const s=($=g[1])===null||$===void 0?void 0:$.trim(),z=(v=g[2])===null||v===void 0?void 0:v.trim();return!s||!z?{}:{workflowId:s,runId:z}}kt(()=>{r(A,n().url.searchParams.get("workflowId")||""),r(N,n().url.searchParams.get("taskQueue")||""),r(q,n().url.searchParams.get("workflowType")||""),ge=n().url.searchParams.get("runId")||"",_e=n().url.searchParams.get("workflowId")||"",$e=n().url.searchParams.get("workflowType")||"",(_e||$e||ge)&&tt({runId:ge,workflowId:_e,workflowType:$e})});const Ye=async()=>{try{r(U,"");const{runId:a}=await bt({namespace:e(S),workflowId:e(A),taskQueue:e(N),workflowType:e(q),input:e(L),summary:e(ae),details:e(le),encoding:O(),messageType:e(ie),searchAttributes:e(Z),identity:Ge,workflowStartDelay:jt(e(X))});qe.push({variant:"success",duration:5e3,message:d("workflows.start-workflow-success"),link:Ne({namespace:e(S),workflow:e(A),run:a})})}catch(a){r(U,(a==null?void 0:a.message)||d("workflows.start-workflow-error")),qe.push({variant:"error",message:d("workflows.start-workflow-error")})}},Ze=()=>{r(A,crypto.randomUUID()),Ue({parameter:"workflowId",value:e(A),url:n().url,allowEmpty:!0,options:{keepFocus:!0,noScroll:!0,replaceState:!0}})},et=async a=>{if(a){const{pollers:$}=await At({namespace:e(S),queue:a});r(M,$.length)}},tt=async({runId:a,workflowId:$,workflowType:v})=>{var g;const s=await It({namespace:e(S),runId:a,workflowId:$,workflowType:v});if(r(L,s.input),e(ne).set(s.encoding),r(ie,s.messageType),r(ae,s.summary),r(le,s.details),s!=null&&s.searchAttributes){const z=Object.keys(E());Object.entries(s.searchAttributes).forEach(([R,he])=>{z.includes(R)&&r(Z,[...e(Z),{label:R,value:he,type:E()[R]}])})}(Object.keys((g=s==null?void 0:s.searchAttributes)!==null&&g!==void 0?g:{}).length||s!=null&&s.summary||s!=null&&s.details)&&r(Y,!0)},ke=(a,$)=>{const v=a.target.value;Ue({parameter:$,value:v,url:n().url,allowEmpty:!0,options:{keepFocus:!0,noScroll:!0,replaceState:!0}})},rt=a=>{try{return JSON.parse(a),!0}catch{return!1}};H(()=>(e(S),n()),()=>{(a=>r(S,a.namespace))(n().params)}),H(()=>e(U),()=>{r(G,Xe(e(U)))}),H(()=>n(),()=>{r(we,n().url.searchParams.get("taskQueue"))}),H(()=>e(L),()=>{r(ve,!e(L)||rt(e(L)))}),H(()=>(e(A),e(N),e(q),e(ve),n()),()=>{r(Te,!!e(A)&&!!e(N)&&!!e(q)&&!!e(ve)&&!Ft(n()))}),H(()=>e(we),()=>{et(e(we))}),vt(),He();var xe=zt(),Se=u(xe);const ot=l(()=>`${Me({namespace:e(S)})}?${me()}`);Pe(Se,{get href(){return e(ot)},"data-testid":"back-to-workflows",icon:"chevron-left",children:(a,$)=>{D();var v=re();C(g=>Q(v,g),[()=>d("workflows.back-to-workflows")],l),f(a,v)},$$slots:{default:!0}});var st=o(Se,4);fe(st,{class:"flex w-full flex-col gap-4 xl:w-3/4 2xl:w-1/2",children:(a,$)=>{var v=Mt(),g=F(v),s=u(g);pe(s,{id:"workflowId",required:!0,label:"Workflow ID",class:"w-full grow",get value(){return e(A)},set value(t){r(A,t)},$$events:{blur:t=>ke(t,"workflowId")},$$legacy:!0});var z=o(s,2);be(z,{class:"mt-0 md:mt-6",variant:"secondary",leadingIcon:"retry",$$events:{click:Ze},children:(t,W)=>{D();var _=re("Random UUID");f(t,_)},$$slots:{default:!0}}),c(g);var R=o(g,2),he=u(R);pe(he,{id:"taskQueue",required:!0,label:"Task Queue",class:"grow",get value(){return e(N)},set value(t){r(N,t)},$$events:{blur:t=>ke(t,"taskQueue")},$$legacy:!0}),c(R);var Ae=o(R,2);{var at=t=>{const W=l(()=>e(M)>0?"success":"warning"),_=l(()=>e(M)?"Task Queue is Active":"Task Queue is Inactive");Le(t,{get intent(){return e(W)},get title(){return e(_)},children:(y,ue)=>{var b=Et(),P=u(b),w=u(P);c(P);var p=o(P,2);const k=l(()=>wt({namespace:e(S),queue:e(N)}));Pe(p,{get href(){return e(k)},newTab:!0,children:(x,j)=>{D();var h=re("View Task Queue");f(x,h)},$$slots:{default:!0}}),c(b),C(x=>Q(w,`${e(M)??""}
            ${x??""}`),[()=>Ct("Worker",e(M))],l),f(y,b)},$$slots:{default:!0}})};de(Ae,t=>{e(M)!==void 0&&t(at)})}var We=o(Ae,2);pe(We,{id:"workflowType",required:!0,label:"Workflow Type",get value(){return e(q)},set value(t){r(q,t)},$$events:{blur:t=>ke(t,"workflowType")},$$legacy:!0});var Qe=o(We,2);yt(Qe,{get input(){return e(L)},set input(t){r(L,t)},get encoding(){return e(ne)},set encoding(t){_t(r(ne,t),"$encoding",m)},get messageType(){return e(ie)},set messageType(t){r(ie,t)},$$legacy:!0});var je=o(Qe,2);{var lt=t=>{var W=Vt(),_=F(W);fe(_,{class:"flex flex-col gap-2",children:(b,P)=>{var w=Nt(),p=F(w),k=u(p),x=u(k,!0);c(k),D(2),c(p);var j=o(p,2);const h=l(()=>d("common.add"));Tt(j,{get buttonCopy(){return e(h)},variant:"secondary",get attributesToAdd(){return e(Z)},set attributesToAdd(I){r(Z,I)},$$legacy:!0}),C(I=>Q(x,I),[()=>d("search-attributes.custom-search-attributes")],l),f(b,w)},$$slots:{default:!0}});var y=o(_,2);fe(y,{class:"flex flex-col gap-2",children:(b,P)=>{var w=Lt(),p=F(w),k=u(p);const x=l(()=>d("workflows.workflow-start-delay"));Ie(k,{for:"workflow-start-delay",get label(){return e(x)},class:"text-xl"}),D(2),c(p);var j=o(p,2),h=u(j);const I=l(()=>d("workflows.workflow-start-delay")),ee=l(()=>isNaN(Number(e(X))));pe(h,{id:"workflow-start-delay",get label(){return e(I)},labelHidden:!0,suffix:"sec",class:"w-36",get error(){return e(ee)},get value(){return e(X)},set value(te){r(X,te)},$$legacy:!0});var B=o(h,2),ce=u(B,!0);c(B),c(j),C(te=>Q(ce,te),[()=>Dt(e(X))],l),f(b,w)},$$slots:{default:!0}});var ue=o(y,2);fe(ue,{class:"flex flex-col gap-2",children:(b,P)=>{var w=Rt(),p=F(w),k=u(p),x=u(k),j=u(x,!0);c(x),D(2),c(k);var h=o(k,2),I=u(h),ee=o(I);const B=l(()=>d("workflows.markdown-description"));St(ee,{topRight:!0,width:200,get text(){return e(B)},children:(V,Ee)=>{Re(V,{name:"info"})},$$slots:{default:!0}}),c(h),c(p);var ce=o(p,2);const te=l(()=>d("workflows.summary"));Ie(ce,{get label(){return e(te)},for:"summary"});var Fe=o(ce,2);Ve(Fe,{get content(){return e(ae)},set content(V){r(ae,V)},$$legacy:!0});var Oe=o(Fe,2);const ft=l(()=>d("workflows.details"));Ie(Oe,{get label(){return e(ft)},for:"details"});var pt=o(Oe,2);Ve(pt,{get content(){return e(le)},set content(V){r(le,V)},$$legacy:!0}),C((V,Ee)=>{Q(j,V),Q(I,`${Ee??""} `)},[()=>d("workflows.user-metadata"),()=>d("workflows.markdown-supported")],l),f(b,w)},$$slots:{default:!0}}),f(t,W)};de(je,t=>{e(Y)&&t(lt)})}var ye=o(je,2),De=u(ye);const nt=l(()=>e(Y)?"chevron-up":"chevron-down");be(De,{variant:"ghost",class:"max-sm:w-full",get trailingIcon(){return e(nt)},$$events:{click:()=>r(Y,!e(Y))},children:(t,W)=>{D();var _=re();C(y=>Q(_,y),[()=>d("common.more-options")],l),f(t,_)},$$slots:{default:!0}});var it=o(De,2);const ut=l(()=>!e(Te));be(it,{get disabled(){return e(ut)},"data-testid":"start-workflow-button",class:"max-sm:w-full",$$events:{click:Ye},children:(t,W)=>{D();var _=re();C(y=>Q(_,y),[()=>d("workflows.start-workflow")],l),f(t,_)},$$slots:{default:!0}}),c(ye);var Ce=o(ye,2);{var ct=t=>{Le(t,{intent:"error",get title(){return e(U)},children:(W,_)=>{var y=gt(),ue=F(y);{var b=P=>{var w=Ut(),p=u(w);const k=l(()=>Ne({namespace:e(S),workflow:e(G).workflowId,run:e(G).runId}));Pe(p,{get href(){return e(k)},class:"inline-flex items-center gap-1",children:(x,j)=>{var h=qt(),I=F(h);Re(I,{name:"external-link",class:"h-4 w-4"});var ee=o(I);C(B=>Q(ee,` ${B??""}`),[()=>d("workflows.view-running-workflow")],l),f(x,h)},$$slots:{default:!0}}),c(w),f(P,w)};de(ue,P=>{e(G).workflowId&&e(G).runId&&P(b)})}f(W,y)},$$slots:{default:!0}})};de(Ce,t=>{e(U)&&t(ct)})}var dt=o(Ce,2);ht(dt,{}),f(a,v)},$$slots:{default:!0}}),c(xe),f(J,xe),Be(),se()}var Ht=T("<!> <!>",1);function Sr(J,K){ze(K,!1);const[m,se]=Je(),n=()=>oe(Ke,"$page",m);He();var O=Ht(),E=F(O);$t(E,{title:"Start Workflow",get url(){return n().url.href}});var me=o(E,2);Bt(me,{}),f(J,O),Be(),se()}export{Sr as component,Tr as universal};
