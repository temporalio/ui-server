import{r as pt}from"../chunks/hUONLBj8.js";import{e as Re,c as Oe,i as mt}from"../chunks/WbYi9Vis.js";import"../chunks/CWj6FrbW.js";import"../chunks/69_IOA4Y.js";import{p as Me,l as H,a as wt,t as P,h as u,c as s,r as c,d as f,b as ze,n as C,k as re,i as D,j as l,g as e,f as F,s as r,m as i,e as vt}from"../chunks/CtXwlho8.js";import{i as Be}from"../chunks/D4D3ThYu.js";import{s as He,d as gt,a as oe}from"../chunks/CI9zuxJp.js";import{p as Je}from"../chunks/lx_gmyuu.js";import{P as _t}from"../chunks/BYpUB0sF.js";import{s as W}from"../chunks/BXc8M6y4.js";import{i as de}from"../chunks/yjFgoZ2z.js";import{o as $t,w as kt}from"../chunks/BBGlwGsK.js";import{C as xt}from"../chunks/TXZPY-eV.js";import{P as ht,s as yt,e as bt,g as It}from"../chunks/DHSD0DbB.js";import{A as Pt}from"../chunks/BXNzIV9c.js";import{A as Ee}from"../chunks/Cb-Z4thM.js";import{B as he}from"../chunks/CWc85qTY.js";import{C as fe}from"../chunks/uH6vHrjH.js";import{I as Ne}from"../chunks/Cey4-U3a.js";import{I as pe}from"../chunks/C8K_M4c-.js";import{L as ye}from"../chunks/DCI8NNqO.js";import{L as be}from"../chunks/DfXRA3hm.js";import{M as Le}from"../chunks/--eXOVcu.js";import{T as Tt}from"../chunks/DHeHXQSq.js";import{t as d}from"../chunks/D2OY9xdY.js";import{g as St}from"../chunks/BHDdm78A.js";import{c as At}from"../chunks/C5JMgcdy.js";import{t as Ve}from"../chunks/GWRmNmWh.js";import{g as Wt}from"../chunks/AlMSaZnh.js";import{c as Qt,d as jt}from"../chunks/CeMbHz9m.js";import{p as Ct}from"../chunks/756y7qLl.js";import{u as qe}from"../chunks/ChZI8Tlr.js";import{w as Dt}from"../chunks/B8d0Y1PO.js";import{v as Ft}from"../chunks/Dz_GI0CC.js";const Ot=async function({params:J,parent:U}){var n,O;const w=await U();if(((n=w==null?void 0:w.settings)==null?void 0:n.disableWriteActions)||((O=w==null?void 0:w.settings)==null?void 0:O.startWorkflowDisabled)){const{namespace:E}=J;pt(302,Re({namespace:E}))}},Sr=Object.freeze(Object.defineProperty({__proto__:null,load:Ot},Symbol.toStringTag,{value:"Module"}));var Et=P('<div class="flex w-full items-center justify-between"><p> </p> <!></div>'),Nt=P(`<div><h3> </h3> <p class="text-xs text-secondary">Indexed fields used in a List Filter to filter a list of Workflow
            Executions.</p></div> <!>`,1),Lt=P('<div><!> <p class="text-xs text-secondary">Time to wait before dispatching the first workflow task.</p></div> <div class="flex flex-wrap items-center gap-2"><!> <p class="text-nowrap text-secondary"> </p></div>',1),Vt=P(`<div class="flex flex-wrap justify-between"><div><h3> </h3> <p class="text-xs text-secondary">Add context to Workflow Execution to help identity and understand
              its operations.</p></div> <p class="flex items-center gap-1 text-sm text-secondary"> <!></p></div> <!> <!> <!> <!>`,1),qt=P("<!> <!> <!>",1),Rt=P("<!> ",1),Mt=P('<div class="mt-2"><!></div>'),zt=P('<div class="flex w-full flex-col justify-between gap-2 sm:items-center md:flex-row md:gap-4"><!> <!></div> <div class="flex w-full items-center justify-between gap-4"><!></div> <!> <!> <!> <!> <div class="mt-4 flex w-full flex-row justify-between gap-4 max-sm:flex-col"><!> <!></div> <!> <!>',1),Bt=P('<div class="flex w-full flex-col gap-4 pb-20"><!> <h1 class="mb-4 overflow-hidden" data-testid="start-workflow">Start a Workflow</h1> <!></div>');function Ht(J,U){Me(U,!1);const[w,se]=He(),n=()=>oe(Je,"$page",w),O=()=>oe(e(ne),"$encoding",w),E=()=>oe(At,"$customSearchAttributes",w),me=()=>oe(It,"$workflowsSearchParams",w),T=i(),K=i(),we=i(),ve=i(),Ie=i(),Ue=Wt();let S=i(""),N=i(""),R=i(""),L=i(""),ae=i(""),le=i(""),ne=i(kt("json/plain")),ie=i(""),G=i(""),ge="",_e="",M=i(""),z=i(void 0),X=i(!1),Y=i([]);function Ke(a){var _,p;if(!a)return{};const o=a.match(/WorkflowId: (.+?), RunId: (.+?)\.?$/);if(!o)return{};const V=(_=o[1])===null||_===void 0?void 0:_.trim(),Q=(p=o[2])===null||p===void 0?void 0:p.trim();return!V||!Q?{}:{workflowId:V,runId:Q}}$t(()=>{r(S,n().url.searchParams.get("workflowId")||""),r(N,n().url.searchParams.get("taskQueue")||""),r(R,n().url.searchParams.get("workflowType")||""),ge=n().url.searchParams.get("workflowId")||"",_e=n().url.searchParams.get("workflowType")||"",(ge||_e)&&Ze(ge,_e)});const Ge=async()=>{try{r(M,"");const{runId:a}=await yt({namespace:e(T),workflowId:e(S),taskQueue:e(N),workflowType:e(R),input:e(L),summary:e(ae),details:e(le),encoding:O(),messageType:e(ie),searchAttributes:e(Y),identity:Ue,workflowStartDelay:Qt(e(G))});Ve.push({variant:"success",duration:5e3,message:d("workflows.start-workflow-success"),link:Oe({namespace:e(T),workflow:e(S),run:a})})}catch(a){r(M,(a==null?void 0:a.message)||d("workflows.start-workflow-error")),Ve.push({variant:"error",message:d("workflows.start-workflow-error")})}},Xe=()=>{r(S,Ft()),qe({parameter:"workflowId",value:e(S),url:n().url,allowEmpty:!0,options:{keepFocus:!0,noScroll:!0,replaceState:!0}})},Ye=async a=>{if(a){const{pollers:_}=await St({namespace:e(T),queue:a});r(z,_.length)}},Ze=async(a,_)=>{var p;const o=await bt({namespace:e(T),workflowId:a,workflowType:_});if(r(L,o.input),e(ne).set(o.encoding),r(ie,o.messageType),r(ae,o.summary),r(le,o.details),o!=null&&o.searchAttributes){const V=Object.keys(E());Object.entries(o.searchAttributes).forEach(([Q,Z])=>{V.includes(Q)&&r(Y,[...e(Y),{label:Q,value:Z,type:E()[Q]}])})}(Object.keys((p=o==null?void 0:o.searchAttributes)!==null&&p!==void 0?p:{}).length||o!=null&&o.summary||o!=null&&o.details)&&r(X,!0)},$e=(a,_)=>{const p=a.target.value;qe({parameter:_,value:p,url:n().url,allowEmpty:!0,options:{keepFocus:!0,noScroll:!0,replaceState:!0}})},et=a=>{try{return JSON.parse(a),!0}catch{return!1}};H(()=>(e(T),n()),()=>{(a=>r(T,a.namespace))(n().params)}),H(()=>e(M),()=>{r(K,Ke(e(M)))}),H(()=>n(),()=>{r(we,n().url.searchParams.get("taskQueue"))}),H(()=>e(L),()=>{r(ve,!e(L)||et(e(L)))}),H(()=>(e(S),e(N),e(R),e(ve),n()),()=>{r(Ie,!!e(S)&&!!e(N)&&!!e(R)&&!!e(ve)&&!Dt(n()))}),H(()=>e(we),()=>{Ye(e(we))}),wt(),Be();var ke=Bt(),Pe=u(ke);const tt=l(()=>`${Re({namespace:e(T)})}?${me()}`);be(Pe,{get href(){return e(tt)},"data-testid":"back-to-workflows",icon:"chevron-left",children:(a,_)=>{C();var p=re();D(o=>W(p,o),[()=>d("workflows.back-to-workflows")],l),f(a,p)},$$slots:{default:!0}});var rt=s(Pe,4);fe(rt,{class:"flex w-full flex-col gap-4 xl:w-3/4 2xl:w-1/2",children:(a,_)=>{var p=zt(),o=F(p),V=u(o);pe(V,{id:"workflowId",required:!0,label:"Workflow ID",class:"w-full grow",get value(){return e(S)},set value(t){r(S,t)},$$events:{blur:t=>$e(t,"workflowId")},$$legacy:!0});var Q=s(V,2);he(Q,{class:"mt-0 md:mt-6",variant:"secondary",leadingIcon:"retry",$$events:{click:Xe},children:(t,A)=>{C();var g=re("Random UUID");f(t,g)},$$slots:{default:!0}}),c(o);var Z=s(o,2),ot=u(Z);pe(ot,{id:"taskQueue",required:!0,label:"Task Queue",class:"grow",get value(){return e(N)},set value(t){r(N,t)},$$events:{blur:t=>$e(t,"taskQueue")},$$legacy:!0}),c(Z);var Te=s(Z,2);{var st=t=>{const A=l(()=>e(z)>0?"success":"warning"),g=l(()=>e(z)?"Task Queue is Active":"Task Queue is Inactive");Ee(t,{get intent(){return e(A)},get title(){return e(g)},children:(h,ue)=>{var y=Et(),I=u(y),v=u(I);c(I);var m=s(I,2);const $=l(()=>mt({namespace:e(T),queue:e(N)}));be(m,{get href(){return e($)},newTab:!0,children:(k,j)=>{C();var x=re("View Task Queue");f(k,x)},$$slots:{default:!0}}),c(y),D(k=>W(v,`${e(z)??""}
            ${k??""}`),[()=>Ct("Worker",e(z))],l),f(h,y)},$$slots:{default:!0}})};de(Te,t=>{e(z)!==void 0&&t(st)})}var Se=s(Te,2);pe(Se,{id:"workflowType",required:!0,label:"Workflow Type",get value(){return e(R)},set value(t){r(R,t)},$$events:{blur:t=>$e(t,"workflowType")},$$legacy:!0});var Ae=s(Se,2);ht(Ae,{get input(){return e(L)},set input(t){r(L,t)},get encoding(){return e(ne)},set encoding(t){gt(r(ne,t),"$encoding",w)},get messageType(){return e(ie)},set messageType(t){r(ie,t)},$$legacy:!0});var We=s(Ae,2);{var at=t=>{var A=qt(),g=F(A);fe(g,{class:"flex flex-col gap-2",children:(y,I)=>{var v=Nt(),m=F(v),$=u(m),k=u($,!0);c($),C(2),c(m);var j=s(m,2);const x=l(()=>d("common.add"));Pt(j,{get buttonCopy(){return e(x)},variant:"secondary",get attributesToAdd(){return e(Y)},set attributesToAdd(b){r(Y,b)},$$legacy:!0}),D(b=>W(k,b),[()=>d("search-attributes.custom-search-attributes")],l),f(y,v)},$$slots:{default:!0}});var h=s(g,2);fe(h,{class:"flex flex-col gap-2",children:(y,I)=>{var v=Lt(),m=F(v),$=u(m);const k=l(()=>d("workflows.workflow-start-delay"));ye($,{for:"workflow-start-delay",get label(){return e(k)},class:"text-xl"}),C(2),c(m);var j=s(m,2),x=u(j);const b=l(()=>d("workflows.workflow-start-delay")),ee=l(()=>isNaN(Number(e(G))));pe(x,{id:"workflow-start-delay",get label(){return e(b)},labelHidden:!0,suffix:"sec",class:"w-36",get error(){return e(ee)},get value(){return e(G)},set value(te){r(G,te)},$$legacy:!0});var B=s(x,2),ce=u(B,!0);c(B),c(j),D(te=>W(ce,te),[()=>jt(e(G))],l),f(y,v)},$$slots:{default:!0}});var ue=s(h,2);fe(ue,{class:"flex flex-col gap-2",children:(y,I)=>{var v=Vt(),m=F(v),$=u(m),k=u($),j=u(k,!0);c(k),C(2),c($);var x=s($,2),b=u(x),ee=s(b);const B=l(()=>d("workflows.markdown-description"));Tt(ee,{topRight:!0,width:200,get text(){return e(B)},children:(q,Fe)=>{Ne(q,{name:"info"})},$$slots:{default:!0}}),c(x),c(m);var ce=s(m,2);const te=l(()=>d("workflows.summary"));ye(ce,{get label(){return e(te)},for:"summary"});var Ce=s(ce,2);Le(Ce,{get content(){return e(ae)},set content(q){r(ae,q)},$$legacy:!0});var De=s(Ce,2);const dt=l(()=>d("workflows.details"));ye(De,{get label(){return e(dt)},for:"details"});var ft=s(De,2);Le(ft,{get content(){return e(le)},set content(q){r(le,q)},$$legacy:!0}),D((q,Fe)=>{W(j,q),W(b,`${Fe??""} `)},[()=>d("workflows.user-metadata"),()=>d("workflows.markdown-supported")],l),f(y,v)},$$slots:{default:!0}}),f(t,A)};de(We,t=>{e(X)&&t(at)})}var xe=s(We,2),Qe=u(xe);const lt=l(()=>e(X)?"chevron-up":"chevron-down");he(Qe,{variant:"ghost",class:"max-sm:w-full",get trailingIcon(){return e(lt)},$$events:{click:()=>r(X,!e(X))},children:(t,A)=>{C();var g=re();D(h=>W(g,h),[()=>d("common.more-options")],l),f(t,g)},$$slots:{default:!0}});var nt=s(Qe,2);const it=l(()=>!e(Ie));he(nt,{get disabled(){return e(it)},"data-testid":"start-workflow-button",class:"max-sm:w-full",$$events:{click:Ge},children:(t,A)=>{C();var g=re();D(h=>W(g,h),[()=>d("workflows.start-workflow")],l),f(t,g)},$$slots:{default:!0}}),c(xe);var je=s(xe,2);{var ut=t=>{Ee(t,{intent:"error",get title(){return e(M)},children:(A,g)=>{var h=vt(),ue=F(h);{var y=I=>{var v=Mt(),m=u(v);const $=l(()=>Oe({namespace:e(T),workflow:e(K).workflowId,run:e(K).runId}));be(m,{get href(){return e($)},class:"inline-flex items-center gap-1",children:(k,j)=>{var x=Rt(),b=F(x);Ne(b,{name:"external-link",class:"h-4 w-4"});var ee=s(b);D(B=>W(ee,` ${B??""}`),[()=>d("workflows.view-running-workflow")],l),f(k,x)},$$slots:{default:!0}}),c(v),f(I,v)};de(ue,I=>{e(K).workflowId&&e(K).runId&&I(y)})}f(A,h)},$$slots:{default:!0}})};de(je,t=>{e(M)&&t(ut)})}var ct=s(je,2);xt(ct,{}),f(a,p)},$$slots:{default:!0}}),c(ke),f(J,ke),ze(),se()}var Jt=P("<!> <!>",1);function Ar(J,U){Me(U,!1);const[w,se]=He(),n=()=>oe(Je,"$page",w);Be();var O=Jt(),E=F(O);_t(E,{title:"Start Workflow",get url(){return n().url.href}});var me=s(E,2);Ht(me,{}),f(J,O),ze(),se()}export{Ar as component,Sr as universal};
