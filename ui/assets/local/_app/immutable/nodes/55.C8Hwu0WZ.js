import"../chunks/CWj6FrbW.js";import"../chunks/69_IOA4Y.js";import{p as de,f as O,c as ce,t as h,e as _,b as me,k as M,G as a,L as r,g as t,o as E,j as u,h as i,s as d,m as T,n as A,r as f,l as ie,a as ke}from"../chunks/yn9lut7I.js";import{i as pe}from"../chunks/Bk16Yghv.js";import{p as g,s as ue,a as Z}from"../chunks/C6jR5PNA.js";import{g as B}from"../chunks/DNuXyELk.js";import{p as fe}from"../chunks/BrtlPyR9.js";import{P as De}from"../chunks/DUSMGXax.js";import{t as e}from"../chunks/DEjs8ZrU.js";import{s as p}from"../chunks/B95CcGmx.js";import{B as U}from"../chunks/CBuGS0h0.js";import{I as Ee}from"../chunks/D9AtNO5f.js";import{L as Te}from"../chunks/DNCniLTu.js";import{M as Ce}from"../chunks/Aq-AsWJm.js";import{N as Fe,e as Me}from"../chunks/B0l7bgzr.js";import{l as H,m as Ae}from"../chunks/BvjGwjVd.js";import{d as He,u as Ie}from"../chunks/DElJp4I9.js";import{n as Se}from"../chunks/BUY-kRRB.js";import{e as je}from"../chunks/DNj4cahJ.js";var ze=O('<h3 slot="title"> </h3>'),Re=O('<div slot="content" class="flex flex-col gap-4"><p> <strong class="select-all"> </strong> </p> <p> <strong class="select-all"> </strong> </p> <!></div>'),Ue=O('<div class="flex flex-col gap-8"><div class="relative flex flex-col gap-4 text-sm"><!></div> <div class="flex flex-col gap-1"><h1 data-testid="namespace-selector-title"> </h1></div> <!> <div class="flex w-full flex-row items-center justify-between gap-4 max-sm:flex-col xl:w-1/2"><div class="items-centeritems-center flex w-full flex-row gap-4 max-sm:flex-col"><!> <!></div> <!> <!></div></div> <!>',1);function Ze(q,o){de(o,!1);const P=()=>Z(fe,"$page",I),[I,L]=ue();let c=g(o,"endpoint",8),G=g(o,"targetNamespaceList",24,()=>[]),v=g(o,"callerNamespaceList",24,()=>[]),S=g(o,"onUpdate",8),j=g(o,"onDelete",8),y=g(o,"error",8,void 0),$=g(o,"loading",8,!1),J=g(o,"isCloud",8,!1),K=g(o,"nameRegexPattern",8,/^[a-zA-Z][a-zA-Z0-9-]*[a-zA-Z0-9]$/),z=g(o,"nameHintText",24,()=>e("nexus.endpoint-name-hint-with-dash")),N=T(!1),b=T("");pe();var n=Ue(),C=ce(n),k=u(C),ve=u(k);{let m=E(()=>(r(H),P(),a(()=>H(P().params.id))));Te(ve,{get href(){return t(m)},icon:"chevron-left",children:(x,l)=>{A();var s=M();h(D=>p(s,D),[()=>(r(e),a(()=>e("nexus.back-to-endpoint")))]),_(x,s)},$$slots:{default:!0}})}f(k);var Q=i(k,2),ae=u(Q),ge=u(ae,!0);f(ae),f(Q);var re=i(Q,2);Fe(re,{get endpoint(){return c()},get nameHintText(){return z()},get nameRegexPattern(){return K()},get targetNamespaceList(){return G()},get callerNamespaceList(){return v()},get error(){return y()},get isCloud(){return J()},nameDisabled:!0});var ne=i(re,2),V=u(ne),se=u(V);U(se,{class:"max-sm:w-full",get loading(){return $()},$$events:{click(...m){var x;(x=S())==null||x.apply(this,m)}},children:(m,x)=>{A();var l=M();h(s=>p(l,s),[()=>(r(e),a(()=>e("common.save")))]),_(m,l)},$$slots:{default:!0}});var xe=i(se,2);U(xe,{class:"max-sm:hidden",variant:"ghost",$$events:{click:()=>B(H(P().params.id))},children:(m,x)=>{A();var l=M();h(s=>p(l,s),[()=>(r(e),a(()=>e("common.cancel")))]),_(m,l)},$$slots:{default:!0}}),f(V);var oe=i(V,2);U(oe,{class:"max-sm:w-full",variant:"destructive",$$events:{click:()=>d(N,!0)},children:(m,x)=>{A();var l=M();h(s=>p(l,s),[()=>(r(e),a(()=>e("common.delete")))]),_(m,l)},$$slots:{default:!0}});var _e=i(oe,2);U(_e,{class:"w-full sm:hidden",variant:"ghost",$$events:{click:()=>B(H(P().params.id))},children:(m,x)=>{A();var l=M();h(s=>p(l,s),[()=>(r(e),a(()=>e("common.cancel")))]),_(m,l)},$$slots:{default:!0}}),f(ne),f(C);var $e=i(C,2);{let m=E(()=>(r(e),a(()=>e("common.delete")))),x=E(()=>(r(e),a(()=>e("common.cancel")))),l=E(()=>(t(b),r(c()),a(()=>t(b)!==c().spec.name)));Ce($e,{id:"delete-endpoint-modal",get loading(){return $()},confirmType:"destructive",get confirmText(){return t(m)},get cancelText(){return t(x)},get confirmDisabled(){return t(l)},get open(){return t(N)},set open(s){d(N,s)},$$events:{confirmModal(...s){var D;(D=j())==null||D.apply(this,s)},cancelModal:()=>d(N,!1)},$$slots:{title:(s,D)=>{var w=ze(),F=u(w,!0);f(w),h(R=>p(F,R),[()=>(r(e),a(()=>e("nexus.delete-modal-title")))]),_(s,w)},content:(s,D)=>{var w=Re(),F=u(w),R=u(F),W=i(R),he=u(W,!0);f(W);var ye=i(W);f(F);var X=i(F,2),le=u(X),Y=i(le),Ne=u(Y,!0);f(Y);var we=i(Y);f(X);var Pe=i(X,2);{let ee=E(()=>(r(e),a(()=>e("nexus.delete-endpoint"))));Ee(Pe,{id:"delete-endpoint",labelHidden:!0,get label(){return t(ee)},get value(){return t(b)},set value(te){d(b,te)},$$legacy:!0})}f(w),h((ee,te,Le,be)=>{p(R,`${ee??""} `),p(he,(r(c()),a(()=>c().spec.name))),p(ye,`?
      ${te??""}`),p(le,`${Le??""} `),p(Ne,(r(c()),a(()=>c().spec.name))),p(we,` ${be??""}`)},[()=>(r(e),a(()=>e("nexus.delete-modal-confirmation-preface"))),()=>(r(e),a(()=>e("nexus.delete-modal-confirmation-postface"))),()=>(r(e),a(()=>e("nexus.type-confirm-preface"))),()=>(r(e),a(()=>e("nexus.type-confirm-postface")))]),_(s,w)}},$$legacy:!0})}h(()=>p(ge,(r(c()),a(()=>c().spec.name)))),_(q,n),me(),L()}var Be=O("<!> <!>",1);function dt(q,o){de(o,!1);const P=()=>Z(Me,"$endpointForm",c),I=()=>Z(Se,"$namespaces",c),L=()=>Z(fe,"$page",c),[c,G]=ue(),v=T(),S=T();let j=g(o,"data",8),y=T(void 0),$=T(!1);const J=async()=>{d(y,void 0),d($,!0);const n={...P()};n.id=t(v).id,n.version=t(v).version;const C=await je({input:JSON.stringify(n.spec.descriptionString),encoding:"json/plain"});n.spec.description=C[0],delete n.spec.allowedCallerNamespaces,delete n.spec.descriptionString;try{await Ie(t(v).id,n),B(H(t(v).id),{invalidateAll:!0})}catch(k){d(y,k),console.error("Error updating endpoint",k)}finally{d($,!1)}},K=async()=>{d(y,void 0),d($,!0);try{await He(t(v).id,String(t(v).version)),B(Ae())}catch(n){d(y,n),console.error("Error deleting endpoint",n)}finally{d($,!1)}};ie(()=>(t(v),r(j())),()=>{(n=>{d(v,n.endpoint)})(j())}),ie(()=>I(),()=>{d(S,I().map(n=>({namespace:n.namespaceInfo.name})))}),ke(),pe();var z=Be(),N=ce(z);{let n=E(()=>(r(e),L(),a(()=>`Edit ${e("nexus.nexus-endpoint",{id:L().params.id})}`)));De(N,{get title(){return t(n)},get url(){return L(),a(()=>L().url.href)}})}var b=i(N,2);Ze(b,{get endpoint(){return t(v)},get loading(){return t($)},get targetNamespaceList(){return t(S)},onUpdate:J,onDelete:K,get error(){return t(y)}}),_(q,z),me(),G()}export{dt as component};
