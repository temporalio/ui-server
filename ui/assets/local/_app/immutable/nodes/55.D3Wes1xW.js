import"../chunks/Bzak7iHL.js";import"../chunks/69_IOA4Y.js";import{p as ne,t as R,f as se,i as m,r as u,c as l,j as $,e as g,b as oe,n as k,k as D,o as c,g as t,s as i,m as N,l as re,a as ke,L as De}from"../chunks/kQSYtCfc.js";import{i as le}from"../chunks/mtgEvp4k.js";import{p as v,s as ie,a as I}from"../chunks/BLseHJlf.js";import{g as z}from"../chunks/DfcffXfF.js";import{p as de}from"../chunks/CCUe2pQz.js";import{P as Ee}from"../chunks/BW5xTiVz.js";import{t as s}from"../chunks/BXv1jDVW.js";import{s as d}from"../chunks/DFbJB1Uf.js";import{B as H}from"../chunks/Csdr1G1k.js";import{I as Te}from"../chunks/DAfWSNBC.js";import{L as Ce}from"../chunks/BEi1tdtZ.js";import{M as Fe}from"../chunks/sJYVMbZm.js";import{N as Me,e as je}from"../chunks/B6r5ZRZQ.js";import{j as S,k as Ae}from"../chunks/DKzLdZAB.js";import{d as He,u as Ie}from"../chunks/CiC9TiUT.js";import{n as Se}from"../chunks/CeeR6zvM.js";import{e as ze}from"../chunks/aGok4QR-.js";var Re=R('<h3 slot="title"> </h3>'),Ue=R('<div slot="content" class="flex flex-col gap-4"><p> <strong class="select-all"> </strong> </p> <p> <strong class="select-all"> </strong> </p> <!></div>'),Ze=R('<div class="flex flex-col gap-8"><div class="relative flex flex-col gap-4 text-sm"><!></div> <div class="flex flex-col gap-1"><h1 data-testid="namespace-selector-title"> </h1></div> <!> <div class="flex w-full flex-row items-center justify-between gap-4 max-sm:flex-col xl:w-1/2"><div class="items-centeritems-center flex w-full flex-row gap-4 max-sm:flex-col"><!> <!></div> <!> <!></div></div> <!>',1);function Be(U,o){ne(o,!1);const[w,Z]=ie(),P=()=>I(de,"$page",w);let x=v(o,"endpoint",8),E=v(o,"targetNamespaceList",24,()=>[]),f=v(o,"callerNamespaceList",24,()=>[]),T=v(o,"onUpdate",8),C=v(o,"onDelete",8),h=v(o,"error",8,void 0),_=v(o,"loading",8,!1),B=v(o,"isCloud",8,!1),O=v(o,"nameRegexPattern",8,/^[a-zA-Z][a-zA-Z0-9-]*[a-zA-Z0-9]$/),F=v(o,"nameHintText",24,()=>s("nexus.endpoint-name-hint-with-dash")),y=N(!1),L=N("");le();var M=Ze(),r=se(M),b=m(r),j=m(b);const ce=c(()=>S(P().params.id));Ce(j,{get href(){return t(ce)},icon:"chevron-left",children:(a,p)=>{k();var e=D();$(n=>d(e,n),[()=>s("nexus.back-to-endpoint")],c),g(a,e)},$$slots:{default:!0}}),u(b);var q=l(b,2),W=m(q),pe=m(W,!0);u(W),u(q);var X=l(q,2);Me(X,{get endpoint(){return x()},get nameHintText(){return F()},get nameRegexPattern(){return O()},get targetNamespaceList(){return E()},get callerNamespaceList(){return f()},get error(){return h()},get isCloud(){return B()},nameDisabled:!0});var Y=l(X,2),J=m(Y),ee=m(J);H(ee,{class:"max-sm:w-full",get loading(){return _()},$$events:{click(...a){var p;(p=T())==null||p.apply(this,a)}},children:(a,p)=>{k();var e=D();$(n=>d(e,n),[()=>s("common.save")],c),g(a,e)},$$slots:{default:!0}});var me=l(ee,2);H(me,{class:"max-sm:hidden",variant:"ghost",$$events:{click:()=>z(S(P().params.id))},children:(a,p)=>{k();var e=D();$(n=>d(e,n),[()=>s("common.cancel")],c),g(a,e)},$$slots:{default:!0}}),u(J);var te=l(J,2);H(te,{class:"max-sm:w-full",variant:"destructive",$$events:{click:()=>i(y,!0)},children:(a,p)=>{k();var e=D();$(n=>d(e,n),[()=>s("common.delete")],c),g(a,e)},$$slots:{default:!0}});var ue=l(te,2);H(ue,{class:"w-full sm:hidden",variant:"ghost",$$events:{click:()=>z(S(P().params.id))},children:(a,p)=>{k();var e=D();$(n=>d(e,n),[()=>s("common.cancel")],c),g(a,e)},$$slots:{default:!0}}),u(Y),u(r);var fe=l(r,2);const ve=c(()=>s("common.delete")),ge=c(()=>s("common.cancel")),xe=c(()=>t(L)!==x().spec.name);Fe(fe,{id:"delete-endpoint-modal",get loading(){return _()},confirmType:"destructive",get confirmText(){return t(ve)},get cancelText(){return t(ge)},get confirmDisabled(){return t(xe)},get open(){return t(y)},set open(a){i(y,a)},$$events:{confirmModal(...a){var p;(p=C())==null||p.apply(this,a)},cancelModal:()=>i(y,!1)},$$slots:{title:(a,p)=>{var e=Re(),n=m(e,!0);u(e),$(A=>d(n,A),[()=>s("nexus.delete-modal-title")],c),g(a,e)},content:(a,p)=>{var e=Ue(),n=m(e),A=m(n),G=l(A),_e=m(G,!0);u(G);var $e=l(G);u(n);var K=l(n,2),ae=m(K),Q=l(ae),he=m(Q,!0);u(Q);var ye=l(Q);u(K);var Ne=l(K,2);const we=c(()=>s("nexus.delete-endpoint"));Te(Ne,{id:"delete-endpoint",labelHidden:!0,get label(){return t(we)},get value(){return t(L)},set value(V){i(L,V)},$$legacy:!0}),u(e),$((V,Pe,Le,be)=>{d(A,`${V??""} `),d(_e,x().spec.name),d($e,`?
      ${Pe??""}`),d(ae,`${Le??""} `),d(he,x().spec.name),d(ye,` ${be??""}`)},[()=>s("nexus.delete-modal-confirmation-preface"),()=>s("nexus.delete-modal-confirmation-postface"),()=>s("nexus.type-confirm-preface"),()=>s("nexus.type-confirm-postface")],c),g(a,e)}},$$legacy:!0}),$(()=>d(pe,x().spec.name)),g(U,M),oe(),Z()}var Oe=R("<!> <!>",1);function ct(U,o){ne(o,!1);const[w,Z]=ie(),P=()=>I(je,"$endpointForm",w),x=()=>I(Se,"$namespaces",w),E=()=>I(de,"$page",w),f=N(),T=N();let C=v(o,"data",8),h=N(void 0),_=N(!1);const B=async()=>{i(h,void 0),i(_,!0);const r={...P()};r.id=t(f).id,r.version=t(f).version;const b=await ze({input:JSON.stringify(r.spec.descriptionString),encoding:"json/plain"});r.spec.description=b[0],delete r.spec.allowedCallerNamespaces,delete r.spec.descriptionString;try{await Ie(t(f).id,r),z(S(t(f).id),{invalidateAll:!0})}catch(j){i(h,j),console.error("Error updating endpoint",j)}finally{i(_,!1)}},O=async()=>{i(h,void 0),i(_,!0);try{await He(t(f).id,String(t(f).version)),z(Ae())}catch(r){i(h,r),console.error("Error deleting endpoint",r)}finally{i(_,!1)}};re(()=>(t(f),De(C())),()=>{(r=>i(f,r.endpoint))(C())}),re(()=>x(),()=>{i(T,x().map(r=>({namespace:r.namespaceInfo.name})))}),ke(),le();var F=Oe(),y=se(F);const L=c(()=>`Edit ${s("nexus.nexus-endpoint",{id:E().params.id})}`);Ee(y,{get title(){return t(L)},get url(){return E().url.href}});var M=l(y,2);Be(M,{get endpoint(){return t(f)},get loading(){return t(_)},get targetNamespaceList(){return t(T)},onUpdate:B,onDelete:O,get error(){return t(h)}}),g(U,F),oe(),Z()}export{ct as component};
