import"../chunks/Bzak7iHL.js";import"../chunks/69_IOA4Y.js";import{p as I,l as J,a as O,t as Q,i as y,r as w,c as g,j as L,e as x,b as G,n as T,k as Z,o,g as l,m as k,s as v,f as ee}from"../chunks/DtSMpxPp.js";import{i as K}from"../chunks/DM92YGvC.js";import{p as s,s as M,a as b}from"../chunks/QkTQNHha.js";import{g as U}from"../chunks/DUl7uQ-q.js";import{p as te}from"../chunks/DHxFbjFE.js";import{P as ae}from"../chunks/zuYibhCe.js";import{t as i}from"../chunks/BXv1jDVW.js";import{s as P}from"../chunks/ChP_J8fE.js";import{B as D}from"../chunks/BJPM8eFE.js";import{L as re}from"../chunks/i-CQMyez.js";import{N as se,e as V}from"../chunks/BMv92wxD.js";import{l as j}from"../chunks/DTzU9ntS.js";import{c as ne}from"../chunks/BZqhFDd9.js";import{n as oe}from"../chunks/DX2FGlsP.js";import{e as ie}from"../chunks/BF3LjO4Q.js";var le=Q('<div class="flex w-full flex-col gap-8"><div class="text-sm"><!></div> <h1 data-testid="namespace-selector-title"> </h1> <!> <div class="flex flex-row items-center gap-4 max-sm:flex-col"><!> <!></div></div>');function ce(C,t){I(t,!1);const[c,F]=M(),n=()=>b(V,"$endpointForm",c),m=k();let A=s(t,"onCreate",8),_=s(t,"targetNamespaceList",24,()=>[]),$=s(t,"callerNamespaceList",24,()=>[]),p=s(t,"error",8,void 0),z=s(t,"loading",8,!1),h=s(t,"isCloud",8,!1),N=s(t,"nameRegexPattern",8,/^[a-zA-Z][a-zA-Z0-9-]*[a-zA-Z0-9]$/),H=s(t,"nameHintText",24,()=>i("nexus.endpoint-name-hint-with-dash"));J(()=>n(),()=>{v(m,n().spec.name===""||n().spec.target.worker.namespace===""||n().spec.target.worker.taskQueue==="")}),O(),K();var d=le(),e=y(d),R=y(e);const W=o(j);re(R,{get href(){return l(W)},icon:"chevron-left",children:(a,u)=>{T();var r=Z();L(f=>P(r,f),[()=>i("nexus.back-to-endpoints")],o),x(a,r)},$$slots:{default:!0}}),w(e);var S=g(e,2),X=y(S,!0);w(S);var B=g(S,2);se(B,{get nameRegexPattern(){return N()},get nameHintText(){return H()},get error(){return p()},get targetNamespaceList(){return _()},get callerNamespaceList(){return $()},get isCloud(){return h()}});var E=g(B,2),q=y(E);D(q,{variant:"primary",get disabled(){return l(m)},class:"max-sm:w-full",get loading(){return z()},$$events:{click(...a){var u;(u=A())==null||u.apply(this,a)}},children:(a,u)=>{T();var r=Z();L(f=>P(r,f),[()=>i("nexus.create-endpoint")],o),x(a,r)},$$slots:{default:!0}});var Y=g(q,2);D(Y,{variant:"ghost",class:"max-sm:w-full",$$events:{click:()=>U(j())},children:(a,u)=>{T();var r=Z();L(f=>P(r,f),[()=>i("common.cancel")],o),x(a,r)},$$slots:{default:!0}}),w(E),w(d),L(a=>P(X,a),[()=>i("nexus.create-endpoint")],o),x(C,d),G(),F()}var me=Q("<!> <!>",1);function Ce(C,t){I(t,!1);const[c,F]=M(),n=()=>b(V,"$endpointForm",c),m=()=>b(oe,"$namespaces",c),A=()=>b(te,"$page",c),_=k();let $=k(void 0),p=k(!1);const z=async()=>{v(p,!0);try{const e={...n()},R=await ie({input:JSON.stringify(e.spec.descriptionString),encoding:"json/plain"});e.spec.description=R[0],delete e.spec.allowedCallerNamespaces,delete e.spec.descriptionString,await ne(e),U(j(),{invalidateAll:!0})}catch(e){v($,e),console.error("Error creating endpoint",e)}finally{v(p,!1)}};J(()=>m(),()=>{v(_,m().map(e=>({namespace:e.namespaceInfo.name})))}),O(),K();var h=me(),N=ee(h);const H=o(()=>i("nexus.create-endpoint"));ae(N,{get title(){return l(H)},get url(){return A().url.href}});var d=g(N,2);ce(d,{onCreate:z,get targetNamespaceList(){return l(_)},get error(){return l($)},get loading(){return l(p)}}),x(C,h),G(),F()}export{Ce as component};
