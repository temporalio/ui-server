import"../chunks/CWj6FrbW.js";import"../chunks/69_IOA4Y.js";import{p as G,l as I,a as J,f as O,t as w,e as g,b as Q,k as Z,G as n,L as p,g as d,o as K,j as k,h as v,m as C,s as x,n as j,r as P,c as ae}from"../chunks/yn9lut7I.js";import{i as M}from"../chunks/Bk16Yghv.js";import{p as s,s as U,a as F}from"../chunks/C6jR5PNA.js";import{g as V}from"../chunks/DNuXyELk.js";import{p as re}from"../chunks/BrtlPyR9.js";import{P as se}from"../chunks/DUSMGXax.js";import{t as a}from"../chunks/DEjs8ZrU.js";import{s as b}from"../chunks/B95CcGmx.js";import{B as D}from"../chunks/CBuGS0h0.js";import{L as ne}from"../chunks/DNCniLTu.js";import{N as oe,e as W}from"../chunks/B0l7bgzr.js";import{m as A}from"../chunks/BvjGwjVd.js";import{c as ie}from"../chunks/DElJp4I9.js";import{n as le}from"../chunks/BUY-kRRB.js";import{e as ce}from"../chunks/DNj4cahJ.js";var me=O('<div class="flex w-full flex-col gap-8"><div class="text-sm"><!></div> <h1 data-testid="namespace-selector-title"> </h1> <!> <div class="flex flex-row items-center gap-4 max-sm:flex-col"><!> <!></div></div>');function pe(z,t){G(t,!1);const o=()=>F(W,"$endpointForm",_),[_,$]=U(),i=C();let H=s(t,"onCreate",8),h=s(t,"targetNamespaceList",24,()=>[]),N=s(t,"callerNamespaceList",24,()=>[]),u=s(t,"error",8,void 0),R=s(t,"loading",8,!1),y=s(t,"isCloud",8,!1),L=s(t,"nameRegexPattern",8,/^[a-zA-Z][a-zA-Z0-9-]*[a-zA-Z0-9]$/),S=s(t,"nameHintText",24,()=>a("nexus.endpoint-name-hint-with-dash"));I(()=>o(),()=>{x(i,o().spec.name===""||o().spec.target.worker.namespace===""||o().spec.target.worker.taskQueue==="")}),J(),M();var e=me(),f=k(e),X=k(f);{let r=K(()=>(p(A),n(A)));ne(X,{get href(){return d(r)},icon:"chevron-left",children:(l,c)=>{j();var m=Z();w(te=>b(m,te),[()=>(p(a),n(()=>a("nexus.back-to-endpoints")))]),g(l,m)},$$slots:{default:!0}})}P(f);var T=v(f,2),Y=k(T,!0);P(T);var B=v(T,2);oe(B,{get nameRegexPattern(){return L()},get nameHintText(){return S()},get error(){return u()},get targetNamespaceList(){return h()},get callerNamespaceList(){return N()},get isCloud(){return y()}});var E=v(B,2),q=k(E);D(q,{variant:"primary",get disabled(){return d(i)},class:"max-sm:w-full",get loading(){return R()},$$events:{click(...r){var l;(l=H())==null||l.apply(this,r)}},children:(r,l)=>{j();var c=Z();w(m=>b(c,m),[()=>(p(a),n(()=>a("nexus.create-endpoint")))]),g(r,c)},$$slots:{default:!0}});var ee=v(q,2);D(ee,{variant:"ghost",class:"max-sm:w-full",$$events:{click:()=>V(A())},children:(r,l)=>{j();var c=Z();w(m=>b(c,m),[()=>(p(a),n(()=>a("common.cancel")))]),g(r,c)},$$slots:{default:!0}}),P(E),P(e),w(r=>b(Y,r),[()=>(p(a),n(()=>a("nexus.create-endpoint")))]),g(z,e),Q(),$()}var de=O("<!> <!>",1);function Ae(z,t){G(t,!1);const o=()=>F(W,"$endpointForm",i),_=()=>F(le,"$namespaces",i),$=()=>F(re,"$page",i),[i,H]=U(),h=C();let N=C(void 0),u=C(!1);const R=async()=>{x(u,!0);try{const e={...o()},f=await ce({input:JSON.stringify(e.spec.descriptionString),encoding:"json/plain"});e.spec.description=f[0],delete e.spec.allowedCallerNamespaces,delete e.spec.descriptionString,await ie(e),V(A(),{invalidateAll:!0})}catch(e){x(N,e),console.error("Error creating endpoint",e)}finally{x(u,!1)}};I(()=>_(),()=>{x(h,_().map(e=>({namespace:e.namespaceInfo.name})))}),J(),M();var y=de(),L=ae(y);{let e=K(()=>(p(a),n(()=>a("nexus.create-endpoint"))));se(L,{get title(){return d(e)},get url(){return $(),n(()=>$().url.href)}})}var S=v(L,2);pe(S,{onCreate:R,get targetNamespaceList(){return d(h)},get error(){return d(N)},get loading(){return d(u)}}),g(z,y),Q(),H()}export{Ae as component};
