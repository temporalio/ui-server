import"../chunks/CWj6FrbW.js";import"../chunks/69_IOA4Y.js";import{p as I,l as J,a as O,t as Q,h as y,r as w,c as g,i as L,d as x,b as G,n as T,k as Z,j as o,g as l,m as P,s as v,f as ee}from"../chunks/DSxqszTl.js";import{i as K}from"../chunks/BcaHj5WR.js";import{s as M,a as b}from"../chunks/CZBNCVvj.js";import{g as U}from"../chunks/DDukZy37.js";import{p as te}from"../chunks/CVrxQ_Mz.js";import{P as ae}from"../chunks/DTWo_ajL.js";import{t as i}from"../chunks/D2OY9xdY.js";import{s as k}from"../chunks/CXaSvchK.js";import{p as s}from"../chunks/Bp73-jql.js";import{B as D}from"../chunks/CBoME8rl.js";import{L as re}from"../chunks/ibexB0ny.js";import{N as se,e as V}from"../chunks/CrHPmuCy.js";import{k as j}from"../chunks/B_w_y9vZ.js";import{c as ne}from"../chunks/B-StX_N4.js";import{n as oe}from"../chunks/BeYH7yPO.js";import{e as ie}from"../chunks/DgkxNWBT.js";var le=Q('<div class="flex w-full flex-col gap-8"><div class="text-sm"><!></div> <h1 data-testid="namespace-selector-title"> </h1> <!> <div class="flex flex-row items-center gap-4 max-sm:flex-col"><!> <!></div></div>');function ce(C,t){I(t,!1);const[c,F]=M(),n=()=>b(V,"$endpointForm",c),m=P();let A=s(t,"onCreate",8),_=s(t,"targetNamespaceList",24,()=>[]),h=s(t,"callerNamespaceList",24,()=>[]),p=s(t,"error",8,void 0),z=s(t,"loading",8,!1),$=s(t,"isCloud",8,!1),N=s(t,"nameRegexPattern",8,/^[a-zA-Z][a-zA-Z0-9-]*[a-zA-Z0-9]$/),H=s(t,"nameHintText",24,()=>i("nexus.endpoint-name-hint-with-dash"));J(()=>n(),()=>{v(m,n().spec.name===""||n().spec.target.worker.namespace===""||n().spec.target.worker.taskQueue==="")}),O(),K();var d=le(),e=y(d),R=y(e);const W=o(j);re(R,{get href(){return l(W)},icon:"chevron-left",children:(a,u)=>{T();var r=Z();L(f=>k(r,f),[()=>i("nexus.back-to-endpoints")],o),x(a,r)},$$slots:{default:!0}}),w(e);var S=g(e,2),X=y(S,!0);w(S);var B=g(S,2);se(B,{get nameRegexPattern(){return N()},get nameHintText(){return H()},get error(){return p()},get targetNamespaceList(){return _()},get callerNamespaceList(){return h()},get isCloud(){return $()}});var E=g(B,2),q=y(E);D(q,{variant:"primary",get disabled(){return l(m)},class:"max-sm:w-full",get loading(){return z()},$$events:{click(...a){var u;(u=A())==null||u.apply(this,a)}},children:(a,u)=>{T();var r=Z();L(f=>k(r,f),[()=>i("nexus.create-endpoint")],o),x(a,r)},$$slots:{default:!0}});var Y=g(q,2);D(Y,{variant:"ghost",class:"max-sm:w-full",$$events:{click:()=>U(j())},children:(a,u)=>{T();var r=Z();L(f=>k(r,f),[()=>i("common.cancel")],o),x(a,r)},$$slots:{default:!0}}),w(E),w(d),L(a=>k(X,a),[()=>i("nexus.create-endpoint")],o),x(C,d),G(),F()}var me=Q("<!> <!>",1);function Fe(C,t){I(t,!1);const[c,F]=M(),n=()=>b(V,"$endpointForm",c),m=()=>b(oe,"$namespaces",c),A=()=>b(te,"$page",c),_=P();let h=P(void 0),p=P(!1);const z=async()=>{v(p,!0);try{const e={...n()},R=await ie({input:JSON.stringify(e.spec.descriptionString),encoding:"json/plain"});e.spec.description=R[0],delete e.spec.allowedCallerNamespaces,delete e.spec.descriptionString,await ne(e),U(j(),{invalidateAll:!0})}catch(e){v(h,e),console.error("Error creating endpoint",e)}finally{v(p,!1)}};J(()=>m(),()=>{v(_,m().map(e=>({namespace:e.namespaceInfo.name})))}),O(),K();var $=me(),N=ee($);const H=o(()=>i("nexus.create-endpoint"));ae(N,{get title(){return l(H)},get url(){return A().url.href}});var d=g(N,2);ce(d,{onCreate:z,get targetNamespaceList(){return l(_)},get error(){return l(h)},get loading(){return l(p)}}),x(C,$),G(),F()}export{Fe as component};
