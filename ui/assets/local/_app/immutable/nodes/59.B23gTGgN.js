import"../chunks/CWj6FrbW.js";import"../chunks/69_IOA4Y.js";import{p as Tt,l as x,a as Qt,i as Rt,c as J,e as w,b as It,M as k,g as t,m as y,s as d,f as Pt,j as W,o as I,r as H,t as q,I as M,av as wt,bK as pt,h as g,n as oe,ac as Oe,v as a,d as ze,u as Me,at as ie,aQ as je,q as ye,k as Ut}from"../chunks/BzuLCQNf.js";import{i as Gt}from"../chunks/W-5sOwmb.js";import{p,s as Bt,a as st,b as Yt,l as fe}from"../chunks/DdNojIXk.js";import{p as de}from"../chunks/Ddb5Lgoz.js";import{P as Fe}from"../chunks/BX5rdQWZ.js";import{t as ot}from"../chunks/DEjs8ZrU.js";import{s as ft,d as Ue,e as Zt}from"../chunks/HOnlAALn.js";import{s as Nt,c as Re}from"../chunks/wWuJlbLq.js";import{b as Ce,g as me}from"../chunks/Cb0YGjUm.js";import{L as At,D as ee,a as Ne,E as Be}from"../chunks/DalMAARF.js";import{s as be,a as xe,b as qe,I as Ve,D as Xe,E as Ye,c as Je}from"../chunks/CLBRuGhH.js";import{i as nt}from"../chunks/Be-bjpec.js";import{k as ce}from"../chunks/B6WYOvS7.js";import{e as ve,i as ke}from"../chunks/DHcq7Esf.js";import{s as A,b as Ke}from"../chunks/Brfhuxqj.js";import{b as $e}from"../chunks/DqfiMSJy.js";import{t as Qe}from"../chunks/pi-WXkM0.js";import{p as Jt,g as Ze,f as tr,e as se,b as er}from"../chunks/D3M6aU_b.js";import{i as le}from"../chunks/Dzb719w0.js";import{a as rr,T as Ct,h as nr,d as ar,M as or,C as pe,t as ir}from"../chunks/DzT2JAAi.js";import{a as sr,o as lr}from"../chunks/SxBBeV83.js";import{s as dr}from"../chunks/D7yhRzLA.js";import{p as te,j as Te}from"../chunks/vp2td3Dl.js";import{W as cr}from"../chunks/B1S_w4vZ.js";import{B as vr}from"../chunks/zCHRLhNX.js";import{I as Kt}from"../chunks/CKL6Zfw6.js";import{J as he,q as ur,p as gr}from"../chunks/ChkBNbMB.js";import{a as fr}from"../chunks/D-F-0Ojj.js";import{g as Ie}from"../chunks/rd2aUq1f.js";import{f as mr}from"../chunks/CO6fuA-C.js";import{v as pr}from"../chunks/q1vSednF.js";import{c as hr}from"../chunks/BvcST-tr.js";import{p as _e}from"../chunks/BawWSvJ3.js";import{a as _r}from"../chunks/ewzzm9Vv.js";import{b as wr}from"../chunks/BtufP36q.js";import{T as yr,a as ae}from"../chunks/Bqj2UW4L.js";import{w as br}from"../chunks/BGTvKxEd.js";import{u as we,p as xr}from"../chunks/DCgAVtT5.js";function kr(V,e){Tt(e,!1);const f=()=>st(Jt,"$pauseLiveUpdates",O),[O,_]=Bt(),l=y(),v=y();let o=p(e,"workflow",8),i=p(e,"startTime",8);const T=()=>{const s=new Date;return s.setSeconds(s.getSeconds()+1),s};let n;const $=s=>{s&&(clearInterval(n),n=null)},m=s=>{s?(clearInterval(n),n=null):!n&&o().isRunning&&(n=setInterval(()=>{d(l,T())},1e3))};sr(()=>{clearInterval(n),n=null,Yt(Jt,!1)}),x(()=>k(o()),()=>{d(l,(o()===null||o()===void 0?void 0:o().endTime)||T())}),x(()=>(k(i()),t(l)),()=>{d(v,te({start:i(),end:t(l),onlyUnderSecond:!1}))}),x(()=>k(o()),()=>{$(o().endTime)}),x(()=>f(),()=>{m(f())}),Qt(),Gt();var u=Rt(),r=J(u);dr(r,e,"default",{get endTime(){return t(l)},get duration(){return t(v)}},null),w(V,u),It(),_()}var $r=Pt("<div><!></div>");function Tr(V,e){const f=fe(e,["children","$$slots","$$events","$$legacy"]),O=fe(f,["namespace","workflowId","runId","viewportHeight","onLoad"]);Tt(e,!1);let _=p(e,"namespace",8),l=p(e,"workflowId",8),v=p(e,"runId",8,""),o=p(e,"viewportHeight",8,360),i=p(e,"onLoad",8,()=>{});const T=async()=>{const[u,r]=await Promise.all([pr({namespace:_(),workflowId:l(),runId:v()}),mr({namespace:_(),workflowId:l(),runId:v()})]);return{workflow:u.workflow,history:r}},n=(u,r)=>{var s;i()();const c=(s=u==null?void 0:u.pendingActivities)!==null&&s!==void 0?s:[];return Ie(r,"ascending",c)};Gt();var $=Rt(),m=J($);fr(m,()=>M(T),null,(u,r)=>{var s=I(()=>{var{workflow:S,history:j}=t(r);return{workflow:S,history:j}}),c=I(()=>t(s).workflow),h=I(()=>t(s).history),P=$r(),N=W(P);{let S=I(()=>(k(t(c)),k(t(h)),M(()=>n(t(c),t(h)))));Pe(N,{get viewportHeight(){return o()},get workflow(){return t(c)},get groups(){return t(S)},readOnly:!0})}H(P),q(()=>Nt(P,1,`cursor-pointer overflow-auto ${k(O),M(()=>O.class)??""}`)),w(u,P)}),w(V,$),It()}var Ir=Pt('<div class="flex items-center gap-1"><!> </div>'),Pr=Pt(" <!>",1),Er=Pt('<div class="surface-primary p-4"><div class="font-medium leading-4 text-secondary">Child Workflow</div> <!></div>'),Wr=pt('<g role="button" tabindex="0" class="relative z-50 svelte-1qsv8v3"><foreignObject><div class="flex flex-col"><div class="relative flex h-full items-center justify-between bg-slate-50 text-sm dark:bg-slate-800"><div class="flex h-full items-center gap-4 px-2"><!> <!></div> <div class="flex items-center gap-4"><!></div></div> <div class="surface-primary"><!></div> <!></div></foreignObject></g>');function Hr(V,e){Tt(e,!1);const f=()=>st(de,"$page",O),[O,_]=Bt(),l=y(),v=y(),o=y(),i=y(),T=y(),n=y(),$=y();var m=y(),u=y();let r=p(e,"group",8),s=p(e,"canvasWidth",8),c=p(e,"x",8,0),h=p(e,"y",8),P=y();const N=E=>{Yt(xe,E)},S=async()=>{await Oe(),d(l,t(P))};x(()=>t(P),()=>{d(l,t(P)||0)}),x(()=>t(l),()=>{N(t(l)||0)}),x(()=>k(r()),()=>{d(v,(r()===null||r()===void 0?void 0:r().finalClassification)||(r()===null||r()===void 0?void 0:r().classification))}),x(()=>(t(o),f()),()=>{(E=>{d(o,E.namespace)})(f().params)}),x(()=>k(s()),()=>{d(i,s())}),x(()=>k(r()),()=>{d(T,r().displayName)}),x(()=>(k(r()),he),()=>{d(n,r()&&r().eventList.find(he))}),x(()=>(wt(m),k(r()),wt(u)),()=>{d($,Te({start:d(m,r()===null||r()===void 0?void 0:r().initialEvent)===null||wt(m)===void 0?void 0:wt(m).eventTime,end:d(u,r()===null||r()===void 0?void 0:r().lastEvent)===null||wt(u)===void 0?void 0:wt(u).eventTime,includeMilliseconds:!0}))}),x(()=>(k(r()),ot),()=>{!(r()===null||r()===void 0)&&r().pendingActivity&&(r().pendingActivity.paused?d(v,ot("workflows.paused")):r().pendingActivity.attempt>1?d(v,ot("events.event-classification.retrying")):d(v,ot("events.event-classification.pending")))}),Qt(),Gt();var j=Wr(),L=W(j),D=W(L),B=W(D),Z=W(B),lt=W(Z);{var dt=E=>{cr(E,{get status(){return t(v)}})};nt(lt,E=>{t(v)&&E(dt)})}var z=g(lt),b=g(z);{var tt=E=>{var at=Ir(),U=W(at);Kt(U,{name:"clock"});var K=g(U);H(at),q(()=>ft(K,` ${t($)??""}`)),w(E,at)};nt(b,E=>{t($)&&E(tt)})}H(Z);var ht=g(Z,2),ct=W(ht);vr(ct,{variant:"ghost",size:"xs",$$events:{click:()=>be(r())},children:(E,at)=>{oe();var U=Pr(),K=J(U),ut=g(K);Kt(ut,{name:"close"}),q(_t=>ft(K,`${_t??""} `),[()=>(k(ot),M(()=>ot("common.close")))]),w(E,U)},$$slots:{default:!0}}),H(ht),H(B);var X=g(B,2),it=W(X);rr(it,{get group(){return r()},get event(){return k(r()),M(()=>r().initialEvent)}}),H(X);var et=g(X,2);{var vt=E=>{var at=Er(),U=g(W(at),2);ce(U,()=>(k(r()),M(()=>r().eventList.length)),K=>{Tr(K,{get namespace(){return t(o)},get workflowId(){return t(n),M(()=>t(n).attributes.workflowExecution.workflowId)},get runId(){return t(n),M(()=>t(n).attributes.workflowExecution.runId)},viewportHeight:320,class:"surface-primary overflow-x-hidden border-t border-subtle",onLoad:S})}),H(at),w(E,at)};nt(et,E=>{t(n)&&E(vt)})}H(D),H(L),H(j),q(()=>{A(L,"x",c()),A(L,"y",h()),A(L,"width",t(i)),A(L,"height",t(l)),ft(z,` ${t(T)??""} `)}),$e(D,"offsetHeight",E=>d(P,E)),w(V,j),It(),_()}var Ar=pt('<text fill="#fff" font-size="12" class="svelte-7nuc95"> </text>'),Sr=pt("<!><!>",1),Lr=pt("<!><!>",1);function Dr(V,e){Tt(e,!0);let f=p(e,"x1",3,0),O=p(e,"x2",3,1e3),_=p(e,"timelineHeight",3,1e3);const{radius:l}=Ct,v=20,o=a(()=>O()-f()),i=a(()=>t(o)/v);var T=Lr(),n=J(T);{let m=a(()=>l/2),u=a(()=>[f(),_()]),r=a(()=>[f()+t(o),_()]);At(n,{get strokeWidth(){return t(m)},get startPoint(){return t(u)},get endPoint(){return t(r)}})}var $=g(n);ve($,17,()=>Array(v),ke,(m,u,r)=>{const s=a(()=>f()+r*t(i)),c=a(()=>_()+l*2);var h=Sr(),P=J(h);{var N=L=>{{let D=a(()=>[t(s),0]),B=a(()=>[t(s),_()]);At(L,{strokeWidth:.5,get startPoint(){return t(D)},get endPoint(){return t(B)},strokeDasharray:"2"})}};nt(P,L=>{r!==0&&L(N)})}var S=g(P);{var j=L=>{var D=Ar(),B=W(D,!0);H(D),q(Z=>{A(D,"transform",`rotate(90, ${t(s)??""}, ${t(c)??""})`),A(D,"x",t(s)-l),A(D,"y",t(c)+3),ft(B,Z)},[()=>Te({start:e.startTime,end:new Date(new Date(e.startTime.toString()).getTime()+e.duration/v*r),includeMilliseconds:e.duration/v<1e3})]),w(L,D)};nt(S,L=>{r!==0&&L(j)})}w(m,h)}),w(V,T),It()}var Gr=pt("<text><!></text>"),Or=pt("<!><!><!>",1);function zr(V,e){Tt(e,!0);var f;let O=p(e,"point",19,()=>[0,0]),_=p(e,"category",3,void 0),l=p(e,"status",3,"none"),v=p(e,"fontSize",3,"13px"),o=p(e,"fontWeight",3,"400"),i=p(e,"textAnchor",3,"start"),T=p(e,"backdrop",3,!1),n=p(e,"backdropHeight",3,0),$=p(e,"icon",3,void 0),m=p(e,"config",3,void 0),u=p(e,"label",3,!1);const r=a(()=>je(O(),2)),s=a(()=>t(r)[0]),c=a(()=>t(r)[1]);let h=ie(void 0);const P=a(()=>$()&&m()),N=a(()=>((f=t(h)===null||t(h)===void 0?void 0:t(h).getBBox())===null||f===void 0?void 0:f.width)||0),S=a(()=>t(P)?t(N)+36:t(N)+12),j=a(()=>t(P)&&i()==="start"?t(s)+m().radius*2:t(s));var L=Or(),D=J(L);{var B=z=>{{let b=a(()=>[t(s)-n(),t(c)]),tt=a(()=>[t(s)+t(S),t(c)]);At(z,{get startPoint(){return t(b)},get endPoint(){return t(tt)},get status(){return l()},get strokeWidth(){return n()}})}};nt(D,z=>{T()&&z(B)})}var Z=g(D);{var lt=z=>{{let b=a(()=>i()==="end"?t(s)-t(N)-n():t(s)),tt=a(()=>t(c)-8),ht=a(()=>T()?"text-white":"text-primary");Kt(z,{get name(){return $()},get x(){return t(b)},get y(){return t(tt)},get class(){return t(ht)}})}};nt(Z,z=>{t(P)&&z(lt)})}var dt=g(Z);ce(dt,()=>t(j),z=>{var b=Gr();let tt;var ht=W(b);ze(ht,()=>e.children??Me),H(b),wr(b,ct=>d(h,ct),()=>t(h)),q(()=>{tt=Nt(b,0,`cursor-pointer select-none outline-none ${_()??""} text-primary`,"svelte-gowbbf",tt,{label:u(),backdrop:T()}),A(b,"x",t(j)),A(b,"y",t(c)+1),A(b,"font-size",v()),A(b,"font-weight",o()),A(b,"text-anchor",i())}),w(z,b)}),w(V,L),It()}var Mr=pt("<foreignObject><div></div></foreignObject>"),jr=pt('<rect fill="transparent" pointer-events="all"></rect>'),Fr=pt("<!><!>",1),Ur=pt("<!><!><!><!>",1),Rr=pt('<!><g role="button" tabindex="0" class="relative cursor-pointer svelte-1vsmkab"><!><!></g>',1);function Cr(V,e){Tt(e,!0);const f=()=>st(_r,"$authUser",O),[O,_]=Bt();var l,v;let o=p(e,"y",3,0),i=p(e,"group",7),T=p(e,"readOnly",3,!1);const{height:n,gutter:$,radius:m}=Ct;let u=ie(!1);const r=a(()=>e.canvasWidth-2*$),s=a(()=>i()===null||i()===void 0?void 0:i().pendingActivity),c=a(()=>t(s)&&((l=t(s).pauseInfo)===null||l===void 0?void 0:l.pauseTime));let h=ie(void 0);lr(async()=>{const F=nr(i());if(F)try{d(h,await ar(F,{namespace:_e.params.namespace,settings:_e.data.settings,accessToken:f().accessToken}),!0),t(h)&&(i().decodedLocalActivity=t(h))}catch(G){console.warn("Failed to decode local activity:",G)}});const P=(F,G,Y)=>{const R=te({start:e.startTime,end:F,onlyUnderSecond:!1}),yt=i().eventList.map(zt=>{const C=te({start:e.startTime,end:zt.eventTime,onlyUnderSecond:!1})/R;return Math.round(C*G)+$});if(t(c)){const rt=te({start:e.startTime,end:t(c),onlyUnderSecond:!1})/R,C=Math.round(rt*G)+$;yt.push(C)}const{textAnchor:St,textIndex:Lt,textPosition:Ot,backdrop:Dt}=ir(yt,Y,G,i().isPending,Ct);return{points:yt,textAnchor:St,textIndex:Lt,textPosition:Ot,backdrop:Dt}},N=a(()=>P(e.endTime,t(r),o())),S=a(()=>t(N).points),j=a(()=>t(N).textAnchor),L=a(()=>t(N).textIndex),D=a(()=>t(N).textPosition),B=a(()=>t(N).backdrop),Z=()=>{T()||be(i())},lt=()=>{T()||d(u,!0)},dt=()=>{T()||d(u,!1)},z=a(()=>i().eventList.find(gr)),b=a(()=>t(z)&&((v=t(z).attributes)===null||v===void 0?void 0:v.attempt)>1),tt=a(()=>i().isPending||!!t(c)),ht=a(()=>t(S).length>=2&&t(S)[t(S).length-1]-t(S)[0]+m*3),ct=a(()=>i().isPending&&e.canvasWidth-t(S)[0]-m*1.5),X=a(()=>m*3),it=a(()=>t(ct)||t(ht)||t(X)),et=hr(["h-full w-full rounded-full border-2"],{variants:{category:{workflow:"border-blue-700 bg-blue-800/80 ",activity:"border-purple-700 bg-purple-800/80 ","child-workflow":"border-cyan-600  bg-cyan-600/80 ",timer:"border-yellow-700 bg-yellow-800/80",signal:"border-pink-700 bg-pink-800/80",update:"border-blue-700 bg-blue-800/80",other:"border-slate-700 bg-slate-800/80",nexus:"border-indigo-700 bg-indigo-800/80","local-activity":"border-slate-700 bg-slate-800/80",default:"border-purple-700 bg-purple-900/80"}}});var vt=Rr(),E=J(vt);{var at=F=>{var G=Mr(),Y=W(G);H(G),q(R=>{A(G,"x",t(S)[0]-m*1.5),A(G,"y",o()-m*1.5),A(G,"width",t(it)),A(G,"height",m*3),Nt(Y,1,R)},[()=>Re(et({category:i()?i().category:"default"}))]),w(F,G)};nt(E,F=>{t(u)&&F(at)})}var U=g(E);U.__click=Z;var K=W(U);{var ut=F=>{const G=a(()=>t(c)?t(S)[1]-t(S)[0]:e.canvasWidth-2*$);var Y=jr();q(()=>{A(Y,"y",o()-n/2),A(Y,"x",t(S)[0]),A(Y,"width",t(G)),A(Y,"height",n)}),w(F,Y)};nt(K,F=>{t(tt)&&F(ut)})}var _t=g(K);ve(_t,17,()=>t(S),ke,(F,G,Y)=>{const R=a(()=>t(S)[Y+1]),yt=a(()=>t(L)===Y);var St=Ur(),Lt=J(St);{var Ot=gt=>{{let mt=a(()=>[t(G),o()]),bt=a(()=>[t(R),o()]),xt=a(()=>!!t(c)),Q=a(()=>!!t(c)),$t=a(()=>m*2),Et=a(()=>Y===0&&i().lastEvent.classification==="Completed");At(gt,{get startPoint(){return t(mt)},get endPoint(){return t(bt)},get category(){return i().category},get classification(){return i().lastEvent.classification},get pending(){return t(xt)},get paused(){return t(Q)},get strokeWidth(){return t($t)},get retried(){return t(b)},get scheduling(){return t(Et)}})}};nt(Lt,gt=>{t(R)&&gt(Ot)})}var Dt=g(Lt);{var zt=gt=>{var mt=Fr(),bt=J(mt);{let Q=a(()=>[t(G),o()]),$t=a(()=>[e.canvasWidth-$,o()]),Et=a(()=>t(s)?t(s).attempt>1?"retry":"pending":i().category),kt=a(()=>!!t(c)),Ht=a(()=>m*2);At(bt,{get startPoint(){return t(Q)},get endPoint(){return t($t)},get category(){return t(Et)},get classification(){return i().lastEvent.classification},pending:!0,get paused(){return t(kt)},get strokeWidth(){return t(Ht)}})}var xt=g(bt);{let Q=a(()=>[t(G),o()]);ee(xt,{get point(){return t(Q)},get classification(){return i().lastEvent.classification},icon:"retry",get r(){return m}})}w(gt,mt)};nt(Dt,gt=>{!t(R)&&i().isPending&&!t(c)&&gt(zt)})}var rt=g(Dt);{var C=gt=>{{let mt=a(()=>{var Q,$t;return($t=(Q=i())==null?void 0:Q.userMetadata)==null?void 0:$t.summary}),bt=a(()=>{var Q;return ur(i().initialEvent)?(Q=i())==null?void 0:Q.displayName:""}),xt=a(()=>{var Q;return t(h)?ot("events.category.local-activity"):(Q=i())==null?void 0:Q.displayName});or(gt,{get value(){return t(mt)},get prefix(){return t(bt)},get fallback(){return t(xt)},children:ye,$$slots:{default:(Q,$t)=>{const Et=a(()=>$t.decodedValue);{let kt=a(()=>m*2),Ht=a(()=>t(s)&&!t(s).paused||t(b)?"retry":void 0);zr(Q,{get point(){return t(D)},get textAnchor(){return t(j)},get backdrop(){return t(B)},get backdropHeight(){return t(kt)},get config(){return Ct},get icon(){return t(Ht)},children:(re,ue)=>{var ge=Rt(),Ee=J(ge);{var We=Mt=>{var qt=Ut();q(ne=>ft(qt,`${ne??""}
            ${t(s).attempt??""} / ${(t(s).maximumAttempts||"∞")??""}
            • 
            ${t(Et)??""}`),[()=>ot("workflows.attempt")]),w(Mt,qt)},He=Mt=>{var qt=Rt(),ne=J(qt);{var Ae=jt=>{var Vt=Ut();q(()=>ft(Vt,`${t(z).attributes.attempt??""} • ${t(Et)??""}`)),w(jt,Vt)},Se=jt=>{var Vt=Rt(),Le=J(Vt);{var De=Ft=>{var Xt=Ut();q(()=>ft(Xt,t(h).value)),w(Ft,Xt)},Ge=Ft=>{var Xt=Ut();q(()=>ft(Xt,t(Et))),w(Ft,Xt)};nt(Le,Ft=>{t(h)?Ft(De):Ft(Ge,!1)},!0)}w(jt,Vt)};nt(ne,jt=>{t(b)?jt(Ae):jt(Se,!1)},!0)}w(Mt,qt)};nt(Ee,Mt=>{t(s)?Mt(We):Mt(He,!1)})}w(re,ge)},$$slots:{default:!0}})}}}})}};nt(rt,gt=>{t(yt)&&gt(C)})}var Wt=g(rt);{let gt=a(()=>[t(G),o()]),mt=a(()=>{var xt;return(xt=i().eventList[Y])==null?void 0:xt.classification}),bt=a(()=>t(c)&&Y!==0?"pause":t(h)?pe["local-activity"].name:pe[i().category].name);ee(Wt,{get point(){return t(gt)},get classification(){return t(mt)},get icon(){return t(bt)},get r(){return m}})}w(F,St)}),H(U),q(()=>A(U,"height",n)),Zt("keypress",U,Z),Zt("mouseenter",U,lt),Zt("mouseleave",U,dt),w(V,vt),It(),_()}Ue(["click"]);var Nr=pt('<g role="button" tabindex="0" class="relative cursor-pointer svelte-1hb0j3w"><!><!><!><!><!></g>');function Br(V,e){Tt(e,!1);const f=y(),O=y();let _=p(e,"workflow",8),l=p(e,"length",8),v=p(e,"y",8);const{radius:o,height:i,gutter:T}=Ct;x(()=>{},()=>{d(f,T)}),x(()=>(t(f),k(l())),()=>{d(O,t(f)+l()-2*T)}),Qt(),Gt();var n=Nr(),$=W(n);{let c=I(()=>[t(f),v()]),h=I(()=>[t(O),v()]),P=I(()=>o*2),N=I(()=>(k(le),k(_()),M(()=>le(_()))));At($,{get startPoint(){return t(c)},get endPoint(){return t(h)},get status(){return k(_()),M(()=>_().status)},get strokeWidth(){return t(P)},get pending(){return k(_()),M(()=>_().isRunning)},get delayed(){return t(N)}})}var m=g($);{let c=I(()=>[t(f),v()]);ee(m,{get point(){return t(c)},get classification(){return k(_()),M(()=>_().status)},get r(){return o}})}var u=g(m);{let c=I(()=>t(f)-o/2),h=I(()=>v()-o/2);Kt(u,{name:"workflow",get x(){return t(c)},get y(){return t(h)},get width(){return o},get height(){return o},strokeWidth:"4",class:"text-black"})}var r=g(u);{let c=I(()=>[t(O),v()]);ee(r,{get point(){return t(c)},get classification(){return k(_()),M(()=>_().status)},get r(){return o}})}var s=g(r);{let c=I(()=>t(O)-o/2),h=I(()=>v()-o/2);Kt(s,{name:"workflow",get x(){return t(c)},get y(){return t(h)},get width(){return o},get height(){return o},strokeWidth:"4",class:"text-black"})}H(n),q(()=>A(n,"height",i)),w(V,n),It()}var qr=pt("<!><!>",1),Vr=Pt('<div><div class="flex w-full justify-between text-xs"><p class="w-60 -translate-x-24 rotate-90"> </p> <p class="w-60 translate-x-24 rotate-90"> </p></div></div> <svg><!><!><!><!><!></svg>',1),Xr=Pt('<div id="event-history-timeline-graph" class="relative h-auto overflow-auto border border-t-0 border-subtle bg-primary"><!></div>');function Pe(V,e){Tt(e,!1);const f=()=>st(xe,"$activeGroupHeight",i),O=()=>st(Ze,"$eventStatusFilter",i),_=()=>st(tr,"$fullEventHistory",i),l=()=>st(qe,"$activeGroups",i),v=()=>st(se,"$eventFilterSort",i),o=()=>st(Qe,"$timestamp",i),[i,T]=Bt(),n=y(),$=y(),m=y(),u=y(),r=y(),s=y(),c=y();var h=y(),P=y();let N=p(e,"x",8,0),S=p(e,"y",8,0),j=p(e,"workflow",8),L=p(e,"groups",8),D=p(e,"viewportHeight",8),B=p(e,"readOnly",8,!1),Z=p(e,"error",8,!1);const{height:lt,gutter:dt,radius:z}=Ct;let b=y(0),tt=y(0);const ht=it=>{var et;d(tt,(et=it==null?void 0:it.target)===null||et===void 0?void 0:et.scrollTop)};x(()=>(k(B()),f()),()=>{d(n,B()?0:f())}),x(()=>(k(L()),O()),()=>{d($,Ne(L(),O()))}),x(()=>(wt(h),_(),k(j()),wt(P)),()=>{d(m,(d(h,_()[0])===null||wt(h)===void 0?void 0:wt(h).eventTime)<j().executionTime?d(P,_()[0])===null||wt(P)===void 0?void 0:wt(P).eventTime:j().executionTime)}),x(()=>(k(j()),t(m)),()=>{d(u,!le(j())&&t(m)||j().startTime)}),x(()=>(t($),t(n)),()=>{d(r,Math.max(lt*(t($).length+2),120)+t(n))}),x(()=>t(r),()=>{d(s,t(r)+120)}),x(()=>(l(),v(),t(n)),()=>{d(c,it=>{const et=l()===null||l()===void 0?void 0:l().filter(vt=>v()==="ascending"?parseInt(vt)<parseInt(it.id):parseInt(vt)>parseInt(it.id));return et!=null&&et.length?t(n):0})}),Qt(),Gt();var ct=Xr(),X=W(ct);kr(X,{get workflow(){return j()},get startTime(){return t(u)},children:ye,$$slots:{default:(it,et)=>{const vt=I(()=>et.endTime),E=I(()=>et.duration);var at=Vr(),U=J(at);let K;var ut=W(U),_t=W(ut),F=W(_t,!0);H(_t);var G=g(_t,2),Y=W(G,!0);H(G),H(ut),H(U);var R=g(U,2);let yt;var St=W(R);{let rt=I(()=>[dt,0]),C=I(()=>[dt,t(r)]),Wt=I(()=>z/2);At(St,{get startPoint(){return t(rt)},get endPoint(){return t(C)},get strokeWidth(){return t(Wt)}})}var Lt=g(St);{let rt=I(()=>[t(b)-dt,0]),C=I(()=>[t(b)-dt,t(r)]),Wt=I(()=>z/2);At(Lt,{get startPoint(){return t(rt)},get endPoint(){return t(C)},get strokeWidth(){return t(Wt)}})}var Ot=g(Lt);{let rt=I(()=>dt-z/4),C=I(()=>t(b)-dt+z/4);Dr(Ot,{get x1(){return t(rt)},get x2(){return t(C)},get timelineHeight(){return t(r)},get startTime(){return t(u)},get duration(){return t(E)}})}var Dt=g(Ot);Br(Dt,{get workflow(){return j()},get y(){return lt},get length(){return t(b)}});var zt=g(Dt);ve(zt,3,()=>t($),rt=>rt.id,(rt,C,Wt,gt)=>{const mt=I(()=>(k(t(Wt)),t(c),t(C),M(()=>(t(Wt)+2)*lt+t(c)(t(C)))));var bt=qr(),xt=J(bt);{var Q=kt=>{var Ht=Rt(),re=J(Ht);ce(re,()=>(t(C),M(()=>t(C).eventList.length)),ue=>{Cr(ue,{get y(){return t(mt)},get group(){return t(C)},get canvasWidth(){return t(b)},get startTime(){return t(u)},get endTime(){return t(vt)},get readOnly(){return B()}})}),w(kt,Ht)};nt(xt,kt=>{(!D()||t(mt)>t(tt)-2*lt&&t(mt)<t(tt)+D()*lt)&&kt(Q)})}var $t=g(xt);{var Et=kt=>{{let Ht=I(()=>t(mt)+1.33*z);Hr(kt,{get y(){return t(Ht)},get group(){return t(C)},get canvasWidth(){return t(b)}})}};nt($t,kt=>{k(B()),l(),t(C),M(()=>!B()&&l().includes(t(C).id))&&kt(Et)})}w(rt,bt)}),H(R),q((rt,C)=>{K=Nt(U,1,"pointer-events-none sticky top-[120px]",null,K,{invisible:!!l().length}),ft(F,rt),ft(Y,C),A(R,"x",N()),A(R,"y",S()),A(R,"viewBox",`0 0 ${t(b)??""} ${t(s)??""}`),A(R,"height",t(s)),A(R,"width",t(b)),yt=Nt(R,0,"-mt-4 svelte-1fw3am",null,yt,{error:Z()})},[()=>(o(),t(u),M(()=>o()(t(u),{format:"short"}))),()=>(o(),k(t(vt)),M(()=>o()(t(vt),{format:"short"})))]),w(it,at)}}}),H(ct),q(()=>Ke(ct,D()?`max-height: ${D()}px;`:"")),$e(ct,"clientWidth",it=>d(b,it)),Zt("scroll",ct,ht),w(V,ct),It(),T()}var Yr=Pt("<span></span> ",1),Jr=Pt("<!> <!> <!> <!>",1),Kr=Pt('<!> <div class="relative pb-24"><div class="surface-background sticky top-0 z-30 flex flex-wrap items-center justify-between gap-2 border-b border-subtle pb-2 md:top-12 xl:gap-8"><div class="flex items-center gap-2"><h2> </h2> <!></div> <div class="flex items-center gap-2"><!></div></div> <div class="flex w-full flex-col"><!></div></div> <!>',1);function Qr(V,e){Tt(e,!1);const f=()=>st(de,"$page",o),O=()=>st(br,"$workflowRun",o),_=()=>st(se,"$eventFilterSort",o),l=()=>st(Jt,"$pauseLiveUpdates",o),v=()=>st(er,"$filteredEventHistory",o),[o,i]=Bt(),T=y(),n=y(),$=y(),m=y(),u=y(),r=y(),s=y(),c=y();Ce(()=>{Je()});let h=y(!1);const P=()=>{const X=t(r)?"ascending":"descending";we(f().url,{sort:X},me)},N=()=>{we(f().url,{refresh_off:!l()},me)};x(()=>(t(T),f()),()=>{(X=>{d(T,X.namespace)})(f().params)}),x(()=>(t(n),O()),()=>{(X=>{d(n,X.workflow)})(O())}),x(()=>t(n),()=>{d($,t(n)===null||t(n)===void 0?void 0:t(n).pendingActivities)}),x(()=>t(n),()=>{d(m,t(n)===null||t(n)===void 0?void 0:t(n).pendingNexusOperations)}),x(()=>f(),()=>{d(u,xr(f().url))}),x(()=>t(u),()=>{Yt(se,t(u).sort),Yt(Jt,t(u).refresh_off)}),x(()=>_(),()=>{d(r,_()==="descending")}),x(()=>(v(),t($),t(m)),()=>{d(s,Ie(v(),"ascending",t($),t(m)))}),x(()=>(t(r),t(s)),()=>{d(c,t(r)?[...t(s)].reverse():t(s))}),x(()=>(t(n),l()),()=>{!(!(t(n)===null||t(n)===void 0)&&t(n).isRunning)&&l()&&Yt(Jt,!1)}),Qt(),Gt();var S=Kr(),j=J(S);Ve(j,{});var L=g(j,2),D=W(L),B=W(D),Z=W(B),lt=W(Z,!0);H(Z);var dt=g(Z,2);Be(dt,{}),H(B);var z=g(B,2),b=W(z);yr(b,{children:(X,it)=>{var et=Jr(),vt=J(et);{let K=I(()=>t(r)?"descending":"ascending");ae(vt,{get leadingIcon(){return t(K)},"data-testid":"zoom-in",size:"sm",$$events:{click:P},children:(ut,_t)=>{oe();var F=Ut();q(()=>ft(F,t(r)?"Descending":"Ascending")),w(ut,F)},$$slots:{default:!0}})}var E=g(vt,2);Ye(E,{compact:!1,minimized:!1});var at=g(E,2);{let K=I(()=>(t(n),M(()=>{var ut;return!((ut=t(n))!=null&&ut.isRunning)})));ae(at,{get disabled(){return t(K)},"data-testid":"pause",class:"border-l-0",size:"sm",$$events:{click:N},children:(ut,_t)=>{var F=Yr(),G=J(F),Y=g(G);q(R=>{Nt(G,1,`h-1.5 w-1.5 rounded-full ${l(),t(n),M(()=>{var yt;return l()||!((yt=t(n))!=null&&yt.isRunning)?"bg-slate-300":"bg-green-600"})??""}`),ft(Y,` ${R??""}`)},[()=>(l(),t(n),k(ot),M(()=>{var R;return l()||!((R=t(n))!=null&&R.isRunning)?ot("workflows.auto-refresh-off"):ot("workflows.auto-refresh-on")}))]),w(ut,F)},$$slots:{default:!0}})}var U=g(at,2);ae(U,{"data-testid":"download",leadingIcon:"download",size:"sm",$$events:{click:()=>d(h,!0)},children:(K,ut)=>{oe();var _t=Ut();q(F=>ft(_t,F),[()=>(k(ot),M(()=>ot("common.download")))]),w(K,_t)},$$slots:{default:!0}}),w(X,et)},$$slots:{default:!0}}),H(z),H(D);var tt=g(D,2),ht=W(tt);Pe(ht,{get workflow(){return t(n)},get groups(){return t(c)},viewportHeight:void 0}),H(tt),H(L);var ct=g(L,2);Xe(ct,{get namespace(){return t(T)},get workflowId(){return t(n),M(()=>t(n).id)},get runId(){return t(n),M(()=>t(n).runId)},get open(){return t(h)},set open(X){d(h,X)},$$legacy:!0}),q(X=>ft(lt,X),[()=>(k(ot),M(()=>ot("workflows.timeline-tab")))]),w(V,S),It(),i()}var Zr=Pt("<!> <!>",1);function Un(V,e){Tt(e,!1);const f=()=>st(de,"$page",O),[O,_]=Bt(),l=f().params.workflow;Gt();var v=Zr(),o=J(v);{let T=I(()=>`${ot("workflows.timeline-tab")} | ${l}`);Fe(o,{get title(){return t(T)},get url(){return f().url.href}})}var i=g(o,2);Qr(i,{}),w(V,v),It(),_()}export{Un as component};
