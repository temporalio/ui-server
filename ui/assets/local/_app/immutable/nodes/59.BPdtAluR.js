import"../chunks/CWj6FrbW.js";import"../chunks/69_IOA4Y.js";import{p as Pt,l as $,a as Jt,i as Rt,c as J,e as y,b as Wt,M as T,g as t,m as k,s as d,f as Ht,j as W,o as I,r as H,t as K,I as P,av as bt,bK as wt,h as u,n as oe,ac as Oe,v as n,d as ze,u as Fe,at as ie,aQ as Me,q as ye,k as Ut}from"../chunks/BzuLCQNf.js";import{i as zt}from"../chunks/W-5sOwmb.js";import{p as h,s as Bt,a as st,b as Xt,l as fe}from"../chunks/DdNojIXk.js";import{p as de}from"../chunks/CIy0ubmg.js";import{P as je}from"../chunks/BX5rdQWZ.js";import{t as it}from"../chunks/DEjs8ZrU.js";import{s as pt,d as Ue,e as Zt}from"../chunks/HOnlAALn.js";import{i as Q}from"../chunks/Be-bjpec.js";import{s as Nt,c as Re}from"../chunks/wWuJlbLq.js";import{b as Ce,g as me}from"../chunks/BSLsaSV2.js";import{L as Ot,D as ee,a as Ne,E as Be}from"../chunks/DMWfzKSN.js";import{s as ke,b as be,d as qe,I as Ke,D as Ve,E as Xe,c as Ye,W as Qe,a as Je}from"../chunks/B-WvdGer.js";import{k as ce}from"../chunks/B6WYOvS7.js";import{e as ve,i as xe}from"../chunks/DHcq7Esf.js";import{s as L,b as Ze}from"../chunks/Brfhuxqj.js";import{b as $e}from"../chunks/DqfiMSJy.js";import{t as tr}from"../chunks/DQtg0T9O.js";import{p as Yt,h as er,f as rr,e as se,b as nr,g as ar}from"../chunks/D3DqvWbn.js";import{i as le}from"../chunks/Dzb719w0.js";import{b as or,T as Ct,j as ir,d as sr,M as lr,C as pe,t as dr}from"../chunks/Daskq5VR.js";import{a as cr,o as vr}from"../chunks/SxBBeV83.js";import{s as ur}from"../chunks/D7yhRzLA.js";import{p as te,g as Te}from"../chunks/CrZfxCV7.js";import{W as gr}from"../chunks/B1S_w4vZ.js";import{B as fr}from"../chunks/BQLqgSXt.js";import{I as Qt}from"../chunks/CKL6Zfw6.js";import{K as he,r as mr,p as pr,o as hr}from"../chunks/Dpq9Ytb2.js";import{a as _r}from"../chunks/D-F-0Ojj.js";import{g as Ee}from"../chunks/CQzS74iW.js";import{f as wr}from"../chunks/vOlKiGe0.js";import{v as yr}from"../chunks/DgFfbOWh.js";import{c as kr}from"../chunks/BvcST-tr.js";import{p as _e}from"../chunks/Ck1QX1w3.js";import{a as br}from"../chunks/ewzzm9Vv.js";import{b as xr}from"../chunks/BtufP36q.js";import{T as $r,a as ae}from"../chunks/BG21-vh_.js";import{w as Tr}from"../chunks/BGTvKxEd.js";import{u as we,p as Er}from"../chunks/xsIJXrnh.js";function Ir(V,e){Pt(e,!1);const f=()=>st(Yt,"$pauseLiveUpdates",G),[G,_]=Bt(),l=k(),g=k();let s=h(e,"workflow",8),o=h(e,"startTime",8);const A=()=>{const i=new Date;return i.setSeconds(i.getSeconds()+1),i};let v;const a=i=>{i&&(clearInterval(v),v=null)},m=i=>{i?(clearInterval(v),v=null):!v&&s().isRunning&&(v=setInterval(()=>{d(l,A())},1e3))};cr(()=>{clearInterval(v),v=null,Xt(Yt,!1)}),$(()=>T(s()),()=>{d(l,(s()===null||s()===void 0?void 0:s().endTime)||A())}),$(()=>(T(o()),t(l)),()=>{d(g,te({start:o(),end:t(l),onlyUnderSecond:!1}))}),$(()=>T(s()),()=>{a(s().endTime)}),$(()=>f(),()=>{m(f())}),Jt(),zt();var p=Rt(),r=J(p);ur(r,e,"default",{get endTime(){return t(l)},get duration(){return t(g)}},null),y(V,p),Wt(),_()}var Pr=Ht("<div><!></div>");function Wr(V,e){const f=fe(e,["children","$$slots","$$events","$$legacy"]),G=fe(f,["namespace","workflowId","runId","viewportHeight","onLoad"]);Pt(e,!1);let _=h(e,"namespace",8),l=h(e,"workflowId",8),g=h(e,"runId",8,""),s=h(e,"viewportHeight",8,360),o=h(e,"onLoad",8,()=>{});const A=async()=>{const[p,r]=await Promise.all([yr({namespace:_(),workflowId:l(),runId:g()}),wr({namespace:_(),workflowId:l(),runId:g()})]);return{workflow:p.workflow,history:r}},v=(p,r)=>{var i;o()();const c=(i=p==null?void 0:p.pendingActivities)!==null&&i!==void 0?i:[];return Ee(r,"ascending",c)};zt();var a=Rt(),m=J(a);_r(m,()=>P(A),null,(p,r)=>{var i=I(()=>{var{workflow:O,history:R}=t(r);return{workflow:O,history:R}}),c=I(()=>t(i).workflow),w=I(()=>t(i).history),E=Pr(),U=W(E);{let O=I(()=>(T(t(c)),T(t(w)),P(()=>v(t(c),t(w)))));Ie(U,{get viewportHeight(){return s()},get workflow(){return t(c)},get groups(){return t(O)},readOnly:!0})}H(E),K(()=>Nt(E,1,`cursor-pointer overflow-auto ${T(G),P(()=>G.class)??""}`)),y(p,E)}),y(V,a),Wt()}var Hr=Ht('<div class="flex items-center gap-1"><!> </div>'),Ar=Ht(" <!>",1),Sr=Ht('<div class="surface-primary p-4"><div class="font-medium leading-4 text-secondary">Child Workflow</div> <!></div>'),Lr=wt('<g role="button" tabindex="0" class="relative z-50 svelte-1qsv8v3"><foreignObject><div class="flex flex-col"><div class="relative flex h-full items-center justify-between bg-slate-50 text-sm dark:bg-slate-800"><div class="flex h-full items-center gap-4 px-2"><!> <!></div> <div class="flex items-center gap-4"><!></div></div> <div class="surface-primary"><!></div> <!></div></foreignObject></g>');function Dr(V,e){Pt(e,!1);const f=()=>st(de,"$page",G),[G,_]=Bt(),l=k(),g=k(),s=k(),o=k(),A=k(),v=k(),a=k();var m=k(),p=k();let r=h(e,"group",8),i=h(e,"canvasWidth",8),c=h(e,"x",8,0),w=h(e,"y",8),E=k();const U=S=>{Xt(be,S)},O=async()=>{await Oe(),d(l,t(E))};$(()=>t(E),()=>{d(l,t(E)||0)}),$(()=>t(l),()=>{U(t(l)||0)}),$(()=>T(r()),()=>{d(g,(r()===null||r()===void 0?void 0:r().finalClassification)||(r()===null||r()===void 0?void 0:r().classification))}),$(()=>(t(s),f()),()=>{(S=>{d(s,S.namespace)})(f().params)}),$(()=>T(i()),()=>{d(o,i())}),$(()=>T(r()),()=>{d(A,r().displayName)}),$(()=>(T(r()),he),()=>{d(v,r()&&r().eventList.find(he))}),$(()=>(bt(m),T(r()),bt(p)),()=>{d(a,Te({start:d(m,r()===null||r()===void 0?void 0:r().initialEvent)===null||bt(m)===void 0?void 0:bt(m).eventTime,end:d(p,r()===null||r()===void 0?void 0:r().lastEvent)===null||bt(p)===void 0?void 0:bt(p).eventTime,includeMilliseconds:!0}))}),$(()=>(T(r()),it),()=>{!(r()===null||r()===void 0)&&r().pendingActivity&&(r().pendingActivity.paused?d(g,it("workflows.paused")):r().pendingActivity.attempt>1?d(g,it("events.event-classification.retrying")):d(g,it("events.event-classification.pending")))}),Jt(),zt();var R=Lr(),z=W(R),F=W(z),B=W(F),rt=W(B),ct=W(rt);{var vt=S=>{gr(S,{get status(){return t(g)}})};Q(ct,S=>{t(g)&&S(vt)})}var j=u(ct),b=u(j);{var Z=S=>{var lt=Hr(),C=W(lt);Qt(C,{name:"clock"});var x=u(C);H(lt),K(()=>pt(x,` ${t(a)??""}`)),y(S,lt)};Q(b,S=>{t(a)&&S(Z)})}H(rt);var ut=u(rt,2),nt=W(ut);fr(nt,{variant:"ghost",size:"xs",$$events:{click:()=>ke(r())},children:(S,lt)=>{oe();var C=Ar(),x=J(C),yt=u(x);Qt(yt,{name:"close"}),K(ot=>pt(x,`${ot??""} `),[()=>(T(it),P(()=>it("common.close")))]),y(S,C)},$$slots:{default:!0}}),H(ut),H(B);var At=u(B,2),at=W(At);or(at,{get group(){return r()},get event(){return T(r()),P(()=>r().initialEvent)}}),H(At);var et=u(At,2);{var ht=S=>{var lt=Sr(),C=u(W(lt),2);ce(C,()=>(T(r()),P(()=>r().eventList.length)),x=>{Wr(x,{get namespace(){return t(s)},get workflowId(){return t(v),P(()=>t(v).attributes.workflowExecution.workflowId)},get runId(){return t(v),P(()=>t(v).attributes.workflowExecution.runId)},viewportHeight:320,class:"surface-primary overflow-x-hidden border-t border-subtle",onLoad:O})}),H(lt),y(S,lt)};Q(et,S=>{t(v)&&S(ht)})}H(F),H(z),H(R),K(()=>{L(z,"x",c()),L(z,"y",w()),L(z,"width",t(o)),L(z,"height",t(l)),pt(j,` ${t(A)??""} `)}),$e(F,"offsetHeight",S=>d(E,S)),y(V,R),Wt(),_()}var Gr=wt('<text fill="#fff" font-size="12" class="svelte-7nuc95"> </text>'),Or=wt("<!><!>",1),zr=wt("<!><!>",1);function Fr(V,e){Pt(e,!0);let f=h(e,"x1",3,0),G=h(e,"x2",3,1e3),_=h(e,"timelineHeight",3,1e3);const{radius:l}=Ct,g=20,s=n(()=>G()-f()),o=n(()=>t(s)/g);var A=zr(),v=J(A);{let m=n(()=>l/2),p=n(()=>[f(),_()]),r=n(()=>[f()+t(s),_()]);Ot(v,{get strokeWidth(){return t(m)},get startPoint(){return t(p)},get endPoint(){return t(r)}})}var a=u(v);ve(a,17,()=>Array(g),xe,(m,p,r)=>{const i=n(()=>f()+r*t(o)),c=n(()=>_()+l*2);var w=Or(),E=J(w);{var U=z=>{{let F=n(()=>[t(i),0]),B=n(()=>[t(i),_()]);Ot(z,{strokeWidth:.5,get startPoint(){return t(F)},get endPoint(){return t(B)},strokeDasharray:"2"})}};Q(E,z=>{r!==0&&z(U)})}var O=u(E);{var R=z=>{var F=Gr(),B=W(F,!0);H(F),K(rt=>{L(F,"transform",`rotate(90, ${t(i)??""}, ${t(c)??""})`),L(F,"x",t(i)-l),L(F,"y",t(c)+3),pt(B,rt)},[()=>Te({start:e.startTime,end:new Date(new Date(e.startTime.toString()).getTime()+e.duration/g*r),includeMilliseconds:e.duration/g<1e3})]),y(z,F)};Q(O,z=>{r!==0&&z(R)})}y(m,w)}),y(V,A),Wt()}var Mr=wt("<text><!></text>"),jr=wt("<!><!><!>",1);function Ur(V,e){Pt(e,!0);var f;let G=h(e,"point",19,()=>[0,0]),_=h(e,"category",3,void 0),l=h(e,"status",3,"none"),g=h(e,"fontSize",3,"13px"),s=h(e,"fontWeight",3,"400"),o=h(e,"textAnchor",3,"start"),A=h(e,"backdrop",3,!1),v=h(e,"backdropHeight",3,0),a=h(e,"icon",3,void 0),m=h(e,"config",3,void 0),p=h(e,"label",3,!1);const r=n(()=>Me(G(),2)),i=n(()=>t(r)[0]),c=n(()=>t(r)[1]);let w=ie(void 0);const E=n(()=>a()&&m()),U=n(()=>((f=t(w)===null||t(w)===void 0?void 0:t(w).getBBox())===null||f===void 0?void 0:f.width)||0),O=n(()=>t(E)?t(U)+36:t(U)+12),R=n(()=>t(E)&&o()==="start"?t(i)+m().radius*2:t(i));var z=jr(),F=J(z);{var B=j=>{{let b=n(()=>[t(i)-v(),t(c)]),Z=n(()=>[t(i)+t(O),t(c)]);Ot(j,{get startPoint(){return t(b)},get endPoint(){return t(Z)},get status(){return l()},get strokeWidth(){return v()}})}};Q(F,j=>{A()&&j(B)})}var rt=u(F);{var ct=j=>{{let b=n(()=>o()==="end"?t(i)-t(U)-v():t(i)),Z=n(()=>t(c)-8),ut=n(()=>A()?"text-white":"text-primary");Qt(j,{get name(){return a()},get x(){return t(b)},get y(){return t(Z)},get class(){return t(ut)}})}};Q(rt,j=>{t(E)&&j(ct)})}var vt=u(rt);ce(vt,()=>t(R),j=>{var b=Mr();let Z;var ut=W(b);ze(ut,()=>e.children??Fe),H(b),xr(b,nt=>d(w,nt),()=>t(w)),K(()=>{Z=Nt(b,0,`cursor-pointer select-none outline-none ${_()??""} text-primary`,"svelte-gowbbf",Z,{label:p(),backdrop:A()}),L(b,"x",t(R)),L(b,"y",t(c)+1),L(b,"font-size",g()),L(b,"font-weight",s()),L(b,"text-anchor",o())}),y(j,b)}),y(V,z),Wt()}var Rr=wt("<foreignObject><div></div></foreignObject>"),Cr=wt('<rect fill="transparent" pointer-events="all"></rect>'),Nr=wt("<!><!>",1),Br=wt("<!><!><!><!>",1),qr=wt('<!><g role="button" tabindex="0" class="relative cursor-pointer svelte-1vsmkab"><!><!></g>',1);function Kr(V,e){Pt(e,!0);const f=()=>st(br,"$authUser",G),[G,_]=Bt();var l,g;let s=h(e,"y",3,0),o=h(e,"group",7),A=h(e,"readOnly",3,!1);const{height:v,gutter:a,radius:m}=Ct;let p=ie(!1);const r=n(()=>e.canvasWidth-2*a),i=n(()=>o()===null||o()===void 0?void 0:o().pendingActivity),c=n(()=>t(i)&&((l=t(i).pauseInfo)===null||l===void 0?void 0:l.pauseTime));let w=ie(void 0);vr(async()=>{const X=ir(o());if(X)try{d(w,await sr(X,{namespace:_e.params.namespace,settings:_e.data.settings,accessToken:f().accessToken}),!0),t(w)&&(o().decodedLocalActivity=t(w))}catch(D){console.warn("Failed to decode local activity:",D)}});const E=(X,D,q)=>{const Y=te({start:e.startTime,end:X,onlyUnderSecond:!1}),gt=o().eventList.map(Lt=>{const M=te({start:e.startTime,end:Lt.eventTime,onlyUnderSecond:!1})/Y;return Math.round(M*D)+a});if(t(c)){const N=te({start:e.startTime,end:t(c),onlyUnderSecond:!1})/Y,M=Math.round(N*D)+a;gt.push(M)}const{textAnchor:dt,textIndex:kt,textPosition:ft,backdrop:Et}=dr(gt,q,D,o().isPending,Ct);return{points:gt,textAnchor:dt,textIndex:kt,textPosition:ft,backdrop:Et}},U=n(()=>E(e.endTime,t(r),s())),O=n(()=>t(U).points),R=n(()=>t(U).textAnchor),z=n(()=>t(U).textIndex),F=n(()=>t(U).textPosition),B=n(()=>t(U).backdrop),rt=()=>{A()||ke(o())},ct=()=>{A()||d(p,!0)},vt=()=>{A()||d(p,!1)},j=n(()=>o().eventList.find(pr)),b=n(()=>t(j)&&((g=t(j).attributes)===null||g===void 0?void 0:g.attempt)>1),Z=n(()=>o().isPending||!!t(c)),ut=n(()=>t(O).length>=2&&t(O)[t(O).length-1]-t(O)[0]+m*3),nt=n(()=>o().isPending&&e.canvasWidth-t(O)[0]-m*1.5),At=n(()=>m*3),at=n(()=>t(nt)||t(ut)||t(At)),et=kr(["h-full w-full rounded-full border-2"],{variants:{category:{workflow:"border-blue-700 bg-blue-800/80 ",activity:"border-purple-700 bg-purple-800/80 ","child-workflow":"border-cyan-600  bg-cyan-600/80 ",timer:"border-yellow-700 bg-yellow-800/80",signal:"border-pink-700 bg-pink-800/80",update:"border-blue-700 bg-blue-800/80",other:"border-slate-700 bg-slate-800/80",nexus:"border-indigo-700 bg-indigo-800/80","local-activity":"border-slate-700 bg-slate-800/80",default:"border-purple-700 bg-purple-900/80"}}});var ht=qr(),S=J(ht);{var lt=X=>{var D=Rr(),q=W(D);H(D),K(Y=>{L(D,"x",t(O)[0]-m*1.5),L(D,"y",s()-m*1.5),L(D,"width",t(at)),L(D,"height",m*3),Nt(q,1,Y)},[()=>Re(et({category:o()?o().category:"default"}))]),y(X,D)};Q(S,X=>{t(p)&&X(lt)})}var C=u(S);C.__click=rt;var x=W(C);{var yt=X=>{const D=n(()=>t(c)?t(O)[1]-t(O)[0]:e.canvasWidth-2*a);var q=Cr();K(()=>{L(q,"y",s()-v/2),L(q,"x",t(O)[0]),L(q,"width",t(D)),L(q,"height",v)}),y(X,q)};Q(x,X=>{t(Z)&&X(yt)})}var ot=u(x);ve(ot,17,()=>t(O),xe,(X,D,q)=>{const Y=n(()=>t(O)[q+1]),gt=n(()=>t(z)===q);var dt=Br(),kt=J(dt);{var ft=mt=>{{let _t=n(()=>[t(D),s()]),xt=n(()=>[t(Y),s()]),$t=n(()=>!!t(c)),tt=n(()=>!!t(c)),It=n(()=>m*2),St=n(()=>q===0&&o().lastEvent.classification==="Completed");Ot(mt,{get startPoint(){return t(_t)},get endPoint(){return t(xt)},get category(){return o().category},get classification(){return o().lastEvent.classification},get pending(){return t($t)},get paused(){return t(tt)},get strokeWidth(){return t(It)},get retried(){return t(b)},get scheduling(){return t(St)}})}};Q(kt,mt=>{t(Y)&&mt(ft)})}var Et=u(kt);{var Lt=mt=>{var _t=Nr(),xt=J(_t);{let tt=n(()=>[t(D),s()]),It=n(()=>[e.canvasWidth-a,s()]),St=n(()=>t(i)?t(i).attempt>1?"retry":"pending":o().category),Tt=n(()=>!!t(c)),Gt=n(()=>m*2);Ot(xt,{get startPoint(){return t(tt)},get endPoint(){return t(It)},get category(){return t(St)},get classification(){return o().lastEvent.classification},pending:!0,get paused(){return t(Tt)},get strokeWidth(){return t(Gt)}})}var $t=u(xt);{let tt=n(()=>[t(D),s()]);ee($t,{get point(){return t(tt)},get classification(){return o().lastEvent.classification},icon:"retry",get r(){return m}})}y(mt,_t)};Q(Et,mt=>{!t(Y)&&o().isPending&&!t(c)&&mt(Lt)})}var N=u(Et);{var M=mt=>{{let _t=n(()=>{var tt,It;return(It=(tt=o())==null?void 0:tt.userMetadata)==null?void 0:It.summary}),xt=n(()=>{var tt;return mr(o().initialEvent)?(tt=o())==null?void 0:tt.displayName:""}),$t=n(()=>{var tt;return t(w)?it("events.category.local-activity"):(tt=o())==null?void 0:tt.displayName});lr(mt,{get value(){return t(_t)},get prefix(){return t(xt)},get fallback(){return t($t)},children:ye,$$slots:{default:(tt,It)=>{const St=n(()=>It.decodedValue);{let Tt=n(()=>m*2),Gt=n(()=>t(i)&&!t(i).paused||t(b)?"retry":void 0);Ur(tt,{get point(){return t(F)},get textAnchor(){return t(R)},get backdrop(){return t(B)},get backdropHeight(){return t(Tt)},get config(){return Ct},get icon(){return t(Gt)},children:(re,ue)=>{var ge=Rt(),Pe=J(ge);{var We=Ft=>{var qt=Ut();K(ne=>pt(qt,`${ne??""}
            ${t(i).attempt??""} / ${(t(i).maximumAttempts||"∞")??""}
            • 
            ${t(St)??""}`),[()=>it("workflows.attempt")]),y(Ft,qt)},He=Ft=>{var qt=Rt(),ne=J(qt);{var Ae=Mt=>{var Kt=Ut();K(()=>pt(Kt,`${t(j).attributes.attempt??""} • ${t(St)??""}`)),y(Mt,Kt)},Se=Mt=>{var Kt=Rt(),Le=J(Kt);{var De=jt=>{var Vt=Ut();K(()=>pt(Vt,t(w).value)),y(jt,Vt)},Ge=jt=>{var Vt=Ut();K(()=>pt(Vt,t(St))),y(jt,Vt)};Q(Le,jt=>{t(w)?jt(De):jt(Ge,!1)},!0)}y(Mt,Kt)};Q(ne,Mt=>{t(b)?Mt(Ae):Mt(Se,!1)},!0)}y(Ft,qt)};Q(Pe,Ft=>{t(i)?Ft(We):Ft(He,!1)})}y(re,ge)},$$slots:{default:!0}})}}}})}};Q(N,mt=>{t(gt)&&mt(M)})}var Dt=u(N);{let mt=n(()=>[t(D),s()]),_t=n(()=>{var $t;return($t=o().eventList[q])==null?void 0:$t.classification}),xt=n(()=>t(c)&&q!==0?"pause":t(w)?pe["local-activity"].name:pe[o().category].name);ee(Dt,{get point(){return t(mt)},get classification(){return t(_t)},get icon(){return t(xt)},get r(){return m}})}y(X,dt)}),H(C),K(()=>L(C,"height",v)),Zt("keypress",C,rt),Zt("mouseenter",C,ct),Zt("mouseleave",C,vt),y(V,ht),Wt(),_()}Ue(["click"]);var Vr=wt('<g role="button" tabindex="0" class="relative cursor-pointer svelte-1hb0j3w"><!><!><!><!><!></g>');function Xr(V,e){Pt(e,!1);const f=k(),G=k();let _=h(e,"workflow",8),l=h(e,"length",8),g=h(e,"y",8);const{radius:s,height:o,gutter:A}=Ct;$(()=>{},()=>{d(f,A)}),$(()=>(t(f),T(l())),()=>{d(G,t(f)+l()-2*A)}),Jt(),zt();var v=Vr(),a=W(v);{let c=I(()=>[t(f),g()]),w=I(()=>[t(G),g()]),E=I(()=>s*2),U=I(()=>(T(le),T(_()),P(()=>le(_()))));Ot(a,{get startPoint(){return t(c)},get endPoint(){return t(w)},get status(){return T(_()),P(()=>_().status)},get strokeWidth(){return t(E)},get pending(){return T(_()),P(()=>_().isRunning)},get delayed(){return t(U)}})}var m=u(a);{let c=I(()=>[t(f),g()]);ee(m,{get point(){return t(c)},get classification(){return T(_()),P(()=>_().status)},get r(){return s}})}var p=u(m);{let c=I(()=>t(f)-s/2),w=I(()=>g()-s/2);Qt(p,{name:"workflow",get x(){return t(c)},get y(){return t(w)},get width(){return s},get height(){return s},strokeWidth:"4",class:"text-black"})}var r=u(p);{let c=I(()=>[t(G),g()]);ee(r,{get point(){return t(c)},get classification(){return T(_()),P(()=>_().status)},get r(){return s}})}var i=u(r);{let c=I(()=>t(G)-s/2),w=I(()=>g()-s/2);Qt(i,{name:"workflow",get x(){return t(c)},get y(){return t(w)},get width(){return s},get height(){return s},strokeWidth:"4",class:"text-black"})}H(v),K(()=>L(v,"height",o)),y(V,v),Wt()}var Yr=wt("<!><!>",1),Qr=Ht('<div><div class="flex w-full justify-between text-xs"><p class="w-60 -translate-x-24 rotate-90"> </p> <p class="w-60 translate-x-24 rotate-90"> </p></div></div> <svg><!><!><!><!><!></svg>',1),Jr=Ht('<div id="event-history-timeline-graph" class="relative h-auto overflow-auto border border-t-0 border-subtle bg-primary"><!></div>');function Ie(V,e){Pt(e,!1);const f=()=>st(be,"$activeGroupHeight",o),G=()=>st(er,"$eventStatusFilter",o),_=()=>st(rr,"$fullEventHistory",o),l=()=>st(qe,"$activeGroups",o),g=()=>st(se,"$eventFilterSort",o),s=()=>st(tr,"$timestamp",o),[o,A]=Bt(),v=k(),a=k(),m=k(),p=k(),r=k(),i=k(),c=k();var w=k(),E=k();let U=h(e,"x",8,0),O=h(e,"y",8,0),R=h(e,"workflow",8),z=h(e,"groups",8),F=h(e,"viewportHeight",8),B=h(e,"readOnly",8,!1),rt=h(e,"error",8,!1);const{height:ct,gutter:vt,radius:j}=Ct;let b=k(0),Z=k(0);const ut=at=>{var et;d(Z,(et=at==null?void 0:at.target)===null||et===void 0?void 0:et.scrollTop)};$(()=>(T(B()),f()),()=>{d(v,B()?0:f())}),$(()=>(T(z()),G()),()=>{d(a,Ne(z(),G()))}),$(()=>(bt(w),_(),T(R()),bt(E)),()=>{d(m,(d(w,_()[0])===null||bt(w)===void 0?void 0:bt(w).eventTime)<R().executionTime?d(E,_()[0])===null||bt(E)===void 0?void 0:bt(E).eventTime:R().executionTime)}),$(()=>(T(R()),t(m)),()=>{d(p,!le(R())&&t(m)||R().startTime)}),$(()=>(t(a),t(v)),()=>{d(r,Math.max(ct*(t(a).length+2),120)+t(v))}),$(()=>t(r),()=>{d(i,t(r)+120)}),$(()=>(l(),g(),t(v)),()=>{d(c,at=>{const et=l()===null||l()===void 0?void 0:l().filter(ht=>g()==="ascending"?parseInt(ht)<parseInt(at.id):parseInt(ht)>parseInt(at.id));return et!=null&&et.length?t(v):0})}),Jt(),zt();var nt=Jr(),At=W(nt);Ir(At,{get workflow(){return R()},get startTime(){return t(p)},children:ye,$$slots:{default:(at,et)=>{const ht=I(()=>et.endTime),S=I(()=>et.duration);var lt=Qr(),C=J(lt);let x;var yt=W(C),ot=W(yt),X=W(ot,!0);H(ot);var D=u(ot,2),q=W(D,!0);H(D),H(yt),H(C);var Y=u(C,2);let gt;var dt=W(Y);{let N=I(()=>[vt,0]),M=I(()=>[vt,t(r)]),Dt=I(()=>j/2);Ot(dt,{get startPoint(){return t(N)},get endPoint(){return t(M)},get strokeWidth(){return t(Dt)}})}var kt=u(dt);{let N=I(()=>[t(b)-vt,0]),M=I(()=>[t(b)-vt,t(r)]),Dt=I(()=>j/2);Ot(kt,{get startPoint(){return t(N)},get endPoint(){return t(M)},get strokeWidth(){return t(Dt)}})}var ft=u(kt);{let N=I(()=>vt-j/4),M=I(()=>t(b)-vt+j/4);Fr(ft,{get x1(){return t(N)},get x2(){return t(M)},get timelineHeight(){return t(r)},get startTime(){return t(p)},get duration(){return t(S)}})}var Et=u(ft);Xr(Et,{get workflow(){return R()},get y(){return ct},get length(){return t(b)}});var Lt=u(Et);ve(Lt,3,()=>t(a),N=>N.id,(N,M,Dt,mt)=>{const _t=I(()=>(T(t(Dt)),t(c),t(M),P(()=>(t(Dt)+2)*ct+t(c)(t(M)))));var xt=Yr(),$t=J(xt);{var tt=Tt=>{var Gt=Rt(),re=J(Gt);ce(re,()=>(t(M),P(()=>t(M).eventList.length)),ue=>{Kr(ue,{get y(){return t(_t)},get group(){return t(M)},get canvasWidth(){return t(b)},get startTime(){return t(p)},get endTime(){return t(ht)},get readOnly(){return B()}})}),y(Tt,Gt)};Q($t,Tt=>{(!F()||t(_t)>t(Z)-2*ct&&t(_t)<t(Z)+F()*ct)&&Tt(tt)})}var It=u($t);{var St=Tt=>{{let Gt=I(()=>t(_t)+1.33*j);Dr(Tt,{get y(){return t(Gt)},get group(){return t(M)},get canvasWidth(){return t(b)}})}};Q(It,Tt=>{T(B()),l(),t(M),P(()=>!B()&&l().includes(t(M).id))&&Tt(St)})}y(N,xt)}),H(Y),K((N,M)=>{x=Nt(C,1,"pointer-events-none sticky top-[120px]",null,x,{invisible:!!l().length}),pt(X,N),pt(q,M),L(Y,"x",U()),L(Y,"y",O()),L(Y,"viewBox",`0 0 ${t(b)??""} ${t(i)??""}`),L(Y,"height",t(i)),L(Y,"width",t(b)),gt=Nt(Y,0,"-mt-4 svelte-1fw3am",null,gt,{error:rt()})},[()=>(s(),t(p),P(()=>s()(t(p),{format:"short"}))),()=>(s(),T(t(ht)),P(()=>s()(t(ht),{format:"short"})))]),y(at,lt)}}}),H(nt),K(()=>Ze(nt,F()?`max-height: ${F()}px;`:"")),$e(nt,"clientWidth",at=>d(b,at)),Zt("scroll",nt,ut),y(V,nt),Wt(),A()}var Zr=Ht("<span></span> ",1),tn=Ht("<!> <!> <!> <!>",1),en=Ht('<!> <div class="flex flex-col gap-2"><!> <!></div> <div class="relative pb-24"><div class="surface-background sticky top-0 z-[11] flex flex-wrap items-center justify-between gap-2 border-b border-subtle pb-2 md:top-12 md:pt-2 xl:gap-8"><div class="flex items-center gap-2"><h2> </h2> <!></div> <div class="flex items-center gap-2"><!></div></div> <div class="flex w-full flex-col"><!></div></div> <!>',1);function rn(V,e){Pt(e,!1);const f=()=>st(de,"$page",o),G=()=>st(Tr,"$workflowRun",o),_=()=>st(se,"$eventFilterSort",o),l=()=>st(Yt,"$pauseLiveUpdates",o),g=()=>st(nr,"$filteredEventHistory",o),s=()=>st(ar,"$currentEventHistory",o),[o,A]=Bt(),v=k(),a=k(),m=k(),p=k(),r=k(),i=k(),c=k(),w=k(),E=k();Ce(()=>{Ye()});let U=k(!1);const O=()=>{const x=t(i)?"ascending":"descending";we(f().url,{sort:x},me)},R=()=>{we(f().url,{refresh_off:!l()},me)};$(()=>(t(v),f()),()=>{(x=>{d(v,x.namespace)})(f().params)}),$(()=>(t(a),G()),()=>{(x=>{d(a,x.workflow)})(G())}),$(()=>t(a),()=>{d(m,t(a)===null||t(a)===void 0?void 0:t(a).pendingActivities)}),$(()=>t(a),()=>{d(p,t(a)===null||t(a)===void 0?void 0:t(a).pendingNexusOperations)}),$(()=>f(),()=>{d(r,Er(f().url))}),$(()=>t(r),()=>{Xt(se,t(r).sort),Xt(Yt,t(r).refresh_off)}),$(()=>_(),()=>{d(i,_()==="descending")}),$(()=>(g(),t(m),t(p)),()=>{d(c,Ee(g(),"ascending",t(m),t(p)))}),$(()=>(t(i),t(c)),()=>{d(w,t(i)?[...t(c)].reverse():t(c))}),$(()=>s(),()=>{d(E,hr(s(),"ascending"))}),$(()=>(t(a),l()),()=>{!(!(t(a)===null||t(a)===void 0)&&t(a).isRunning)&&l()&&Xt(Yt,!1)}),Jt(),zt();var z=en(),F=J(z);Ke(F,{});var B=u(F,2),rt=W(B);{var ct=x=>{{let yt=I(()=>(t(a),P(()=>{var ot;return(ot=t(a))==null?void 0:ot.pendingWorkflowTask})));Qe(x,{get error(){return t(E)},get pendingTask(){return t(yt)}})}};Q(rt,x=>{t(E)&&x(ct)})}var vt=u(rt,2);{var j=x=>{Je(x,{get callbacks(){return t(a),P(()=>t(a).callbacks)}})};Q(vt,x=>{t(a),P(()=>{var yt,ot;return(ot=(yt=t(a))==null?void 0:yt.callbacks)==null?void 0:ot.length})&&x(j)})}H(B);var b=u(B,2),Z=W(b),ut=W(Z),nt=W(ut),At=W(nt,!0);H(nt);var at=u(nt,2);Be(at,{}),H(ut);var et=u(ut,2),ht=W(et);$r(ht,{children:(x,yt)=>{var ot=tn(),X=J(ot);{let gt=I(()=>t(i)?"descending":"ascending");ae(X,{get leadingIcon(){return t(gt)},"data-testid":"zoom-in",size:"sm",$$events:{click:O},children:(dt,kt)=>{oe();var ft=Ut();K(()=>pt(ft,t(i)?"Descending":"Ascending")),y(dt,ft)},$$slots:{default:!0}})}var D=u(X,2);Xe(D,{compact:!1,minimized:!1});var q=u(D,2);{let gt=I(()=>(t(a),P(()=>{var dt;return!((dt=t(a))!=null&&dt.isRunning)})));ae(q,{get disabled(){return t(gt)},"data-testid":"pause",class:"border-l-0",size:"sm",$$events:{click:R},children:(dt,kt)=>{var ft=Zr(),Et=J(ft),Lt=u(Et);K(N=>{Nt(Et,1,`h-1.5 w-1.5 rounded-full ${l(),t(a),P(()=>{var M;return l()||!((M=t(a))!=null&&M.isRunning)?"bg-slate-300":"bg-green-600"})??""}`),pt(Lt,` ${N??""}`)},[()=>(l(),t(a),T(it),P(()=>{var N;return l()||!((N=t(a))!=null&&N.isRunning)?it("workflows.auto-refresh-off"):it("workflows.auto-refresh-on")}))]),y(dt,ft)},$$slots:{default:!0}})}var Y=u(q,2);ae(Y,{"data-testid":"download",leadingIcon:"download",size:"sm",$$events:{click:()=>d(U,!0)},children:(gt,dt)=>{oe();var kt=Ut();K(ft=>pt(kt,ft),[()=>(T(it),P(()=>it("common.download")))]),y(gt,kt)},$$slots:{default:!0}}),y(x,ot)},$$slots:{default:!0}}),H(et),H(Z);var S=u(Z,2),lt=W(S);{let x=I(()=>(t(E),P(()=>!!t(E))));Ie(lt,{get workflow(){return t(a)},get groups(){return t(w)},viewportHeight:void 0,get error(){return t(x)}})}H(S),H(b);var C=u(b,2);Ve(C,{get namespace(){return t(v)},get workflowId(){return t(a),P(()=>t(a).id)},get runId(){return t(a),P(()=>t(a).runId)},get open(){return t(U)},set open(x){d(U,x)},$$legacy:!0}),K(x=>pt(At,x),[()=>(T(it),P(()=>it("workflows.timeline-tab")))]),y(V,z),Wt(),A()}var nn=Ht("<!> <!>",1);function Bn(V,e){Pt(e,!1);const f=()=>st(de,"$page",G),[G,_]=Bt(),l=f().params.workflow;zt();var g=nn(),s=J(g);{let A=I(()=>`${it("workflows.timeline-tab")} | ${l}`);je(s,{get title(){return t(A)},get url(){return f().url.href}})}var o=u(s,2);rn(o,{}),y(V,g),Wt(),_()}export{Bn as component};
