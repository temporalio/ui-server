import"../chunks/CWj6FrbW.js";import"../chunks/69_IOA4Y.js";import{p as $t,l as x,a as Kt,i as Ct,c as J,e as w,b as Tt,M as $,g as t,m as y,s as l,f as Pt,j as L,o as T,r as z,t as B,I as U,av as ht,bH as mt,h as p,n as Zt,ac as Ge,v as n,d as Oe,u as Fe,at as ie,aQ as Me,q as ye,k as Dt}from"../chunks/UnFCzZBm.js";import{i as Gt}from"../chunks/BBLBidKq.js";import{p as m,s as Rt,a as st,b as Xt,l as fe}from"../chunks/GmGfGY7t.js";import{p as de}from"../chunks/Dwxo_w7E.js";import{P as Ue}from"../chunks/Bu3uT3O7.js";import{t as ft}from"../chunks/DEjs8ZrU.js";import{s as vt,d as je,e as te}from"../chunks/CX2avYX0.js";import{b as Ce,g as me}from"../chunks/BU7d8K5s.js";import{s as be,a as xe,b as Ne,I as Re,D as Be,E as qe,c as Ve}from"../chunks/ZzO9vEdY.js";import{i as rt}from"../chunks/pI5hk1MB.js";import{k as ce}from"../chunks/DD-ctplv.js";import{e as ve,i as ke}from"../chunks/DMsHiW-d.js";import{s as E,b as Xe}from"../chunks/fCvEOUPS.js";import{s as Jt,c as Ye}from"../chunks/CDVS_aRO.js";import{b as $e}from"../chunks/BEPBwaRr.js";import{t as Je}from"../chunks/DJTfxBJa.js";import{p as Yt,g as Qe,f as Ke,e as se,b as Ze}from"../chunks/DDItt_LS.js";import{i as le}from"../chunks/Dzb719w0.js";import{L as At,D as re,a as tr}from"../chunks/BfATd3m4.js";import{E as er,T as Nt,e as rr,d as nr,M as ar,C as pe,t as or}from"../chunks/DPEaMjgq.js";import{a as ir,o as sr}from"../chunks/CDMQnRTF.js";import{s as lr}from"../chunks/D_idi4aj.js";import{p as ee,k as Te}from"../chunks/iEPjGoii.js";import{W as dr}from"../chunks/S4CKWv6E.js";import{B as cr}from"../chunks/iyExifMn.js";import{I as Qt}from"../chunks/dWO51a22.js";import{J as he,q as vr,p as ur}from"../chunks/Dnsu5D6o.js";import{a as gr}from"../chunks/DX0XWFAv.js";import{g as Ie}from"../chunks/B4V_56Kr.js";import{f as fr}from"../chunks/DhM9njwR.js";import{v as mr}from"../chunks/BQVzUIQ8.js";import{c as pr}from"../chunks/CROwkM3p.js";import{p as _e}from"../chunks/BgtcGMOc.js";import{a as hr}from"../chunks/Bt9FnE2Z.js";import{b as _r}from"../chunks/4awWeR2C.js";import{T as wr,a as oe}from"../chunks/AWhzZJWC.js";import{w as yr}from"../chunks/BuXSPDAs.js";import{u as we,p as br}from"../chunks/CtAKYQns.js";function xr(q,e){$t(e,!1);const g=()=>st(Yt,"$pauseLiveUpdates",D),[D,_]=Rt(),d=y(),v=y();let o=m(e,"workflow",8),i=m(e,"startTime",8);const I=()=>{const s=new Date;return s.setSeconds(s.getSeconds()+1),s};let a;const k=s=>{s&&(clearInterval(a),a=null)},f=s=>{s?(clearInterval(a),a=null):!a&&o().isRunning&&(a=setInterval(()=>{l(d,I())},1e3))};ir(()=>{clearInterval(a),a=null,Xt(Yt,!1)}),x(()=>$(o()),()=>{l(d,(o()===null||o()===void 0?void 0:o().endTime)||I())}),x(()=>($(i()),t(d)),()=>{l(v,ee({start:i(),end:t(d),onlyUnderSecond:!1}))}),x(()=>$(o()),()=>{k(o().endTime)}),x(()=>g(),()=>{f(g())}),Kt(),Gt();var u=Ct(),r=J(u);lr(r,e,"default",{get endTime(){return t(d)},get duration(){return t(v)}},null),w(q,u),Tt(),_()}var kr=Pt("<div><!></div>");function $r(q,e){const g=fe(e,["children","$$slots","$$events","$$legacy"]),D=fe(g,["namespace","workflowId","runId","viewportHeight","onLoad"]);$t(e,!1);let _=m(e,"namespace",8),d=m(e,"workflowId",8),v=m(e,"runId",8,""),o=m(e,"viewportHeight",8,360),i=m(e,"onLoad",8,()=>{});const I=async()=>{const[u,r]=await Promise.all([mr({namespace:_(),workflowId:d(),runId:v()}),fr({namespace:_(),workflowId:d(),runId:v()})]);return{workflow:u.workflow,history:r}},a=(u,r)=>{var s;i()();const c=(s=u==null?void 0:u.pendingActivities)!==null&&s!==void 0?s:[];return Ie(r,"ascending",c)};Gt();var k=Ct(),f=J(k);gr(f,()=>U(I),null,(u,r)=>{var s=T(()=>{var{workflow:H,history:F}=t(r);return{workflow:H,history:F}}),c=T(()=>t(s).workflow),h=T(()=>t(s).history),P=kr(),N=L(P);{let H=T(()=>($(t(c)),$(t(h)),U(()=>a(t(c),t(h)))));Pe(N,{get viewportHeight(){return o()},get workflow(){return t(c)},get groups(){return t(H)},readOnly:!0})}z(P),B(()=>Jt(P,1,`cursor-pointer overflow-auto ${$(D),U(()=>D.class)??""}`)),w(u,P)}),w(q,k),Tt()}var Tr=Pt('<div class="flex items-center gap-1"><!> </div>'),Ir=Pt(" <!>",1),Pr=Pt('<div class="surface-primary p-4"><div class="font-medium leading-4 text-secondary">Child Workflow</div> <!></div>'),Er=mt('<g role="button" tabindex="0" class="relative z-50 svelte-1qsv8v3"><foreignObject><div class="flex flex-col"><div class="relative flex h-full items-center justify-between bg-slate-50 text-sm dark:bg-slate-800"><div class="flex h-full items-center gap-4 px-2"><!> <!></div> <div class="flex items-center gap-4"><!></div></div> <div class="surface-primary"><!></div> <!></div></foreignObject></g>');function Hr(q,e){$t(e,!1);const g=()=>st(de,"$page",D),[D,_]=Rt(),d=y(),v=y(),o=y(),i=y(),I=y(),a=y(),k=y();var f=y(),u=y();let r=m(e,"group",8),s=m(e,"canvasWidth",8),c=m(e,"x",8,0),h=m(e,"y",8),P=y();const N=S=>{Xt(xe,S)},H=async()=>{await Ge(),l(d,t(P))};x(()=>t(P),()=>{l(d,t(P)||0)}),x(()=>t(d),()=>{N(t(d)||0)}),x(()=>$(r()),()=>{l(v,(r()===null||r()===void 0?void 0:r().finalClassification)||(r()===null||r()===void 0?void 0:r().classification))}),x(()=>(t(o),g()),()=>{(S=>{l(o,S.namespace)})(g().params)}),x(()=>$(s()),()=>{l(i,s())}),x(()=>$(r()),()=>{l(I,r().displayName)}),x(()=>($(r()),he),()=>{l(a,r()&&r().eventList.find(he))}),x(()=>(ht(f),$(r()),ht(u)),()=>{l(k,Te({start:l(f,r()===null||r()===void 0?void 0:r().initialEvent)===null||ht(f)===void 0?void 0:ht(f).eventTime,end:l(u,r()===null||r()===void 0?void 0:r().lastEvent)===null||ht(u)===void 0?void 0:ht(u).eventTime,includeMilliseconds:!0}))}),x(()=>($(r()),ft),()=>{!(r()===null||r()===void 0)&&r().pendingActivity&&(r().pendingActivity.paused?l(v,ft("workflows.paused")):r().pendingActivity.attempt>1?l(v,ft("events.event-classification.retrying")):l(v,ft("events.event-classification.pending")))}),Kt(),Gt();var F=Er(),W=L(F),A=L(W),R=L(A),ot=L(R),it=L(ot);{var lt=S=>{dr(S,{get status(){return t(v)}})};rt(it,S=>{t(v)&&S(lt)})}var G=p(it),b=p(G);{var nt=S=>{var V=Tr(),O=L(V);Qt(O,{name:"clock"});var X=p(O);z(V),B(()=>vt(X,` ${t(k)??""}`)),w(S,V)};rt(b,S=>{t(k)&&S(nt)})}z(ot);var j=p(ot,2),ut=L(j);cr(ut,{variant:"ghost",size:"xs",$$events:{click:()=>be(r())},children:(S,V)=>{Zt();var O=Ir(),X=J(O),pt=p(X);Qt(pt,{name:"close"}),B(xt=>vt(X,`${xt??""} `),[()=>($(ft),U(()=>ft("common.close")))]),w(S,O)},$$slots:{default:!0}}),z(j),z(R);var bt=p(R,2),Q=L(bt);er(Q,{get group(){return r()},get event(){return $(r()),U(()=>r().initialEvent)}}),z(bt);var K=p(bt,2);{var dt=S=>{var V=Pr(),O=p(L(V),2);ce(O,()=>($(r()),U(()=>r().eventList.length)),X=>{$r(X,{get namespace(){return t(o)},get workflowId(){return t(a),U(()=>t(a).attributes.workflowExecution.workflowId)},get runId(){return t(a),U(()=>t(a).attributes.workflowExecution.runId)},viewportHeight:320,class:"surface-primary overflow-x-hidden border-t border-subtle",onLoad:H})}),z(V),w(S,V)};rt(K,S=>{t(a)&&S(dt)})}z(A),z(W),z(F),B(()=>{E(W,"x",c()),E(W,"y",h()),E(W,"width",t(i)),E(W,"height",t(d)),vt(G,` ${t(I)??""} `)}),$e(A,"offsetHeight",S=>l(P,S)),w(q,F),Tt(),_()}var Wr=mt('<text fill="#fff" font-size="12" class="svelte-7nuc95"> </text>'),Ar=mt("<!><!>",1),Sr=mt("<!><!>",1);function Lr(q,e){$t(e,!0);let g=m(e,"x1",3,0),D=m(e,"x2",3,1e3),_=m(e,"timelineHeight",3,1e3);const{radius:d}=Nt,v=20,o=n(()=>D()-g()),i=n(()=>t(o)/v);var I=Sr(),a=J(I);{let f=n(()=>d/2),u=n(()=>[g(),_()]),r=n(()=>[g()+t(o),_()]);At(a,{get strokeWidth(){return t(f)},get startPoint(){return t(u)},get endPoint(){return t(r)}})}var k=p(a);ve(k,17,()=>Array(v),ke,(f,u,r)=>{const s=n(()=>g()+r*t(i)),c=n(()=>_()+d*2);var h=Ar(),P=J(h);{var N=W=>{{let A=n(()=>[t(s),0]),R=n(()=>[t(s),_()]);At(W,{strokeWidth:.5,get startPoint(){return t(A)},get endPoint(){return t(R)},strokeDasharray:"2"})}};rt(P,W=>{r!==0&&W(N)})}var H=p(P);{var F=W=>{var A=Wr(),R=L(A,!0);z(A),B(ot=>{E(A,"transform",`rotate(90, ${t(s)??""}, ${t(c)??""})`),E(A,"x",t(s)-d),E(A,"y",t(c)+3),vt(R,ot)},[()=>Te({start:e.startTime,end:new Date(new Date(e.startTime.toString()).getTime()+e.duration/v*r),includeMilliseconds:e.duration/v<1e3})]),w(W,A)};rt(H,W=>{r!==0&&W(F)})}w(f,h)}),w(q,I),Tt()}var zr=mt("<text><!></text>"),Dr=mt("<!><!><!>",1);function Gr(q,e){$t(e,!0);var g;let D=m(e,"point",19,()=>[0,0]),_=m(e,"category",3,void 0),d=m(e,"status",3,"none"),v=m(e,"fontSize",3,"13px"),o=m(e,"fontWeight",3,"400"),i=m(e,"textAnchor",3,"start"),I=m(e,"backdrop",3,!1),a=m(e,"backdropHeight",3,0),k=m(e,"icon",3,void 0),f=m(e,"config",3,void 0),u=m(e,"label",3,!1);const r=n(()=>Me(D(),2)),s=n(()=>t(r)[0]),c=n(()=>t(r)[1]);let h=ie(void 0);const P=n(()=>k()&&f()),N=n(()=>((g=t(h)===null||t(h)===void 0?void 0:t(h).getBBox())===null||g===void 0?void 0:g.width)||0),H=n(()=>t(P)?t(N)+36:t(N)+12),F=n(()=>t(P)&&i()==="start"?t(s)+f().radius*2:t(s));var W=Dr(),A=J(W);{var R=G=>{{let b=n(()=>[t(s)-a(),t(c)]),nt=n(()=>[t(s)+t(H),t(c)]);At(G,{get startPoint(){return t(b)},get endPoint(){return t(nt)},get status(){return d()},get strokeWidth(){return a()}})}};rt(A,G=>{I()&&G(R)})}var ot=p(A);{var it=G=>{{let b=n(()=>i()==="end"?t(s)-t(N)-a():t(s)),nt=n(()=>t(c)-8),j=n(()=>I()?"text-white":"text-primary");Qt(G,{get name(){return k()},get x(){return t(b)},get y(){return t(nt)},get class(){return t(j)}})}};rt(ot,G=>{t(P)&&G(it)})}var lt=p(ot);ce(lt,()=>t(F),G=>{var b=zr();let nt;var j=L(b);Oe(j,()=>e.children??Fe),z(b),_r(b,ut=>l(h,ut),()=>t(h)),B(()=>{nt=Jt(b,0,`cursor-pointer select-none outline-none ${_()??""} text-primary`,"svelte-gowbbf",nt,{label:u(),backdrop:I()}),E(b,"x",t(F)),E(b,"y",t(c)+1),E(b,"font-size",v()),E(b,"font-weight",o()),E(b,"text-anchor",i())}),w(G,b)}),w(q,W),Tt()}var Or=mt("<foreignObject><div></div></foreignObject>"),Fr=mt('<rect fill="transparent" pointer-events="all"></rect>'),Mr=mt("<!><!>",1),Ur=mt("<!><!><!><!>",1),jr=mt('<!><g role="button" tabindex="0" class="relative cursor-pointer svelte-1vsmkab"><!><!></g>',1);function Cr(q,e){$t(e,!0);const g=()=>st(hr,"$authUser",D),[D,_]=Rt();var d,v;let o=m(e,"y",3,0),i=m(e,"group",7),I=m(e,"readOnly",3,!1);const{height:a,gutter:k,radius:f}=Nt;let u=ie(!1);const r=n(()=>e.canvasWidth-2*k),s=n(()=>i()===null||i()===void 0?void 0:i().pendingActivity),c=n(()=>t(s)&&((d=t(s).pauseInfo)===null||d===void 0?void 0:d.pauseTime));let h=ie(void 0);sr(async()=>{const at=rr(i());if(at)try{l(h,await nr(at,{namespace:_e.params.namespace,settings:_e.data.settings,accessToken:g().accessToken}),!0),t(h)&&(i().decodedLocalActivity=t(h))}catch(M){console.warn("Failed to decode local activity:",M)}});const P=(at,M,Z)=>{const tt=ee({start:e.startTime,end:at,onlyUnderSecond:!1}),Et=i().eventList.map(Ft=>{const C=ee({start:e.startTime,end:Ft.eventTime,onlyUnderSecond:!1})/tt;return Math.round(C*M)+k});if(t(c)){const et=ee({start:e.startTime,end:t(c),onlyUnderSecond:!1})/tt,C=Math.round(et*M)+k;Et.push(C)}const{textAnchor:St,textIndex:Lt,textPosition:Ot,backdrop:zt}=or(Et,Z,M,i().isPending,Nt);return{points:Et,textAnchor:St,textIndex:Lt,textPosition:Ot,backdrop:zt}},N=n(()=>P(e.endTime,t(r),o())),H=n(()=>t(N).points),F=n(()=>t(N).textAnchor),W=n(()=>t(N).textIndex),A=n(()=>t(N).textPosition),R=n(()=>t(N).backdrop),ot=()=>{I()||be(i())},it=()=>{I()||l(u,!0)},lt=()=>{I()||l(u,!1)},G=n(()=>i().eventList.find(ur)),b=n(()=>t(G)&&((v=t(G).attributes)===null||v===void 0?void 0:v.attempt)>1),nt=n(()=>i().isPending||!!t(c)),j=n(()=>t(H).length>=2&&t(H)[t(H).length-1]-t(H)[0]+f*3),ut=n(()=>i().isPending&&e.canvasWidth-t(H)[0]-f*1.5),bt=n(()=>f*3),Q=n(()=>t(ut)||t(j)||t(bt)),K=pr(["h-full w-full rounded-full border-2"],{variants:{category:{workflow:"border-blue-700 bg-blue-800/80 ",activity:"border-purple-700 bg-purple-800/80 ","child-workflow":"border-cyan-600  bg-cyan-600/80 ",timer:"border-yellow-700 bg-yellow-800/80",signal:"border-pink-700 bg-pink-800/80",update:"border-blue-700 bg-blue-800/80",other:"border-slate-700 bg-slate-800/80",nexus:"border-indigo-700 bg-indigo-800/80","local-activity":"border-slate-700 bg-slate-800/80",default:"border-purple-700 bg-purple-900/80"}}});var dt=jr(),S=J(dt);{var V=at=>{var M=Or(),Z=L(M);z(M),B(tt=>{E(M,"x",t(H)[0]-f*1.5),E(M,"y",o()-f*1.5),E(M,"width",t(Q)),E(M,"height",f*3),Jt(Z,1,tt)},[()=>Ye(K({category:i()?i().category:"default"}))]),w(at,M)};rt(S,at=>{t(u)&&at(V)})}var O=p(S);O.__click=ot;var X=L(O);{var pt=at=>{const M=n(()=>t(c)?t(H)[1]-t(H)[0]:e.canvasWidth-2*k);var Z=Fr();B(()=>{E(Z,"y",o()-a/2),E(Z,"x",t(H)[0]),E(Z,"width",t(M)),E(Z,"height",a)}),w(at,Z)};rt(X,at=>{t(nt)&&at(pt)})}var xt=p(X);ve(xt,17,()=>t(H),ke,(at,M,Z)=>{const tt=n(()=>t(H)[Z+1]),Et=n(()=>t(W)===Z);var St=Ur(),Lt=J(St);{var Ot=ct=>{{let gt=n(()=>[t(M),o()]),_t=n(()=>[t(tt),o()]),wt=n(()=>!!t(c)),Y=n(()=>!!t(c)),kt=n(()=>f*2),It=n(()=>Z===0&&i().lastEvent.classification==="Completed");At(ct,{get startPoint(){return t(gt)},get endPoint(){return t(_t)},get category(){return i().category},get classification(){return i().lastEvent.classification},get pending(){return t(wt)},get paused(){return t(Y)},get strokeWidth(){return t(kt)},get retried(){return t(b)},get scheduling(){return t(It)}})}};rt(Lt,ct=>{t(tt)&&ct(Ot)})}var zt=p(Lt);{var Ft=ct=>{var gt=Mr(),_t=J(gt);{let Y=n(()=>[t(M),o()]),kt=n(()=>[e.canvasWidth-k,o()]),It=n(()=>t(s)?t(s).attempt>1?"retry":"pending":i().category),yt=n(()=>!!t(c)),Wt=n(()=>f*2);At(_t,{get startPoint(){return t(Y)},get endPoint(){return t(kt)},get category(){return t(It)},get classification(){return i().lastEvent.classification},pending:!0,get paused(){return t(yt)},get strokeWidth(){return t(Wt)}})}var wt=p(_t);{let Y=n(()=>[t(M),o()]);re(wt,{get point(){return t(Y)},get classification(){return i().lastEvent.classification},icon:"retry",get r(){return f}})}w(ct,gt)};rt(zt,ct=>{!t(tt)&&i().isPending&&!t(c)&&ct(Ft)})}var et=p(zt);{var C=ct=>{{let gt=n(()=>{var Y,kt;return(kt=(Y=i())==null?void 0:Y.userMetadata)==null?void 0:kt.summary}),_t=n(()=>{var Y;return vr(i().initialEvent)?(Y=i())==null?void 0:Y.displayName:""}),wt=n(()=>{var Y;return t(h)?ft("events.category.local-activity"):(Y=i())==null?void 0:Y.displayName});ar(ct,{get value(){return t(gt)},get prefix(){return t(_t)},get fallback(){return t(wt)},children:ye,$$slots:{default:(Y,kt)=>{const It=n(()=>kt.decodedValue);{let yt=n(()=>f*2),Wt=n(()=>t(s)&&!t(s).paused||t(b)?"retry":void 0);Gr(Y,{get point(){return t(A)},get textAnchor(){return t(F)},get backdrop(){return t(R)},get backdropHeight(){return t(yt)},get config(){return Nt},get icon(){return t(Wt)},children:(ne,ue)=>{var ge=Ct(),Ee=J(ge);{var He=Mt=>{var Bt=Dt();B(ae=>vt(Bt,`${ae??""}
            ${t(s).attempt??""} / ${(t(s).maximumAttempts||"∞")??""}
            • 
            ${t(It)??""}`),[()=>ft("workflows.attempt")]),w(Mt,Bt)},We=Mt=>{var Bt=Ct(),ae=J(Bt);{var Ae=Ut=>{var qt=Dt();B(()=>vt(qt,`${t(G).attributes.attempt??""} • ${t(It)??""}`)),w(Ut,qt)},Se=Ut=>{var qt=Ct(),Le=J(qt);{var ze=jt=>{var Vt=Dt();B(()=>vt(Vt,t(h).value)),w(jt,Vt)},De=jt=>{var Vt=Dt();B(()=>vt(Vt,t(It))),w(jt,Vt)};rt(Le,jt=>{t(h)?jt(ze):jt(De,!1)},!0)}w(Ut,qt)};rt(ae,Ut=>{t(b)?Ut(Ae):Ut(Se,!1)},!0)}w(Mt,Bt)};rt(Ee,Mt=>{t(s)?Mt(He):Mt(We,!1)})}w(ne,ge)},$$slots:{default:!0}})}}}})}};rt(et,ct=>{t(Et)&&ct(C)})}var Ht=p(et);{let ct=n(()=>[t(M),o()]),gt=n(()=>{var wt;return(wt=i().eventList[Z])==null?void 0:wt.classification}),_t=n(()=>t(c)&&Z!==0?"pause":t(h)?pe["local-activity"]:pe[i().category]);re(Ht,{get point(){return t(ct)},get classification(){return t(gt)},get icon(){return t(_t)},get r(){return f}})}w(at,St)}),z(O),B(()=>E(O,"height",a)),te("keypress",O,ot),te("mouseenter",O,it),te("mouseleave",O,lt),w(q,dt),Tt(),_()}je(["click"]);var Nr=mt('<g role="button" tabindex="0" class="relative cursor-pointer svelte-1hb0j3w"><!><!><!><!><!></g>');function Rr(q,e){$t(e,!1);const g=y(),D=y();let _=m(e,"workflow",8),d=m(e,"length",8),v=m(e,"y",8);const{radius:o,height:i,gutter:I}=Nt;x(()=>{},()=>{l(g,I)}),x(()=>(t(g),$(d())),()=>{l(D,t(g)+d()-2*I)}),Kt(),Gt();var a=Nr(),k=L(a);{let c=T(()=>[t(g),v()]),h=T(()=>[t(D),v()]),P=T(()=>o*2),N=T(()=>($(le),$(_()),U(()=>le(_()))));At(k,{get startPoint(){return t(c)},get endPoint(){return t(h)},get status(){return $(_()),U(()=>_().status)},get strokeWidth(){return t(P)},get pending(){return $(_()),U(()=>_().isRunning)},get delayed(){return t(N)}})}var f=p(k);{let c=T(()=>[t(g),v()]);re(f,{get point(){return t(c)},get classification(){return $(_()),U(()=>_().status)},get r(){return o}})}var u=p(f);{let c=T(()=>t(g)-o/2),h=T(()=>v()-o/2);Qt(u,{name:"workflow",get x(){return t(c)},get y(){return t(h)},get width(){return o},get height(){return o},strokeWidth:"4",class:"text-black"})}var r=p(u);{let c=T(()=>[t(D),v()]);re(r,{get point(){return t(c)},get classification(){return $(_()),U(()=>_().status)},get r(){return o}})}var s=p(r);{let c=T(()=>t(D)-o/2),h=T(()=>v()-o/2);Qt(s,{name:"workflow",get x(){return t(c)},get y(){return t(h)},get width(){return o},get height(){return o},strokeWidth:"4",class:"text-black"})}z(a),B(()=>E(a,"height",i)),w(q,a),Tt()}var Br=mt("<!><!>",1),qr=Pt('<div><div class="flex w-full justify-between text-xs"><p class="w-60 -translate-x-24 rotate-90"> </p> <p class="w-60 translate-x-24 rotate-90"> </p></div></div> <svg><!><!><!><!><!></svg>',1),Vr=Pt('<div id="event-history-timeline-graph" class="relative h-auto overflow-auto border border-t-0 border-subtle bg-primary"><!></div>');function Pe(q,e){$t(e,!1);const g=()=>st(xe,"$activeGroupHeight",i),D=()=>st(Qe,"$eventStatusFilter",i),_=()=>st(Ke,"$fullEventHistory",i),d=()=>st(Ne,"$activeGroups",i),v=()=>st(se,"$eventFilterSort",i),o=()=>st(Je,"$timestamp",i),[i,I]=Rt(),a=y(),k=y(),f=y(),u=y(),r=y(),s=y(),c=y();var h=y(),P=y();let N=m(e,"x",8,0),H=m(e,"y",8,0),F=m(e,"workflow",8),W=m(e,"groups",8),A=m(e,"viewportHeight",8),R=m(e,"readOnly",8,!1),ot=m(e,"error",8,!1);const{height:it,gutter:lt,radius:G}=Nt;let b=y(0),nt=y(0);const j=Q=>{var K;l(nt,(K=Q==null?void 0:Q.target)===null||K===void 0?void 0:K.scrollTop)};x(()=>($(R()),g()),()=>{l(a,R()?0:g())}),x(()=>($(W()),D()),()=>{l(k,tr(W(),D()))}),x(()=>(ht(h),_(),$(F()),ht(P)),()=>{l(f,(l(h,_()[0])===null||ht(h)===void 0?void 0:ht(h).eventTime)<F().executionTime?l(P,_()[0])===null||ht(P)===void 0?void 0:ht(P).eventTime:F().executionTime)}),x(()=>($(F()),t(f)),()=>{l(u,!le(F())&&t(f)||F().startTime)}),x(()=>(t(k),t(a)),()=>{l(r,Math.max(it*(t(k).length+2),120)+t(a))}),x(()=>t(r),()=>{l(s,t(r)+120)}),x(()=>(d(),v(),t(a)),()=>{l(c,Q=>{const K=d()===null||d()===void 0?void 0:d().filter(dt=>v()==="ascending"?parseInt(dt)<parseInt(Q.id):parseInt(dt)>parseInt(Q.id));return K!=null&&K.length?t(a):0})}),Kt(),Gt();var ut=Vr(),bt=L(ut);xr(bt,{get workflow(){return F()},get startTime(){return t(u)},children:ye,$$slots:{default:(Q,K)=>{const dt=T(()=>K.endTime),S=T(()=>K.duration);var V=qr(),O=J(V);let X;var pt=L(O),xt=L(pt),at=L(xt,!0);z(xt);var M=p(xt,2),Z=L(M,!0);z(M),z(pt),z(O);var tt=p(O,2);let Et;var St=L(tt);{let et=T(()=>[lt,0]),C=T(()=>[lt,t(r)]),Ht=T(()=>G/2);At(St,{get startPoint(){return t(et)},get endPoint(){return t(C)},get strokeWidth(){return t(Ht)}})}var Lt=p(St);{let et=T(()=>[t(b)-lt,0]),C=T(()=>[t(b)-lt,t(r)]),Ht=T(()=>G/2);At(Lt,{get startPoint(){return t(et)},get endPoint(){return t(C)},get strokeWidth(){return t(Ht)}})}var Ot=p(Lt);{let et=T(()=>lt-G/4),C=T(()=>t(b)-lt+G/4);Lr(Ot,{get x1(){return t(et)},get x2(){return t(C)},get timelineHeight(){return t(r)},get startTime(){return t(u)},get duration(){return t(S)}})}var zt=p(Ot);Rr(zt,{get workflow(){return F()},get y(){return it},get length(){return t(b)}});var Ft=p(zt);ve(Ft,3,()=>t(k),et=>et.id,(et,C,Ht,ct)=>{const gt=T(()=>($(t(Ht)),t(c),t(C),U(()=>(t(Ht)+2)*it+t(c)(t(C)))));var _t=Br(),wt=J(_t);{var Y=yt=>{var Wt=Ct(),ne=J(Wt);ce(ne,()=>(t(C),U(()=>t(C).eventList.length)),ue=>{Cr(ue,{get y(){return t(gt)},get group(){return t(C)},get canvasWidth(){return t(b)},get startTime(){return t(u)},get endTime(){return t(dt)},get readOnly(){return R()}})}),w(yt,Wt)};rt(wt,yt=>{(!A()||t(gt)>t(nt)-2*it&&t(gt)<t(nt)+A()*it)&&yt(Y)})}var kt=p(wt);{var It=yt=>{{let Wt=T(()=>t(gt)+1.33*G);Hr(yt,{get y(){return t(Wt)},get group(){return t(C)},get canvasWidth(){return t(b)}})}};rt(kt,yt=>{$(R()),d(),t(C),U(()=>!R()&&d().includes(t(C).id))&&yt(It)})}w(et,_t)}),z(tt),B((et,C)=>{X=Jt(O,1,"pointer-events-none sticky top-[120px]",null,X,{invisible:!!d().length}),vt(at,et),vt(Z,C),E(tt,"x",N()),E(tt,"y",H()),E(tt,"viewBox",`0 0 ${t(b)??""} ${t(s)??""}`),E(tt,"height",t(s)),E(tt,"width",t(b)),Et=Jt(tt,0,"-mt-4 svelte-1fw3am",null,Et,{error:ot()})},[()=>(o(),t(u),U(()=>o()(t(u),{format:"short"}))),()=>(o(),$(t(dt)),U(()=>o()(t(dt),{format:"short"})))]),w(Q,V)}}}),z(ut),B(()=>Xe(ut,A()?`max-height: ${A()}px;`:"")),$e(ut,"clientWidth",Q=>l(b,Q)),te("scroll",ut,j),w(q,ut),Tt(),I()}var Xr=Pt("<!> <!> <!> <!>",1),Yr=Pt('<!> <div class="relative pb-24"><div class="surface-background sticky top-0 z-30 flex flex-wrap items-center justify-between gap-2 border-b border-subtle pb-2 md:top-12 xl:gap-8"><h2> </h2> <div class="flex items-center gap-2"><!></div></div> <div class="flex w-full flex-col"><!></div></div> <!>',1);function Jr(q,e){$t(e,!1);const g=()=>st(de,"$page",o),D=()=>st(yr,"$workflowRun",o),_=()=>st(se,"$eventFilterSort",o),d=()=>st(Yt,"$pauseLiveUpdates",o),v=()=>st(Ze,"$filteredEventHistory",o),[o,i]=Rt(),I=y(),a=y(),k=y(),f=y(),u=y(),r=y(),s=y(),c=y();Ce(()=>{Ve()});let h=y(!1);const P=()=>{const j=t(r)?"ascending":"descending";we(g().url,{sort:j},me)},N=()=>{we(g().url,{frozen:!d()},me)};x(()=>(t(I),g()),()=>{(j=>{l(I,j.namespace)})(g().params)}),x(()=>(t(a),D()),()=>{(j=>{l(a,j.workflow)})(D())}),x(()=>t(a),()=>{l(k,t(a)===null||t(a)===void 0?void 0:t(a).pendingActivities)}),x(()=>t(a),()=>{l(f,t(a)===null||t(a)===void 0?void 0:t(a).pendingNexusOperations)}),x(()=>g(),()=>{l(u,br(g().url))}),x(()=>t(u),()=>{Xt(se,t(u).sort),Xt(Yt,t(u).frozen)}),x(()=>_(),()=>{l(r,_()==="descending")}),x(()=>(v(),t(k),t(f)),()=>{l(s,Ie(v(),"ascending",t(k),t(f)))}),x(()=>(t(r),t(s)),()=>{l(c,t(r)?[...t(s)].reverse():t(s))}),x(()=>(t(a),d()),()=>{!t(a).isRunning&&d()&&Xt(Yt,!1)}),Kt(),Gt();var H=Yr(),F=J(H);Re(F,{});var W=p(F,2),A=L(W),R=L(A),ot=L(R,!0);z(R);var it=p(R,2),lt=L(it);wr(lt,{children:(j,ut)=>{var bt=Xr(),Q=J(bt);{let V=T(()=>t(r)?"descending":"ascending");oe(Q,{get leadingIcon(){return t(V)},"data-testid":"zoom-in",size:"sm",$$events:{click:P},children:(O,X)=>{Zt();var pt=Dt();B(()=>vt(pt,t(r)?"Descending":"Ascending")),w(O,pt)},$$slots:{default:!0}})}var K=p(Q,2);qe(K,{compact:!1,minimized:!1});var dt=p(K,2);{let V=T(()=>(t(a),U(()=>!t(a).isRunning))),O=T(()=>d()?"play":"pause");oe(dt,{get disabled(){return t(V)},get leadingIcon(){return t(O)},"data-testid":"pause",class:"border-l-0",size:"sm",$$events:{click:N},children:(X,pt)=>{Zt();var xt=Dt();B(()=>vt(xt,d()?"Unfreeze":"Freeze")),w(X,xt)},$$slots:{default:!0}})}var S=p(dt,2);oe(S,{"data-testid":"download",leadingIcon:"download",size:"sm",$$events:{click:()=>l(h,!0)},children:(V,O)=>{Zt();var X=Dt();B(pt=>vt(X,pt),[()=>($(ft),U(()=>ft("common.download")))]),w(V,X)},$$slots:{default:!0}}),w(j,bt)},$$slots:{default:!0}}),z(it),z(A);var G=p(A,2),b=L(G);Pe(b,{get workflow(){return t(a)},get groups(){return t(c)},viewportHeight:void 0}),z(G),z(W);var nt=p(W,2);Be(nt,{get namespace(){return t(I)},get workflowId(){return t(a),U(()=>t(a).id)},get runId(){return t(a),U(()=>t(a).runId)},get open(){return t(h)},set open(j){l(h,j)},$$legacy:!0}),B(j=>vt(ot,j),[()=>($(ft),U(()=>ft("workflows.timeline-tab")))]),w(q,H),Tt(),i()}var Qr=Pt("<!> <!>",1);function Mn(q,e){$t(e,!1);const g=()=>st(de,"$page",D),[D,_]=Rt(),d=g().params.workflow;Gt();var v=Qr(),o=J(v);{let I=T(()=>`${ft("workflows.timeline-tab")} | ${d}`);Ue(o,{get title(){return t(I)},get url(){return g().url.href}})}var i=p(o,2);Jr(i,{}),w(q,v),Tt(),_()}export{Mn as component};
