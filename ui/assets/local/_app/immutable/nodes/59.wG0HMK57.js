import"../chunks/CWj6FrbW.js";import"../chunks/69_IOA4Y.js";import{p as At,l as k,a as Vt,i as Zt,c as et,e as b,b as St,O as $,g as t,m as _,s as l,f as Lt,j as W,o as P,r as I,t as V,K as L,az as bt,bR as yt,h as u,n as ee,af as Ie,v as n,d as He,u as Ae,ax as re,aU as Se,q as me,k as Ut}from"../chunks/DZ1-1a5q.js";import{i as Ft}from"../chunks/Bby3K3wO.js";import{p as h,s as Nt,a as st,b as Bt,l as de}from"../chunks/TaaIktnz.js";import{p as oe}from"../chunks/DFkz0NIp.js";import{P as Le}from"../chunks/BvHFjIFb.js";import{t as it}from"../chunks/DEjs8ZrU.js";import{s as mt,d as De,a as Ge,e as Yt}from"../chunks/DxwvfIkW.js";import{i as tt}from"../chunks/DnKg3jxh.js";import{s as Ct,c as Oe}from"../chunks/B3h3Bc2r.js";import{b as ze,g as ce}from"../chunks/dh9yT-f0.js";import{L as zt,D as Qt,a as Fe,E as Me}from"../chunks/C5HLaX3U.js";import{s as pe,b as he,d as Ue,I as je,D as Ce,E as Ne,c as Re,W as Be,a as qe}from"../chunks/rApGrhnx.js";import{k as ie}from"../chunks/DhxkE7tO.js";import{e as se,i as _e}from"../chunks/DGhzC9On.js";import{s as D,b as Ke}from"../chunks/D3L9VHHD.js";import{b as we}from"../chunks/w-8oIT2o.js";import{t as Ve}from"../chunks/4Dr_hdgK.js";import{p as qt,h as Xe,f as Ye,e as ne,b as Je,g as Qe}from"../chunks/Pg_53ZcC.js";import{i as ae}from"../chunks/Dzb719w0.js";import{b as Ze,T as jt,j as tr,d as er,M as rr,C as ve,t as nr}from"../chunks/C59phNuv.js";import{a as ar,o as or}from"../chunks/D7JzDj9r.js";import{s as ir}from"../chunks/DMJjfc0_.js";import{p as Jt,g as ye}from"../chunks/CrZfxCV7.js";import{W as sr}from"../chunks/DPVSJDnS.js";import{B as lr}from"../chunks/D5BzRETI.js";import{I as Kt}from"../chunks/BwERH40W.js";import{K as ue,r as dr,p as cr,o as vr}from"../chunks/BeRQMQBb.js";import{a as ur}from"../chunks/Ave-ZrbK.js";import{g as ke}from"../chunks/CCyjrG4D.js";import{f as gr}from"../chunks/DPBDE75s.js";import{v as fr}from"../chunks/D4fB6g5Q.js";import{c as mr}from"../chunks/CqqsKTDn.js";import{p as ge}from"../chunks/BkzJhme6.js";import{a as pr}from"../chunks/urDygoU8.js";import{b as hr}from"../chunks/CpT1VbVb.js";import{T as _r,a as te}from"../chunks/Rv-oCG-a.js";import{w as wr}from"../chunks/D3HmRl1U.js";import{u as fe,p as yr}from"../chunks/CGKJjPH8.js";function kr(X,e){At(e,!1);const f=()=>st(qt,"$pauseLiveUpdates",z),[z,w]=Nt(),d=_(),g=_();let i=h(e,"workflow",8),a=h(e,"startTime",8);const H=()=>{const s=new Date;return s.setSeconds(s.getSeconds()+1),s};let v;const o=s=>{s&&(clearInterval(v),v=null)},m=s=>{s?(clearInterval(v),v=null):!v&&(i().isRunning||i().isPaused)&&(v=setInterval(()=>{l(d,H())},1e3))};ar(()=>{clearInterval(v),v=null,Bt(qt,!1)}),k(()=>$(i()),()=>{l(d,(i()===null||i()===void 0?void 0:i().endTime)||H())}),k(()=>($(a()),t(d)),()=>{l(g,Jt({start:a(),end:t(d),onlyUnderSecond:!1}))}),k(()=>$(i()),()=>{o(i().endTime)}),k(()=>f(),()=>{m(f())}),Vt(),Ft();var p=Zt(),r=et(p);ir(r,e,"default",{get endTime(){return t(d)},get duration(){return t(g)}},null),b(X,p),St(),w()}var br=Lt("<div><!></div>");function xr(X,e){const f=de(e,["children","$$slots","$$events","$$legacy"]),z=de(f,["namespace","workflowId","runId","viewportHeight","onLoad"]);At(e,!1);let w=h(e,"namespace",8),d=h(e,"workflowId",8),g=h(e,"runId",8,""),i=h(e,"viewportHeight",8,360),a=h(e,"onLoad",8,()=>{});const H=async()=>{const[p,r]=await Promise.all([fr({namespace:w(),workflowId:d(),runId:g()}),gr({namespace:w(),workflowId:d(),runId:g()})]);return{workflow:p.workflow,history:r}},v=(p,r)=>{var s;a()();const c=(s=p==null?void 0:p.pendingActivities)!==null&&s!==void 0?s:[];return ke(r,"ascending",c)};Ft();var o=Zt(),m=et(o);ur(m,()=>L(H),null,(p,r)=>{var s=P(()=>{var{workflow:S,history:C}=t(r);return{workflow:S,history:C}}),c=P(()=>t(s).workflow),y=P(()=>t(s).history),T=br(),A=W(T);{let S=P(()=>($(t(c)),$(t(y)),L(()=>v(t(c),t(y)))));be(A,{get viewportHeight(){return i()},get workflow(){return t(c)},get groups(){return t(S)},readOnly:!0})}I(T),V(()=>Ct(T,1,`cursor-pointer overflow-auto ${$(z),L(()=>z.class)??""}`)),b(p,T)}),b(X,o),St()}var $r=Lt('<div class="flex items-center gap-1"><!> </div>'),Tr=Lt(" <!>",1),Pr=Lt('<div class="surface-primary p-4"><div class="font-medium leading-4 text-secondary">Child Workflow</div> <!></div>'),Er=yt('<g role="button" tabindex="0" class="relative z-50 svelte-1qsv8v3"><foreignObject><div class="flex flex-col"><div class="relative flex h-full items-center justify-between bg-slate-50 text-sm dark:bg-slate-800"><div class="flex h-full items-center gap-4 px-2"><!> <!></div> <div class="flex items-center gap-4"><!></div></div> <div class="surface-primary"><!></div> <!></div></foreignObject></g>');function Wr(X,e){At(e,!1);const f=()=>st(oe,"$page",z),[z,w]=Nt(),d=_(),g=_(),i=_(),a=_(),H=_(),v=_(),o=_();var m=_(),p=_();let r=h(e,"group",8),s=h(e,"canvasWidth",8),c=h(e,"x",8,0),y=h(e,"y",8),T=_();const A=G=>{Bt(he,G)},S=async()=>{await Ie(),l(d,t(T))};k(()=>t(T),()=>{l(d,t(T)||0)}),k(()=>t(d),()=>{A(t(d)||0)}),k(()=>$(r()),()=>{l(g,(r()===null||r()===void 0?void 0:r().finalClassification)||(r()===null||r()===void 0?void 0:r().classification))}),k(()=>(t(i),f()),()=>{(G=>{l(i,G.namespace)})(f().params)}),k(()=>$(s()),()=>{l(a,s())}),k(()=>$(r()),()=>{l(H,r().displayName)}),k(()=>($(r()),ue),()=>{l(v,r()&&r().eventList.find(ue))}),k(()=>(bt(m),$(r()),bt(p)),()=>{l(o,ye({start:l(m,r()===null||r()===void 0?void 0:r().initialEvent)===null||bt(m)===void 0?void 0:bt(m).eventTime,end:l(p,r()===null||r()===void 0?void 0:r().lastEvent)===null||bt(p)===void 0?void 0:bt(p).eventTime,includeMilliseconds:!0}))}),k(()=>($(r()),it),()=>{!(r()===null||r()===void 0)&&r().pendingActivity&&(r().pendingActivity.paused?l(g,it("workflows.paused")):r().pendingActivity.attempt>1?l(g,it("events.event-classification.retrying")):l(g,it("events.event-classification.pending")))}),Vt(),Ft();var C=Er(),U=W(C),F=W(U),B=W(F),Z=W(B),lt=W(Z);{var ct=G=>{sr(G,{get status(){return t(g)}})};tt(lt,G=>{t(g)&&G(ct)})}var j=u(lt),x=u(j);{var J=G=>{var ot=$r(),N=W(ot);Kt(N,{name:"clock"});var gt=u(N);I(ot),V(()=>mt(gt,` ${t(o)??""}`)),b(G,ot)};tt(x,G=>{t(o)&&G(J)})}I(Z);var vt=u(Z,2),rt=W(vt);lr(rt,{variant:"ghost",size:"xs",$$events:{click:()=>pe(r())},children:(G,ot)=>{ee();var N=Tr(),gt=et(N),E=u(gt);Kt(E,{name:"close"}),V(pt=>mt(gt,`${pt??""} `),[()=>($(it),L(()=>it("common.close")))]),b(G,N)},$$slots:{default:!0}}),I(vt),I(B);var xt=u(B,2),nt=W(xt);Ze(nt,{get group(){return r()},get event(){return $(r()),L(()=>r().initialEvent)}}),I(xt);var at=u(xt,2);{var ut=G=>{var ot=Pr(),N=u(W(ot),2);ie(N,()=>($(r()),L(()=>r().eventList.length)),gt=>{xr(gt,{get namespace(){return t(i)},get workflowId(){return t(v),L(()=>t(v).attributes.workflowExecution.workflowId)},get runId(){return t(v),L(()=>t(v).attributes.workflowExecution.runId)},viewportHeight:320,class:"surface-primary overflow-x-hidden border-t border-subtle",onLoad:S})}),I(ot),b(G,ot)};tt(at,G=>{t(v)&&G(ut)})}I(F),I(U),I(C),V(()=>{D(U,"x",c()),D(U,"y",y()),D(U,"width",t(a)),D(U,"height",t(d)),mt(j,` ${t(H)??""} `)}),we(F,"offsetHeight",G=>l(T,G)),b(X,C),St(),w()}var Ir=yt('<text fill="#fff" font-size="12" class="svelte-7nuc95"> </text>'),Hr=yt("<!><!>",1),Ar=yt("<!><!>",1);function Sr(X,e){At(e,!0);let f=h(e,"x1",3,0),z=h(e,"x2",3,1e3),w=h(e,"timelineHeight",3,1e3);const{radius:d}=jt,g=20,i=n(()=>z()-f()),a=n(()=>t(i)/g);var H=Ar(),v=et(H);{let m=n(()=>d/2),p=n(()=>[f(),w()]),r=n(()=>[f()+t(i),w()]);zt(v,{get strokeWidth(){return t(m)},get startPoint(){return t(p)},get endPoint(){return t(r)}})}var o=u(v);se(o,17,()=>Array(g),_e,(m,p,r)=>{const s=n(()=>f()+r*t(a)),c=n(()=>w()+d*2);var y=Hr(),T=et(y);{var A=U=>{{let F=n(()=>[t(s),0]),B=n(()=>[t(s),w()]);zt(U,{strokeWidth:.5,get startPoint(){return t(F)},get endPoint(){return t(B)},strokeDasharray:"2"})}};tt(T,U=>{r!==0&&U(A)})}var S=u(T);{var C=U=>{var F=Ir(),B=W(F,!0);I(F),V(Z=>{D(F,"transform",`rotate(90, ${t(s)??""}, ${t(c)??""})`),D(F,"x",t(s)-d),D(F,"y",t(c)+3),mt(B,Z)},[()=>ye({start:e.startTime,end:new Date(new Date(e.startTime.toString()).getTime()+e.duration/g*r),includeMilliseconds:e.duration/g<1e3})]),b(U,F)};tt(S,U=>{r!==0&&U(C)})}b(m,y)}),b(X,H),St()}var Lr=yt("<text><!></text>"),Dr=yt("<!><!><!>",1);function Gr(X,e){At(e,!0);var f;let z=h(e,"point",19,()=>[0,0]),w=h(e,"category",3,void 0),d=h(e,"status",3,"none"),g=h(e,"fontSize",3,"13px"),i=h(e,"fontWeight",3,"400"),a=h(e,"textAnchor",3,"start"),H=h(e,"backdrop",3,!1),v=h(e,"backdropHeight",3,0),o=h(e,"icon",3,void 0),m=h(e,"config",3,void 0),p=h(e,"label",3,!1);const r=n(()=>Se(z(),2)),s=n(()=>t(r)[0]),c=n(()=>t(r)[1]);let y=re(void 0);const T=n(()=>o()&&m()),A=n(()=>((f=t(y)===null||t(y)===void 0?void 0:t(y).getBBox())===null||f===void 0?void 0:f.width)||0),S=n(()=>t(T)?t(A)+36:t(A)+12),C=n(()=>t(T)&&a()==="start"?t(s)+m().radius*2:t(s));var U=Dr(),F=et(U);{var B=j=>{{let x=n(()=>[t(s)-v(),t(c)]),J=n(()=>[t(s)+t(S),t(c)]);zt(j,{get startPoint(){return t(x)},get endPoint(){return t(J)},get status(){return d()},get strokeWidth(){return v()}})}};tt(F,j=>{H()&&j(B)})}var Z=u(F);{var lt=j=>{{let x=n(()=>a()==="end"?t(s)-t(A)-v():t(s)),J=n(()=>t(c)-8),vt=n(()=>H()?"text-white":"text-primary");Kt(j,{get name(){return o()},get x(){return t(x)},get y(){return t(J)},get class(){return t(vt)}})}};tt(Z,j=>{t(T)&&j(lt)})}var ct=u(Z);ie(ct,()=>t(C),j=>{var x=Lr();let J;var vt=W(x);He(vt,()=>e.children??Ae),I(x),hr(x,rt=>l(y,rt),()=>t(y)),V(()=>{J=Ct(x,0,`cursor-pointer select-none outline-none ${w()??""} text-primary`,"svelte-gowbbf",J,{label:p(),backdrop:H()}),D(x,"x",t(C)),D(x,"y",t(c)+1),D(x,"font-size",g()),D(x,"font-weight",i()),D(x,"text-anchor",a())}),b(j,x)}),b(X,U),St()}var Or=yt("<foreignObject><div></div></foreignObject>"),zr=yt('<rect fill="transparent" pointer-events="all"></rect>'),Fr=yt("<!><!>",1),Mr=yt("<!><!><!><!>",1),Ur=yt('<!><g role="button" tabindex="0" class="relative cursor-pointer svelte-1vsmkab"><!><!></g>',1);function jr(X,e){At(e,!0);const f=()=>st(pr,"$authUser",z),[z,w]=Nt();var d,g;let i=h(e,"y",3,0),a=h(e,"group",7),H=h(e,"readOnly",3,!1);const{height:v,gutter:o,radius:m}=jt;let p=re(!1);const r=n(()=>e.canvasWidth-2*o),s=n(()=>a()===null||a()===void 0?void 0:a().pendingActivity),c=n(()=>t(s)&&((d=t(s).pauseInfo)===null||d===void 0?void 0:d.pauseTime));let y=re(void 0);or(async()=>{const M=tr(a());if(M)try{l(y,await er(M,{namespace:ge.params.namespace,settings:ge.data.settings,accessToken:f().accessToken}),!0),t(y)&&(a().decodedLocalActivity=t(y))}catch(O){console.warn("Failed to decode local activity:",O)}});const T=(M,O,q)=>{const K=Jt({start:e.startTime,end:M,onlyUnderSecond:!1}),It=a().eventList.map(Gt=>{const R=Jt({start:e.startTime,end:Gt.eventTime,onlyUnderSecond:!1})/K;return Math.round(R*O)+o});if(t(c)){const Y=Jt({start:e.startTime,end:t(c),onlyUnderSecond:!1})/K,R=Math.round(Y*O)+o;It.push(R)}const{textAnchor:ht,textIndex:$t,textPosition:_t,backdrop:dt}=nr(It,q,O,a().isPending,jt);return{points:It,textAnchor:ht,textIndex:$t,textPosition:_t,backdrop:dt}},A=n(()=>T(e.endTime,t(r),i())),S=n(()=>t(A).points),C=n(()=>t(A).textAnchor),U=n(()=>t(A).textIndex),F=n(()=>t(A).textPosition),B=n(()=>t(A).backdrop),Z=()=>{H()||pe(a())},lt=()=>{H()||l(p,!0)},ct=()=>{H()||l(p,!1)},j=n(()=>a().eventList.find(cr)),x=n(()=>t(j)&&((g=t(j).attributes)===null||g===void 0?void 0:g.attempt)>1),J=n(()=>a().isPending||!!t(c)),vt=n(()=>t(S).length>=2&&t(S)[t(S).length-1]-t(S)[0]+m*3),rt=n(()=>a().isPending&&e.canvasWidth-t(S)[0]-m*1.5),xt=n(()=>m*3),nt=n(()=>t(rt)||t(vt)||t(xt)),at=mr(["h-full w-full rounded-full border-2"],{variants:{category:{workflow:"border-blue-700 bg-blue-800/80 ",activity:"border-purple-700 bg-purple-800/80 ","child-workflow":"border-cyan-600  bg-cyan-600/80 ",timer:"border-yellow-700 bg-yellow-800/80",signal:"border-pink-700 bg-pink-800/80",update:"border-blue-700 bg-blue-800/80",other:"border-slate-700 bg-slate-800/80",nexus:"border-indigo-700 bg-indigo-800/80","local-activity":"border-slate-700 bg-slate-800/80",default:"border-purple-700 bg-purple-900/80"}}});var ut=Ur(),G=et(ut);{var ot=M=>{var O=Or(),q=W(O);I(O),V(K=>{D(O,"x",t(S)[0]-m*1.5),D(O,"y",i()-m*1.5),D(O,"width",t(nt)),D(O,"height",m*3),Ct(q,1,K)},[()=>Oe(at({category:a()?a().category:"default"}))]),b(M,O)};tt(G,M=>{t(p)&&M(ot)})}var N=u(G),gt=W(N);{var E=M=>{const O=n(()=>t(c)?t(S)[1]-t(S)[0]:e.canvasWidth-2*o);var q=zr();V(()=>{D(q,"y",i()-v/2),D(q,"x",t(S)[0]),D(q,"width",t(O)),D(q,"height",v)}),b(M,q)};tt(gt,M=>{t(J)&&M(E)})}var pt=u(gt);se(pt,17,()=>t(S),_e,(M,O,q)=>{const K=n(()=>t(S)[q+1]),It=n(()=>t(U)===q);var ht=Mr(),$t=et(ht);{var _t=ft=>{{let wt=n(()=>[t(O),i()]),Tt=n(()=>[t(K),i()]),Pt=n(()=>!!t(c)),Q=n(()=>!!t(c)),Ht=n(()=>m*2),Dt=n(()=>q===0&&a().lastEvent.classification==="Completed");zt(ft,{get startPoint(){return t(wt)},get endPoint(){return t(Tt)},get category(){return a().category},get classification(){return a().lastEvent.classification},get pending(){return t(Pt)},get paused(){return t(Q)},get strokeWidth(){return t(Ht)},get retried(){return t(x)},get scheduling(){return t(Dt)}})}};tt($t,ft=>{t(K)&&ft(_t)})}var dt=u($t);{var Gt=ft=>{var wt=Fr(),Tt=et(wt);{let Q=n(()=>[t(O),i()]),Ht=n(()=>[e.canvasWidth-o,i()]),Dt=n(()=>t(s)?t(s).attempt>1?"retry":"pending":a().category),Rt=n(()=>!!t(c)),Et=n(()=>m*2);zt(Tt,{get startPoint(){return t(Q)},get endPoint(){return t(Ht)},get category(){return t(Dt)},get classification(){return a().lastEvent.classification},pending:!0,get paused(){return t(Rt)},get strokeWidth(){return t(Et)}})}var Pt=u(Tt);{let Q=n(()=>[t(O),i()]);Qt(Pt,{get point(){return t(Q)},get classification(){return a().lastEvent.classification},icon:"retry",get r(){return m}})}b(ft,wt)};tt(dt,ft=>{!t(K)&&a().isPending&&!t(c)&&ft(Gt)})}var Y=u(dt);{var R=ft=>{{let wt=n(()=>{var Q,Ht;return(Ht=(Q=a())==null?void 0:Q.userMetadata)==null?void 0:Ht.summary}),Tt=n(()=>{var Q;return dr(a().initialEvent)?(Q=a())==null?void 0:Q.displayName:""}),Pt=n(()=>{var Q;return t(y)?it("events.category.local-activity"):(Q=a())==null?void 0:Q.displayName});rr(ft,{get value(){return t(wt)},get prefix(){return t(Tt)},get fallback(){return t(Pt)},children:me,$$slots:{default:(Q,Ht)=>{const Dt=n(()=>Ht.decodedValue);{let Rt=n(()=>m*2),Et=n(()=>t(s)&&!t(s).paused||t(x)?"retry":void 0);Gr(Q,{get point(){return t(F)},get textAnchor(){return t(C)},get backdrop(){return t(B)},get backdropHeight(){return t(Rt)},get config(){return jt},get icon(){return t(Et)},children:(Mt,le)=>{var Xt=Zt(),xe=et(Xt);{var $e=kt=>{var Wt=Ut();V(We=>mt(Wt,`${We??""}
            ${t(s).attempt??""} / ${(t(s).maximumAttempts||"∞")??""}
            • 
            ${t(Dt)??""}`),[()=>it("workflows.attempt")]),b(kt,Wt)},Te=kt=>{var Wt=Ut();V(()=>mt(Wt,`${t(j).attributes.attempt??""} • ${t(Dt)??""}`)),b(kt,Wt)},Pe=kt=>{var Wt=Ut();V(()=>mt(Wt,t(y).value)),b(kt,Wt)},Ee=kt=>{var Wt=Ut();V(()=>mt(Wt,t(Dt))),b(kt,Wt)};tt(xe,kt=>{t(s)?kt($e):t(x)?kt(Te,1):t(y)?kt(Pe,2):kt(Ee,!1)})}b(Mt,Xt)},$$slots:{default:!0}})}}}})}};tt(Y,ft=>{t(It)&&ft(R)})}var Ot=u(Y);{let ft=n(()=>[t(O),i()]),wt=n(()=>{var Pt;return(Pt=a().eventList[q])==null?void 0:Pt.classification}),Tt=n(()=>t(c)&&q!==0?"pause":t(y)?ve["local-activity"].name:ve[a().category].name);Qt(Ot,{get point(){return t(ft)},get classification(){return t(wt)},get icon(){return t(Tt)},get r(){return m}})}b(M,ht)}),I(N),V(()=>D(N,"height",v)),Ge("click",N,Z),Yt("keypress",N,Z),Yt("mouseenter",N,lt),Yt("mouseleave",N,ct),b(X,ut),St(),w()}De(["click"]);var Cr=yt('<g role="button" tabindex="0" class="relative cursor-pointer svelte-1hb0j3w"><!><!><!><!><!></g>');function Nr(X,e){At(e,!1);const f=_(),z=_();let w=h(e,"workflow",8),d=h(e,"length",8),g=h(e,"y",8);const{radius:i,height:a,gutter:H}=jt;k(()=>{},()=>{l(f,H)}),k(()=>(t(f),$(d())),()=>{l(z,t(f)+d()-2*H)}),Vt(),Ft();var v=Cr(),o=W(v);{let c=P(()=>[t(f),g()]),y=P(()=>[t(z),g()]),T=P(()=>i*2),A=P(()=>($(ae),$(w()),L(()=>ae(w()))));zt(o,{get startPoint(){return t(c)},get endPoint(){return t(y)},get status(){return $(w()),L(()=>w().status)},get strokeWidth(){return t(T)},get pending(){return $(w()),L(()=>w().isRunning)},get delayed(){return t(A)}})}var m=u(o);{let c=P(()=>[t(f),g()]);Qt(m,{get point(){return t(c)},get classification(){return $(w()),L(()=>w().status)},get r(){return i}})}var p=u(m);{let c=P(()=>t(f)-i/2),y=P(()=>g()-i/2);Kt(p,{name:"workflow",get x(){return t(c)},get y(){return t(y)},get width(){return i},get height(){return i},strokeWidth:"4",class:"text-black"})}var r=u(p);{let c=P(()=>[t(z),g()]);Qt(r,{get point(){return t(c)},get classification(){return $(w()),L(()=>w().status)},get r(){return i}})}var s=u(r);{let c=P(()=>t(z)-i/2),y=P(()=>g()-i/2);Kt(s,{name:"workflow",get x(){return t(c)},get y(){return t(y)},get width(){return i},get height(){return i},strokeWidth:"4",class:"text-black"})}I(v),V(()=>D(v,"height",a)),b(X,v),St()}var Rr=yt("<!><!>",1),Br=Lt('<div><div class="flex w-full justify-between text-xs"><p class="w-60 -translate-x-24 rotate-90"> </p> <p class="w-60 translate-x-24 rotate-90"> </p></div></div> <svg><!><!><!><!><!></svg>',1),qr=Lt('<div id="event-history-timeline-graph" class="relative h-auto overflow-auto border border-t-0 border-subtle bg-primary"><!></div>');function be(X,e){At(e,!1);const f=()=>st(he,"$activeGroupHeight",a),z=()=>st(Xe,"$eventStatusFilter",a),w=()=>st(Ye,"$fullEventHistory",a),d=()=>st(Ue,"$activeGroups",a),g=()=>st(ne,"$eventFilterSort",a),i=()=>st(Ve,"$timestamp",a),[a,H]=Nt(),v=_(),o=_(),m=_(),p=_(),r=_(),s=_(),c=_();var y=_(),T=_();let A=h(e,"x",8,0),S=h(e,"y",8,0),C=h(e,"workflow",8),U=h(e,"groups",8),F=h(e,"viewportHeight",8),B=h(e,"readOnly",8,!1),Z=h(e,"error",8,!1);const{height:lt,gutter:ct,radius:j}=jt;let x=_(0),J=_(0);const vt=nt=>{var at;l(J,(at=nt==null?void 0:nt.target)===null||at===void 0?void 0:at.scrollTop)};k(()=>($(B()),f()),()=>{l(v,B()?0:f())}),k(()=>($(U()),z()),()=>{l(o,Fe(U(),z()))}),k(()=>(bt(y),w(),$(C()),bt(T)),()=>{l(m,(l(y,w()[0])===null||bt(y)===void 0?void 0:bt(y).eventTime)<C().executionTime?l(T,w()[0])===null||bt(T)===void 0?void 0:bt(T).eventTime:C().executionTime)}),k(()=>($(C()),t(m)),()=>{l(p,!ae(C())&&t(m)||C().startTime)}),k(()=>(t(o),t(v)),()=>{l(r,Math.max(lt*(t(o).length+2),120)+t(v))}),k(()=>t(r),()=>{l(s,t(r)+120)}),k(()=>(d(),g(),t(v)),()=>{l(c,nt=>{const at=d()===null||d()===void 0?void 0:d().filter(ut=>g()==="ascending"?parseInt(ut)<parseInt(nt.id):parseInt(ut)>parseInt(nt.id));return at!=null&&at.length?t(v):0})}),Vt(),Ft();var rt=qr(),xt=W(rt);kr(xt,{get workflow(){return C()},get startTime(){return t(p)},children:me,$$slots:{default:(nt,at)=>{const ut=P(()=>at.endTime),G=P(()=>at.duration);var ot=Br(),N=et(ot);let gt;var E=W(N),pt=W(E),M=W(pt,!0);I(pt);var O=u(pt,2),q=W(O,!0);I(O),I(E),I(N);var K=u(N,2);let It;var ht=W(K);{let Y=P(()=>[ct,0]),R=P(()=>[ct,t(r)]),Ot=P(()=>j/2);zt(ht,{get startPoint(){return t(Y)},get endPoint(){return t(R)},get strokeWidth(){return t(Ot)}})}var $t=u(ht);{let Y=P(()=>[t(x)-ct,0]),R=P(()=>[t(x)-ct,t(r)]),Ot=P(()=>j/2);zt($t,{get startPoint(){return t(Y)},get endPoint(){return t(R)},get strokeWidth(){return t(Ot)}})}var _t=u($t);{let Y=P(()=>ct-j/4),R=P(()=>t(x)-ct+j/4);Sr(_t,{get x1(){return t(Y)},get x2(){return t(R)},get timelineHeight(){return t(r)},get startTime(){return t(p)},get duration(){return t(G)}})}var dt=u(_t);Nr(dt,{get workflow(){return C()},get y(){return lt},get length(){return t(x)}});var Gt=u(dt);se(Gt,3,()=>t(o),Y=>Y.id,(Y,R,Ot,ft)=>{const wt=P(()=>($(t(Ot)),t(c),t(R),L(()=>(t(Ot)+2)*lt+t(c)(t(R)))));var Tt=Rr(),Pt=et(Tt);{var Q=Et=>{var Mt=Zt(),le=et(Mt);ie(le,()=>(t(R),L(()=>t(R).eventList.length)),Xt=>{jr(Xt,{get y(){return t(wt)},get group(){return t(R)},get canvasWidth(){return t(x)},get startTime(){return t(p)},get endTime(){return t(ut)},get readOnly(){return B()}})}),b(Et,Mt)};tt(Pt,Et=>{(!F()||t(wt)>t(J)-2*lt&&t(wt)<t(J)+F()*lt)&&Et(Q)})}var Ht=u(Pt);{var Dt=Et=>{{let Mt=P(()=>t(wt)+1.33*j);Wr(Et,{get y(){return t(Mt)},get group(){return t(R)},get canvasWidth(){return t(x)}})}},Rt=n(()=>($(B()),d(),t(R),L(()=>!B()&&d().includes(t(R).id))));tt(Ht,Et=>{t(Rt)&&Et(Dt)})}b(Y,Tt)}),I(K),V((Y,R)=>{gt=Ct(N,1,"pointer-events-none sticky top-[120px]",null,gt,{invisible:!!d().length}),mt(M,Y),mt(q,R),D(K,"x",A()),D(K,"y",S()),D(K,"viewBox",`0 0 ${t(x)??""} ${t(s)??""}`),D(K,"height",t(s)),D(K,"width",t(x)),It=Ct(K,0,"-mt-4 svelte-1fw3am",null,It,{error:Z()})},[()=>(i(),t(p),L(()=>i()(t(p),{format:"short"}))),()=>(i(),$(t(ut)),L(()=>i()(t(ut),{format:"short"})))]),b(nt,ot)}}}),I(rt),V(()=>Ke(rt,F()?`max-height: ${F()}px;`:"")),we(rt,"clientWidth",nt=>l(x,nt)),Yt("scroll",rt,vt),b(X,rt),St(),H()}var Kr=Lt("<span></span> ",1),Vr=Lt("<!> <!> <!> <!>",1),Xr=Lt('<!> <div class="flex flex-col gap-2"><!> <!></div> <div class="relative pb-24"><div class="surface-background sticky top-0 z-[11] flex flex-wrap items-center justify-between gap-2 border-b border-subtle pb-2 md:top-12 md:pt-2 xl:gap-8"><div class="flex items-center gap-2"><h2> </h2> <!></div> <div class="flex items-center gap-2"><!></div></div> <div class="flex w-full flex-col"><!></div></div> <!>',1);function Yr(X,e){At(e,!1);const f=()=>st(oe,"$page",a),z=()=>st(wr,"$workflowRun",a),w=()=>st(ne,"$eventFilterSort",a),d=()=>st(qt,"$pauseLiveUpdates",a),g=()=>st(Je,"$filteredEventHistory",a),i=()=>st(Qe,"$currentEventHistory",a),[a,H]=Nt(),v=_(),o=_(),m=_(),p=_(),r=_(),s=_(),c=_(),y=_(),T=_(),A=_();ze(()=>{Re()});let S=_(!1);const C=()=>{const E=t(s)?"ascending":"descending";fe(f().url,{sort:E},ce)},U=()=>{fe(f().url,{refresh_off:!d()},ce)};k(()=>(t(v),f()),()=>{(E=>{l(v,E.namespace)})(f().params)}),k(()=>(t(o),z()),()=>{(E=>{l(o,E.workflow)})(z())}),k(()=>t(o),()=>{l(m,t(o)===null||t(o)===void 0?void 0:t(o).pendingActivities)}),k(()=>t(o),()=>{l(p,t(o)===null||t(o)===void 0?void 0:t(o).pendingNexusOperations)}),k(()=>f(),()=>{l(r,yr(f().url))}),k(()=>t(r),()=>{Bt(ne,t(r).sort),Bt(qt,t(r).refresh_off)}),k(()=>w(),()=>{l(s,w()==="descending")}),k(()=>(g(),t(m),t(p)),()=>{l(c,ke(g(),"ascending",t(m),t(p)))}),k(()=>(t(s),t(c)),()=>{l(y,t(s)?[...t(c)].reverse():t(c))}),k(()=>i(),()=>{l(T,vr(i(),"ascending"))}),k(()=>t(o),()=>{l(A,t(o)&&!(!(t(o)===null||t(o)===void 0)&&t(o).isRunning)&&!(!(t(o)===null||t(o)===void 0)&&t(o).isPaused))}),k(()=>(t(A),d()),()=>{t(A)&&d()&&Bt(qt,!1)}),Vt(),Ft();var F=Xr(),B=et(F);je(B,{});var Z=u(B,2),lt=W(Z);{var ct=E=>{{let pt=P(()=>(t(o),L(()=>{var M;return(M=t(o))==null?void 0:M.pendingWorkflowTask})));Be(E,{get error(){return t(T)},get pendingTask(){return t(pt)}})}};tt(lt,E=>{t(T)&&E(ct)})}var j=u(lt,2);{var x=E=>{qe(E,{get callbacks(){return t(o),L(()=>t(o).callbacks)}})};tt(j,E=>{t(o),L(()=>{var pt,M;return(M=(pt=t(o))==null?void 0:pt.callbacks)==null?void 0:M.length})&&E(x)})}I(Z);var J=u(Z,2),vt=W(J),rt=W(vt),xt=W(rt),nt=W(xt,!0);I(xt);var at=u(xt,2);Me(at,{}),I(rt);var ut=u(rt,2),G=W(ut);_r(G,{children:(E,pt)=>{var M=Vr(),O=et(M);{let ht=P(()=>t(s)?"descending":"ascending");te(O,{get leadingIcon(){return t(ht)},"data-testid":"zoom-in",size:"sm",$$events:{click:C},children:($t,_t)=>{ee();var dt=Ut();V(()=>mt(dt,t(s)?"Descending":"Ascending")),b($t,dt)},$$slots:{default:!0}})}var q=u(O,2);Ne(q,{compact:!1,minimized:!1});var K=u(q,2);te(K,{get disabled(){return t(A)},"data-testid":"pause",class:"border-l-0",size:"sm",$$events:{click:U},children:(ht,$t)=>{var _t=Kr(),dt=et(_t),Gt=u(dt);V(Y=>{Ct(dt,1,`h-1.5 w-1.5 rounded-full ${d()||t(A)?"bg-slate-300":"bg-green-600"}`),mt(Gt,` ${Y??""}`)},[()=>(d(),t(A),$(it),L(()=>d()||t(A)?it("workflows.auto-refresh-off"):it("workflows.auto-refresh-on")))]),b(ht,_t)},$$slots:{default:!0}});var It=u(K,2);te(It,{"data-testid":"download",leadingIcon:"download",size:"sm",$$events:{click:()=>l(S,!0)},children:(ht,$t)=>{ee();var _t=Ut();V(dt=>mt(_t,dt),[()=>($(it),L(()=>it("common.download")))]),b(ht,_t)},$$slots:{default:!0}}),b(E,M)},$$slots:{default:!0}}),I(ut),I(vt);var ot=u(vt,2),N=W(ot);{let E=P(()=>(t(T),L(()=>!!t(T))));be(N,{get workflow(){return t(o)},get groups(){return t(y)},viewportHeight:void 0,get error(){return t(E)}})}I(ot),I(J);var gt=u(J,2);Ce(gt,{get namespace(){return t(v)},get workflowId(){return t(o),L(()=>t(o).id)},get runId(){return t(o),L(()=>t(o).runId)},get open(){return t(S)},set open(E){l(S,E)},$$legacy:!0}),V(E=>mt(nt,E),[()=>($(it),L(()=>it("workflows.timeline-tab")))]),b(X,F),St(),H()}var Jr=Lt("<!> <!>",1);function Mn(X,e){At(e,!1);const f=()=>st(oe,"$page",z),[z,w]=Nt(),d=f().params.workflow;Ft();var g=Jr(),i=et(g);{let H=P(()=>`${it("workflows.timeline-tab")} | ${d}`);Le(i,{get title(){return t(H)},get url(){return f().url.href}})}var a=u(i,2);Yr(a,{}),b(X,g),St(),w()}export{Mn as component};
