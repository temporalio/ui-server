import{r as mt}from"../chunks/pfMRWl6z.js";import{f as We,k as Pe,l as Re}from"../chunks/Z8IfJyCM.js";import"../chunks/CWj6FrbW.js";import"../chunks/69_IOA4Y.js";import{p as He,l as Z,a as wt,f as W,e as m,b as Ke,g as e,m as u,k as oe,t as R,I as i,M as d,o as k,j as c,h as s,c as q,s as r,n as V,r as f,i as pt}from"../chunks/UnFCzZBm.js";import{i as Ge}from"../chunks/BBLBidKq.js";import{s as Xe,a as se,d as vt}from"../chunks/GmGfGY7t.js";import{p as Ye}from"../chunks/BUvCWaxB.js";import{P as $t}from"../chunks/Bu3uT3O7.js";import{o as gt,w as kt}from"../chunks/CDMQnRTF.js";import{s as F}from"../chunks/CX2avYX0.js";import{i as fe}from"../chunks/pI5hk1MB.js";import{C as _t}from"../chunks/Dca3VkJp.js";import{P as ht}from"../chunks/B6X1oQTW.js";import{A as yt}from"../chunks/ZChkMxQt.js";import{A as Ve}from"../chunks/DShpFQyZ.js";import{B as Te}from"../chunks/BucI9aEo.js";import{C as me}from"../chunks/svSl5Q80.js";import{I as qe}from"../chunks/dWO51a22.js";import{I as we}from"../chunks/DdRXkFba.js";import{L as Se}from"../chunks/BesXf-cm.js";import{L as Ae}from"../chunks/D6wj6dwk.js";import{M as Me}from"../chunks/C4RieDiD.js";import{T as xt}from"../chunks/BV10CEsJ.js";import{t as a}from"../chunks/DEjs8ZrU.js";import{g as bt}from"../chunks/m937edVN.js";import{c as It,e as Pt,g as Tt}from"../chunks/C7O2hdDn.js";import{c as St}from"../chunks/S5tDCMHZ.js";import{t as Ue}from"../chunks/BGz05qh2.js";import{g as At}from"../chunks/B88ITPUD.js";import{d as Wt,e as ze}from"../chunks/iEPjGoii.js";import{p as Be}from"../chunks/756y7qLl.js";import{a as Je}from"../chunks/D3qpmd67.js";import{w as Qt}from"../chunks/k4CUJ19V.js";const jt=async function({params:ee,parent:te}){var M,O;const l=await te();if(((M=l==null?void 0:l.settings)==null?void 0:M.disableWriteActions)||((O=l==null?void 0:l.settings)==null?void 0:O.startWorkflowDisabled)){const{namespace:S}=ee;mt(302,We({namespace:S}))}},Ir=Object.freeze(Object.defineProperty({__proto__:null,load:jt},Symbol.toStringTag,{value:"Module"}));var Dt=W('<div class="flex w-full items-center justify-between"><p> </p> <!></div>'),Ct=W(`<div><h3> </h3> <p class="text-xs text-secondary">Indexed fields used in a List Filter to filter a list of Workflow
            Executions.</p></div> <!>`,1),Ft=W('<div><!> <p class="text-xs text-secondary">Time to wait before dispatching the first workflow task.</p></div> <div class="flex flex-wrap items-center gap-2"><!> <p class="text-nowrap text-secondary"> </p></div>',1),Ot=W(`<div class="flex flex-wrap justify-between"><div><h3> </h3> <p class="text-xs text-secondary">Add context to Workflow Execution to help identity and understand
              its operations.</p></div> <p class="flex items-center gap-1 text-sm text-secondary"> <!></p></div> <!> <!> <!> <!>`,1),Et=W("<!> <!> <!>",1),Nt=W("<!> ",1),Lt=W('<div class="mt-2"><!></div>'),Rt=W('<div class="flex w-full flex-col justify-between gap-2 sm:items-center md:flex-row md:gap-4"><!> <!></div> <div class="flex w-full items-center justify-between gap-4"><!></div> <!> <!> <!> <!> <div class="mt-4 flex w-full flex-row justify-between gap-4 max-sm:flex-col"><!> <!></div> <!> <!>',1),Vt=W('<div class="flex w-full flex-col gap-4 pb-20"><!> <h1 class="mb-4 overflow-hidden" data-testid="start-workflow">Start Workflow</h1> <!></div>');function qt(ee,te){He(te,!1);const l=()=>se(Ye,"$page",S),le=()=>se(e(ue),"$encoding",S),M=()=>se(St,"$customSearchAttributes",S),O=()=>se(Tt,"$workflowsSearchParams",S),[S,pe]=Xe(),h=u(),U=u(),ve=u(),$e=u(),Qe=u(),Ze=At();let Q=u(""),E=u(""),K=u(""),z=u(""),ne=u(""),ie=u(""),ue=u(kt("json/plain")),de=u(""),B=u(""),ge="",ke="",_e="",G=u(""),J=u(void 0),re=u(!1),ae=u([]);function et(n){var y,x;if(!n)return{};const p=n.match(/WorkflowId: (.+?), RunId: (.+?)\.?$/);if(!p)return{};const o=(y=p[1])===null||y===void 0?void 0:y.trim(),X=(x=p[2])===null||x===void 0?void 0:x.trim();return!o||!X?{}:{workflowId:o,runId:X}}gt(()=>{r(Q,l().url.searchParams.get("workflowId")||""),r(E,l().url.searchParams.get("taskQueue")||""),r(K,l().url.searchParams.get("workflowType")||""),ge=l().url.searchParams.get("runId")||"",ke=l().url.searchParams.get("workflowId")||"",_e=l().url.searchParams.get("workflowType")||"",(ke||_e||ge)&&ot({runId:ge,workflowId:ke,workflowType:_e})});const tt=async()=>{try{r(G,"");const{runId:n}=await It({namespace:e(h),workflowId:e(Q),taskQueue:e(E),workflowType:e(K),input:e(z),summary:e(ne),details:e(ie),encoding:le(),messageType:e(de),searchAttributes:e(ae),identity:Ze,workflowStartDelay:Wt(e(B))});Ue.push({variant:"success",duration:5e3,message:a("workflows.start-workflow-success"),link:Pe({namespace:e(h),workflow:e(Q),run:n})})}catch(n){r(G,(n==null?void 0:n.message)||a("workflows.start-workflow-error")),Ue.push({variant:"error",message:a("workflows.start-workflow-error")})}},rt=()=>{r(Q,crypto.randomUUID()),Je({parameter:"workflowId",value:e(Q),url:l().url,allowEmpty:!0,options:{keepFocus:!0,noScroll:!0,replaceState:!0}})},at=async n=>{if(n){const{pollers:y}=await bt({namespace:e(h),queue:n});r(J,y.length)}},ot=async({runId:n,workflowId:y,workflowType:x})=>{var p;const o=await Pt({namespace:e(h),runId:n,workflowId:y,workflowType:x});if(r(z,o.input),e(ue).set(o.encoding),r(de,o.messageType),r(ne,o.summary),r(ie,o.details),o!=null&&o.searchAttributes){const X=Object.keys(M());Object.entries(o.searchAttributes).forEach(([H,xe])=>{X.includes(H)&&r(ae,[...e(ae),{label:H,value:xe,type:M()[H]}])})}(Object.keys((p=o==null?void 0:o.searchAttributes)!==null&&p!==void 0?p:{}).length||o!=null&&o.summary||o!=null&&o.details)&&r(re,!0)},he=(n,y)=>{const x=n.target.value;Je({parameter:y,value:x,url:l().url,allowEmpty:!0,options:{keepFocus:!0,noScroll:!0,replaceState:!0}})},st=n=>{try{return JSON.parse(n),!0}catch{return!1}};Z(()=>(e(h),l()),()=>{(n=>{r(h,n.namespace)})(l().params)}),Z(()=>e(G),()=>{r(U,et(e(G)))}),Z(()=>l(),()=>{r(ve,l().url.searchParams.get("taskQueue"))}),Z(()=>e(z),()=>{r($e,!e(z)||st(e(z)))}),Z(()=>(e(Q),e(E),e(K),e($e),l()),()=>{r(Qe,!!e(Q)&&!!e(E)&&!!e(K)&&!!e($e)&&!Qt(l()))}),Z(()=>e(ve),()=>{at(e(ve))}),wt(),Ge();var ye=Vt(),je=c(ye);{let n=k(()=>(d(We),e(h),O(),i(()=>`${We({namespace:e(h)})}?${O()}`)));Ae(je,{get href(){return e(n)},"data-testid":"back-to-workflows",icon:"chevron-left",children:(y,x)=>{V();var p=oe();R(o=>F(p,o),[()=>(d(a),i(()=>a("workflows.back-to-workflows")))]),m(y,p)},$$slots:{default:!0}})}var lt=s(je,4);me(lt,{class:"flex w-full flex-col gap-4 xl:w-3/4 2xl:w-1/2",children:(n,y)=>{var x=Rt(),p=q(x),o=c(p);we(o,{id:"workflowId",required:!0,label:"Workflow ID",class:"w-full grow",get value(){return e(Q)},set value(t){r(Q,t)},$$events:{blur:t=>he(t,"workflowId")},$$legacy:!0});var X=s(o,2);Te(X,{class:"mt-0 md:mt-6",variant:"secondary",leadingIcon:"retry",$$events:{click:rt},children:(t,b)=>{V();var j=oe("Random UUID");m(t,j)},$$slots:{default:!0}}),f(p);var H=s(p,2),xe=c(H);we(xe,{id:"taskQueue",required:!0,label:"Task Queue",class:"grow",get value(){return e(E)},set value(t){r(E,t)},$$events:{blur:t=>he(t,"taskQueue")},$$legacy:!0}),f(H);var De=s(H,2);{var nt=t=>{{let b=k(()=>e(J)>0?"success":"warning"),j=k(()=>e(J)?"Task Queue is Active":"Task Queue is Inactive");Ve(t,{get intent(){return e(b)},get title(){return e(j)},children:(_,N)=>{var I=Dt(),A=c(I),v=c(A);f(A);var w=s(A,2);{let $=k(()=>(d(Re),e(h),e(E),i(()=>Re({namespace:e(h),queue:e(E)}))));Ae(w,{get href(){return e($)},newTab:!0,children:(P,L)=>{V();var g=oe("View Task Queue");m(P,g)},$$slots:{default:!0}})}f(I),R($=>F(v,`${e(J)??""}
            ${$??""}`),[()=>(d(Be),e(J),i(()=>Be("Worker",e(J))))]),m(_,I)},$$slots:{default:!0}})}};fe(De,t=>{e(J)!==void 0&&t(nt)})}var Ce=s(De,2);we(Ce,{id:"workflowType",required:!0,label:"Workflow Type",get value(){return e(K)},set value(t){r(K,t)},$$events:{blur:t=>he(t,"workflowType")},$$legacy:!0});var Fe=s(Ce,2);ht(Fe,{get input(){return e(z)},set input(t){r(z,t)},get encoding(){return e(ue)},set encoding(t){vt(r(ue,t),"$encoding",S)},get messageType(){return e(de)},set messageType(t){r(de,t)},$$legacy:!0});var Oe=s(Fe,2);{var it=t=>{var b=Et(),j=q(b);me(j,{class:"flex flex-col gap-2",children:(I,A)=>{var v=Ct(),w=q(v),$=c(w),P=c($,!0);f($),V(2),f(w);var L=s(w,2);{let g=k(()=>(d(a),i(()=>a("common.add"))));yt(L,{get buttonCopy(){return e(g)},variant:"secondary",get attributesToAdd(){return e(ae)},set attributesToAdd(D){r(ae,D)},$$legacy:!0})}R(g=>F(P,g),[()=>(d(a),i(()=>a("search-attributes.custom-search-attributes")))]),m(I,v)},$$slots:{default:!0}});var _=s(j,2);me(_,{class:"flex flex-col gap-2",children:(I,A)=>{var v=Ft(),w=q(v),$=c(w);{let C=k(()=>(d(a),i(()=>a("workflows.workflow-start-delay"))));Se($,{for:"workflow-start-delay",get label(){return e(C)},class:"text-xl"})}V(2),f(w);var P=s(w,2),L=c(P);{let C=k(()=>(d(a),i(()=>a("workflows.workflow-start-delay")))),Y=k(()=>(e(B),i(()=>isNaN(Number(e(B))))));we(L,{id:"workflow-start-delay",get label(){return e(C)},labelHidden:!0,suffix:"sec",class:"w-36",get error(){return e(Y)},get value(){return e(B)},set value(ce){r(B,ce)},$$legacy:!0})}var g=s(L,2),D=c(g,!0);f(g),f(P),R(C=>F(D,C),[()=>(d(ze),e(B),i(()=>ze(e(B))))]),m(I,v)},$$slots:{default:!0}});var N=s(_,2);me(N,{class:"flex flex-col gap-2",children:(I,A)=>{var v=Ot(),w=q(v),$=c(w),P=c($),L=c(P,!0);f(P),V(2),f($);var g=s($,2),D=c(g),C=s(D);{let T=k(()=>(d(a),i(()=>a("workflows.markdown-description"))));xt(C,{topRight:!0,width:200,get text(){return e(T)},children:(Ie,Ut)=>{qe(Ie,{name:"info"})},$$slots:{default:!0}})}f(g),f(w);var Y=s(w,2);{let T=k(()=>(d(a),i(()=>a("workflows.summary"))));Se(Y,{get label(){return e(T)},for:"summary"})}var ce=s(Y,2);Me(ce,{get content(){return e(ne)},set content(T){r(ne,T)},$$legacy:!0});var Le=s(ce,2);{let T=k(()=>(d(a),i(()=>a("workflows.details"))));Se(Le,{get label(){return e(T)},for:"details"})}var ft=s(Le,2);Me(ft,{get content(){return e(ie)},set content(T){r(ie,T)},$$legacy:!0}),R((T,Ie)=>{F(L,T),F(D,`${Ie??""} `)},[()=>(d(a),i(()=>a("workflows.user-metadata"))),()=>(d(a),i(()=>a("workflows.markdown-supported")))]),m(I,v)},$$slots:{default:!0}}),m(t,b)};fe(Oe,t=>{e(re)&&t(it)})}var be=s(Oe,2),Ee=c(be);{let t=k(()=>e(re)?"chevron-up":"chevron-down");Te(Ee,{variant:"ghost",class:"max-sm:w-full",get trailingIcon(){return e(t)},$$events:{click:()=>r(re,!e(re))},children:(b,j)=>{V();var _=oe();R(N=>F(_,N),[()=>(d(a),i(()=>a("common.more-options")))]),m(b,_)},$$slots:{default:!0}})}var ut=s(Ee,2);{let t=k(()=>!e(Qe));Te(ut,{get disabled(){return e(t)},"data-testid":"start-workflow-button",class:"max-sm:w-full",$$events:{click:tt},children:(b,j)=>{V();var _=oe();R(N=>F(_,N),[()=>(d(a),i(()=>a("workflows.start-workflow")))]),m(b,_)},$$slots:{default:!0}})}f(be);var Ne=s(be,2);{var dt=t=>{Ve(t,{intent:"error",get title(){return e(G)},children:(b,j)=>{var _=pt(),N=q(_);{var I=A=>{var v=Lt(),w=c(v);{let $=k(()=>(d(Pe),e(h),e(U),i(()=>Pe({namespace:e(h),workflow:e(U).workflowId,run:e(U).runId}))));Ae(w,{get href(){return e($)},class:"inline-flex items-center gap-1",children:(P,L)=>{var g=Nt(),D=q(g);qe(D,{name:"external-link",class:"h-4 w-4"});var C=s(D);R(Y=>F(C,` ${Y??""}`),[()=>(d(a),i(()=>a("workflows.view-running-workflow")))]),m(P,g)},$$slots:{default:!0}})}f(v),m(A,v)};fe(N,A=>{e(U),i(()=>e(U).workflowId&&e(U).runId)&&A(I)})}m(b,_)},$$slots:{default:!0}})};fe(Ne,t=>{e(G)&&t(dt)})}var ct=s(Ne,2);_t(ct,{}),m(n,x)},$$slots:{default:!0}}),f(ye),m(ee,ye),Ke(),pe()}var Mt=W("<!> <!>",1);function Pr(ee,te){He(te,!1);const l=()=>se(Ye,"$page",le),[le,M]=Xe();Ge();var O=Mt(),S=q(O);$t(S,{title:"Start Workflow",get url(){return l().url.href}});var pe=s(S,2);qt(pe,{}),m(ee,O),Ke(),M()}export{Pr as component,Ir as universal};
