import"../chunks/CWj6FrbW.js";import{p as W,f as P,c as X,j as d,r as c,h as m,g as e,v as p,s as g,ax as q,t as k,e as v,b as Y,n as ee,k as te}from"../chunks/DZ1-1a5q.js";import{s as u}from"../chunks/DxwvfIkW.js";import{i as ie}from"../chunks/DnKg3jxh.js";import{p as $,s as le,a as Q}from"../chunks/TaaIktnz.js";import{g as V}from"../chunks/Co8ye45H.js";import{p as de}from"../chunks/R4HJJQL1.js";import{P as ce}from"../chunks/BvHFjIFb.js";import{L as ue}from"../chunks/y0sr2j8b.js";import{t as l}from"../chunks/DEjs8ZrU.js";import{B as me}from"../chunks/D8HFYSzB.js";import{I as pe}from"../chunks/pyfXDEkt.js";import{M as fe}from"../chunks/BAyo-NfC.js";import{N as ve,g as ge}from"../chunks/DpAygczz.js";import{d as xe,u as _e}from"../chunks/CBGtUTXE.js";import{n as he}from"../chunks/DpYqgY9S.js";import{m as O,n as be}from"../chunks/OsXtHQDs.js";var Ne=P('<div class="flex w-full grow justify-end"><!></div>'),ye=P('<h3 slot="title"> </h3>'),we=P('<div slot="content" class="flex flex-col gap-4"><p> <strong class="select-all"> </strong> </p> <p> <strong class="select-all"> </strong> </p> <!></div>'),Le=P('<div class="flex flex-col gap-8"><div class="flex flex-col gap-1"><h1 data-testid="namespace-selector-title"> </h1></div> <!></div> <!>',1);function $e(I,t){W(t,!0);let z=$(t,"targetNamespaceList",19,()=>[]),b=$(t,"callerNamespaceList",19,()=>[]),D=$(t,"loading",3,!1),B=$(t,"isCloud",3,!1),a=$(t,"nameRegexPattern",3,/^[a-zA-Z][a-zA-Z0-9-]*[a-zA-Z0-9]$/),x=$(t,"cancelHref",3,"/nexus"),N=q(!1),E=q("");var M=Le(),y=X(M),w=d(y),T=d(w),R=d(T,!0);c(T),c(w);var n=m(w,2);{const i=(_,r)=>{let h=()=>r==null?void 0:r().submitting;var s=Ne(),f=d(s);me(f,{variant:"destructive",get disabled(){return h()},class:"max-sm:w-full","data-testid":"delete-endpoint-button",$$events:{click:()=>g(N,!0)},children:(L,A)=>{ee();var C=te();k(Z=>u(C,Z),[()=>l("common.delete")]),v(L,C)},$$slots:{default:!0}}),c(s),v(_,s)};let H=p(()=>l("common.save"));ve(n,{get endpoint(){return t.endpoint},get nameRegexPattern(){return a()},nameHintText:"",get targetNamespaceList(){return z()},get callerNamespaceList(){return b()},get isCloud(){return B()},get cancelHref(){return x()},get submitButtonText(){return e(H)},get onSubmit(){return t.onUpdate},nameDisabled:!0,footer:i,$$slots:{footer:!0}})}c(y);var o=m(y,2);{let i=p(()=>l("common.delete")),H=p(()=>l("common.cancel")),_=p(()=>{var r;return e(E)!==((r=t.endpoint.spec)==null?void 0:r.name)});fe(o,{id:"delete-endpoint-modal",get loading(){return D()},confirmType:"destructive",get confirmText(){return e(i)},get cancelText(){return e(H)},get confirmDisabled(){return e(_)},get open(){return e(N)},set open(r){g(N,r,!0)},$$events:{confirmModal(...r){var h;(h=t.onDelete)==null||h.apply(this,r)},cancelModal:()=>g(N,!1)},$$slots:{title:(r,h)=>{var s=ye(),f=d(s,!0);c(s),k(L=>u(f,L),[()=>l("nexus.delete-modal-title")]),v(r,s)},content:(r,h)=>{var s=we(),f=d(s),L=d(f),A=m(L),C=d(A,!0);c(A);var Z=m(A);c(f);var j=m(f,2),G=d(j),F=m(G),ae=d(F,!0);c(F);var re=m(F);c(j);var ne=m(j,2);{let S=p(()=>l("nexus.delete-endpoint"));pe(ne,{id:"delete-endpoint",labelHidden:!0,get label(){return e(S)},get value(){return e(E)},set value(U){g(E,U,!0)}})}c(s),k((S,U,oe,se)=>{var J,K;u(L,`${S??""} `),u(C,((J=t.endpoint.spec)==null?void 0:J.name)||""),u(Z,`?
      ${U??""}`),u(G,`${oe??""} `),u(ae,((K=t.endpoint.spec)==null?void 0:K.name)||""),u(re,` ${se??""}`)},[()=>l("nexus.delete-modal-confirmation-preface"),()=>l("nexus.delete-modal-confirmation-postface"),()=>l("nexus.type-confirm-preface"),()=>l("nexus.type-confirm-postface")]),v(r,s)}}})}k(()=>{var i;return u(R,((i=t.endpoint.spec)==null?void 0:i.name)||"")}),v(I,M),Y()}var Pe=P('<div class="flex flex-col gap-4"><!> <!></div>'),Ee=P("<!> <!>",1);function qe(I,t){W(t,!0);const z=()=>Q(he,"$namespaces",D),b=()=>Q(de,"$page",D),[D,B]=le(),a=p(()=>t.data.endpoint);let x=q(!1);const N=async n=>{if(!(e(a)===null||e(a)===void 0)&&e(a).id){g(x,!0);try{const o={...await ge(n),id:e(a).id,version:e(a).version};await _e(e(a).id,o),await V(O(e(a).id),{invalidateAll:!0})}catch(o){throw console.error("Error updating endpoint",o),o}finally{g(x,!1)}}},E=async()=>{if(!(e(a)===null||e(a)===void 0)&&e(a).id){g(x,!0);try{await xe(e(a).id,String(e(a).version)),await V(be())}catch(n){throw console.error("Error deleting endpoint",n),n}finally{g(x,!1)}}},M=p(()=>z().map(n=>{var o,i;return{namespace:(i=(o=n.namespaceInfo)===null||o===void 0?void 0:o.name)!==null&&i!==void 0?i:""}}));var y=Ee(),w=X(y);{let n=p(()=>`Edit ${l("nexus.nexus-endpoint",{id:b().params.id})}`);ce(w,{get title(){return e(n)},get url(){return b().url.href}})}var T=m(w,2);{var R=n=>{var o=Pe(),i=d(o);{let _=p(()=>O(b().params.id));ue(i,{get href(){return e(_)},icon:"chevron-left",children:(r,h)=>{ee();var s=te();k(f=>u(s,f),[()=>l("nexus.back-to-endpoint")]),v(r,s)},$$slots:{default:!0}})}var H=m(i,2);{let _=p(()=>O(b().params.id));$e(H,{get endpoint(){return e(a)},get targetNamespaceList(){return e(M)},onUpdate:N,onDelete:E,get loading(){return e(x)},get cancelHref(){return e(_)}})}c(o),v(n,o)};ie(T,n=>{e(a)&&n(R)})}v(I,y),Y(),B()}export{qe as component};
